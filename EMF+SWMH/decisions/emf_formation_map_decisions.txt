# -*- ck2.decisions -*-

decisions = {
	emf_create_leon = {
		ai = no
		potential = { always = no }
		effect = {}
	}

	emf_create_castille = {
		ai = no
		potential = { always = no }
		effect = {}
	}

	emf_create_portugal = {
		ai = no
		potential = { always = no }
		effect = {}
	}

	emf_create_aragon = {
		ai = no
		potential = { always = no }
		effect = {}
	}

	emf_create_powys = {
		only_playable = yes
		is_high_prio = yes
		ai_check_interval = 120

		potential = {
			lower_tier_than = KING
			OR = {
				has_landed_title = d_powys
				has_landed_title = c_powys_wenwynwyn
				has_landed_title = c_rhwng
				has_landed_title = c_buellt
				has_landed_title = c_shrewsbury
				has_landed_title = c_hereford
			}
			d_powys = {
				NAND = {
					c_powys_wenwynwyn = { de_jure_liege = PREV }
					c_rhwng = { de_jure_liege = PREV }
					c_buellt = { de_jure_liege = PREV }
					c_shrewsbury = { de_jure_liege = PREV }
					c_hereford = { de_jure_liege = PREV }
				}
				OR = {
					has_holder = no
					holder = ROOT
				}
			}
			has_random_dejure_or_title_names = no
			emf_hiprio_decision_basic_potential = yes
		}
		allow = {
			is_adult = yes
			independent = yes
			trigger_if = {
				limit = { ai = no }
				war = no
				prisoner = no
				has_regent = no
			}
			trigger_else = {
				is_primary_war_defender = no
			}
			is_incapable = no
			trigger_if = {
				limit = { ai = no }
				prestige >= 500
			}
			custom_tooltip = {
				text = NEEDS_100_GOLD_COST
				wealth >= 100
			}
			custom_tooltip = {
				text = DIRECTLY_HOLDS_AT_LEAST_3_OF_THE_POWYS_COUNTIES_SWMH
				calc_true_if = {
					amount = 3
					has_landed_title = c_powys_wenwynwyn
					has_landed_title = c_rhwng
					has_landed_title = c_buellt
					has_landed_title = c_shrewsbury
					has_landed_title = c_hereford
				}
			}
			trigger_if = {
				limit = { NOT = { has_landed_title = c_powys_wenwynwyn } }
				c_powys_wenwynwyn = { owner_under_ROOT = yes }
			}
			trigger_if = {
				limit = { NOT = { has_landed_title = c_rhwng } }
				c_rhwng = { owner_under_ROOT = yes }
			}
			trigger_if = {
				limit = { NOT = { has_landed_title = c_buellt } }
				c_buellt = { owner_under_ROOT = yes }
			}
			trigger_if = {
				limit = { NOT = { has_landed_title = c_shrewsbury } }
				c_shrewsbury = { owner_under_ROOT = yes }
			}
			trigger_if = {
				limit = { NOT = { has_landed_title = c_hereford } }
				c_hereford = { owner_under_ROOT = yes }
			}
		}
		effect = {
			wealth = -100
			prestige = 250
			d_powys = {
				c_powys_wenwynwyn = {
					show_scope_change = no
					if = {
						limit = { NOT = { de_jure_liege = PREV } }
						de_jure_liege = PREV
					}
				}
				c_rhwng = {
					show_scope_change = no
					if = {
						limit = { NOT = { de_jure_liege = PREV } }
						de_jure_liege = PREV
					}
				}
				c_buellt = {
					show_scope_change = no
					if = {
						limit = { NOT = { de_jure_liege = PREV } }
						de_jure_liege = PREV
					}
				}
				c_shrewsbury = {
					show_scope_change = no
					if = {
						limit = { NOT = { de_jure_liege = PREV } }
						de_jure_liege = PREV
					}
				}
				c_hereford = {
					show_scope_change = no
					if = {
						limit = { NOT = { de_jure_liege = PREV } }
						de_jure_liege = PREV
					}
				}
			}
			primary_title = {
				show_scope_change = no
				d_powys = {
					show_scope_change = no
					if = {
						limit = { has_holder = no }
						hidden_effect = {
							if = {
								limit = { NOT = { is_title_active = THIS } }
								activate_title = { title = THIS status = yes }
							}
						}
						grant_title = ROOT
						copy_title_laws = PREV
					}
				}
			}
		}
		ai_will_do = {
			factor = 10
		}
	}
}
