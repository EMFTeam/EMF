# -*- ck2.scripted_effects -*-

emf_grant_golden_horde_titles = {
	any_demesne_title = {
		limit = {
			NOT = { tier = EMPEROR }
			OR = {
				location = { emf_golden_holde_province = yes }
				capital_scope = { emf_golden_holde_province = yes }
			}
		}
		grant_title = event_target:first_mongol_heir
	}
}

emf_grant_il_khanate_titles = {
	any_demesne_title = {
		limit = {
			NOT = { tier = EMPEROR }
			OR = {
				location = { emf_il_khanate_province = yes }
				capital_scope = { emf_il_khanate_province = yes }
			}
		}
		grant_title = event_target:second_mongol_heir
	}
}

emf_grant_chagatai_titles = {
	any_demesne_title = {
		limit = {
			NOT = { tier = EMPEROR }
			OR = {
				location = { region = emf_region_mongol_east }
				capital_scope = { region = emf_region_mongol_east }
			}
		}
		grant_title = event_target:third_mongol_heir
	}
}

emf_create_mongol_dynasty = {
	# Send dynasty-changing event to children
	save_event_target_as = new_dynasty_head
	any_child_even_if_dead = {
		limit = { dynasty = ROOT }
		character_event = { id = emf.mongol.102 days = 1 }
	}
	# Then actually change dynasty
	if = {
		limit = {
			OR = {
				NOT = { dynasty = 11100 }
				NOR = {
					has_character_flag = line_of_jochi
					has_character_flag = line_of_chagatai
					has_character_flag = line_of_ogodei
					has_character_flag = line_of_tolui
				}
			}
		}
		dynasty = father_bastard
	}
	if = {
		limit = {
			dynasty = 11100 # Genghis Khan's dynasty
			OR = {
				has_character_flag = line_of_jochi
				has_character_flag = line_of_chagatai
				has_character_flag = line_of_ogodei
				has_character_flag = line_of_tolui
			}
		}
		if = {
			limit = { has_character_flag = line_of_jochi }
			dynasty = 7379
		}
		if = {
			limit = { has_character_flag = line_of_chagatai }
			dynasty = 7380
		}
		if = {
			limit = { has_character_flag = line_of_ogodei }
			dynasty = 1000054550
		}
		if = {
			limit = { has_character_flag = line_of_tolui }
			dynasty = 101916
		}
	}
}

emf_create_courtiers_for_ROOT = {
	create_random_soldier = {
		random_traits = yes
		dynasty = random
		religion = ROOT
		culture = ROOT
		female = no
		age = 30
		attributes = {
			martial = 5
		}
	}
	new_character = {
		opinion = { who = ROOT modifier = opinion_loyal_servant }
	}
	create_random_soldier = {
		random_traits = yes
		dynasty = random
		religion = ROOT
		culture = ROOT
		female = no
		age = 40
		attributes = {
			martial = 5
		}
	}
	new_character = {
		opinion = { who = ROOT modifier = opinion_loyal_servant }
	}
	create_random_soldier = {
		random_traits = yes
		dynasty = random
		religion = ROOT
		culture = ROOT
		female = no
		age = 30
		attributes = {
			martial = 5
		}
	}
	new_character = {
		opinion = { who = ROOT modifier = opinion_loyal_servant }
	}
	create_random_diplomat = {
		random_traits = yes
		dynasty = random
		religion = ROOT
		culture = ROOT
		female = no
		age = 24
	}
	new_character = {
		opinion = { who = ROOT modifier = opinion_loyal_servant }
	}
	create_random_intriguer = {
		random_traits = yes
		dynasty = random
		religion = ROOT
		culture = ROOT
		female = no
		age = 33
	}
	new_character = {
		opinion = { who = ROOT modifier = opinion_loyal_servant }
	}
	create_random_steward = {
		random_traits = yes
		dynasty = random
		religion = ROOT
		culture = ROOT
		female = no
		age = 25
	}
	new_character = {
		opinion = { who = ROOT modifier = opinion_loyal_servant }
	}
	create_character = {
		random_traits = yes
		dynasty = random
		religion = ROOT
		culture = ROOT
		female = yes
		age = 16
	}
	new_character = {
		opinion = { who = ROOT modifier = opinion_loyal_servant }
	}
}
