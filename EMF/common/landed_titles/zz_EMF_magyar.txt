# -*- ck2.landed_titles -*-

# If the game strictly began in 1066/1043, then keeping the ducal name-tier for k_bavaria would make sense, but most starts
# these days are from the TOG bookmark, and a name_tier of KING is far more appropriate for k_bavaria in that case while
# doing no harm to the later-starts case.
k_hungary = {
	allow = {
		hidden_tooltip = {
			OR = {
				ai = no
				NOT = { culture = hungarian }
				is_tribal = no
				has_global_flag = emf_conquest_hungary_completed
			}
		}
	}
	gain_effect = {
		if = {
			limit = {
				culture = hungarian
				k_hungary = { NOT = { has_title_flag = hungary_name_change } }
			}
			k_hungary = {
				set_title_flag = hungary_name_change
				reset_coa = THIS
				set_name = ""
				adjective = ""
			}
		}
		# If title receiver also owns the Magyar tribal title, then
		# we can safely destroy and deactivate that title now.
		k_magyar = { # Magyar
			if = {
				limit = { holder = PREV }
				k_hungary = {
					copy_title_laws = PREV
					copy_title_history = PREV
					make_primary_title = yes
				}
			}
			if = {
				limit = {
					is_title_active = THIS
					OR = {
						has_holder = no
						holder = PREV
					}
				}
				hidden_tooltip = {
					# If it somehow became non-titular, then we must be sure
					# to transfer its de jure territory to k_hungary first.
					any_direct_de_jure_vassal_title = { de_jure_liege = k_hungary }
				}
				destroy_landed_title = THIS
				activate_title = { title = THIS status = no }
			}
		}
	}
}

k_magyar = {
	title = GYULA
	title_female = GYULUN
}
