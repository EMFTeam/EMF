# -*- ck2.objectives -*-

# Faction tags need to start with 'faction_'

# Supported types:
# liege_titles, liege_titles_w_claimant, character

# The succession law factions have hard coded elements to ensure that the correct heir is shown in Plot and
# Faction interfaces and that AI faction members vote for laws in accordance with the faction goal.
# The valid tags correspond to the law name: faction_succ_seniority, faction_succ_primogeniture, etc.
# (faction_succ_ultimogeniture is fully supported by the code, but not currently implemented)

###############
# FACTIONS
###############

# Independence
faction_independence = {
	type = character

	warning_level = 0.85 # At this level of faction power we give player an alert. Set to 0 for no alerts.

	# Plotter scope
	potential = {
		emf_faction_basic_potential = yes
		OR = {
			ai = yes
			is_feudal = yes
			is_tribal = yes
			is_nomadic = yes
			higher_tier_than = COUNT
		}
		liege = {
			#independent = yes
			higher_real_tier_than = COUNT
			NOT = {
				any_war = {
					defender = { character = PREV }
					using_cb = cb_faction_independence
				}
			}
			# Not allowed to start factions like this if our capital borders the liege's capital
			NOT = {
				capital_scope = {
					any_neighbor_province = {
						ROOT = {
							capital_scope = {
								province = PREVPREV
							}
						}
					}
				}
			}
		}
		# No independence factions in merchant republics
		NAND = {
			is_patrician = yes
			liege = {
				is_merchant_republic = yes
			}
		}
		NOT = { has_character_modifier = faction_independence_ultimatum_timer }
	}

	# Target scope
	allow = {
		prisoner = no
		NOR = {
			has_opinion_modifier = {
				who = LIEGE
				modifier = opinion_coerced_into_leaving_faction
			}
			AND = {
				is_nomadic = yes
				clan_opinion = { who = LIEGE value = 0 }
			}
		}
	}

	# Faction member scope (ROOT = joiner, FROM = target)
	allow_join = {
		ROOT = {
			emf_faction_basic_allow_join = yes
			OR = {
				is_nomadic = no
				NOT = {
					clan_opinion = { who = LIEGE value = 0 }
				}
			}
			# No independence factions in merchant republics
			NAND = {
				is_patrician = yes
				liege = {
					is_merchant_republic = yes
				}
			}
		}
	}

	# AI creation weight
	chance = {
		factor = 3

		modifier = {
			factor = 0
			OR = {
				emf_faction_has_special_chance_blocker = yes
				war = yes
				preparing_invasion = yes
				is_incapable = yes
				is_adult = no
				is_landed = no
				has_character_modifier = in_seclusion
				has_landed_title = k_orthodox
				AND = {
					is_patrician = yes
					is_merchant_republic = no
				}
				liege = { current_heir = { character = ROOT } }
				liege = { player_heir = { character = ROOT } }
			}
		}
		modifier = {
			factor = 0
			liege = {
				independent = yes
				OR = {
					religion = { target = ROOT target_type = true }
					AND = {
						has_secret_religion = yes
						ROOT = {
							can_see_secret_religion = PREV
							true_religion = { target = PREV target_type = secret }
						}
					}
				}
				culture = ROOT
				OR = {
					NOT = { distance = { who = ROOT value = 90 } }
					AND = {
						NOT = { distance = { who = ROOT value = 200 } }
						ROOT = { emf_true_unreformed_pagan = no }
					}
				}
			}
		}
		modifier = {
			factor = 0
			lower_real_tier_than = KING
			emf_true_unreformed_pagan = no
			liege = {
				independent = yes
				OR = {
					religion_group = { target = ROOT target_type = true }
					AND = {
						has_secret_religion = yes
						ROOT = {
							can_see_secret_religion = PREV
							OR = {
								true_religion_group = { target = PREV target_type = secret }
								emf_syncretized_true_religion_with_PREVs_true_religion = yes
							}
						}
					}
					AND = {
						OR = {
							has_secret_religion = no
							NOT = { ROOT = { can_see_secret_religion = PREV } }
						}
						ROOT = { emf_syncretized_true_religion_with_PREV = yes }
					}
				}
				culture_group = ROOT
				OR = {
					religion = { target = ROOT target_type = true }
					AND = {
						has_secret_religion = yes
						ROOT = {
							can_see_secret_religion = PREV
							true_religion = { target = PREV target_type = secret }
						}
					}
					culture = ROOT
				}
				ROOT = {
					emf_hostile_true_religion_to_PREV = no
				}
				trigger_if = {
					limit = {
						OR = {
							is_tribal = yes
							is_nomadic = yes
						}
					}
					NOT = { distance = { who = ROOT value = 90 } }
				}
				trigger_else = {
					NOT = { distance = { who = ROOT value = 150 } }
				}
			}
		}
		# Try to exclude people who should rather support a claimant
		modifier = {
			factor = 0
			lower_tier_than = KING
			liege = {
				NAND = {
					culture = ROOT
					OR = {
						religion = { target = ROOT target_type = true }
						AND = {
							has_secret_religion = yes
							ROOT = {
								can_see_secret_religion = PREV
								true_religion = { target = PREV target_type = secret }
							}
						}
					}
				}
				any_demesne_title = {
					OR = {
						is_primary_holder_title = yes
						higher_tier_than = DUKE
					}
					ROOT = {
						primary_title = {
							de_jure_liege_or_above = PREVPREV
						}
					}
					any_claimant = {
						culture = ROOT
						OR = {
							religion = { target = ROOT target_type = true }
							AND = {
								has_secret_religion = yes
								ROOT = {
									can_see_secret_religion = PREV
									true_religion = { target = PREV target_type = secret }
								}
							}
						}
						reverse_opinion = { who = ROOT value = 0 }
						ROOT = {
							opinion_diff = {
								first = PREV
								second = LIEGE
								value = 10
								as_if_liege = yes
							}
						}
					}
				}
			}
		}
		modifier = {
			factor = 0
			trigger_if = {
				limit = {
					liege = {
						OR = {
							is_tribal = yes
							is_nomadic = yes
						}
					}
				}
				OR = {
					AND = {
						NOT = { leads_faction = faction_independence }
						opinion = { who = LIEGE value = 60 }
					}
					AND = {
						leads_faction = faction_independence
						opinion = { who = LIEGE value = 80 }
					}
				}
			}
			trigger_else = {
				OR = {
					AND = {
						NOT = { leads_faction = faction_independence }
						opinion = { who = LIEGE value = 40 }
					}
					AND = {
						leads_faction = faction_independence
						opinion = { who = LIEGE value = 60 }
					}
				}
			}
		}
		modifier = {
			factor = 0.05
			emf_is_hre_being_restored = yes
			liege = {
				emf_has_hre_precursor_kingdom = yes
				NOT = {
					any_player = {
						vassal_of = PREV
						in_faction = faction_independence
					}
				}
			}
		}
		modifier = {
			factor = 0.2
			emf_pacifist_true_religion = yes
		}
		modifier = {
			factor = 0.1
			ai_ambition <= -40
		}
		modifier = {
			factor = 0.1
			emf_true_unreformed_pagan = no
			is_tribal = no
			is_nomadic = no
			liege = {
				higher_real_tier_than = DUKE
				NOT = { distance = { who = ROOT value = 200 } }
			}
		}
		modifier = {
			factor = 0.25
			liege = {
				culture = ROOT
				OR = {
					religion = { target = ROOT target_type = true }
					AND = {
						has_secret_religion = yes
						ROOT = {
							can_see_secret_religion = PREV
							true_religion = { target = PREV target_type = secret }
						}
					}
				}
			}
		}
		modifier = {
			factor = 0.5
			trigger_if = {
				limit = {
					liege = {
						OR = {
							is_tribal = yes
							is_nomadic = yes
						}
					}
				}
				opinion = { who = LIEGE value = 40 }
			}
			trigger_else = {
				opinion = { who = LIEGE value = 20 }
			}
		}
		modifier = {
			factor = 0.5
			liege = {  
				any_owned_bloodline = {
					has_bloodline_flag = bloodline_less_factions
					bloodline_is_active_for = PREV
				}
			}
		}
		modifier = {
			factor = 4.0
			ai_ambition >= 40
		}
		modifier = {
			factor = 2.0
			ai_ambition >= 20
		}
		modifier = {
			factor = 0.5
			ai_ambition <= -20
		}
		modifier = {
			factor = 0.25
			ai_ambition <= -40
		}
		modifier = {
			factor = 1.5
			liege = {
				distance = { who = ROOT value = 300 }
			}
		}
		modifier = {
			factor = 1.35
			liege = {
				OR = {
					is_tribal = yes
					is_nomadic = yes
				}
				distance = { who = ROOT value = 300 }
			}
		}
		modifier = {
			factor = 2.0
			liege = {
				distance = { who = ROOT value = 400 }
				NOT = { distance = { who = ROOT value = 500 } }
			}
		}
		modifier = {
			factor = 1.4
			liege = {
				OR = {
					is_tribal = yes
					is_nomadic = yes
				}
				distance = { who = ROOT value = 400 }
				NOT = { distance = { who = ROOT value = 500 } }
			}
		}
		modifier = {
			factor = 2.5
			liege = {
				distance = { who = ROOT value = 500 }
				NOT = { distance = { who = ROOT value = 650 } }
			}
		}
		modifier = {
			factor = 1.5
			liege = {
				OR = {
					is_tribal = yes
					is_nomadic = yes
				}
				distance = { who = ROOT value = 500 }
				NOT = { distance = { who = ROOT value = 650 } }
			}
		}
		modifier = {
			factor = 3.0
			liege = {
				distance = { who = ROOT value = 650 }
			}
		}
		modifier = {
			factor = 1.4
			liege = {
				OR = {
					is_tribal = yes
					is_nomadic = yes
				}
				distance = { who = ROOT value = 650 }
			}
		}
		modifier = {
			factor = 2.0
			liege = {
				distance = { who = ROOT value = 800 }
			}
		}
		modifier = {
			factor = 1.35
			liege = {
				OR = {
					is_tribal = yes
					is_nomadic = yes
				}
				distance = { who = ROOT value = 800 }
			}
		}
		modifier = {
			factor = 3.0
			trait = lucky_ruler
			NOT = { opinion = { who = LIEGE value = 50 } }
		}
		modifier = {
			factor = 2.0
			emf_true_unreformed_pagan = yes
		}
		modifier = {
			factor = 2.0
			OR = {
				is_tribal = yes
				is_nomadic = yes
			}
		}
		modifier = {
			factor = 3.0
			liege = {
				OR = {
					religion_group = { target = ROOT target_type = true }
					AND = {
						has_secret_religion = yes
						ROOT = {
							can_see_secret_religion = PREV
							OR = {
								true_religion_group = { target = PREV target_type = secret }
								emf_syncretized_true_religion_with_PREVs_true_religion = yes
							}
						}
					}
					AND = {
						OR = {
							has_secret_religion = no
							NOT = { ROOT = { can_see_secret_religion = PREV } }
						}
						ROOT = { emf_syncretized_true_religion_with_PREV = yes }
					}
				}
				ROOT = {
					emf_hostile_true_religion_to_PREV = yes
				}
			}
		}
		modifier = {
			factor = 4.0
			liege = {
				NOR = {
					religion_group = { target = ROOT target_type = true }
					AND = {
						has_secret_religion = yes
						ROOT = {
							can_see_secret_religion = PREV
							OR = {
								true_religion_group = { target = PREV target_type = secret }
								emf_syncretized_true_religion_with_PREVs_true_religion = yes
							}
						}
					}
					AND = {
						OR = {
							has_secret_religion = no
							NOT = { ROOT = { can_see_secret_religion = PREV } }
						}
						ROOT = { emf_syncretized_true_religion_with_PREV = yes }
					}
				}
				ROOT = {
					emf_hostile_true_religion_to_PREV = yes
				}
			}
		}
		modifier = {
			factor = 1.5
			liege = {
				NOT = { culture_group = ROOT }
			}
		}
		modifier = {
			factor = 1.5
			NOT = { opinion = { who = LIEGE value = -20 } }
		}
		modifier = {
			factor = 2.0
			liege = { ai = no }
			NOT = { opinion = { who = LIEGE value = -40 } }
		}
		modifier = {
			factor = 4.0
			liege = { ai = no }
			NOT = { opinion = { who = LIEGE value = -60 } }
		}
		modifier = {
			factor = 4.0
			liege = { ai = no }
			NOT = { opinion = { who = LIEGE value = -80 } }
		}
		modifier = {
			factor = 2.0
			liege = { ai = yes }
			NOT = { opinion = { who = LIEGE value = -50 } }
		}
		modifier = {
			factor = 4.0
			liege = { ai = yes }
			NOT = { opinion = { who = LIEGE value = -75 } }
		}
		modifier = {
			factor = 0.025
			trait = imbecile
		}
		modifier = {
			factor = 0.1
			trait = craven
		}
		modifier = {
			factor = 0.1
			trait = inbred
		}
		modifier = {
			factor = 0.1
			OR = {
				trait = slow
				trait = dull
			}
		}
		modifier = {
			factor = 0.5
			trait = kind
		}
		modifier = {
			factor = 0.75
			trait = charitable
		}
		modifier = {
			factor = 0.5
			trait = honest
		}
		modifier = {
			factor = 0.75
			trait = humble
		}
		modifier = {
			factor = 0.75
			trait = just
		}
		modifier = {
			factor = 1.5
			trait = proud
		}
		modifier = {
			factor = 1.5
			trait = brave
		}
		modifier = {
			factor = 1.5
			trait = arbitrary
		}
		modifier = {
			factor = 2.0
			trait = envious
		}
		modifier = {
			factor = 2.0
			trait = greedy
		}
		modifier = {
			factor = 2.0
			trait = impaler
		}
		modifier = {
			factor = 2.0
			trait = deceitful
		}
		#Dejure characters are unlikely to go independent
		modifier = {
			factor = 0.1
			NOR = {
				is_tribal = yes
				is_nomadic = yes
			}
			liege = {
				OR = {
					AND = { # Italy/Burgundy considers itself de jure HRE before 1125
						NOT = { year = 1125 }
						emf_has_hre = yes
						ROOT = {
							primary_title = {
								OR = {
									de_jure_liege_or_above = k_burgundy
									de_jure_liege_or_above = k_italy
								}
							}
						}
					}
					any_demesne_title = {
						OR = {
							is_primary_holder_title = yes
							higher_tier_than = DUKE
						}
						ROOT = {
							primary_title = {
								de_jure_liege_or_above = PREVPREV
							}
						}
					}
				}
			}
		}
		#Aquitaine doesn't want independence from France
		modifier = {
			factor = 0.025
			primary_title = { de_jure_liege_or_above = k_aquitaine }
			OR = {
				culture = occitan
				culture = frankish
				culture = basque
				culture = arpitan # SWMH
			}
			liege = {
				primary_title = { title = k_france }
				NOT = { has_landed_title = k_aquitaine }
				OR = {
					religion = { target = ROOT target_type = true }
					AND = {
						has_secret_religion = yes
						ROOT = {
							can_see_secret_religion = PREV
							true_religion = { target = PREV target_type = secret }
						}
					}
				}
				OR = {
					culture = frankish
					culture = norman
					culture = occitan
					culture = arpitan # SWMH
				}
			}
		}
		# If none of vassal's realm is connected to the liege's capital, they get rowdy
		modifier = {
			factor = 1.5
			liege = { independent = yes }
			NOT = { capital_scope = { has_province_flag = emf_capital_connected } }
		}
		modifier = {
			factor = 4.0
			liege = { independent = yes }
			any_realm_province = { has_province_flag = emf_capital_connected_by_seazone }
			NOT = { any_realm_province = { has_province_flag = emf_capital_connected } }
		}
		modifier = {
			factor = 5.0
			liege = { independent = yes }
			NOT = {
				any_realm_province = {
					OR = {
						has_province_flag = emf_capital_connected
						has_province_flag = emf_capital_connected_by_seazone
					}
				}
			}
		}
		modifier = { # More likely to want to go independent from the WP if China is unstable
			factor = 10.0 # TODO: Balance this factor to something on par with the rest of them
			liege = {
				government = confucian_bureaucracy
			}
			offmap_china = {
				NOR = {
					has_status = china_stable
					has_status = china_golden_age
				}
			}
		}
	}

	# AI membership weight: ROOT is the prospective member. FROM is the faction leader. FROMFROM is the target title or character.
	membership = {
		factor = 4

		modifier = {
			factor = 0
			OR = {
				has_character_modifier = faction_independence_ultimatum_timer
				emf_faction_has_special_chance_blocker = yes
				war = yes
				preparing_invasion = yes
				is_incapable = yes
				is_adult = no
				is_landed = no
				has_character_modifier = in_seclusion
				has_landed_title = k_orthodox
				AND = {
					is_patrician = yes
					is_merchant_republic = no
				}
			}
		}
		modifier = {
			factor = 0
			OR = {
				liege = { current_heir = { character = ROOT } }
				liege = { player_heir = { character = ROOT } }
			}
			NOT = { has_opinion_modifier = { who = FROM modifier = opinion_coerced_into_joining_faction } }
		}
		modifier = {
			factor = 0
			liege = {
				independent = yes
				OR = {
					religion = { target = ROOT target_type = true }
					AND = {
						has_secret_religion = yes
						ROOT = {
							can_see_secret_religion = PREV
							true_religion = { target = PREV target_type = secret }
						}
					}
				}
				culture = ROOT
				OR = {
					NOT = { distance = { who = ROOT value = 90 } }
					AND = {
						NOT = { distance = { who = ROOT value = 200 } }
						ROOT = { emf_true_unreformed_pagan = no }
					}
				}
			}
			NOT = { has_opinion_modifier = { who = FROM modifier = opinion_coerced_into_joining_faction } }
		}
		modifier = {
			factor = 0
			lower_real_tier_than = KING
			emf_true_unreformed_pagan = no
			liege = {
				independent = yes
				OR = {
					religion_group = { target = ROOT target_type = true }
					AND = {
						has_secret_religion = yes
						ROOT = {
							can_see_secret_religion = PREV
							OR = {
								true_religion_group = { target = PREV target_type = secret }
								emf_syncretized_true_religion_with_PREVs_true_religion = yes
							}
						}
					}
					AND = {
						OR = {
							has_secret_religion = no
							NOT = { ROOT = { can_see_secret_religion = PREV } }
						}
						ROOT = { emf_syncretized_true_religion_with_PREV = yes }
					}
				}
				culture_group = ROOT
				OR = {
					religion = { target = ROOT target_type = true }
					AND = {
						has_secret_religion = yes
						ROOT = {
							can_see_secret_religion = PREV
							true_religion = { target = PREV target_type = secret }
						}
					}
					culture = ROOT
				}
				ROOT = {
					emf_hostile_true_religion_to_PREV = no
				}
				trigger_if = {
					limit = {
						OR = {
							is_tribal = yes
							is_nomadic = yes
						}
					}
					NOT = { distance = { who = ROOT value = 90 } }
				}
				trigger_else = {
					NOT = { distance = { who = ROOT value = 150 } }
				}
			}
			NOT = { has_opinion_modifier = { who = FROM modifier = opinion_coerced_into_joining_faction } }
		}
		# Try to exclude people who should rather support a claimant
		modifier = {
			factor = 0
			lower_tier_than = KING
			liege = {
				NAND = {
					culture = ROOT
					OR = {
						religion = { target = ROOT target_type = true }
						AND = {
							has_secret_religion = yes
							ROOT = {
								can_see_secret_religion = PREV
								true_religion = { target = PREV target_type = secret }
							}
						}
					}
				}
				any_demesne_title = {
					OR = {
						is_primary_holder_title = yes
						higher_tier_than = DUKE
					}
					ROOT = {
						primary_title = {
							de_jure_liege_or_above = PREVPREV
						}
					}
					any_claimant = {
						culture = ROOT
						OR = {
							religion = { target = ROOT target_type = true }
							AND = {
								has_secret_religion = yes
								ROOT = {
									can_see_secret_religion = PREV
									true_religion = { target = PREV target_type = secret }
								}
							}
						}
						reverse_opinion = { who = ROOT value = 0 }
						ROOT = {
							opinion_diff = {
								first = PREV
								second = LIEGE
								value = 10
								as_if_liege = yes
							}
						}
					}
				}
			}
			NOT = { has_opinion_modifier = { who = FROM modifier = opinion_coerced_into_joining_faction } }
		}
		modifier = {
			factor = 0
			OR = {
				liege = { current_heir = { character = ROOT } }
				liege = { player_heir = { character = ROOT } }
			}
			NOT = { has_opinion_modifier = { who = FROM modifier = opinion_coerced_into_joining_faction } }
		}
		modifier = {
			factor = 0
			trigger_if = {
				limit = {
					liege = {
						OR = {
							is_tribal = yes
							is_nomadic = yes
						}
					}
				}
				OR = {
					AND = {
						NOT = { in_faction = faction_independence }
						opinion = { who = LIEGE value = 60 }
					}
					AND = {
						in_faction = faction_independence
						opinion = { who = LIEGE value = 80 }
					}
				}
			}
			trigger_else = {
				OR = {
					AND = {
						NOT = { in_faction = faction_independence }
						opinion = { who = LIEGE value = 40 }
					}
					AND = {
						in_faction = faction_independence
						opinion = { who = LIEGE value = 60 }
					}
				}
			}
			# Cannot have subrealm entirely surrounded by faction members to drop out of faction
			OR = {
				NOT = { in_faction = faction_independence }
				any_realm_province = {
					owner_under_ROOT = yes
					any_neighbor_province = {
						owner = {
							OR = {
								AND = {
									same_liege = ROOT
									NOT = { in_faction = faction_independence }
								}
								any_liege = {
									same_liege = ROOT
									NOT = { in_faction = faction_independence }
								}
							}
						}
					}
				}
			}
			NOT = { has_opinion_modifier = { who = FROM modifier = opinion_coerced_into_joining_faction } }
		}
		modifier = {
			factor = 0
			# Won't join this type of faction if our capital borders the liege's capital
			liege = {
				capital_scope = {
					any_neighbor_province = {
						ROOT = {
							capital_scope = {
								province = PREVPREV
							}
						}
					}
				}
			}
			NOT = { has_opinion_modifier = { who = FROM modifier = opinion_coerced_into_joining_faction } }
		}
		modifier = {
			factor = 1000
			has_opinion_modifier = {
				who = FROM
				modifier = opinion_coerced_into_joining_faction
			}
		}
		modifier = {
			factor = 0.05
			emf_is_hre_being_restored = yes
			liege = {
				emf_has_hre_precursor_kingdom = yes
				NOT = {
					any_player = {
						vassal_of = PREV
						in_faction = faction_independence
					}
				}
			}
			NOT = { has_opinion_modifier = { who = FROM modifier = opinion_coerced_into_joining_faction } }
		}
		modifier = {
			factor = 0.2
			emf_pacifist_true_religion = yes
			NOT = { has_opinion_modifier = { who = FROM modifier = opinion_coerced_into_joining_faction } }
		}
		modifier = {
			factor = 0.1
			ai_ambition <= -40
			NOT = { has_opinion_modifier = { who = FROM modifier = opinion_coerced_into_joining_faction } }
		}
		modifier = {
			factor = 0.1
			emf_true_unreformed_pagan = no
			is_tribal = no
			is_nomadic = no
			liege = {
				higher_real_tier_than = DUKE
				NOT = { distance = { who = ROOT value = 200 } }
			}
			NOT = { has_opinion_modifier = { who = FROM modifier = opinion_coerced_into_joining_faction } }
		}
		modifier = {
			factor = 0.25
			liege = {
				culture = ROOT
				OR = {
					religion = { target = ROOT target_type = true }
					AND = {
						has_secret_religion = yes
						ROOT = {
							can_see_secret_religion = PREV
							true_religion = { target = PREV target_type = secret }
						}
					}
				}
			}
			NOT = { has_opinion_modifier = { who = FROM modifier = opinion_coerced_into_joining_faction } }
		}
		modifier = {
			factor = 0.5
			trigger_if = {
				limit = {
					liege = {
						OR = {
							is_tribal = yes
							is_nomadic = yes
						}
					}
				}
				opinion = { who = LIEGE value = 40 }
			}
			trigger_else = {
				opinion = { who = LIEGE value = 20 }
			}
			NOT = { has_opinion_modifier = { who = FROM modifier = opinion_coerced_into_joining_faction } }
		}
		modifier = {
			factor = 0.5
			liege = {  
				any_owned_bloodline = {
					has_bloodline_flag = bloodline_less_factions
					bloodline_is_active_for = PREV
				}
			}
			NOT = { has_opinion_modifier = { who = FROM modifier = opinion_coerced_into_joining_faction } }
		}
		modifier = {
			factor = 4.0
			ai_ambition >= 40
		}
		modifier = {
			factor = 2.0
			ai_ambition >= 20
		}
		modifier = {
			factor = 0.5
			ai_ambition <= -20
			NOT = { has_opinion_modifier = { who = FROM modifier = opinion_coerced_into_joining_faction } }
		}
		modifier = {
			factor = 0.25
			ai_ambition <= -40
			NOT = { has_opinion_modifier = { who = FROM modifier = opinion_coerced_into_joining_faction } }
		}
		modifier = {
			factor = 1.5
			liege = {
				distance = { who = ROOT value = 300 }
			}
		}
		modifier = {
			factor = 1.35
			liege = {
				OR = {
					is_tribal = yes
					is_nomadic = yes
				}
				distance = { who = ROOT value = 300 }
			}
		}
		modifier = {
			factor = 2.0
			liege = {
				distance = { who = ROOT value = 400 }
				NOT = { distance = { who = ROOT value = 500 } }
			}
		}
		modifier = {
			factor = 1.4
			liege = {
				OR = {
					is_tribal = yes
					is_nomadic = yes
				}
				distance = { who = ROOT value = 400 }
				NOT = { distance = { who = ROOT value = 500 } }
			}
		}
		modifier = {
			factor = 2.5
			liege = {
				distance = { who = ROOT value = 500 }
				NOT = { distance = { who = ROOT value = 650 } }
			}
		}
		modifier = {
			factor = 1.5
			liege = {
				OR = {
					is_tribal = yes
					is_nomadic = yes
				}
				distance = { who = ROOT value = 500 }
				NOT = { distance = { who = ROOT value = 650 } }
			}
		}
		modifier = {
			factor = 3.0
			liege = {
				distance = { who = ROOT value = 650 }
			}
		}
		modifier = {
			factor = 1.4
			liege = {
				OR = {
					is_tribal = yes
					is_nomadic = yes
				}
				distance = { who = ROOT value = 650 }
			}
		}
		modifier = {
			factor = 2.0
			liege = {
				distance = { who = ROOT value = 800 }
			}
		}
		modifier = {
			factor = 1.35
			liege = {
				OR = {
					is_tribal = yes
					is_nomadic = yes
				}
				distance = { who = ROOT value = 800 }
			}
		}
		modifier = {
			factor = 3.0
			trait = lucky_ruler
			NOT = { opinion = { who = LIEGE value = 50 } }
		}
		modifier = {
			factor = 2.0
			emf_true_unreformed_pagan = yes
		}
		modifier = {
			factor = 2.0
			OR = {
				is_tribal = yes
				is_nomadic = yes
			}
		}
		modifier = {
			factor = 3.0
			liege = {
				OR = {
					religion_group = { target = ROOT target_type = true }
					AND = {
						has_secret_religion = yes
						ROOT = {
							can_see_secret_religion = PREV
							OR = {
								true_religion_group = { target = PREV target_type = secret }
								emf_syncretized_true_religion_with_PREVs_true_religion = yes
							}
						}
					}
					AND = {
						OR = {
							has_secret_religion = no
							NOT = { ROOT = { can_see_secret_religion = PREV } }
						}
						ROOT = { emf_syncretized_true_religion_with_PREV = yes }
					}
				}
				ROOT = {
					emf_hostile_true_religion_to_PREV = yes
				}
			}
		}
		modifier = {
			factor = 10.0
			liege = {
				NOR = {
					religion_group = { target = ROOT target_type = true }
					AND = {
						has_secret_religion = yes
						ROOT = {
							can_see_secret_religion = PREV
							OR = {
								true_religion_group = { target = PREV target_type = secret }
								emf_syncretized_true_religion_with_PREVs_true_religion = yes
							}
						}
					}
					AND = {
						OR = {
							has_secret_religion = no
							NOT = { ROOT = { can_see_secret_religion = PREV } }
						}
						ROOT = { emf_syncretized_true_religion_with_PREV = yes }
					}
				}
				ROOT = {
					emf_hostile_true_religion_to_PREV = yes
				}
			}
		}
		modifier = {
			factor = 1.5
			liege = {
				NOT = { culture_group = ROOT }
			}
		}
		modifier = {
			factor = 1.5
			NOT = { opinion = { who = LIEGE value = -20 } }
		}
		modifier = {
			factor = 2.0
			liege = { ai = no }
			NOT = { opinion = { who = LIEGE value = -40 } }
		}
		modifier = {
			factor = 4.0
			liege = { ai = no }
			NOT = { opinion = { who = LIEGE value = -60 } }
		}
		modifier = {
			factor = 4.0
			liege = { ai = no }
			NOT = { opinion = { who = LIEGE value = -80 } }
		}
		modifier = {
			factor = 2.0
			liege = { ai = yes }
			NOT = { opinion = { who = LIEGE value = -50 } }
		}
		modifier = {
			factor = 4.0
			liege = { ai = yes }
			NOT = { opinion = { who = LIEGE value = -75 } }
		}
		# Clans are very unlikely to join Independence factions led by non-nomads
		modifier = {
			factor = 0.01
			is_nomadic = yes
			FROM = {
				is_nomadic = no
			}
			NOT = { has_opinion_modifier = { who = FROM modifier = opinion_coerced_into_joining_faction } }
		}
		modifier = {
			factor = 0.025
			trait = imbecile
			NOT = { has_opinion_modifier = { who = FROM modifier = opinion_coerced_into_joining_faction } }
		}
		modifier = {
			factor = 0.1
			trait = craven
			NOT = { has_opinion_modifier = { who = FROM modifier = opinion_coerced_into_joining_faction } }
		}
		modifier = {
			factor = 0.1
			trait = inbred
			NOT = { has_opinion_modifier = { who = FROM modifier = opinion_coerced_into_joining_faction } }
		}
		modifier = {
			factor = 0.1
			OR = {
				trait = slow
				trait = dull
			}
			NOT = { has_opinion_modifier = { who = FROM modifier = opinion_coerced_into_joining_faction } }
		}
		modifier = {
			factor = 0.5
			trait = kind
			NOT = { has_opinion_modifier = { who = FROM modifier = opinion_coerced_into_joining_faction } }
		}
		modifier = {
			factor = 0.75
			trait = charitable
			NOT = { has_opinion_modifier = { who = FROM modifier = opinion_coerced_into_joining_faction } }
		}
		modifier = {
			factor = 0.5
			trait = honest
			NOT = { has_opinion_modifier = { who = FROM modifier = opinion_coerced_into_joining_faction } }
		}
		modifier = {
			factor = 0.75
			trait = humble
			NOT = { has_opinion_modifier = { who = FROM modifier = opinion_coerced_into_joining_faction } }
		}
		modifier = {
			factor = 0.75
			trait = just
			NOT = { has_opinion_modifier = { who = FROM modifier = opinion_coerced_into_joining_faction } }
		}
		modifier = {
			factor = 1.5
			trait = proud
		}
		modifier = {
			factor = 1.5
			trait = brave
		}
		modifier = {
			factor = 1.5
			trait = arbitrary
		}
		modifier = {
			factor = 2.0
			trait = envious
		}
		modifier = {
			factor = 2.0
			trait = greedy
		}
		modifier = {
			factor = 2.0
			trait = impaler
		}
		modifier = {
			factor = 2.0
			trait = deceitful
		}
		# Characters completely surrounded by faction members (or simply isolated from peer vassals) are more likely to
		# want independence:
		modifier = {
			factor = 2.0
			NOT = {
				any_realm_province = {
					owner_under_ROOT = yes
					any_neighbor_province = {
						owner = {
							OR = {
								AND = {
									same_liege = ROOT
									NOT = { in_faction = faction_independence }
								}
								any_liege = {
									same_liege = ROOT
									NOT = { in_faction = faction_independence }
								}
							}
						}
					}
				}
			}
		}
		# Characters that border faction members are more likely to want independence:
		modifier = {
			factor = 2.0
			any_realm_province = {
				owner_under_ROOT = yes
				any_neighbor_province = {
					owner = {
						OR = {
							AND = {
								same_liege = ROOT
								in_faction = faction_independence
							}
							any_liege = {
								same_liege = ROOT
								in_faction = faction_independence
							}
						}
					}
				}
			}
		}
		#Dejure characters are unlikely to go independent
		modifier = {
			factor = 0.1
			NOR = {
				is_tribal = yes
				is_nomadic = yes
			}
			liege = {
				OR = {
					AND = { # Italy/Burgundy considers itself de jure HRE before 1125
						NOT = { year = 1125 }
						emf_has_hre = yes
						ROOT = {
							primary_title = {
								OR = {
									de_jure_liege_or_above = k_burgundy
									de_jure_liege_or_above = k_italy
								}
							}
						}
					}
					any_demesne_title = {
						OR = {
							is_primary_holder_title = yes
							higher_tier_than = DUKE
						}
						ROOT = {
							primary_title = {
								de_jure_liege_or_above = PREVPREV
							}
						}
					}
				}
			}
		}
		#Aquitaine doesn't want independence from France
		modifier = {
			factor = 0.025
			primary_title = { de_jure_liege_or_above = k_aquitaine }
			OR = {
				culture = occitan
				culture = frankish
				culture = basque
				culture = arpitan # SWMH
			}
			liege = {
				primary_title = { title = k_france }
				NOT = { has_landed_title = k_aquitaine }
				OR = {
					religion = { target = ROOT target_type = true }
					AND = {
						has_secret_religion = yes
						ROOT = {
							can_see_secret_religion = PREV
							true_religion = { target = PREV target_type = secret }
						}
					}
				}
				OR = {
					culture = frankish
					culture = norman
					culture = occitan
					culture = arpitan # SWMH
				}
			}
		}
		# If none of vassal's realm is connected to the liege's capital, they get rowdy
		modifier = {
			factor = 1.5
			liege = { independent = yes }
			NOT = { capital_scope = { has_province_flag = emf_capital_connected } }
		}
		modifier = {
			factor = 4.0
			liege = { independent = yes }
			any_realm_province = { has_province_flag = emf_capital_connected_by_seazone }
			NOT = { any_realm_province = { has_province_flag = emf_capital_connected } }
		}
		modifier = {
			factor = 5.0
			liege = { independent = yes }
			NOT = {
				any_realm_province = {
					OR = {
						has_province_flag = emf_capital_connected
						has_province_flag = emf_capital_connected_by_seazone
					}
				}
			}
		}
		modifier = { # More likely to want to go independent from the WP if China is unstable
			factor = 10.0 # TODO: Balance this factor to something on par with the rest of them
			liege = {
				government = confucian_bureaucracy
			}
			offmap_china = {
				NOR = {
					has_status = china_stable
					has_status = china_golden_age
				}
			}
		}
	}

	success = {
		independent = yes
	}

	abort = {
		always = no
	}

	abort_effect = {
	}

	effect = {
		FROM = {
			any_faction_backer = {
				faction = faction_independence
				reverse_opinion = {
					modifier = opinion_grateful
					who = FROM
					years = 5
				}
			}
		}
	}
}

# Support Claimant to Liege Title
faction_claimant = {
	type = liege_titles_w_claimant # 'new_character' is a Claimant, or, if the title is Elective, anyone eligible for election
	exclusive = yes # Can only lead or be in one faction of this type

	warning_level = 0.7 # At this level of faction power we give player an alert. Set to 0 for no alerts.

	# Plotter scope
	potential = {
		emf_faction_basic_potential = yes
		liege = {
			OR = {
				is_feudal = yes
				is_tribal = yes
				is_nomadic = yes
			}
		}
		OR = {
			# Is not affected by a Crown Law title
			NOT = { crownlaw_title = { always = yes } }
			# The Crown Law title holder is my liege
			crownlaw_title = { holder_scope = { is_liege_of = ROOT } }
			# The Crown Law title allows vassal infighting
			crownlaw_title = { has_law = king_peace_0 }
		}
		NOT = { has_character_modifier = faction_claimant_timer }
	}

	# Target scope
	allow = {
		# primary or king titles only
		OR = {
			is_primary_holder_title = yes
			higher_tier_than = DUKE
		}
		# is either the primary title or my de jure liege
		OR = {
			is_primary_holder_title = yes
			de_jure_vassal_or_below = FROM
		}
		# title is either elective or the claimant actually has a claim [of any strength] on the title
		OR = {
			has_law = succ_hre_elective
			has_law = succ_feudal_elective
			new_character = { has_claim = PREV }
		}
		# title is either not elective or the claimant is a non-ruler/de jure vassal of the title
		OR = {
			NOR = {
				has_law = succ_feudal_elective
				has_law = succ_hre_elective
			}
			new_character = { is_ruler = no }
			new_character = {
				primary_title = {
					de_jure_liege_or_above = PREVPREV
				}
			}
		}
		# no claimant factions to return duke/king titles to emperor within imperial realm
		OR = {
			holder_scope = { emf_imperial_government = no }
			new_character = { lower_real_tier_than = EMPEROR }
			new_character = {
				ROOT = {
					holder_scope = {
						NOT = { same_realm = PREVPREV }
					}
				}
			}
			NOR = {
				tier = DUKE
				tier = KING
			}
		}
		new_character = {
			NOR = {
				has_landed_title = PREV
				is_vassal_or_below = FROM
			}
			# Not if the claimant has recently refused to let a claimant faction press their claim for this title:
			OR = {
				NOT = { has_character_flag = emf_no_claimant_faction_@ROOT }
				had_flag = { flag = emf_no_claimant_faction_@ROOT days = 1825 }
			}
			# prevent theocracies
			OR = {
				is_theocracy = no
				ROOT = { is_theocracy = yes }
			}
			# respect nomadic blood oath
			NAND = {
				has_dlc = "Horse Lords"
				is_nomadic = yes
				ROOT = {
					holder_scope = {
						is_nomadic = yes
						has_blood_oath_with = PREVPREV
					}
				}
			}
			# gender of claimant
			trigger_if = {
				limit = { is_female = yes }
				NOR = {
					AND = {
						true_religion_group = muslim
						emf_feminist_true_religion = no
					}
					ROOT = { succ_law_title = { has_law = agnatic_succession } }
					true_religion_scope = { has_religion_feature = religion_patriarchal }
				}
			}
			trigger_else = {
				NOR = {
					ROOT = { succ_law_title = { has_law = enatic_succession } }
					true_religion_scope = { has_religion_feature = religion_matriarchal }
				}
			}
			# claimant is either not a ruler or has a non-primary-type title and is lower-tier than title
			OR = {
				is_ruler = no
				primary_title = {
					OR = {
						is_primary_type_title = no # Static Mercs, the Pope, Holy Orders, etc
						higher_tier_than = ROOT
						tier = ROOT
					}
				}
			}
			# holder is not currently defending against that claimant for that title
			ROOT = {
				holder_scope = {
					NOR = {
						reverse_has_truce = PREVPREV
						defending_against_claimant = {
							character = PREVPREV
							title = ROOT
						}
					}
				}
			}
			# either holder is independent or claimant is in the same realm/not a ruler
			OR = {
				ROOT = { holder_scope = { independent = yes } }
				ROOT = { holder_scope = { same_realm = PREVPREV } }
				is_ruler = no
			}
			NOR = {
				has_landed_title = k_papal_state
				has_landed_title = d_fraticelli
			}
		}
		NOT = {
			holder_scope = {
				reverse_has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_leaving_faction
				}
			}
		}
	}

	# Faction member scope (ROOT = joiner, FROM = target)
	allow_join = {
		ROOT = {
			emf_faction_basic_allow_join = yes
		}
	}

	# AI creation weight { ROOT = title, FROM = faction creator, new_character = claimant }
	chance = {
		factor = 4
		modifier = {
			factor = 0.5
			holder_scope = {
				any_owned_bloodline = {
					has_bloodline_flag = bloodline_less_factions
					bloodline_is_active_for = PREV
				}
			}
		}
		modifier = {
			factor = 0
			FROM = { emf_faction_has_special_chance_blocker = yes }
		}
		modifier = {
			factor = 0.2
			FROM = { emf_pacifist_true_religion = yes }
		}
		modifier = {
			factor = 2
			FROM = { emf_warlike_true_religion = yes }
		}
		modifier = {
			factor = 0
			FROM = { preparing_invasion = yes }
		}
		modifier = {
			factor = 0.25
			new_character = { NOT = { culture = FROM } }
		}
		modifier = {
			factor = 0.25
			new_character = { NOT = { culture_group = FROM } }
		}
		# religion heads do not form claimant factions
		modifier = {
			factor = 0
			FROM = {
				OR = {
					controls_religion = yes
					rightful_religious_head_scope = { character = PREV }
				}
			}
		}
		# unlikely to form claimant factions against vassals in another realm
		modifier = {
			factor = 0
			holder_scope = {
				independent = no
				NOT = { same_realm = FROM }
			}
		}
		# bonus vs. titles held by prisoners, children, incapable, uncrowned, or those in seclusion
		modifier = {
			factor = 3.0
			holder_scope = {
				OR = {
					prisoner = yes
					is_adult = no
					emf_needs_coronation = yes
					is_incapable = yes
					is_inaccessible_trigger = yes
				}
			}
		}
		# limits on who the AI will install in the title
		modifier = {
			factor = 0
			new_character = {
				OR = {
					has_opinion_modifier = { who = FROM modifier = overthrew_me }
					is_rival = FROM
					emf_can_inherit = no
					trait = imbecile
					trait = inbred
					is_incapable = yes
					NOR = {
						religion = { target = FROM target_type = true }
						AND = {
							has_secret_religion = yes
							ROOT_FROM = {
								can_see_secret_religion = PREV
								true_religion = { target = PREV target_type = secret }
							}
						}
					}
					# not over 60 or celibate unless they have a legitimate son
					AND = {
						OR = {
							practical_age >= 60
							trait = celibate
						}
						NOT = {
							any_child = {
								is_female = no
								emf_can_inherit = yes
							}
						}
					}
					# not old women, period
					AND = {
						is_female = yes
						practical_age >= 40
					}
				}
			}
		}
		# the claimant is a justified claimant
		modifier = {
			factor = 3
			new_character = { has_character_flag = emf_justified_claimant_@ROOT }
		}
		# I am the claimant
		modifier = {
			factor = 10
			new_character = { character = FROM }
		}
		# the claimant is of my dynasty, and the current holder is not
		modifier = {
			factor = 1.5
			holder_scope = { NOT = { dynasty = FROM } }
			new_character = {
				NOT = { character = FROM }
				dynasty = FROM
			}
		}
		# the claimant is a close relative, and the current holder is not
		modifier = {
			factor = 1.5
			holder_scope = { NOT = { is_close_relative = FROM } }
			new_character = { is_close_relative = FROM }
		}
		# discourage forming claimant factions in support of rulers from another independent realm
		modifier = {
			factor = 0.25
			new_character = {
				is_ruler = yes
				NOT = { same_realm = FROM }
			}
		}
		# will not install parents of the current holder
		modifier = {
			factor = 0
			new_character = {
				ROOT = {
					holder_scope = {
						is_child_of = PREVPREV
					}
				}
			}
		}
		# will not support decadent claimant unless also decadent
		modifier = {
			factor = 0
			new_character = { trait = decadent }
			FROM = { NOT = { trait = decadent } }
		}
		# will not support a claimant against someone they installed in the position
		modifier = {
			factor = 0
			holder_scope = {
				reverse_has_opinion_modifier = { who = FROM modifier = opinion_fought_for_claimant }
			}
		}
		# will support a claimant of the same religion & culture against a liege who is either not of the same religion group or the same culture group
		modifier = {
			factor = 3.0
			holder_scope = {
				is_liege_of = FROM
				OR = {
					NOT = { culture_group = FROM }
					ROOT_FROM = {
						emf_hostile_true_religion_to_PREV = yes
					}
				}
			}
			new_character = {
				culture = FROM
				OR = {
					religion = { target = FROM target_type = true }
					AND = {
						has_secret_religion = yes
						ROOT_FROM = {
							can_see_secret_religion = PREV
							true_religion = { target = PREV target_type = secret }
						}
					}
				}
			}
		}
		# less likely to support young children
		modifier = {
			factor = 0.5
			new_character = { NOT = { age = 13 } }
		}
		modifier = {
			factor = 0.5
			new_character = { NOT = { age = 10 } }
		}
		modifier = {
			factor = 0.5
			new_character = { NOT = { age = 5 } }
		}
		# more likely to support a male claimant against a female holding an agnatic title
		modifier = {
			factor = 3.0
			succ_law_title = { has_law = agnatic_succession }
			holder_scope = { is_female = yes }
			new_character = { is_female = no }
			FROM = { emf_feminist_true_religion = no }
		}
		# will not support a woman for an agnatic title unless she has a son (who can inherit) or is formidable
		modifier = {
			factor = 0
			succ_law_title = { has_law = agnatic_succession }
			FROM = { emf_feminist_true_religion = no }
			new_character = {
				is_female = yes
				NOR = {
					character = FROM
					emf_is_formidable_person = yes
					any_child = {
						is_female = no
						emf_can_inherit = yes
						OR = {
							dynasty = PREV
							dynasty = FROM
						}
					}
				}
			}
		}
		# unlikely to support a woman for a cognatic title unless she has a son (who can inherit) or is formidable
		modifier = {
			factor = 0.5
			succ_law_title = { has_law = cognatic_succession }
			FROM = { emf_feminist_true_religion = no }
			new_character = {
				is_female = yes
				NOR = {
					character = FROM
					emf_is_formidable_person = yes
					any_child = {
						is_female = no
						emf_can_inherit = yes
						OR = {
							dynasty = PREV
							dynasty = FROM
						}
					}
				}
			}
		}
		# unlikely to support a woman in any case unless they are a woman
		modifier = {
			factor = 0.5
			NOR = {
				succ_law_title = { has_law = true_cognatic_succession }
				succ_law_title = { has_law = enatic_cognatic_succession }
				succ_law_title = { has_law = enatic_succession }
				holder_scope = { primary_title = { has_law = status_of_women_4 } }
			}
			new_character = { is_female = yes }
			FROM = {
				is_female = no
				emf_feminist_true_religion = no
			}
		}
		# will not support a woman at all if zealous or in tradition faction
		modifier = {
			factor = 0
			NOR = {
				succ_law_title = { has_law = true_cognatic_succession }
				succ_law_title = { has_law = enatic_cognatic_succession }
				succ_law_title = { has_law = enatic_succession }
				holder_scope = { primary_title = { has_law = status_of_women_4 } }
			}
			new_character = { is_female = yes }
			FROM = {
				OR = {
					trait = zealous
					in_faction = faction_tradition
				}
				emf_feminist_true_religion = no
			}
		}
		# more likely to support a female claimant against a male holding an enatic title
		modifier = {
			factor = 3.0
			succ_law_title = { has_law = enatic_succession }
			holder_scope = { is_female = no }
			new_character = { is_female = yes }
			FROM = { true_religion_scope = { has_religion_feature = religion_matriarchal } }
		}
		# will not support a man for an enatic title unless he has a daughter (who can inherit) or is formidable
		modifier = {
			factor = 0
			succ_law_title = { has_law = enatic_succession }
			FROM = { true_religion_scope = { has_religion_feature = religion_matriarchal } }
			new_character = {
				is_female = no
				NOR = {
					character = FROM
					emf_is_formidable_person = yes
					any_child = {
						is_female = yes
						emf_can_inherit = yes
						OR = {
							dynasty = PREV
							dynasty = FROM
						}
					}
				}
			}
		}
		# unlikely to support a man for an enatic-cognatic title unless he has a daughter (who can inherit) or is formidable
		modifier = {
			factor = 0.5
			succ_law_title = { has_law = enatic_cognatic_succession }
			FROM = { true_religion_scope = { has_religion_feature = religion_matriarchal } }
			new_character = {
				is_female = no
				NOR = {
					character = FROM
					emf_is_formidable_person = yes
					any_child = {
						is_female = yes
						emf_can_inherit = yes
						OR = {
							dynasty = PREV
							dynasty = FROM
						}
					}
				}
			}
		}
		# as matriarchal, unlikely to support a man in any case unless they are a man
		modifier = {
			factor = 0.5
			OR = {
				succ_law_title = { has_law = enatic_cognatic_succession }
				succ_law_title = { has_law = enatic_succession }
			}
			new_character = { is_female = no }
			FROM = {
				is_female = yes
				true_religion_scope = { has_religion_feature = religion_matriarchal }
			}
		}
		# as matriarchal, will not support a man at all if zealous or in tradition faction
		modifier = {
			factor = 0
			OR = {
				succ_law_title = { has_law = enatic_cognatic_succession }
				succ_law_title = { has_law = enatic_succession }
			}
			new_character = { is_female = no }
			FROM = {
				OR = {
					trait = zealous
					in_faction = faction_tradition
				}
				true_religion_scope = { has_religion_feature = religion_matriarchal }
			}
		}
		#If claimaint's sex is incompatible with religious dogma.
		modifier = {
			factor = 0.1
			true_religion_scope = { has_religion_feature = religion_patriarchal }
			new_character = {
				is_female = yes
			}
		}
		modifier = {
			factor = 0.1
			true_religion_scope = { has_religion_feature = religion_matriarchal }
			new_character = {
				is_female = no
			}
		}
		#Or if vassal is under the yoke of the wrong kind of liege.
		modifier = {
			factor = 3
			true_religion_scope = { has_religion_feature = religion_patriarchal }
			FROM = {
				is_female = yes
			}
			new_character = {
				is_female = no
			}
		}
		modifier = {
			factor = 3
			true_religion_scope = { has_religion_feature = religion_matriarchal }
			FROM = {
				is_female = no
			}
			new_character = {
				is_female = yes
			}
		}
		# will not support claimants against their own spouse
		modifier = {
			factor = 0
			holder_scope = { is_married = FROM }
		}
		# will not install the current heir & will not install anyone if the heir, unless elective
		modifier = {
			factor = 0
			NOR = {
				has_law = succ_feudal_elective
				has_law = succ_hre_elective
				has_law = succ_byzantine_elective
			}
			current_heir = {
				OR = {
					character = FROM
					ROOT = { new_character = { character = PREVPREV } }
				}
			}
		}
		# less likely to support a weak claimant when a strong claimant of the same religion & culture exists in the realm
		modifier = {
			factor = 0.25
			new_character = { has_weak_claim = ROOT }
			FROM = {
				liege = {
					any_vassal = {
						leads_faction = faction_claimant
						supported_claimant = {
							OR = {
								religion = { target = FROM target_type = true }
								AND = {
									has_secret_religion = yes
									ROOT_FROM = {
										can_see_secret_religion = PREV
										true_religion = { target = PREV target_type = secret }
									}
								}
							}
							culture = FROM
							has_strong_claim = ROOT
						}
					}
				}
			}
		}
		# there's already another claimant of my culture and religion who I don't dislike
		modifier = {
			factor = 0.75
			new_character = { NOT = { character = FROM } }
			FROM = {
				liege = {
					any_vassal = {
						leads_faction = faction_claimant
						supported_claimant = {
							culture = FROM
							OR = {
								religion = { target = FROM target_type = true }
								AND = {
									has_secret_religion = yes
									ROOT_FROM = {
										can_see_secret_religion = PREV
										true_religion = { target = PREV target_type = secret }
									}
								}
							}
							reverse_opinion = { who = FROM value = 0 }
							ROOT = {
								new_character = {
									NOT = { character = PREVPREV }
								}
							}
						}
					}
				}
			}
		}
		# will not support another claimant when they themselves are the claimant of another faction
		modifier = {
			factor = 0.25
			new_character = { NOT = { character = FROM } }
			FROM = {
				liege = {
					any_vassal = {
						leads_faction = faction_claimant
						supported_claimant = { character = ROOT_FROM }
						supported_claimant_title = { title = ROOT }
					}
				}
			}
		}
		# will not support a claimant to a title they also have a claim to
		modifier = {
			factor = 0
			new_character = { NOT = { character = FROM } }
			FROM = { has_claim = ROOT }
		}
		# will not support a claimant of a different dynasty if holder is same dynasty, religion and culture
		modifier = {
			factor = 0
			holder_scope = {
				dynasty = FROM
				OR = {
					religion = { target = FROM target_type = true }
					AND = {
						has_secret_religion = yes
						ROOT_FROM = {
							can_see_secret_religion = PREV
							true_religion = { target = PREV target_type = secret }
						}
					}
				}
				culture = FROM
			}
			new_character = {
				NOT = { dynasty = FROM }
			}
		}
		# will not put themselves forward for an elective title unless ambitious or a justified/strong claimant
		modifier = {
			factor = 0
			OR = {
				has_law = succ_feudal_elective
				has_law = succ_hre_elective
			}
			new_character = {
				character = FROM
				NOR = {
					ai_ambition = 40
					has_strong_claim = PREV
					has_character_flag = emf_justified_claimant_@ROOT
				}
			}
		}
		# will not support a claim for the primary title if there is an equal-tier title they are de jure vassal of
		modifier = {
			factor = 0
			NOT = { de_jure_vassal_or_below = FROM }
			holder_scope = {
				any_demesne_title = {
					is_primary_holder_title_tier = yes
					de_jure_vassal_or_below = FROM
					NOT = { title = ROOT }
				}
			}
		}
		# will not support a claim for the title if the claimant already has a faction for a higher tier one
		modifier = {
			factor = 0
			FROM = {
				liege = {
					any_vassal = {
						leads_faction = faction_claimant
						supported_claimant = { ROOT = { new_character = { character = PREVPREV } } }
						supported_claimant_title = { higher_tier_than = ROOT }
					}
				}
			}
		}
		# will not support a claimant of a different culture for a recently conquered title
		modifier = {
			factor = 0
			is_conquered = yes
			NOT = { new_character = { culture = FROM } }
		}
		# more likely to support a claimant of the same culture for a recently conquered title
		modifier = {
			factor = 4.0
			is_conquered = yes
			NOT = { conquest_culture = FROM }
			new_character = { culture = FROM }
		}
		# tend to unite behind one single claimant if conquered
		modifier = {
			factor = 0.1
			is_conquered = yes
			NOT = { conquest_culture = FROM }
			holder_scope = {
				any_vassal = {
					NOT = { character = FROM }
					in_faction = faction_claimant
					supported_claimant = {
						culture = FROM
						OR = {
							religion = { target = FROM target_type = true }
							AND = {
								has_secret_religion = yes
								ROOT_FROM = {
									can_see_secret_religion = PREV
									true_religion = { target = PREV target_type = secret }
								}
							}
						}
						reverse_opinion = { who = FROM value = 0 }
						ROOT = {
							new_character = {
								NOT = { character = PREVPREV }
							}
						}
					}
				}
			}
		}
		# If there is an antiking faction, prioritize that
		modifier = {
			factor = 0
			FROM = {
				OR = {
					religion = catholic
					religion = fraticelli
				}
				top_liege = {
					any_realm_lord = { in_faction = faction_antiking }
					FROM = { vassal_of = PREV }
					religion = FROM
					rightful_religious_head_scope = {
						OR = {
							has_claim = k_papal_state
							has_claim = d_fraticelli
						}
					}
				}
			}
		}
		# more likely to support claimants from less powerful dynasties
		modifier = {
			factor = 2.0
			holder_scope = { dynasty_realm_power = 0.25 }
			new_character = {
				ROOT = {
					holder_scope = { NOT = { dynasty = PREVPREV } }
				}
			}
		}
		modifier = {
			factor = 2.0
			holder_scope = { dynasty_realm_power = 0.4 }
			new_character = {
				ROOT = {
					holder_scope = { NOT = { dynasty = PREVPREV } }
				}
			}
		}
		# less likely to support a claimant not born in the purple when another claimant exists who is
		modifier = {
			factor = 0.5
			emf_is_roman_empire = yes
			new_character = { NOT = { trait = born_in_the_purple } }
			FROM = {
				OR = {
					culture_group = byzantine
					culture = roman
				}
				liege = {
					any_vassal = {
						leads_faction = faction_claimant
						supported_claimant_title = { title = ROOT }
						supported_claimant = {
							NOT = { character = PREVPREVPREV }
							trait = born_in_the_purple
						}
					}
				}
			}
		}
		# more likely to support sayyid against a holder who isn't
		modifier = {
			factor = 2.0
			FROM = { true_religion_group = muslim }
			new_character = {
				OR = {
					religion_group = { target = FROM target_type = true }
					AND = {
						has_secret_religion = yes
						ROOT_FROM = {
							can_see_secret_religion = PREV
							true_religion_group = { target = PREV target_type = secret }
						}
					}
				}
				trait = sayyid
			}
			holder_scope = { NOT = { trait = sayyid } }
		}
		# more likely to support mirza against a holder who is neither sayyid nor mirza
		modifier = {
			factor = 1.5
			FROM = { true_religion_group = muslim }
			new_character = {
				OR = {
					religion_group = { target = FROM target_type = true }
					AND = {
						has_secret_religion = yes
						ROOT_FROM = {
							can_see_secret_religion = PREV
							true_religion_group = { target = PREV target_type = secret }
						}
					}
				}
				trait = mirza
			}
			holder_scope = {
				NOT = { trait = sayyid }
				NOT = { trait = mirza }
			}
		}
		# members of the tradition faction are less likely to support claimants unless the holder is excommunicated
		modifier = {
			factor = 2
			holder_scope = { trait = excommunicated }
			FROM = { in_faction = faction_tradition }
		}
		modifier = {
			factor = 0.25
			holder_scope = { NOT = { trait = excommunicated } }
			FROM = { in_faction = faction_tradition }
		}
		# members of an unhappy court faction are more likely to support claimants
		modifier = {
			factor = 2.0
			FROM = {
				in_faction = faction_court
				liege = {
					OR = {
						has_character_flag = faction_court_angry
						has_character_flag = faction_court_unhappy
					}
				}
			}
		}
		# opinions
		modifier = {
			factor = 0
			holder_scope = {
				culture = FROM
				OR = {
					religion = { target = FROM target_type = true }
					AND = {
						has_secret_religion = yes
						ROOT_FROM = {
							can_see_secret_religion = PREV
							true_religion = { target = PREV target_type = secret }
						}
					}
				}
				FROM = {
					opinion = { who = PREV value = 0 }
					NOR = {
						trait = deceitful
						ai_ambition = 40
						trait = envious
						trait = proud
						trait = brave
					}
				}
			}
		}
		modifier = {
			factor = 0
			holder_scope = {
				OR = {
					NOT = { culture = FROM }
					NOR = {
						religion = { target = FROM target_type = true }
						AND = {
							has_secret_religion = yes
							ROOT_FROM = {
								can_see_secret_religion = PREV
								true_religion = { target = PREV target_type = secret }
							}
						}
					}
				}
				FROM = {
					opinion = { who = PREV value = 25 }
					NOR = {
						trait = deceitful
						ai_ambition = 40
						trait = envious
						trait = proud
						trait = brave
					}
				}
			}
		}
		modifier = {
			factor = 0
			holder_scope = {
				culture = FROM
				OR = {
					religion = { target = FROM target_type = true }
					AND = {
						has_secret_religion = yes
						ROOT_FROM = {
							can_see_secret_religion = PREV
							true_religion = { target = PREV target_type = secret }
						}
					}
				}
				FROM = {
					opinion = { who = PREV value = 25 }
					OR = {
						trait = deceitful
						ai_ambition = 40
						trait = envious
						trait = proud
						trait = brave
					}
				}
			}
		}
		modifier = {
			factor = 0
			holder_scope = {
				OR = {
					NOT = { culture = FROM }
					NOR = {
						religion = { target = FROM target_type = true }
						AND = {
							has_secret_religion = yes
							ROOT_FROM = {
								can_see_secret_religion = PREV
								true_religion = { target = PREV target_type = secret }
							}
						}
					}
				}
				FROM = {
					opinion = { who = PREV value = 50 }
					OR = {
						trait = deceitful
						ai_ambition = 40
						trait = envious
						trait = proud
						trait = brave
					}
				}
			}
		}
		modifier = {
			factor = 1.5
			holder_scope = {
				NOT = { reverse_opinion = { who = FROM value = -25 } }
			}
		}
		modifier = {
			factor = 2.0
			holder_scope = {
				NOT = { reverse_opinion = { who = FROM value = -50 } }
			}
		}
		modifier = {
			factor = 4.0
			holder_scope = {
				NOT = { reverse_opinion = { who = FROM value = -75 } }
			}
		}
		modifier = {
			factor = 0.5
			new_character = {
				NOT = { reverse_opinion = { who = FROM value = 20 } }
			}
		}
		modifier = {
			factor = 0
			new_character = {
				NOT = { reverse_opinion = { who = FROM value = 0 } }
			}
		}
		# must like the claimant more than the current ruler
		modifier = {
			factor = 0
			new_character = { NOT = { character = FROM } }
			NOT = {
				new_character = {
					FROM = {
						opinion_diff = {
							first = PREV
							second = LIEGE
							value = 10
							as_if_liege = yes
						}
					}
				}
			}
		}
		modifier = {
			factor = 1.5
			new_character = {
				NOT = { character = FROM }
				FROM = {
					opinion_diff = {
						first = PREV
						second = LIEGE
						value = 25
						as_if_liege = yes
					}
				}
			}
		}
		modifier = {
			factor = 1.5
			new_character = {
				NOT = { character = FROM }
				FROM = {
					opinion_diff = {
						first = PREV
						second = LIEGE
						value = 50
						as_if_liege = yes
					}
				}
			}
		}
		modifier = {
			factor = 1.5
			new_character = {
				NOT = { character = FROM }
				FROM = {
					opinion_diff = {
						first = PREV
						second = LIEGE
						value = 75
						as_if_liege = yes
					}
				}
			}
		}
		modifier = {
			factor = 1.5
			new_character = {
				NOT = { character = FROM }
				FROM = {
					opinion_diff = {
						first = PREV
						second = LIEGE
						value = 100
						as_if_liege = yes
					}
				}
			}
		}
		# the new claimant cannot like the holder too much
		modifier = {
			factor = 0
			NOT = { new_character = { character = FROM } }
			holder_scope = {
				ROOT = {
					new_character = {
						opinion = { who = PREVPREV value = 25 }
						NOR = {
							trait = deceitful
							ai_ambition = 40
							trait = envious
							trait = proud
							trait = greedy
						}
					}
				}
			}
		}
		modifier = {
			factor = 0
			NOT = { new_character = { character = FROM } }
			holder_scope = {
				ROOT = {
					new_character = {
						opinion = { who = PREVPREV value = 50 }
					}
				}
			}
		}
		# personal traits of the claimant
		modifier = {
			factor = 0
			new_character = {
				OR = {
					trait = lunatic
					trait = possessed
				}
			}
			FROM = {
				NOR = {
					trait = lunatic
					trait = possessed
				}
			}
			holder_scope = {
				NOR = {
					trait = lunatic
					trait = possessed
				}
			}
		}
		modifier = {
			factor = 1.5
			new_character = {
				is_smart_trigger = yes
			}
			holder_scope = {
				is_smart_trigger = no
			}
		}
		modifier = {
			factor = 0.5
			new_character = {
				OR = {
					trait = slow
					trait = dull
					trait = infirm
					NOT = { ai_ambition = -39 }
					NOT = { health = 4 }
				}
			}
		}
		modifier = {
			factor = 1.5
			new_character = { trait = zealous }
			FROM = { trait = zealous }
			holder_scope = { NOT = { trait = zealous } }
		}
		modifier = {
			factor = 0.5
			new_character = { trait = cynical }
			FROM = { trait = zealous }
		}
		modifier = {
			factor = 1.2
			holder_scope = {
				ROOT = {
					new_character = {
						attribute_diff = {
							character = PREVPREV
							attribute = diplomacy
							value = 2
						}
					}
				}
			}
		}
		modifier = {
			factor = 1.2
			holder_scope = {
				ROOT = {
					new_character = {
						attribute_diff = {
							character = PREVPREV
							attribute = diplomacy
							value = 4
						}
					}
				}
			}
		}
		modifier = {
			factor = 1.2
			holder_scope = {
				ROOT = {
					new_character = {
						attribute_diff = {
							character = PREVPREV
							attribute = diplomacy
							value = 6
						}
					}
				}
			}
		}
		modifier = {
			factor = 1.2
			holder_scope = {
				ROOT = {
					new_character = {
						attribute_diff = {
							character = PREVPREV
							attribute = diplomacy
							value = 8
						}
					}
				}
			}
		}
		modifier = {
			factor = 1.2
			holder_scope = {
				ROOT = {
					new_character = {
						attribute_diff = {
							character = PREVPREV
							attribute = diplomacy
							value = 10
						}
					}
				}
			}
		}
		modifier = {
			factor = 0.8
			new_character = {
				ROOT = {
					holder_scope = {
						attribute_diff = {
							character = PREVPREV
							attribute = diplomacy
							value = 2
						}
					}
				}
			}
		}
		modifier = {
			factor = 0.8
			new_character = {
				ROOT = {
					holder_scope = {
						attribute_diff = {
							character = PREVPREV
							attribute = diplomacy
							value = 4
						}
					}
				}
			}
		}
		modifier = {
			factor = 0.8
			new_character = {
				ROOT = {
					holder_scope = {
						attribute_diff = {
							character = PREVPREV
							attribute = diplomacy
							value = 6
						}
					}
				}
			}
		}
		modifier = {
			factor = 0.8
			new_character = {
				ROOT = {
					holder_scope = {
						attribute_diff = {
							character = PREVPREV
							attribute = diplomacy
							value = 8
						}
					}
				}
			}
		}
		modifier = {
			factor = 0.8
			new_character = {
				ROOT = {
					holder_scope = {
						attribute_diff = {
							character = PREVPREV
							attribute = diplomacy
							value = 10
						}
					}
				}
			}
		}
		modifier = {
			factor = 1.2
			holder_scope = {
				ROOT = {
					new_character = {
						attribute_diff = {
							character = PREVPREV
							attribute = stewardship
							value = 5
						}
					}
				}
			}
		}
		modifier = {
			factor = 0.8
			new_character = {
				ROOT = {
					holder_scope = {
						attribute_diff = {
							character = PREVPREV
							attribute = stewardship
							value = 5
						}
					}
				}
			}
		}
		modifier = {
			factor = 1.2
			holder_scope = {
				ROOT = {
					new_character = {
						attribute_diff = {
							character = PREVPREV
							attribute = intrigue
							value = 5
						}
					}
				}
			}
		}
		modifier = {
			factor = 0.8
			new_character = {
				ROOT = {
					holder_scope = {
						attribute_diff = {
							character = PREVPREV
							attribute = intrigue
							value = 5
						}
					}
				}
			}
		}
		# personal traits
		modifier = {
			factor = 0.1
			FROM = { NOT = { ai_ambition = -39 } }
			OR = {
				is_conquered = no
				conquest_culture = FROM
			}
		}
		modifier = {
			factor = 0.1
			FROM = { NOT = { ai_ambition = -19 } }
			OR = {
				is_conquered = no
				conquest_culture = FROM
			}
		}
		modifier = {
			factor = 0.01
			FROM = { trait = imbecile }
		}
		modifier = {
			factor = 0.1
			new_character = { character = FROM }
			FROM = { trait = humble }
		}
		modifier = {
			factor = 0.1
			new_character = { character = FROM }
			FROM = { NOT = { ai_ambition = -39 } }
		}
		modifier = {
			factor = 0.1
			FROM = { trait = inbred }
		}
		modifier = {
			factor = 0.1
			FROM = { trait = craven }
		}
		modifier = {
			factor = 0.2
			FROM = {
				OR = {
					trait = slow
					trait = dull
				}
			}
		}
		modifier = {
			factor = 0.5
			FROM = { trait = slothful }
		}
		modifier = {
			factor = 0.5
			new_character = { NOT = { character = FROM } }
			FROM = { trait = humble }
		}
		modifier = {
			factor = 1.5
			new_character = { character = FROM }
			FROM = { trait = brave }
		}
		modifier = {
			factor = 1.5
			new_character = { character = FROM }
			FROM = { trait = proud }
		}
		modifier = {
			factor = 1.5
			new_character = { character = FROM }
			FROM = {
				OR = {
					trait = envious
					trait = greedy
					trait = deceitful
				}
			}
		}
		modifier = {
			factor = 2.0
			is_conquered = yes
			NOT = { conquest_culture = FROM }
			new_character = { culture = FROM }
			FROM = {
				OR = {
					trait = diligent
					trait = just
					trait = wroth
				}
			}
		}
		modifier = {
			factor = 3.0
			FROM = { trait = lunatic }
		}
		modifier = {
			factor = 4.0
			new_character = {
				OR = {
					character = FROM
					is_close_relative = FROM
					is_married = FROM
					is_friend = FROM
					is_lover = FROM
				}
			}
			FROM = { ai_ambition = 40 }
		}
		modifier = {
			factor = 5
			new_character = {
				same_society_as = FROM
			}
		}
		modifier = {
			factor = 2
			FROM = {
				OR = {
					has_opinion_modifier = { who = LIEGE modifier = opinion_evil_tyrant }
					has_opinion_modifier = { who = LIEGE modifier = opinion_tyrant }
				}
			}
		}
		# less likely to support a claimant who is adopted
		modifier = {
			factor = 0.7
			new_character = { trait = adopted }
		}
	}

	# AI membership weight: ROOT is the prospective member. FROM is the faction leader. FROMFROM is the target title or character.
	membership = {
		factor = 4

		modifier = {
			factor = 0.5
			ROOT = {  
				liege = { 
					any_owned_bloodline = {
						has_bloodline_flag = bloodline_less_factions
						bloodline_is_active_for = PREV
					}
				}
			}
		}
		modifier = {
			factor = 0
			emf_faction_has_special_chance_blocker = yes
		}
		modifier = {
			factor = 0
			has_character_modifier = faction_claimant_timer
		}
		modifier = {
			factor = 0
			has_opinion_modifier = { who = LIEGE modifier = opinion_coerced_into_leaving_faction }
		}
		modifier = {
			factor = 1000
			has_opinion_modifier = { who = FROM modifier = opinion_coerced_into_joining_faction }
		}
		modifier = {
			factor = 0
			preparing_invasion = yes
		}
		modifier = {
			factor = 0.2
			emf_pacifist_true_religion = yes
			NOT = {	has_opinion_modifier = { who = FROM modifier = opinion_coerced_into_joining_faction } }
		}
		modifier = {
			factor = 2
			emf_warlike_true_religion = yes
		}
		modifier = {
			factor = 0.25
			FROM = { supported_claimant = { NOT = { culture = ROOT } } }
			NOT = {	has_opinion_modifier = { who = FROM modifier = opinion_coerced_into_joining_faction } }
		}
		modifier = {
			factor = 0.25
			FROM = { supported_claimant = { NOT = { culture_group = ROOT } } }
			NOT = {	has_opinion_modifier = { who = FROM modifier = opinion_coerced_into_joining_faction } }
		}
		# limits on who the AI will install in the title
		modifier = {
			factor = 0
			FROM = {
				supported_claimant = {
					OR = {
						is_rival = ROOT
						emf_can_inherit = no
						trait = imbecile
						trait = inbred
						is_incapable = yes
						NOR = {
							religion = { target = ROOT target_type = true }
							AND = {
								has_secret_religion = yes
								ROOT = {
									can_see_secret_religion = PREV
									true_religion = { target = PREV target_type = secret }
								}
							}
						}
						# not over 65 or celibate unless they have a legitimate son
						AND = {
							OR = {
								practical_age = 65
								trait = celibate
							}
							NOT = {
								any_child = {
									is_female = no
									emf_can_inherit = yes
								}
							}
						}
						# not old women, period
						AND = {
							is_female = yes
							practical_age = 45
						}
					}
				}
			}
			NOT = {	has_opinion_modifier = { who = FROM modifier = opinion_coerced_into_joining_faction } }
		}
		# religion heads do not join claimant factions
		modifier = {
			factor = 0
			OR = {
				controls_religion = yes
				rightful_religious_head = ROOT
			}
			NOT = {	has_opinion_modifier = { who = FROM modifier = opinion_coerced_into_joining_faction } }
		}
		# will not join claimant factions for titles held by an AI religion head, unless cynical
		modifier = {
			factor = 0
			NOT = { trait = cynical }
			rightful_religious_head_scope = {
				ai = yes
				has_landed_title = FROMFROM
			}
			NOT = {	has_opinion_modifier = { who = FROM modifier = opinion_coerced_into_joining_faction } }
		}
		# will not join claimant factions against vassals in another realm
		modifier = {
			factor = 0
			FROMFROM = {
				holder_scope = {
					independent = no
					NOT = { same_realm = ROOT }
				}
			}
			NOT = {	has_opinion_modifier = { who = FROM modifier = opinion_coerced_into_joining_faction } }
		}
		# bonus vs. titles held by prisoners, children, incapable, uncrowned, or in seclusion
		modifier = {
			factor = 3.0
			FROMFROM = {
				holder_scope = {
					OR = {
						prisoner = yes
						has_character_modifier = in_seclusion
						is_adult = no
						is_incapable = yes
						emf_needs_coronation = yes
					}
				}
			}
		}
		# more likely to support a justified claimant
		modifier = {
			factor = 3.0
			FROM = {
				supported_claimant = { has_character_flag = emf_justified_claimant_@FROMFROM }
			}
		}
		# they are the supported claimant
		modifier = {
			factor = 10.0
			FROM = {
				supported_claimant = { character = ROOT }
			}
		}
		# the claimant is of my dynasty, and the current holder is not
		modifier = {
			factor = 1.5
			FROMFROM = {
				holder_scope = {
					NOT = { dynasty = ROOT }
				}
			}
			FROM = {
				supported_claimant = {
					NOT = { character = ROOT }
					dynasty = ROOT
				}
			}
		}
		# the claimant is a close relative, and the current holder is not
		modifier = {
			factor = 1.5
			FROMFROM = {
				holder_scope = {
					NOT = { is_close_relative = ROOT }
				}
			}
			FROM = {
				supported_claimant = { is_close_relative = ROOT }
			}
		}
		# discourage forming claimant factions in support of rulers from another independent realm
		modifier = {
			factor = 0.15
			FROM = {
				supported_claimant = {
					is_ruler = yes
					NOT = { same_realm = ROOT }
				}
			}
			NOT = {	has_opinion_modifier = { who = FROM modifier = opinion_coerced_into_joining_faction } }
		}
		# will not support decadent claimant unless also decadent
		modifier = {
			factor = 0
			NOT = { trait = decadent }
			FROM = { supported_claimant = { trait = decadent } }
			NOT = {	has_opinion_modifier = { who = FROM modifier = opinion_coerced_into_joining_faction } }
		}
		# will not support a claimant against someone you installed in the position
		modifier = {
			factor = 0
			FROMFROM = {
				holder_scope = {
					reverse_has_opinion_modifier = { who = ROOT modifier = opinion_fought_for_claimant }
				}
			}
			NOT = {	has_opinion_modifier = { who = FROM modifier = opinion_coerced_into_joining_faction } }
		}
		# should not be supporting a different claimant unless it's yourself
		modifier = {
			factor = 0
			in_faction = faction_claimant
			supported_claimant = {
				FROM = {
					supported_claimant = {
						NOT = { character = ROOT }
						NOT = { character = PREVPREV }
					}
				}
			}
			NOT = {	has_opinion_modifier = { who = FROM modifier = opinion_coerced_into_joining_faction } }
		}
		# will support a claimant of the same religion & culture against a liege who is either not of the same religion group or the same culture group
		modifier = {
			factor = 10.0
			FROMFROM = {
				holder_scope = {
					is_liege_of = ROOT
					OR = {
						NOT = { culture_group = ROOT }
						ROOT_FROM = {
							emf_hostile_true_religion_to_PREV = yes
						}
					}
				}
			}
			FROM = {
				supported_claimant = {
					culture = ROOT
					OR = {
						religion = { target = ROOT target_type = true }
						AND = {
							has_secret_religion = yes
							ROOT = {
								can_see_secret_religion = PREV
								true_religion = { target = PREV target_type = secret }
							}
						}
					}
				}
			}
		}
		# less likely to support young children
		modifier = {
			factor = 0.5
			FROM = {
				supported_claimant = { NOT = { age = 13 } }
			}
		}
		modifier = {
			factor = 0.5
			FROM = {
				supported_claimant = { NOT = { age = 10 } }
			}
		}
		modifier = {
			factor = 0.5
			FROM = {
				supported_claimant = { NOT = { age = 5 } }
			}
		}
		# more likely to support a male claimant against a woman holding an agnatic title
		modifier = {
			factor = 3.0
			FROMFROM = {
				succ_law_title = { has_law = agnatic_succession }
				holder_scope = { is_female = yes }
			}
			FROM = { supported_claimant = { is_female = no } }
			emf_feminist_true_religion = no
		}
		# will not support a woman for an agnatic title unless she has a son (who can inherit) or is formidable
		modifier = {
			factor = 0
			FROMFROM = { succ_law_title = { has_law = agnatic_succession } }
			emf_feminist_true_religion = no
			FROM = {
				supported_claimant = {
					is_female = yes
					NOR = {
						character = ROOT
						emf_is_formidable_person = yes
						any_child = {
							is_female = no
							emf_can_inherit = yes
							OR = {
								dynasty = PREV
								dynasty = ROOT
							}
						}
					}
				}
			}
			NOT = {	has_opinion_modifier = { who = FROM modifier = opinion_coerced_into_joining_faction } }
		}
		# unlikely to support a woman for a cognatic title unless she has a son (who can inherit) or is formidable
		modifier = {
			factor = 0.5
			FROMFROM = { succ_law_title = { has_law = cognatic_succession } }
			emf_feminist_true_religion = no
			FROM = {
				supported_claimant = {
					is_female = yes
					NOR = {
						character = ROOT
						emf_is_formidable_person = yes
						any_child = {
							is_female = no
							emf_can_inherit = yes
							OR = {
								dynasty = PREV
								dynasty = ROOT
							}
						}
					}
				}
			}
		}
		# unlikely to support a woman in any case unless they are female
		modifier = {
			factor = 0.5
			FROMFROM = {
				NOR = {
					succ_law_title = { has_law = true_cognatic_succession }
					succ_law_title = { has_law = enatic_cognatic_succession }
					succ_law_title = { has_law = enatic_succession }
					holder_scope = { primary_title = { has_law = status_of_women_4 } }
				}
			}
			FROM = { supported_claimant = { is_female = yes } }
			is_female = no
			emf_feminist_true_religion = no
		}
		# will not support a woman at all if zealous or in tradition faction
		modifier = {
			factor = 0
			FROMFROM = {
				NOR = {
					succ_law_title = { has_law = true_cognatic_succession }
					succ_law_title = { has_law = enatic_cognatic_succession }
					succ_law_title = { has_law = enatic_succession }
					holder_scope = { primary_title = { has_law = status_of_women_4 } }
				}
			}
			FROM = { supported_claimant = { is_female = yes } }
			OR = {
				trait = zealous
				in_faction = faction_tradition
			}
			emf_feminist_true_religion = no
			NOT = {	has_opinion_modifier = { who = FROM modifier = opinion_coerced_into_joining_faction } }
		}
		# more likely to support a female claimant against a man holding an enatic title
		modifier = {
			factor = 3.0
			FROMFROM = {
				succ_law_title = { has_law = enatic_succession }
				holder_scope = { is_female = no }
			}
			FROM = { supported_claimant = { is_female = yes } }
			true_religion_scope = { has_religion_feature = religion_matriarchal }
		}
		# will not support a man for an enatic title unless he has a daughter (who can inherit) or is formidable
		modifier = {
			factor = 0
			FROMFROM = { succ_law_title = { has_law = enatic_succession } }
			true_religion_scope = { has_religion_feature = religion_matriarchal }
			FROM = {
				supported_claimant = {
					is_female = no
					NOR = {
						character = ROOT
						emf_is_formidable_person = yes
						any_child = {
							is_female = yes
							emf_can_inherit = yes
							OR = {
								dynasty = PREV
								dynasty = ROOT
							}
						}
					}
				}
			}
			NOT = {	has_opinion_modifier = { who = FROM modifier = opinion_coerced_into_joining_faction } }
		}
		# unlikely to support a man for an enatic-cognatic title unless he has a daughter (who can inherit) or is formidable
		modifier = {
			factor = 0.5
			FROMFROM = { succ_law_title = { has_law = enatic_cognatic_succession } }
			true_religion_scope = { has_religion_feature = religion_matriarchal }
			FROM = {
				supported_claimant = {
					is_female = no
					NOR = {
						character = ROOT
						emf_is_formidable_person = yes
						any_child = {
							is_female = yes
							emf_can_inherit = yes
							OR = {
								dynasty = PREV
								dynasty = ROOT
							}
						}
					}
				}
			}
		}
		# as matriarchal, unlikely to support a man in any case unless they are male
		modifier = {
			factor = 0.5
			FROMFROM = {
				NOR = {
					succ_law_title = { has_law = enatic_cognatic_succession }
					succ_law_title = { has_law = enatic_succession }
				}
			}
			FROM = { supported_claimant = { is_female = no } }
			is_female = yes
			true_religion_scope = { has_religion_feature = religion_matriarchal }
		}
		# as matriarchal, will not support a man at all if zealous or in tradition faction
		modifier = {
			factor = 0
			FROMFROM = {
				OR = {
					succ_law_title = { has_law = enatic_cognatic_succession }
					succ_law_title = { has_law = enatic_succession }
				}
			}
			FROM = { supported_claimant = { is_female = no } }
			OR = {
				trait = zealous
				in_faction = faction_tradition
			}
			true_religion_scope = { has_religion_feature = religion_matriarchal }
			NOT = {	has_opinion_modifier = { who = FROM modifier = opinion_coerced_into_joining_faction } }
		}
		# will not support claimants against their own spouse
		modifier = {
			factor = 0
			FROMFROM = { holder_scope = { is_married = ROOT } }
			NOT = {	has_opinion_modifier = { who = FROM modifier = opinion_coerced_into_joining_faction } }
		}
		# will not install anyone else if the current heir
		modifier = {
			factor = 0
			FROMFROM = { current_heir = { character = ROOT } }
			FROM = { supported_claimant = { NOT = { character = ROOT } } }
			NOT = {	has_opinion_modifier = { who = FROM modifier = opinion_coerced_into_joining_faction } }
		}
		# less likely to support a weak claimant when a strong claimant of the same religion & culture exists in the realm
		modifier = {
			factor = 0.25
			FROM = { supported_claimant = { has_weak_claim = ROOT_FROMFROM } }
			liege = {
				any_vassal = {
					leads_faction = faction_claimant
					supported_claimant = {
						OR = {
							religion = { target = ROOT target_type = true }
							AND = {
								has_secret_religion = yes
								ROOT = {
									can_see_secret_religion = PREV
									true_religion = { target = PREV target_type = secret }
								}
							}
						}
						culture = ROOT
						has_strong_claim = ROOT_FROMFROM
					}
				}
			}
			NOT = {	has_opinion_modifier = { who = FROM modifier = opinion_coerced_into_joining_faction } }
		}
		# there's already another claimant of my cultuer and religion that I don't dislike
		modifier = {
			factor = 0.75
			FROM = { supported_claimant = { NOT = { character = ROOT } } }
			FROMFROM = {
				holder_scope = {
					any_vassal = {
						leads_faction = faction_claimant
						supported_claimant = {
							culture = ROOT
							OR = {
								religion = { target = ROOT target_type = true }
								AND = {
									has_secret_religion = yes
									ROOT = {
										can_see_secret_religion = PREV
										true_religion = { target = PREV target_type = secret }
									}
								}
							}
							reverse_opinion = { who = FROM value = 0 }
							FROM = {
								supported_claimant = {
									NOT = { character = PREVPREV }
								}
							}
						}
					}
				}
			}
		}
		# will not support a claimant when they are already a claimant of another faction
		modifier = {
			factor = 0
			FROM = { supported_claimant = { NOT = { character = ROOT } } }
			liege = {
				any_vassal = {
					leads_faction = faction_claimant
					supported_claimant = { character = ROOT }
					supported_claimant_title = { title = FROMFROM }
				}
			}
			NOT = {	has_opinion_modifier = { who = FROM modifier = opinion_coerced_into_joining_faction } }
		}
		# more likely to support a claimant with good backing
		modifier = {
			factor = 1.2
			NOT = { has_claim = FROMFROM }
			FROM = {
				OR = {
					faction_power = { faction = faction_claimant power = 0.3 }
					any_faction_backer = { in_faction = faction_claimant count = 2 }
				}
			}
		}
		modifier = {
			factor = 1.2
			NOT = { has_claim = FROMFROM }
			FROM = {
				OR = {
					faction_power = { faction = faction_claimant power = 0.5 }
					any_faction_backer = { in_faction = faction_claimant count = 4 }
				}
			}
		}
		modifier = {
			factor = 1.2
			NOT = { has_claim = FROMFROM }
			FROM = {
				OR = {
					faction_power = { faction = faction_claimant power = 0.7 }
					any_faction_backer = { in_faction = faction_claimant count = 6 }
				}
			}
		}
		# less likely to support a weak claimant for a title they also have a weak claim to unless it has good backing
		modifier = {
			factor = 0.1
			FROMFROM = {
				NOR = {
					has_law = succ_feudal_elective
					has_law = succ_hre_elective
				}
			}
			has_weak_claim = FROMFROM
			FROM = {
				supported_claimant = {
					NOT = { character = ROOT }
					has_weak_claim = ROOT_FROMFROM
				}
				NOR = {
					faction_power = { faction = faction_claimant power = 0.3 }
					any_faction_backer = { in_faction = faction_claimant count = 2 }
				}
			}
			NOT = {	has_opinion_modifier = { who = FROM modifier = opinion_coerced_into_joining_faction } }
		}
		# still reluctant to support a weak claimant for a title they also have a weak claim to even when it has good backing
		modifier = {
			factor = 0.5
			FROMFROM = {
				NOR = {
					has_law = succ_feudal_elective
					has_law = succ_hre_elective
				}
			}
			has_weak_claim = FROMFROM
			FROM = {
				supported_claimant = {
					NOT = { character = ROOT }
					has_weak_claim = ROOT_FROMFROM
				}
				OR = {
					faction_power = { faction = faction_claimant power = 0.3 }
					any_faction_backer = { in_faction = faction_claimant count = 2 }
				}
			}
		}
		# will not support a claimant for a title they also have a strong claim to unless that claimant also has a strong claim
		modifier = {
			factor = 0
			has_strong_claim = FROMFROM
			FROM = {
				supported_claimant = {
					NOT = { character = ROOT }
					NOT = { has_strong_claim = ROOT_FROMFROM }
				}
			}
			NOT = {	has_opinion_modifier = { who = FROM modifier = opinion_coerced_into_joining_faction } }
		}
		# less likely to support a strong claimant for a title they also have a strong claim to unless it has good backing
		modifier = {
			factor = 0.1
			FROMFROM = {
				NOR = {
					has_law = succ_feudal_elective
					has_law = succ_hre_elective
				}
			}
			has_strong_claim = FROMFROM
			FROM = {
				supported_claimant = {
					NOT = { character = ROOT }
					has_strong_claim = ROOT_FROMFROM
				}
				NOR = {
					faction_power = { faction = faction_claimant power = 0.3 }
					any_faction_backer = { in_faction = faction_claimant count = 2 }
				}
			}
			NOT = {	has_opinion_modifier = { who = FROM modifier = opinion_coerced_into_joining_faction } }
		}
		# still reluctant to support a strong claimant for a title they also have a strong claim to even when it has good backing
		modifier = {
			factor = 0.5
			FROMFROM = {
				NOR = {
					has_law = succ_feudal_elective
					has_law = succ_hre_elective
				}
			}
			has_strong_claim = FROMFROM
			FROM = {
				supported_claimant = {
					NOT = { character = ROOT }
					has_strong_claim = ROOT_FROMFROM
				}
				OR = {
					faction_power = { faction = faction_claimant power = 0.3 }
					any_faction_backer = { in_faction = faction_claimant count = 2 }
				}
			}
		}
		# less likely to support a strong claimant for a title they have a weak claim to unless it has good backing
		modifier = {
			factor = 0.25
			FROMFROM = {
				NOR = {
					has_law = succ_feudal_elective
					has_law = succ_hre_elective
				}
			}
			has_weak_claim = FROMFROM
			FROM = {
				supported_claimant = {
					NOT = { character = ROOT }
					has_strong_claim = ROOT_FROMFROM
				}
				NOR = {
					faction_power = { faction = faction_claimant power = 0.3 }
					any_faction_backer = { in_faction = faction_claimant count = 2 }
				}
			}
			NOT = {	has_opinion_modifier = { who = FROM modifier = opinion_coerced_into_joining_faction } }
		}
		# still less likely to support a strong claimant for a title they have a weak claim even when it has good backing
		modifier = {
			factor = 0.75
			FROMFROM = {
				NOR = {
					has_law = succ_feudal_elective
					has_law = succ_hre_elective
				}
			}
			has_weak_claim = FROMFROM
			FROM = {
				supported_claimant = {
					NOT = { character = ROOT }
					has_strong_claim = ROOT_FROMFROM
				}
				OR = {
					faction_power = { faction = faction_claimant power = 0.3 }
					any_faction_backer = { in_faction = faction_claimant count = 2 }
				}
			}
		}
		# will not support a claimant of a different dynasty if holder is same dynasty, religion and culture
		modifier = {
			factor = 0
			FROMFROM = {
				holder_scope = {
					dynasty = ROOT
					OR = {
						religion = { target = ROOT target_type = true }
						AND = {
							has_secret_religion = yes
							ROOT = {
								can_see_secret_religion = PREV
								true_religion = { target = PREV target_type = secret }
							}
						}
					}
					culture = ROOT
				}
			}
			FROM = {
				supported_claimant = {
					NOT = { dynasty = ROOT }
				}
			}
			NOT = {	has_opinion_modifier = { who = FROM modifier = opinion_coerced_into_joining_faction } }
		}
		# will not put themselves forward for an elective title unless ambitious or a justified/strong claimant
		modifier = {
			factor = 0
			FROMFROM = {
				OR = {
					has_law = succ_feudal_elective
					has_law = succ_hre_elective
				}
			}
			FROM = {
				supported_claimant = {
					character = ROOT
					NOR = {
						ai_ambition = 40
						has_strong_claim = ROOT_FROMFROM
						has_character_flag = emf_justified_claimant_@FROMFROM
					}
				}
			}
			NOT = {	has_opinion_modifier = { who = FROM modifier = opinion_coerced_into_joining_faction } }
		}
		# will not support a claimant for a title that is currently contested by someone of a different religion/culture group
		modifier = {
			factor = 0
			FROMFROM = {
				NOR = {
					has_law = succ_feudal_elective
					has_law = succ_hre_elective
				}
				holder_scope = {
					culture_group = ROOT
					OR = {
						religion = { target = ROOT target_type = true }
						AND = {
							has_secret_religion = yes
							ROOT = {
								can_see_secret_religion = PREV
								true_religion = { target = PREV target_type = secret }
							}
						}
					}
					any_war = {
						war_title = PREVPREV
						defender = { character = FROMFROM }
						attacker = {
							OR = {
								NOT = { culture_group = ROOT }
								NOR = {
									religion = { target = ROOT target_type = true }
									AND = {
										has_secret_religion = yes
										ROOT = {
											can_see_secret_religion = PREV
											true_religion = { target = PREV target_type = secret }
										}
									}
								}
							}
						}
					}
				}
			}
			NOT = {	has_opinion_modifier = { who = FROM modifier = opinion_coerced_into_joining_faction } }
		}
		# will not support a claim for the primary title if there is an equal-tier title they are de jure vassal of
		modifier = {
			factor = 0
			FROMFROM = {
				NOT = { de_jure_vassal_or_below = ROOT }
				holder_scope = {
					any_demesne_title = {
						is_primary_holder_title_tier = yes
						de_jure_vassal_or_below = ROOT
						NOT = { title = PREVPREV }
					}
				}
			}
			NOT = {	has_opinion_modifier = { who = FROM modifier = opinion_coerced_into_joining_faction } }
		}
		# will not support a claimant of a different culture if title is recently conquered
		modifier = {
			factor = 0
			FROMFROM = { is_conquered = yes }
			FROM = { supported_claimant = { NOT = { culture = ROOT } } }
			NOT = {	has_opinion_modifier = { who = FROM modifier = opinion_coerced_into_joining_faction } }
		}
		# more likely to support a claimant of the same culture if title is recently conquered
		modifier = {
			factor = 4.0
			FROMFROM = {
				is_conquered = yes
				NOT = { conquest_culture = ROOT }
			}
			FROM = {
				supported_claimant = { culture = ROOT }
			}
		}
		# If there is an antiking faction, prioritize that
		modifier = {
			factor = 0
			OR = {
				religion = catholic
				religion = fraticelli
			}
			top_liege = {
				is_liege_of = ROOT
				religion = ROOT
				rightful_religious_head_scope = {
					OR = {
						has_claim = k_papal_state
						has_claim = d_fraticelli
					}
				}
				any_realm_lord = { in_faction = faction_antiking }
			}
			NOT = {	has_opinion_modifier = { who = FROM modifier = opinion_coerced_into_joining_faction } }
		}
		# more likely to support claimants from less powerful dynasties
		modifier = {
			factor = 2.0
			FROMFROM = { holder_scope = { dynasty_realm_power = 0.25 } }
			FROM = {
				supported_claimant = {
					FROMFROM = {
						holder_scope = { NOT = { dynasty = PREVPREV } }
					}
				}
			}
		}
		modifier = {
			factor = 2.0
			FROMFROM = { holder_scope = { dynasty_realm_power = 0.4 } }
			FROM = {
				supported_claimant = {
					FROMFROM = {
						holder_scope = { NOT = { dynasty = PREVPREV } }
					}
				}
			}
		}
		# less likely to support a claimant not born in the purple when there's a claimant who is
		modifier = {
			factor = 0.5
			FROMFROM = {
				emf_is_roman_empire = yes
			}
			FROM = { supported_claimant = { NOT = { trait = born_in_the_purple } } }
			OR = {
				culture_group = byzantine
				culture = roman
			}
			liege = {
				any_vassal = {
					leads_faction = faction_claimant
					supported_claimant = { trait = born_in_the_purple }
				}
			}
		}
		# more likely to support sayyid against a holder who isn't
		modifier = {
			factor = 2.0
			true_religion_group = muslim
			FROMFROM = { holder_scope = { NOT = { trait = sayyid } } }
			FROM = {
				supported_claimant = {
					OR = {
						religion_group = { target = ROOT target_type = true }
						AND = {
							has_secret_religion = yes
							ROOT = {
								can_see_secret_religion = PREV
								true_religion_group = { target = PREV target_type = secret }
							}
						}
					}
					trait = sayyid
				}
			}
		}
		# more likely to support mirza against a holder who is neither sayyid nor mirza
		modifier = {
			factor = 1.5
			true_religion_group = muslim
			FROMFROM = {
				holder_scope = {
					NOR = {
						trait = sayyid
						trait = mirza
					}
				}
			}
			FROM = {
				supported_claimant = {
					OR = {
						religion_group = { target = ROOT target_type = true }
						AND = {
							has_secret_religion = yes
							ROOT = {
								can_see_secret_religion = PREV
								true_religion_group = { target = PREV target_type = secret }
							}
						}
					}
					trait = mirza
				}
			}
		}
		# members of the tradition faction are less likely to support claimants unless the holder is excommunicated
		modifier = {
			factor = 2
			FROMFROM = { holder_scope = { trait = excommunicated } }
			in_faction = faction_tradition
		}
		modifier = {
			factor = 0.5
			FROMFROM = { holder_scope = { NOT = { trait = excommunicated } } }
			in_faction = faction_tradition
		}
		# members of an unhappy court faction are more likely to support claimants
		modifier = {
			factor = 2.0
			in_faction = faction_court
			liege = {
				OR = {
					has_character_flag = faction_court_angry
					has_character_flag = faction_court_unhappy
				}
			}
		}
		# faction leader is a member of the same faction, which is angry
		modifier = {
			factor = 5.0
			OR = {
				AND = {
					in_faction = faction_court
					liege = { has_character_flag = faction_court_angry }
					FROM = {
						OR = {
							leads_faction = faction_court
							any_faction_backer = {
								in_faction = faction_claimant
								leads_faction = faction_court
							}
						}
					}
				}
				AND = {
					in_faction = faction_prosperity
					liege = { has_character_flag = faction_prosperity_angry }
					FROM = {
						OR = {
							leads_faction = faction_prosperity
							any_faction_backer = {
								in_faction = faction_claimant
								leads_faction = faction_prosperity
							}
						}
					}
				}
				AND = {
					in_faction = faction_glory
					liege = { has_character_flag = faction_glory_angry }
					FROM = {
						OR = {
							leads_faction = faction_glory
							any_faction_backer = {
								in_faction = faction_claimant
								leads_faction = faction_glory
							}
						}
					}
				}
				AND = {
					in_faction = faction_tradition
					liege = { has_character_flag = faction_tradition_angry }
					FROM = {
						OR = {
							leads_faction = faction_tradition
							any_faction_backer = {
								in_faction = faction_claimant
								leads_faction = faction_tradition
							}
						}
					}
				}
			}
		}
		# opinions
		modifier = {
			factor = 0
			FROMFROM = {
				holder_scope = {
					culture = ROOT
					OR = {
						religion = { target = ROOT target_type = true }
						AND = {
							has_secret_religion = yes
							ROOT = {
								can_see_secret_religion = PREV
								true_religion = { target = PREV target_type = secret }
							}
						}
					}
					ROOT = {
						opinion = { who = PREV value = 0 }
						NOR = {
							trait = deceitful
							ai_ambition = 40
							trait = envious
							trait = proud
							trait = brave
						}
					}
				}
			}
			NOT = {	has_opinion_modifier = { who = FROM modifier = opinion_coerced_into_joining_faction } }
		}
		modifier = {
			factor = 0
			FROMFROM = {
				holder_scope = {
					OR = {
						NOT = { culture = ROOT }
						NOR = {
							religion = { target = ROOT target_type = true }
							AND = {
								has_secret_religion = yes
								ROOT = {
									can_see_secret_religion = PREV
									true_religion = { target = PREV target_type = secret }
								}
							}
						}
					}
					ROOT = {
						opinion = { who = PREV value = 25 }
						NOR = {
							trait = deceitful
							ai_ambition = 40
							trait = envious
							trait = proud
							trait = brave
						}
					}
				}
			}
			NOT = {	has_opinion_modifier = { who = FROM modifier = opinion_coerced_into_joining_faction } }
		}
		modifier = {
			factor = 0
			FROMFROM = {
				holder_scope = {
					culture = ROOT
					OR = {
						religion = { target = ROOT target_type = true }
						AND = {
							has_secret_religion = yes
							ROOT = {
								can_see_secret_religion = PREV
								true_religion = { target = PREV target_type = secret }
							}
						}
					}
					ROOT = {
						opinion = { who = PREV value = 25 }
						OR = {
							trait = deceitful
							ai_ambition = 40
							trait = envious
							trait = proud
							trait = brave
						}
					}
				}
			}
			NOT = {	has_opinion_modifier = { who = FROM modifier = opinion_coerced_into_joining_faction } }
		}
		modifier = {
			factor = 1.5
			FROMFROM = {
				holder_scope = {
					NOT = { reverse_opinion = { who = ROOT value = -25 } }
				}
			}
		}
		modifier = {
			factor = 2.0
			FROMFROM = {
				holder_scope = {
					NOT = { reverse_opinion = { who = ROOT value = -50 } }
				}
			}
		}
		modifier = {
			factor = 4.0
			FROMFROM = {
				holder_scope = {
					NOT = { reverse_opinion = { who = ROOT value = -75 } }
				}
			}
		}
		modifier = {
			factor = 0.5
			FROM = {
				supported_claimant = {
					NOT = { reverse_opinion = { who = ROOT value = 20 } }
				}
			}
		}
		modifier = {
			factor = 0
			FROM = {
				supported_claimant = {
					NOT = { reverse_opinion = { who = ROOT value = 0 } }
				}
			}
			NOT = {	has_opinion_modifier = { who = FROM modifier = opinion_coerced_into_joining_faction } }
		}
		modifier = {
			# I must like the claimant more than the current ruler
			factor = 0
			FROM = {
				supported_claimant = { NOT = { character = ROOT } }
			}
			NOT = {
				FROM = {
					supported_claimant = {
						ROOT = {
							opinion_diff = {
								first = PREV
								second = LIEGE
								value = 10
								as_if_liege = yes
							}
						}
					}
				}
			}
			NOT = {	has_opinion_modifier = { who = FROM modifier = opinion_coerced_into_joining_faction } }
		}
		modifier = {
			factor = 1.5
			FROM = {
				supported_claimant = {
					NOT = { character = ROOT }
					ROOT = {
						opinion_diff = {
							first = PREV
							second = LIEGE
							value = 25
							as_if_liege = yes
						}
					}
				}
			}
		}
		modifier = {
			factor = 1.5
			FROM = {
				supported_claimant = {
					NOT = { character = ROOT }
					ROOT = {
						opinion_diff = {
							first = PREV
							second = LIEGE
							value = 50
							as_if_liege = yes
						}
					}
				}
			}
		}
		modifier = {
			factor = 1.5
			FROM = {
				supported_claimant = {
					NOT = { character = ROOT }
					ROOT = {
						opinion_diff = {
							first = PREV
							second = LIEGE
							value = 75
							as_if_liege = yes
						}
					}
				}
			}
		}
		modifier = {
			factor = 1.5
			FROM = {
				supported_claimant = {
					NOT = { character = ROOT }
					ROOT = {
						opinion_diff = {
							first = PREV
							second = LIEGE
							value = 100
							as_if_liege = yes
						}
					}
				}
			}
		}
		modifier = {
			factor = 1.1
			opinion = { who = FROM value = 25 }
		}
		modifier = {
			factor = 1.1
			opinion = { who = FROM value = 50 }
		}
		modifier = {
			factor = 1.1
			opinion = { who = FROM value = 75 }
		}
		modifier = {
			factor = 0.9
			NOT = { opinion = { who = FROM value = -25 } }
		}
		modifier = {
			factor = 0.9
			NOT = { opinion = { who = FROM value = -50 } }
		}
		modifier = {
			factor = 0.9
			NOT = { opinion = { who = FROM value = -75 } }
		}
		# personal traits of the claimant
		modifier = {
			factor = 0
			FROM = {
				supported_claimant = {
					OR = {
						trait = lunatic
						trait = possessed
					}
				}
			}
			FROMFROM = {
				holder_scope = {
					NOR = {
						trait = lunatic
						trait = possessed
					}
				}
			}
			NOR = {
				trait = lunatic
				trait = possessed
			}
			NOT = {	has_opinion_modifier = { who = FROM modifier = opinion_coerced_into_joining_faction } }
		}
		modifier = {
			factor = 1.5
			FROM = {
				supported_claimant = {
					is_smart_trigger = yes
				}
			}
			FROMFROM = {
				holder_scope = {
					is_smart_trigger = no
				}
			}
		}
		modifier = {
			factor = 0.5
			FROM = {
				supported_claimant = {
					OR = {
						trait = slow
						trait = dull
						trait = infirm
						NOT = { ai_ambition = -39 }
						NOT = { health = 4 }
					}
				}
			}
		}
		modifier = {
			factor = 1.5
			trait = zealous
			FROM = {
				supported_claimant = { trait = zealous }
			}
			FROMFROM = {
				holder_scope = { NOT = { trait = zealous } }
			}
		}
		modifier = {
			factor = 0.5
			trait = cynical
			FROM = {
				supported_claimant = { trait = cynical }
			}
		}
		modifier = {
			factor = 1.2
			liege = {
				FROM = {
					supported_claimant = {
						attribute_diff = {
							character = PREVPREV
							attribute = diplomacy
							value = 2
						}
					}
				}
			}
		}
		modifier = {
			factor = 1.2
			liege = {
				FROM = {
					supported_claimant = {
						attribute_diff = {
							character = PREVPREV
							attribute = diplomacy
							value = 4
						}
					}
				}
			}
		}
		modifier = {
			factor = 1.2
			liege = {
				FROM = {
					supported_claimant = {
						attribute_diff = {
							character = PREVPREV
							attribute = diplomacy
							value = 6
						}
					}
				}
			}
		}
		modifier = {
			factor = 1.2
			liege = {
				FROM = {
					supported_claimant = {
						attribute_diff = {
							character = PREVPREV
							attribute = diplomacy
							value = 8
						}
					}
				}
			}
		}
		modifier = {
			factor = 1.2
			liege = {
				FROM = {
					supported_claimant = {
						attribute_diff = {
							character = PREVPREV
							attribute = diplomacy
							value = 10
						}
					}
				}
			}
		}
		modifier = {
			factor = 0.8
			FROM = {
				supported_claimant = {
					FROMFROM = {
						holder_scope = {
							attribute_diff = {
								character = PREVPREV
								attribute = diplomacy
								value = 2
							}
						}
					}
				}
			}
		}
		modifier = {
			factor = 0.8
			FROM = {
				supported_claimant = {
					FROMFROM = {
						holder_scope = {
							attribute_diff = {
								character = PREVPREV
								attribute = diplomacy
								value = 4
							}
						}
					}
				}
			}
		}
		modifier = {
			factor = 0.8
			FROM = {
				supported_claimant = {
					FROMFROM = {
						holder_scope = {
							attribute_diff = {
								character = PREVPREV
								attribute = diplomacy
								value = 6
							}
						}
					}
				}
			}
		}
		modifier = {
			factor = 0.8
			FROM = {
				supported_claimant = {
					FROMFROM = {
						holder_scope = {
							attribute_diff = {
								character = PREVPREV
								attribute = diplomacy
								value = 8
							}
						}
					}
				}
			}
		}
		modifier = {
			factor = 0.8
			FROM = {
				supported_claimant = {
					FROMFROM = {
						holder_scope = {
							attribute_diff = {
								character = PREVPREV
								attribute = diplomacy
								value = 10
							}
						}
					}
				}
			}
		}
		modifier = {
			factor = 1.2
			liege = {
				FROM = {
					supported_claimant = {
						attribute_diff = {
							character = PREVPREV
							attribute = stewardship
							value = 5
						}
					}
				}
			}
		}
		modifier = {
			factor = 0.8
			FROM = {
				supported_claimant = {
					FROMFROM = {
						holder_scope = {
							attribute_diff = {
								character = PREVPREV
								attribute = stewardship
								value = 5
							}
						}
					}
				}
			}
		}
		modifier = {
			factor = 1.2
			liege = {
				FROM = {
					supported_claimant = {
						attribute_diff = {
							character = PREVPREV
							attribute = intrigue
							value = 5
						}
					}
				}
			}
		}
		modifier = {
			factor = 0.8
			FROM = {
				supported_claimant = {
					FROMFROM = {
						holder_scope = {
							attribute_diff = {
								character = PREVPREV
								attribute = intrigue
								value = 5
							}
						}
					}
				}
			}
		}
		# personal traits
		modifier = {
			factor = 0.1
			NOT = { ai_ambition = -39 }
			FROMFROM = {
				OR = {
					is_conquered = no
					conquest_culture = FROM
				}
			}
			NOT = {	has_opinion_modifier = { who = FROM modifier = opinion_coerced_into_joining_faction } }
		}
		modifier = {
			factor = 0.1
			NOT = { ai_ambition = -19 }
			FROMFROM = {
				OR = {
					is_conquered = no
					conquest_culture = FROM
				}
			}
			NOT = {	has_opinion_modifier = { who = FROM modifier = opinion_coerced_into_joining_faction } }
		}
		modifier = {
			factor = 0.01
			trait = imbecile
			NOT = {	has_opinion_modifier = { who = FROM modifier = opinion_coerced_into_joining_faction } }
		}
		modifier = {
			factor = 0.1
			FROM = { supported_claimant = { character = ROOT } }
			trait = humble
			NOT = {	has_opinion_modifier = { who = FROM modifier = opinion_coerced_into_joining_faction } }
		}
		modifier = {
			factor = 0.1
			FROM = { supported_claimant = { character = ROOT } }
			NOT = { ai_ambition = -39 }
			NOT = {	has_opinion_modifier = { who = FROM modifier = opinion_coerced_into_joining_faction } }
		}
		modifier = {
			factor = 0.1
			trait = inbred
			NOT = {	has_opinion_modifier = { who = FROM modifier = opinion_coerced_into_joining_faction } }
		}
		modifier = {
			factor = 0.1
			trait = craven
			NOT = {	has_opinion_modifier = { who = FROM modifier = opinion_coerced_into_joining_faction } }
		}
		modifier = {
			factor = 0.2
			OR = {
				trait = slow
				trait = dull
			}
			NOT = {	has_opinion_modifier = { who = FROM modifier = opinion_coerced_into_joining_faction } }
		}
		modifier = {
			factor = 0.5
			trait = slothful
		}
		modifier = {
			factor = 0.5
			FROM = { supported_claimant = { NOT = { character = ROOT } } }
			trait = humble
		}
		modifier = {
			factor = 1.5
			FROM = { supported_claimant = { character = ROOT } }
			trait = brave
		}
		modifier = {
			factor = 1.5
			FROM = { supported_claimant = { character = ROOT } }
			trait = proud
		}
		modifier = {
			factor = 1.5
			FROM = { supported_claimant = { character = ROOT } }
			OR = {
				trait = envious
				trait = greedy
				trait = deceitful
			}
		}
		modifier = {
			factor = 2.0
			FROMFROM = {
				is_conquered = yes
				NOT = { conquest_culture = ROOT }
			}
			FROM = { supported_claimant = { culture = ROOT } }
			OR = {
				trait = diligent
				trait = just
				trait = wroth
			}
		}
		modifier = {
			factor = 3.0
			trait = lunatic
		}
		modifier = {
			factor = 2.0
			FROM = {
				supported_claimant = {
					OR = {
						character = ROOT
						is_close_relative = ROOT
						is_married = ROOT
						is_friend = ROOT
						is_lover = ROOT
					}
				}
			}
			ai_ambition = 20
		}
		modifier = {
			factor = 2.0
			FROM = {
				supported_claimant = {
					OR = {
						character = ROOT
						is_close_relative = ROOT
						is_married = ROOT
						is_friend = ROOT
						is_lover = ROOT
					}
				}
			}
			ai_ambition = 40
		}
		modifier = {
			factor = 2
			OR = {
				has_opinion_modifier = { who = LIEGE modifier = opinion_evil_tyrant }
				has_opinion_modifier = { who = LIEGE modifier = opinion_tyrant }
			}
		}
		# less likely to support a claimant who is adopted
		modifier = {
			factor = 0.7
			FROM = { supported_claimant = { trait = adopted } }
		}
	}

	success = {
		always = no
	}

	abort = {
		always = no		# Factions will abort if the Potential or Allow triggers are no longer valid
	}

	abort_effect = {
	}

	effect = {
	}
}

# Antiking Faction
faction_antiking = {
	type = liege_titles

	warning_level = 0.7 # At this level of faction power we give player an alert. Set to 0 for no alerts.

	rel_head_loyalist = yes # Members consider the "real" pope to be the rightful religious head
	cancel_on_leader_death = yes # The faction will not automatically continue under a new leader

	# Plotter scope
	potential = {
		emf_faction_basic_potential = yes
		OR = {
			religion = catholic
			religion = fraticelli
		}
		primary_title = { higher_tier_than = COUNT }
		liege = {
			religion = ROOT
			OR = {
				is_feudal = yes
				is_tribal = yes
			}
			rightful_religious_head_scope = {
				OR = {
					has_claim = k_papal_state
					has_claim = d_fraticelli
				}
			}
		}
		NOT = { has_character_modifier = faction_antiking_ultimatum_timer }
	}

	# Target scope
	allow = {
		higher_tier_than = DUKE
		is_primary_holder_title = yes

		holder_scope = {
			independent = yes
			NOT = {
				any_war = {
					war_title = ROOT
					using_cb = cb_install_antiking
				}
			}

			NOT = {
				reverse_has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_leaving_faction
				}
			}
		}

		OR = {
			culture = FROM
			holder_scope = {
				culture = FROM
			}
		}
	}

	# If false, shows the faction entry for players, but disabled
	player_allow = {
		FROM = {
			piety = 500
		}
	}

	# Faction member scope (ROOT = joiner, FROM = target)
	allow_join = {
		ROOT = {
			emf_faction_basic_allow_join = yes
		}
	}

	# AI creation weight
	chance = {
		factor = 1

		modifier = {
			factor = 0
			FROM = { emf_faction_has_special_chance_blocker = yes }
		}

		modifier = {
			factor = 0.5
			holder_scope = {  
				any_owned_bloodline = {
					has_bloodline_flag = bloodline_less_factions
					bloodline_is_active_for = PREV
				}
			}
		}

		modifier = {
			factor = 0.2
			FROM = { emf_pacifist_true_religion = yes }
		}
		
		modifier = {
			factor = 2
			FROM = { emf_warlike_true_religion = yes }
		}

		modifier = {
			factor = 0
			FROM = {
				OR = {
					prisoner = yes
					has_character_modifier = in_seclusion
				}
			}
		}

		modifier = {
			factor = 0
			holder_scope = {
				is_married = FROM
			}
		}

		modifier = {
			factor = 0
			current_heir = {
				character = FROM
			}
		}

		modifier = {
			factor = 0
			FROM = {
				opinion = { who = LIEGE value = 25 }
				NOT = {
					trait = deceitful
					ai_ambition = 40
					trait = envious
				}
			}
		}

		modifier = {
			factor = 0
			FROM = {
				opinion = { who = LIEGE value = 50 }
				OR = {
					trait = deceitful
					ai_ambition = 40
					trait = envious
				}
			}
		}

		modifier = {
			factor = 1.5
			NOT = { FROM = { opinion = { who = LIEGE value = -10 } } }
		}
		modifier = {
			factor = 2.0
			NOT = { FROM = { opinion = { who = LIEGE value = -50 } } }
		}
		modifier = {
			factor = 4.0
			NOT = { FROM = { opinion = { who = LIEGE value = -75 } } }
		}

		modifier = {
			factor = 0.25
			NOT = { claimed_by = FROM }
		}

		modifier = {
			factor = 0.1
			NOT = { FROM = { ai_ambition = -39 } }
		}
		modifier = {
			factor = 0.1
			NOT = { FROM = { ai_ambition = -19 } }
		}
		modifier = {
			factor = 0.01
			FROM = { trait = imbecile }
		}
		modifier = {
			factor = 0.1
			FROM = { trait = inbred }
		}
		modifier = {
			factor = 0.1
			FROM = { trait = craven }
		}
		modifier = {
			factor = 0.2
			FROM = {
				OR = {
					trait = slow
					trait = dull
				}
			}
		}
		modifier = {
			factor = 0.5
			FROM = { trait = kind }
		}
		modifier = {
			factor = 0.5
			FROM = { trait = charitable }
		}
		modifier = {
			factor = 0.5
			FROM = { trait = honest }
		}
		modifier = {
			factor = 0.75
			FROM = { trait = humble }
		}
		modifier = {
			factor = 0.75
			FROM = { trait = just }
		}
		modifier = {
			factor = 1.5
			FROM = { trait = proud }
		}
		modifier = {
			factor = 1.5
			FROM = { trait = brave }
		}
		modifier = {
			factor = 1.5
			FROM = { trait = arbitrary }
		}
		modifier = {
			factor = 2.0
			FROM = { trait = envious }
		}
		modifier = {
			factor = 2.0
			FROM = { trait = greedy }
		}
		modifier = {
			factor = 2.0
			FROM = { trait = impaler }
		}
		modifier = {
			factor = 2.0
			FROM = { trait = deceitful }
		}
		modifier = {
			factor = 2.0
			FROM = { ai_ambition = 20 }
		}
		modifier = {
			factor = 2.0
			FROM = { ai_ambition = 40 }
		}
	}

	# AI membership weight: ROOT is the prospective member. FROM is the faction leader. FROMFROM is the target title or character.
	membership = {
		factor = 1

		modifier = {
			factor = 0.5
			FROMFROM = {  
				holder_scope = { 
					any_owned_bloodline = {
						has_bloodline_flag = bloodline_less_factions
						bloodline_is_active_for = PREV
					}
				}
			}
		}
		modifier = {
			factor = 0
			emf_faction_has_special_chance_blocker = yes
		}
		modifier = {
			factor = 0
			OR = {
				prisoner = yes
				has_character_modifier = in_seclusion
				is_incapable = yes
				is_adult = no
				is_landed = no
				preparing_invasion = yes
				NOT = { religion = FROM }
			}
		}

		modifier = {
			factor = 0
			FROMFROM = {
				current_heir = {
					character = ROOT
				}
			}
			NOT = {
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}

		modifier = {
			factor = 0
			has_character_modifier = faction_antiking_ultimatum_timer
		}

		modifier = {
			factor = 0
			NOT = { opinion = { who = FROM value = -40 } }
			NOT = {
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}

		modifier = {
			factor = 0
			has_opinion_modifier = {
				who = LIEGE
				modifier = opinion_coerced_into_leaving_faction
			}
		}

		modifier = {
			factor = 0
			opinion = { who = LIEGE value = 25 }
			NOT = {
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}

		modifier = {
			factor = 1000
			has_opinion_modifier = {
				who = FROM
				modifier = opinion_coerced_into_joining_faction
			}
		}

		modifier = {
			factor = 0.2
			emf_pacifist_true_religion = yes
			NOT = {
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		
		modifier = {
			factor = 2
			emf_warlike_true_religion = yes
		}

		modifier = {
			factor = 1.5
			NOT = { opinion = { who = LIEGE value = -10 } }
		}
		modifier = {
			factor = 2.0
			NOT = { opinion = { who = LIEGE value = -50 } }
		}
		modifier = {
			factor = 4.0
			NOT = { opinion = { who = LIEGE value = -75 } }
		}

		modifier = {
			factor = 0.1
			NOT = { ai_ambition = -39 }
			NOT = {
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		modifier = {
			factor = 0.1
			NOT = { ai_ambition = -19 }
			NOT = {
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		modifier = {
			factor = 0.01
			trait = imbecile
			NOT = {
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		modifier = {
			factor = 0.1
			trait = inbred
			NOT = {
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		modifier = {
			factor = 0.1
			trait = craven
			NOT = {
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		modifier = {
			factor = 0.2
			OR = {
				trait = slow
				trait = dull
			}
			NOT = {
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		modifier = {
			factor = 0.5
			trait = kind
		}
		modifier = {
			factor = 0.5
			trait = charitable
		}
		modifier = {
			factor = 0.5
			trait = honest
		}
		modifier = {
			factor = 0.75
			trait = humble
		}
		modifier = {
			factor = 0.75
			trait = just
		}
		modifier = {
			factor = 1.5
			trait = proud
		}
		modifier = {
			factor = 1.5
			trait = brave
		}
		modifier = {
			factor = 1.5
			trait = arbitrary
		}
		modifier = {
			factor = 2.0
			trait = envious
		}
		modifier = {
			factor = 2.0
			trait = greedy
		}
		modifier = {
			factor = 2.0
			trait = impaler
		}
		modifier = {
			factor = 2.0
			trait = deceitful
		}
		modifier = {
			factor = 2.0
			ai_ambition = 20
		}
		modifier = {
			factor = 2.0
			ai_ambition = 40
		}
	}

	success = {
		always = no
	}

	abort = {
		always = no
	}

	abort_effect = {
	}

	effect = {
	}
}

# Overthrow a weak Khan faction
faction_overthrow = {

	type = liege_titles

	warning_level = 0.7 # At this level of faction power we give player an alert. Set to 0 for no alerts.

	cancel_on_leader_death = yes # The faction will not automatically continue under a new leader

	# Plotter scope
	potential = {
		is_nomadic = yes
		emf_faction_basic_potential = yes
	}

	# Target scope
	allow = {
		is_nomadic = yes
		is_primary_holder_title = yes

		holder_scope = {
			independent = yes

			NOT = {
				OR = {
					reverse_has_opinion_modifier = {
						who = FROM
						modifier = opinion_coerced_into_leaving_faction
					}
					blood_brother = {
						holder_scope = {
							character = FROM
						}
					}
				}
			}
		}
	}

	# If false, shows the faction entry for players, but disabled
	player_allow = {
		is_nomadic = yes
	}

	# Faction member scope (ROOT = joiner, FROM = target)
	allow_join = {
		ROOT = {
			emf_faction_basic_allow_join = yes
		}
	}

	# AI creation weight (ROOT = title, FROM = faction creator)
	chance = {
		factor = 1

		modifier = {
			factor = 0.5
			holder_scope = {  
				any_owned_bloodline = {
					has_bloodline_flag = bloodline_less_factions
					bloodline_is_active_for = PREV
				}
			}
		}
		modifier = {
			factor = 0
			FROM = { emf_faction_has_special_chance_blocker = yes }
		}
		modifier = {
			factor = 0.2
			FROM = { emf_pacifist_true_religion = yes }
		}
		modifier = {
			factor = 2
			FROM = { emf_warlike_true_religion = yes }
		}
		modifier = {
			factor = 0
			FROM = {
				OR = {
					prisoner = yes
					has_character_modifier = in_seclusion
				}
			}
		}
		modifier = {
			factor = 0
			holder_scope = { is_married = FROM }
		}
		modifier = {
			factor = 0
			current_heir = { character = FROM }
		}

		# Opinions
		modifier = {
			factor = 0
			FROM = { opinion = { who = LIEGE value = 50 } }
		}
		modifier = {
			factor = 0.25
			FROM = {
				opinion = { who = LIEGE value = 10 }
				NOR = {
					trait = deceitful
					ai_ambition = 40
					trait = envious
				}
			}
		}
		modifier = {
			factor = 0.05
			FROM = {
				opinion = { who = LIEGE value = 25 }
				NOR = {
					trait = deceitful
					ai_ambition = 40
					trait = envious
				}
			}
		}
		modifier = {
			factor = 1.5
			NOT = { FROM = { opinion = { who = LIEGE value = -10 } } }
		}
		modifier = {
			factor = 2.0
			NOT = { FROM = { opinion = { who = LIEGE value = -50 } } }
		}
		modifier = {
			factor = 4.0
			NOT = { FROM = { opinion = { who = LIEGE value = -75 } } }
		}

		# Clan Opinions
		modifier = {
			factor = 1.5
			holder_scope = {
				clan_title = {
					FROM = {
						clan_title = {
							NOT = { clan_opinion = { who = PREVPREV value = -10 } }
						}
					}
				}
			}
		}
		modifier = {
			factor = 2.0
			holder_scope = {
				clan_title = {
					FROM = {
						clan_title = {
							NOT = { clan_opinion = { who = PREVPREV value = -50 } }
						}
					}
				}
			}
		}
		modifier = {
			factor = 4.0
			holder_scope = {
				clan_title = {
					FROM = {
						clan_title = {
							NOT = { clan_opinion = { who = PREVPREV value = -75 } }
						}
					}
				}
			}
		}
		modifier = {
			factor = 0.25
			holder_scope = {
				clan_title = {
					FROM = {
						clan_title = {
							clan_opinion = { who = PREVPREV value = 10 }
						}
					}
				}
			}
		}
		modifier = {
			factor = 0.05
			holder_scope = {
				clan_title = {
					FROM = {
						clan_title = {
							clan_opinion = { who = PREVPREV value = 25 }
						}
					}
				}
			}
		}
		modifier = {
			factor = 0
			holder_scope = {
				clan_title = {
					FROM = {
						clan_title = {
							clan_opinion = { who = PREVPREV value = 50 }
						}
					}
				}
			}
		}

		# Liege traits
		modifier = {
			factor = 1.5
			FROM = {
				liege = { NOT = { ai_ambition = -39 } }
			}
		}
		modifier = {
			factor = 0.75
			FROM = {
				liege = { ai_ambition = 40 }
			}
		}
		modifier = {
			factor = 1.5
			FROM = {
				liege = { trait = imbecile }
			}
		}
		modifier = {
			factor = 0.75
			FROM = {
				liege = { trait = quick }
			}
		}
		modifier = {
			factor = 0.5
			FROM = {
				liege = { trait = genius }
			}
		}
		modifier = {
			factor = 1.5
			FROM = {
				liege = { trait = inbred }
			}
		}
		modifier = {
			factor = 1.5
			FROM = {
				liege = {
					OR = {
						trait = slow
						trait = dull
					}
				}
			}
		}
		modifier = {
			factor = 1.5
			FROM = {
				liege = { trait = kind }
			}
		}
		modifier = {
			factor = 0.75
			FROM = {
				liege = { trait = cruel }
			}
		}
		modifier = {
			factor = 0.75
			FROM = {
				liege = { trait = impaler }
			}
		}
		modifier = {
			factor = 1.5
			FROM = {
				liege = { trait = humble }
			}
		}
		modifier = {
			factor = 0.75
			FROM = {
				liege = { trait = proud }
			}
		}
		modifier = {
			factor = 2
			FROM = {
				liege = { trait = craven }
			}
		}
		modifier = {
			factor = 0.75
			FROM = {
				liege = { trait = brave }
			}
		}
		modifier = {
			factor = 3
			FROM = {
				liege = { trait = weak }
			}
		}
		modifier = {
			factor = 0.01
			FROM = {
				liege = { trait = strong }
			}
		}
		modifier = {
			factor = 1.5
			FROM = {
				liege = {
					NOT = { health = 5 }
				}
			}
		}
		modifier = {
			factor = 2
			FROM = {
				liege = {
					NOT = { health = 3 }
				}
			}
		}

		# Leader traits
		modifier = {
			factor = 0.1
			NOT = { FROM = { ai_ambition = -39 } }
		}
		modifier = {
			factor = 0.1
			NOT = { FROM = { ai_ambition = -19 } }
		}
		modifier = {
			factor = 0.01
			FROM = { trait = imbecile }
		}
		modifier = {
			factor = 0.1
			FROM = { trait = inbred }
		}
		modifier = {
			factor = 0.1
			FROM = { trait = craven }
		}
		modifier = {
			factor = 0.2
			FROM = {
				OR = {
					trait = slow
					trait = dull
				}
			}
		}
		modifier = {
			factor = 0.5
			FROM = { trait = kind }
		}
		modifier = {
			factor = 0.5
			FROM = { trait = charitable }
		}
		modifier = {
			factor = 0.5
			FROM = { trait = honest }
		}
		modifier = {
			factor = 0.75
			FROM = { trait = humble }
		}
		modifier = {
			factor = 0.75
			FROM = { trait = just }
		}
		modifier = {
			factor = 1.5
			FROM = { trait = proud }
		}
		modifier = {
			factor = 1.5
			FROM = { trait = brave }
		}
		modifier = {
			factor = 1.5
			FROM = { trait = arbitrary }
		}
		modifier = {
			factor = 2.0
			FROM = { trait = envious }
		}
		modifier = {
			factor = 2.0
			FROM = { trait = greedy }
		}
		modifier = {
			factor = 2.0
			FROM = { trait = impaler }
		}
		modifier = {
			factor = 2.0
			FROM = { trait = deceitful }
		}
		modifier = {
			factor = 2.0
			FROM = { ai_ambition = 20 }
		}
		modifier = {
			factor = 2.0
			FROM = { ai_ambition = 40 }
		}
	}

	# AI membership weight: ROOT is the prospective member. FROM is the faction leader. FROMFROM is the target title or character.
	membership = {
		factor = 1

		modifier = {
			factor = 0.5
			FROMFROM = {  
				holder_scope = { 
					any_owned_bloodline = {
						has_bloodline_flag = bloodline_less_factions
						bloodline_is_active_for = PREV
					}
				}
			}
		}
		modifier = {
			factor = 0
			emf_faction_has_special_chance_blocker = yes
		}
		modifier = {
			factor = 0
			OR = {
				prisoner = yes
				has_character_modifier = in_seclusion
				is_incapable = yes
				is_adult = no
				is_landed = no
				preparing_invasion = yes
			}
		}
		modifier = {
			factor = 0.2
			emf_pacifist_true_religion = yes
			NOT = {
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		modifier = {
			factor = 2
			emf_warlike_true_religion = yes
		}
		modifier = {
			factor = 0
			FROMFROM = {
				current_heir = {
					character = ROOT
				}
			}
			NOT = {
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		modifier = {
			factor = 0
			NOT = { opinion = { who = FROM value = -40 } }
			NOT = {
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		modifier = {
			factor = 0
			has_opinion_modifier = {
				who = LIEGE
				modifier = opinion_coerced_into_leaving_faction
			}
		}

		# Opinions
		modifier = {
			factor = 0
			opinion = { who = LIEGE value = 50 }
		}
		modifier = {
			factor = 0.25
			opinion = { who = LIEGE value = 10 }
			NOR = {
				trait = deceitful
				ai_ambition = 40
				trait = envious
			}
		}
		modifier = {
			factor = 0.05
			opinion = { who = LIEGE value = 25 }
			NOR = {
				trait = deceitful
				ai_ambition = 40
				trait = envious
			}
		}
		modifier = {
			factor = 1.5
			NOT = { opinion = { who = LIEGE value = -10 } }
		}
		modifier = {
			factor = 2.0
			NOT = { opinion = { who = LIEGE value = -50 } }
		}
		modifier = {
			factor = 4.0
			NOT = { opinion = { who = LIEGE value = -75 } }
		}

		# Clan Opinions
		modifier = {
			factor = 1.5
			liege = {
				clan_title = {
					ROOT = {
						clan_title = {
							NOT = { clan_opinion = { who = PREVPREV value = -10 } }
						}
					}
				}
			}
		}
		modifier = {
			factor = 2.0
			liege = {
				clan_title = {
					ROOT = {
						clan_title = {
							NOT = { clan_opinion = { who = PREVPREV value = -50 } }
						}
					}
				}
			}
		}
		modifier = {
			factor = 4.0
			liege = {
				clan_title = {
					ROOT = {
						clan_title = {
							NOT = { clan_opinion = { who = PREVPREV value = -75 } }
						}
					}
				}
			}
		}
		modifier = {
			factor = 0.5
			liege = {
				clan_title = {
					ROOT = {
						clan_title = {
							clan_opinion = { who = PREVPREV value = 10 }
						}
					}
				}
			}
			NOT = {
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		modifier = {
			factor = 0.1
			liege = {
				clan_title = {
					ROOT = {
						clan_title = {
							clan_opinion = { who = PREVPREV value = 25 }
						}
					}
				}
			}
			NOT = {
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		modifier = {
			factor = 0
			liege = {
				clan_title = {
					ROOT = {
						clan_title = {
							clan_opinion = { who = PREVPREV value = 75 }
						}
					}
				}
			}
			NOT = {
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}

		# Liege traits
		modifier = {
			factor = 1.5
			liege = { NOT = { ai_ambition = -39 } }
		}
		modifier = {
			factor = 0.75
			liege = { ai_ambition = 40 }
		}
		modifier = {
			factor = 1.5
			liege = { trait = imbecile }
		}
		modifier = {
			factor = 0.75
			liege = { trait = quick }
		}
		modifier = {
			factor = 0.5
			liege = { trait = genius }
		}
		modifier = {
			factor = 1.5
			liege = { trait = inbred }
		}
		modifier = {
			factor = 1.5
			liege = {
				OR = {
					trait = slow
					trait = dull
				}
			}
		}
		modifier = {
			factor = 1.5
			liege = { trait = kind }
		}
		modifier = {
			factor = 0.75
			liege = { trait = cruel }
		}
		modifier = {
			factor = 0.75
			liege = { trait = impaler }
		}
		modifier = {
			factor = 1.5
			liege = { trait = humble }
		}
		modifier = {
			factor = 0.75
			liege = { trait = proud }
		}
		modifier = {
			factor = 2
			liege = { trait = craven }
		}
		modifier = {
			factor = 0.5
			liege = { trait = brave }
		}
		modifier = {
			factor = 3
			liege = { trait = weak }
		}
		modifier = {
			factor = 0.01
			liege = { trait = strong }
			NOT = {
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		modifier = {
			factor = 1.5
			liege = {
				NOT = { health = 5 }
			}
		}
		modifier = {
			factor = 2
			liege = {
				NOT = { health = 3 }
			}
		}

		modifier = {
			factor = 1000
			has_opinion_modifier = {
				who = FROM
				modifier = opinion_coerced_into_joining_faction
			}
		}

		modifier = {
			factor = 0.1
			NOT = { ai_ambition = -39 }
			NOT = {
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		modifier = {
			factor = 0.1
			NOT = { ai_ambition = -19 }
			NOT = {
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		modifier = {
			factor = 0.01
			trait = imbecile
			NOT = {
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		modifier = {
			factor = 0.1
			trait = inbred
			NOT = {
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		modifier = {
			factor = 0.1
			trait = craven
			NOT = {
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		modifier = {
			factor = 0.2
			OR = {
				trait = slow
				trait = dull
			}
			NOT = {
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		modifier = {
			factor = 0.5
			trait = kind
		}
		modifier = {
			factor = 0.5
			trait = charitable
		}
		modifier = {
			factor = 0.5
			trait = honest
		}
		modifier = {
			factor = 0.75
			trait = humble
		}
		modifier = {
			factor = 0.75
			trait = just
		}
		modifier = {
			factor = 1.5
			trait = proud
		}
		modifier = {
			factor = 1.5
			trait = brave
		}
		modifier = {
			factor = 1.5
			trait = arbitrary
		}
		modifier = {
			factor = 2.0
			trait = envious
		}
		modifier = {
			factor = 2.0
			trait = greedy
		}
		modifier = {
			factor = 2.0
			trait = impaler
		}
		modifier = {
			factor = 2.0
			trait = deceitful
		}
		modifier = {
			factor = 2.0
			ai_ambition = 20
		}
		modifier = {
			factor = 2.0
			ai_ambition = 40
		}
	}

	success = {
		always = no
	}

	abort = {
		always = no
	}

	abort_effect = {
	}

	effect = {
	}
}

# Increase Council Power
faction_increase_council_power = {
	type = liege_titles

	warning_level = 0.7 # At this level of faction power we give player an alert. Set to 0 for no alerts.

	# Plotter scope
	potential = {
		has_dlc = "Zeus"
		emf_faction_basic_potential = yes
		liege = { is_nomadic = no }

		NOT = { has_character_modifier = faction_council_power_ultimatum_timer }
	}

	# Target scope
	allow = {
		OR = {
			higher_tier_than = BARON
			is_patrician = yes
		}
		is_primary_holder_title = yes
		holder_scope = {
			primary_title = {
				ROOT = {
					tier = PREV
				}
			}
			NOT = {
				any_vassal = {
					OR = {
						higher_tier_than = BARON
						is_patrician = yes
					}
					NOT = { character = FROM }
					num_of_faction_backers = {
						faction = faction_increase_council_power
						value = 0
					}
				}
			}
		}
		holder_scope = {
			primary_title = {
				NOT = { emf_laws_has_full_council_power = yes }
			}
			NOT = {
				any_war = {
					war_title = ROOT
					using_cb = increase_council_power_war
				}
			}

			NOT = {
				reverse_has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_leaving_faction
				}
			}
		}
	}

	# Faction member scope (ROOT = joiner, FROM = target)
	allow_join = {
		ROOT = {
			emf_faction_basic_allow_join = yes
		}
	}

	# AI creation weight
	chance = {
		factor = 1

		modifier = {
			factor = 0.5
			holder_scope = {
				any_owned_bloodline = {
					has_bloodline_flag = bloodline_less_factions
					bloodline_is_active_for = PREV
				}
			}
		}
		modifier = {
			factor = 0
			FROM = { emf_faction_has_special_chance_blocker = yes }
		}
		modifier = {
			factor = 0
			# Only formed by actual councillors
			# Or friends/close relatives of councillors
			FROM = {
				NOR = {
					emf_is_voter = yes
					liege = {
						any_voter = {
							OR = {
								is_friend = PREVPREV
								is_child_of = PREVPREV
								is_mother = PREVPREV
								is_father = PREVPREV
								sibling = PREVPREV
								is_married = PREVPREV
								is_lover = PREVPREV
							}
						}
					}
				}
			}
		}

		modifier = {
			factor = 0.8
			has_law = law_voting_power_1
		}
		modifier = {
			factor = 0.8
			has_law = war_voting_power_1
		}
		modifier = {
			factor = 0.8
			has_law = titles_voting_power_1
		}
		modifier = {
			factor = 0.8
			has_law = justice_voting_power_1
		}

		modifier = {
			factor = 0.2
			FROM = { emf_pacifist_true_religion = yes }
		}
		
		modifier = {
			factor = 2
			FROM = { emf_warlike_true_religion = yes }
		}

		modifier = {
			factor = 0
			FROM = {
				OR = {
					prisoner = yes
					has_character_modifier = in_seclusion
				}
			}
		}

		modifier = {
			factor = 0
			holder_scope = {
				is_married = FROM
			}
		}

		modifier = {
			factor = 0
			current_heir = {
				character = FROM
			}
		}

		# Try to exclude people who should rather support a claimant
		modifier = {
			factor = 0
			holder_scope = {
				OR = {
					NOT = { culture = FROM }
					NOR = {
						religion = { target = FROM target_type = true }
						AND = {
							has_secret_religion = yes
							ROOT_FROM = {
								can_see_secret_religion = PREV
								true_religion = { target = PREV target_type = secret }
							}
						}
					}
				}
				any_demesne_title = {
					OR = {
						is_primary_holder_title = yes
						higher_tier_than = DUKE
					}
					FROM = {
						primary_title = {
							de_jure_liege_or_above = PREVPREV
						}
					}
					any_claimant = {
						culture = FROM
						OR = {
							religion = { target = FROM target_type = true }
							AND = {
								has_secret_religion = yes
								ROOT_FROM = {
									can_see_secret_religion = PREV
									true_religion = { target = PREV target_type = secret }
								}
							}
						}
					}
				}
			}
		}

		modifier = {
			factor = 0
			FROM = { preparing_invasion = yes }
		}

		modifier = {
			factor = 0.5
			FROM = {
				opinion = { who = LIEGE value = 0 }
				NOR = {
					trait = deceitful
					ai_ambition = 40
					trait = envious
				}
			}
		}

		modifier = {
			factor = 0
			FROM = {
				opinion = { who = LIEGE value = 25 }
			}
		}

		modifier = {
			factor = 0.5
			FROM = { emf_is_voter = no }
		}

		modifier = {
			factor = 5
			FROM = {
				emf_is_voter = yes
				has_position = malcontent
			}
		}

		modifier = {
			factor = 2
			FROM = {
				emf_is_voter = yes
				NOR = {
					has_position = loyalist
					has_position = malcontent
				}
			}
		}

		modifier = {
			factor = 1.5
			NOT = { FROM = { opinion = { who = LIEGE value = -10 } } }
		}
		modifier = {
			factor = 2.0
			NOT = { FROM = { opinion = { who = LIEGE value = -50 } } }
		}
		modifier = {
			factor = 4.0
			NOT = { FROM = { opinion = { who = LIEGE value = -75 } } }
		}

		modifier = {
			factor = 0.1
			FROM = { NOT = { ai_ambition = -39 } }
		}
		modifier = {
			factor = 0.1
			FROM = { NOT = { ai_ambition = -19 } }
		}
		modifier = {
			factor = 0.01
			FROM = { trait = imbecile }
		}
		modifier = {
			factor = 0.1
			FROM = { trait = inbred }
		}
		modifier = {
			factor = 0.1
			FROM = { trait = craven }
		}
		modifier = {
			factor = 0.2
			FROM = {
				OR = {
					trait = slow
					trait = dull
				}
			}
		}
		modifier = {
			factor = 0.5
			FROM = { trait = kind }
		}
		modifier = {
			factor = 0.5
			FROM = { trait = charitable }
		}
		modifier = {
			factor = 0.5
			FROM = { trait = honest }
		}
		modifier = {
			factor = 0.75
			FROM = { trait = humble }
		}
		modifier = {
			factor = 0.75
			FROM = { trait = just }
		}
		modifier = {
			factor = 1.5
			FROM = { trait = proud }
		}
		modifier = {
			factor = 1.5
			FROM = { trait = brave }
		}
		modifier = {
			factor = 1.5
			FROM = { trait = arbitrary }
		}
		modifier = {
			factor = 2.0
			FROM = { trait = envious }
		}
		modifier = {
			factor = 2.0
			FROM = { trait = greedy }
		}
		modifier = {
			factor = 2.0
			FROM = { trait = impaler }
		}
		modifier = {
			factor = 2.0
			FROM = { trait = deceitful }
		}
		modifier = {
			factor = 2.0
			FROM = { ai_ambition = 20 }
		}
		modifier = {
			factor = 2.0
			FROM = { ai_ambition = 40 }
		}
	}

	# AI membership weight: ROOT is the prospective member. FROM is the faction leader. FROMFROM is the target title or character.
	membership = {
		factor = 1

		modifier = {
			factor = 0.5
			FROMFROM = {  
				holder_scope = { 
					any_owned_bloodline = {
						has_bloodline_flag = bloodline_less_factions
						bloodline_is_active_for = PREV
					}
				}
			}
		}
		modifier = {
			factor = 0
			emf_faction_has_special_chance_blocker = yes
		}
		modifier = {
			factor = 0
			OR = {
				prisoner = yes
				has_character_modifier = in_seclusion
				is_incapable = yes
				is_adult = no
				is_landed = no
				preparing_invasion = yes
			}
		}

		modifier = {
			factor = 0
			FROMFROM = {
				current_heir = {
					character = ROOT
				}
			}
			NOT = {
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}

		modifier = {
			factor = 0
			has_character_modifier = faction_council_power_ultimatum_timer
		}

		modifier = {
			factor = 0
			NOT = { opinion = { who = FROM value = -40 } }
			NOT = {
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}

		modifier = {
			factor = 0.8
			FROMFROM = { has_law = law_voting_power_1 }
		}
		modifier = {
			factor = 0.8
			FROMFROM = { has_law = war_voting_power_1 }
		}
		modifier = {
			factor = 0.8
			FROMFROM = { has_law = titles_voting_power_1 }
		}
		modifier = {
			factor = 0.8
			FROMFROM = { has_law = justice_voting_power_1 }
		}

		modifier = {
			factor = 0
			FROMFROM = {
				holder_scope = {
					NOT = { year = 1350 }
					has_horde_culture = yes
					culture = ROOT
					OR = {
						religion = { target = ROOT target_type = true }
						AND = {
							has_secret_religion = yes
							ROOT = {
								can_see_secret_religion = PREV
								true_religion = { target = PREV target_type = secret }
							}
						}
					}
				}
			}
			NOT = {
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}

		modifier = {
			factor = 0
			has_opinion_modifier = {
				who = LIEGE
				modifier = opinion_coerced_into_leaving_faction
			}
		}

		modifier = {
			factor = 0.5
			opinion = { who = LIEGE value = 0 }
		}

		modifier = {
			factor = 0
			opinion = { who = LIEGE value = 25 }
			NOT = {
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}

		modifier = {
			factor = 0.2
			emf_pacifist_true_religion = yes
			NOT = {
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		
		modifier = {
			factor = 2
			emf_warlike_true_religion = yes
		}

		modifier = {
			factor = 5
			FROM = {
				emf_is_voter = yes
				has_position = malcontent
			}
		}

		modifier = {
			factor = 2
			FROM = {
				emf_is_voter = yes
				NOR = {
					has_position = loyalist
					has_position = malcontent
				}
			}
		}

		modifier = {
			factor = 1000
			has_opinion_modifier = {
				who = FROM
				modifier = opinion_coerced_into_joining_faction
			}
		}

		modifier = {
			factor = 1.5
			NOT = { opinion = { who = LIEGE value = -10 } }
		}
		modifier = {
			factor = 2.0
			NOT = { opinion = { who = LIEGE value = -50 } }
		}
		modifier = {
			factor = 4.0
			NOT = { opinion = { who = LIEGE value = -75 } }
		}

		modifier = {
			factor = 0.1
			NOT = { ai_ambition = -39 }
			NOT = {
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		modifier = {
			factor = 0.1
			NOT = { ai_ambition = -19 }
			NOT = {
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		modifier = {
			factor = 0.01
			trait = imbecile
			NOT = {
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		modifier = {
			factor = 0.1
			trait = inbred
			NOT = {
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		modifier = {
			factor = 0.1
			trait = craven
			NOT = {
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		modifier = {
			factor = 0.2
			OR = {
				trait = slow
				trait = dull
			}
			NOT = {
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		modifier = {
			factor = 0.5
			trait = kind
		}
		modifier = {
			factor = 0.5
			trait = charitable
		}
		modifier = {
			factor = 0.5
			trait = honest
		}
		modifier = {
			factor = 0.75
			trait = humble
		}
		modifier = {
			factor = 0.75
			trait = just
		}
		modifier = {
			factor = 1.5
			trait = proud
		}
		modifier = {
			factor = 1.5
			trait = brave
		}
		modifier = {
			factor = 1.5
			trait = arbitrary
		}
		modifier = {
			factor = 2.0
			trait = envious
		}
		modifier = {
			factor = 2.0
			trait = greedy
		}
		modifier = {
			factor = 2.0
			trait = impaler
		}
		modifier = {
			factor = 2.0
			trait = deceitful
		}
		modifier = {
			factor = 2.0
			ai_ambition = 20
		}
		modifier = {
			factor = 2.0
			ai_ambition = 40
		}
	}

	success = {
		holder_scope = {
			FROM = {
				has_opinion_modifier = { who = PREV modifier = opinion_increased_council_power }
			}
		}
	}

	abort = {
	}

	abort_effect = {
	}

	effect = {
		FROM = {
			any_faction_backer = {
				faction = faction_increase_council_power
				reverse_opinion = {
					modifier = opinion_grateful
					who = FROM
					years = 5
				}
			}
		}
	}
}

# Powerful vassals overthrow their liege
faction_powerful_vassal_takeover = {
	type = liege_titles

	warning_level = 0.7 # At this level of faction power we give player an alert. Set to 0 for no alerts.

	# Plotter scope
	potential = {
		always = no
	}

	# Target scope
	allow = {
		always = no
	}

	# Faction member scope (ROOT = joiner, FROM = target)
	allow_join = {
		always = no
	}

	# AI creation weight
	chance = {
		factor = 0
	}

	# AI membership weight: ROOT is the prospective member. FROM is the faction leader. FROMFROM is the target title or character.
	membership = {
		factor = 0
	}

	success = {
		always = no
	}

	abort = {
	}

	abort_effect = {
	}

	effect = {
	}
}

faction_true_belivers = {
	type = character
	
	warning_level = 0.7 # At this level of faction power we give player an alert. Set to 0 for no alerts.
	
	# Plotter scope
	potential = {
		emf_faction_basic_vassal_requirements = yes
		OR = {
			primary_title = { is_primary_type_title = no higher_tier_than = BARON }
			is_patrician = yes
		}
		# NOTE FROM ZIJI: WTF is up with this factioon? looks like its rough draft wasn't even finished. can't use standard
		# EMF faction triggers here, because they impose far more protections & requirements than are coded here, and I don't
		# know how this is used; it appears to be a script-invoked faction.
		has_character_flag = ai_flag_refuse_conversion
		emf_unreformed_pagan = yes
		liege = { 
			NOT = { religion = PREV	}			
		}
		has_character_flag = flag_truebelievers_revolter

		#NOT = { has_character_modifier = faction_lower_TO_ultimatum_timer }
	}
	
	# Target scope
	allow = {
		prisoner = no
	}
	
	# Faction member scope (ROOT = joiner, FROM = target)
	allow_join = {
		ROOT = {
			is_ruler = yes
		#	independent = no
		#	is_landed = yes
		#	is_adult = yes
		#	NOT = { trait = incapable }
		#	prisoner = no
			emf_unreformed_pagan = yes
		}
	}
	
	# AI creation weight
	chance = {
		factor = 1
		modifier = {
			factor = 1000
			FROM = { has_character_flag = ai_flag_refuse_conversion }
		}
		
		modifier = {
			factor = 0
			FROM = { NOT = { has_character_flag = ai_flag_refuse_conversion } }
		}
	}
	
	# AI membership weight: ROOT is the prospective member. FROM is the faction leader. FROMFROM is the target title or character.
	membership = {
		factor = 1

		modifier = {
			factor = 1000
			has_character_flag = ai_flag_refuse_conversion
		}
		modifier = {
			factor = 0
			NOT = { religion = FROM }
		}
		modifier = {
			factor = 0
			NOT = { has_character_flag = ai_flag_refuse_conversion }
		}
	}
	
	success = {
		independent = yes
	}
	
	abort = {
		always = no
	}
	
	abort_effect = {
	}
	
	effect = {
		FROM = {
			any_faction_backer = {
				faction = faction_true_belivers
				reverse_opinion = {
					modifier = opinion_grateful
					who = FROM
					years = 5
				}
			}
		}
	}
}

faction_abrahamic_revolters = {
	type = character
	
	warning_level = 0.9 # At this level of faction power we give player an alert. Set to 0 for no alerts.
	
	# Plotter scope
	potential = {
		emf_faction_basic_vassal_requirements = yes
		# NOTE FROM ZIJI: WTF is up with this factioon? looks like its rough draft wasn't even finished. can't use standard
		# EMF faction triggers here, because they impose far more protections & requirements than are coded here, and I don't
		# know how this is used; it appears to be a script-invoked faction.
		has_character_flag = flag_abrahamic_revolter
		OR = { 
			religion_group = christian
			religion_group = muslim
			religion_group = jewish_group
		}
		liege = { 
			OR = {
				religion = hellenic_pagan
				religion = hellenic_pagan_reformed 
			}			
		}

		#NOT = { has_character_modifier = faction_lower_TO_ultimatum_timer }
	}
	
	# Target scope
	allow = {
		prisoner = no
	}
	
	# Faction member scope (ROOT = joiner, FROM = target)
	allow_join = {
		ROOT = {
			is_ruler = yes
		#	independent = no
		#	is_landed = yes
		#	is_adult = yes
		#	NOT = { trait = incapable }
		#	prisoner = no
			OR = { 
				religion_group = christian
				religion_group = muslim
				religion_group = jewish_group
			}
		}
	}
	
	# AI creation weight
	chance = {
		factor = 1
		modifier = {
			factor = 1000
			FROM = { has_character_flag = flag_abrahamic_revolter }
		}
		
		modifier = {
			factor = 0
			FROM = { NOT = { has_character_flag = flag_abrahamic_revolter } }
		}
	}
	
	# AI membership weight: ROOT is the prospective member. FROM is the faction leader. FROMFROM is the target title or character.
	membership = {
		factor = 1

	}
	
	success = {
		independent = yes
	}
	
	abort = {
		always = no
	}
	
	abort_effect = {
	}
	
	effect = {
		FROM = {
			any_faction_backer = {
				faction = faction_abrahamic_revolters
				reverse_opinion = {
					modifier = opinion_grateful
					who = FROM
					years = 5
				}
			}
		}
	}
}
