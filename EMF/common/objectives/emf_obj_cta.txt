##############################################################
# CTA: Combat Trait Advancement: Ambitions                   #
# zijistark <azrinon@gmail.com>                              #
##############################################################

# no combat trait -> poor_warrior
obj_cta_0 = {
	type = character
	
	allow = {
		or = {
			is_ruler = yes
			liege = { job_marshal = { character = ROOT } }
			has_minor_title = title_commander
		}
		nor = {
			age = 50
			trait = blinded
			and = {
				controls_religion = yes
				religion_group = christian
			}
		}
		emf_council_marshal_trigger = yes
		nor = {
			trait = poor_warrior
			trait = trained_warrior
			trait = skilled_warrior
			trait = master_warrior
		}
		not = { has_character_flag = cta_done }
	}
	chance = {
		factor = 50
		
		modifier = {
			factor = 0
			not = { martial = 8 }
		}
		modifier = {
			factor = 20
			or = {
				liege = { job_marshal = { character = ROOT } }
				has_minor_title = title_commander
			}
		}
		modifier = {
			factor = 0.75
			age = 40
		}
		modifier = {
			factor = 0.333
			age = 45
		}
		modifier = {
			factor = 2
			trait = diligent
		}
		modifier = {
			factor = 1.5
			trait = ambitious
			martial = 10
		}
		modifier = {
			factor = 2.5
			trait = brave
		}
		modifier = {
			factor = 2.5
			trait = crusader
		}
		modifier = {
			factor = 2.5
			trait = mujahid
		}
		modifier = {
			factor = 1.75
			trait = scarred # already has proven battle experience, likely candidate to be in future battles
		}
		modifier = {
			factor = 1.75
			trait = agile
		}
		modifier = {
			factor = 2
			trait = strong
		}
		modifier = {
			factor = 6
			trait = duelist
		}
		modifier = {
			factor = 1.5
			trait = hunter
		}
		modifier = {
			factor = 0.25
			trait = weak
		}
		modifier = {
			factor = 0.25
			trait = clubfooted
		}
		modifier = {
			factor = 0.75
			trait = content
		}
		modifier = {
			factor = 0.25
			trait = craven
		}
		modifier = {
			factor = 0.1
			trait = slothful
		}
		modifier = {
			factor = 4
			trait = brilliant_strategist
		}
		modifier = {
			factor = 3
			trait = skilled_tactician
		}
		modifier = {
			factor = 2
			trait = tough_soldier
		}
		modifier = {
			factor = 1.5
			martial = 12
		}
		modifier = {
			factor = 1.5
			martial = 15
		}
		modifier = {
			factor = 1.5
			martial = 18
		}
		modifier = {
			factor = 1.5
			martial = 21
		}
		modifier = {
			factor = 1.5
			martial = 24
		}
	}
	success = {
		or = { # CTA only advances 1 level, but external code or console might jump the trait higher
			trait = poor_warrior
			trait = trained_warrior
			trait = skilled_warrior
			trait = master_warrior
		}
	}
	abort = {
		or = {
			nor = {
				is_ruler = yes
				liege = { job_marshal = { character = ROOT } }
				has_minor_title = title_commander
			}
			age = 50
			trait = blinded
			and = {
				controls_religion = yes
				religion_group = christian
			}
			emf_council_marshal_trigger = no
		}
	}
	effect = {
		prestige = 25
	}
}


# poor_warrior -> trained_warrior
obj_cta_1 = {
	type = character
	
	allow = {
		or = {
			is_ruler = yes
			liege = { job_marshal = { character = ROOT } }
			has_minor_title = title_commander
		}
		nor = {
			age = 50
			trait = blinded
			and = {
				controls_religion = yes
				religion_group = christian
			}
		}
		emf_council_marshal_trigger = yes
		
		trait = poor_warrior
		nor = {
			trait = trained_warrior
			trait = skilled_warrior
			trait = master_warrior
		}
		
		not = { has_character_flag = cta_done }
	}
	chance = {
		factor = 50
		
		modifier = {
			factor = 0
			not = { martial = 8 }
		}
		modifier = {
			factor = 20
			or = {
				liege = { job_marshal = { character = ROOT } }
				has_minor_title = title_commander
			}
		}
		modifier = {
			factor = 0.75
			age = 40
		}
		modifier = {
			factor = 0.333
			age = 45
		}
		modifier = {
			factor = 2
			trait = diligent
		}
		modifier = {
			factor = 1.5
			trait = ambitious
			martial = 10
		}
		modifier = {
			factor = 2.5
			trait = brave
		}
		modifier = {
			factor = 2.5
			trait = crusader
		}
		modifier = {
			factor = 2.5
			trait = mujahid
		}
		modifier = {
			factor = 1.75
			trait = scarred # already has proven battle experience, likely candidate to be in future battles
		}
		modifier = {
			factor = 1.75
			trait = agile
		}
		modifier = {
			factor = 2
			trait = strong
		}
		modifier = {
			factor = 6
			trait = duelist
		}
		modifier = {
			factor = 1.5
			trait = hunter
		}
		modifier = {
			factor = 0.25
			trait = weak
		}
		modifier = {
			factor = 0.25
			trait = clubfooted
		}
		modifier = {
			factor = 0.75
			trait = content
		}
		modifier = {
			factor = 0.25
			trait = craven
		}
		modifier = {
			factor = 0.1
			trait = slothful
		}
		modifier = {
			factor = 4
			trait = brilliant_strategist
		}
		modifier = {
			factor = 3
			trait = skilled_tactician
		}
		modifier = {
			factor = 2
			trait = tough_soldier
		}
		modifier = {
			factor = 1.5
			martial = 12
		}
		modifier = {
			factor = 1.5
			martial = 15
		}
		modifier = {
			factor = 1.5
			martial = 18
		}
		modifier = {
			factor = 1.5
			martial = 21
		}
		modifier = {
			factor = 1.5
			martial = 24
		}
	}
	success = {
		or = {
			trait = trained_warrior
			trait = skilled_warrior
			trait = master_warrior
		}
	}
	abort = {
		or = {
			nor = {
				is_ruler = yes
				liege = { job_marshal = { character = ROOT } }
				has_minor_title = title_commander
			}
			age = 50
			trait = blinded
			and = {
				controls_religion = yes
				religion_group = christian
			}
			emf_council_marshal_trigger = no
			nor = { # external code might demote a character
				trait = poor_warrior
				trait = trained_warrior
				trait = skilled_warrior
				trait = master_warrior
			}
		}
	}
	effect = {
		prestige = 50
	}
}


# trained_warrior -> skilled_warrior
obj_cta_2 = {
	type = character
	
	allow = {
		or = {
			is_ruler = yes
			liege = { job_marshal = { character = ROOT } }
			has_minor_title = title_commander
		}
		nor = {
			age = 50
			trait = blinded
			and = {
				controls_religion = yes
				religion_group = christian
			}
		}
		emf_council_marshal_trigger = yes
		
		trait = trained_warrior
		nor = {
			trait = poor_warrior
			trait = skilled_warrior
			trait = master_warrior
		}
		
		not = { has_character_flag = cta_done }
	}
	chance = {
		factor = 50
		
		modifier = {
			factor = 0
			not = { martial = 8 }
		}
		modifier = {
			factor = 20
			or = {
				liege = { job_marshal = { character = ROOT } }
				has_minor_title = title_commander
			}
		}
		modifier = {
			factor = 0.75
			age = 40
		}
		modifier = {
			factor = 0.333
			age = 45
		}
		modifier = {
			factor = 2
			trait = diligent
		}
		modifier = {
			factor = 1.5
			trait = ambitious
			martial = 10
		}
		modifier = {
			factor = 2.5
			trait = brave
		}
		modifier = {
			factor = 2.5
			trait = crusader
		}
		modifier = {
			factor = 2.5
			trait = mujahid
		}
		modifier = {
			factor = 1.75
			trait = scarred # already has proven battle experience, likely candidate to be in future battles
		}
		modifier = {
			factor = 1.75
			trait = agile
		}
		modifier = {
			factor = 2
			trait = strong
		}
		modifier = {
			factor = 6
			trait = duelist
		}
		modifier = {
			factor = 1.5
			trait = hunter
		}
		modifier = {
			factor = 0.25
			trait = weak
		}
		modifier = {
			factor = 0.25
			trait = clubfooted
		}
		modifier = {
			factor = 0.75
			trait = content
		}
		modifier = {
			factor = 0.25
			trait = craven
		}
		modifier = {
			factor = 0.1
			trait = slothful
		}
		modifier = {
			factor = 4
			trait = brilliant_strategist
		}
		modifier = {
			factor = 3
			trait = skilled_tactician
		}
		modifier = {
			factor = 2
			trait = tough_soldier
		}
		modifier = {
			factor = 1.5
			martial = 12
		}
		modifier = {
			factor = 1.5
			martial = 15
		}
		modifier = {
			factor = 1.5
			martial = 18
		}
		modifier = {
			factor = 1.5
			martial = 21
		}
		modifier = {
			factor = 1.5
			martial = 24
		}
	}
	success = {
		or = {
			trait = skilled_warrior
			trait = master_warrior
		}
	}
	abort = {
		or = {
			nor = {
				is_ruler = yes
				liege = { job_marshal = { character = ROOT } }
				has_minor_title = title_commander
			}
			age = 50
			trait = blinded
			and = {
				controls_religion = yes
				religion_group = christian
			}
			emf_council_marshal_trigger = no
			
			# external code might demote a character
			trait = poor_warrior
			nor = {
				trait = poor_warrior
				trait = trained_warrior
				trait = skilled_warrior
				trait = master_warrior
			}
		}
	}
	effect = {
		prestige = 75
	}
}


# skilled_warrior -> master_warrior
obj_cta_3 = {
	type = character
	
	allow = {
		or = {
			is_ruler = yes
			liege = { job_marshal = { character = ROOT } }
			has_minor_title = title_commander
		}
		nor = {
			age = 50
			trait = blinded
			and = {
				controls_religion = yes
				religion_group = christian
			}
		}
		emf_council_marshal_trigger = yes
		
		trait = skilled_warrior
		nor = {
			trait = poor_warrior
			trait = trained_warrior
			trait = master_warrior
		}
		
		not = { has_character_flag = cta_done }
	}
	chance = {
		factor = 50
		
		modifier = {
			factor = 0
			not = { martial = 8 }
		}
		modifier = {
			factor = 20
			or = {
				liege = { job_marshal = { character = ROOT } }
				has_minor_title = title_commander
			}
		}
		modifier = {
			factor = 0.75
			age = 40
		}
		modifier = {
			factor = 0.333
			age = 45
		}
		modifier = {
			factor = 2
			trait = diligent
		}
		modifier = {
			factor = 1.5
			trait = ambitious
			martial = 10
		}
		modifier = {
			factor = 2.5
			trait = brave
		}
		modifier = {
			factor = 2.5
			trait = crusader
		}
		modifier = {
			factor = 2.5
			trait = mujahid
		}
		modifier = {
			factor = 1.75
			trait = scarred # already has proven battle experience, likely candidate to be in future battles
		}
		modifier = {
			factor = 1.75
			trait = agile
		}
		modifier = {
			factor = 2
			trait = strong
		}
		modifier = {
			factor = 6
			trait = duelist
		}
		modifier = {
			factor = 1.5
			trait = hunter
		}
		modifier = {
			factor = 0.25
			trait = weak
		}
		modifier = {
			factor = 0.25
			trait = clubfooted
		}
		modifier = {
			factor = 0.75
			trait = content
		}
		modifier = {
			factor = 0.25
			trait = craven
		}
		modifier = {
			factor = 0.1
			trait = slothful
		}
		modifier = {
			factor = 4
			trait = brilliant_strategist
		}
		modifier = {
			factor = 3
			trait = skilled_tactician
		}
		modifier = {
			factor = 2
			trait = tough_soldier
		}
		modifier = {
			factor = 1.5
			martial = 12
		}
		modifier = {
			factor = 1.5
			martial = 15
		}
		modifier = {
			factor = 1.5
			martial = 18
		}
		modifier = {
			factor = 1.5
			martial = 21
		}
		modifier = {
			factor = 1.5
			martial = 24
		}
	}
	success = {
		trait = master_warrior
	}
	abort = {
		or = {
			nor = {
				is_ruler = yes
				liege = { job_marshal = { character = ROOT } }
				has_minor_title = title_commander
			}
			age = 50
			trait = blinded
			and = {
				controls_religion = yes
				religion_group = christian
			}
			emf_council_marshal_trigger = no
			
			# external code might demote a character
			trait = poor_warrior
			trait = trained_warrior
			not = {
				trait = poor_warrior
				trait = trained_warrior
				trait = skilled_warrior
				trait = master_warrior
			}
		}
	}
	effect = {
		prestige = 200
	}
}
