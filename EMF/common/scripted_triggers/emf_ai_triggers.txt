# -*- ck2.scripted_triggers -*-

# Triggers intended to shepherd AI behavior to be less stupid

# Whether THIS would ever be hired as a spymaster by their liege
emf_in_consideration_for_spymaster = {
	liege = {
		OR = {
			ai = no
			PREV = { # Prevents player frustration
				ai = no
				has_position = job_spymaster
			}
			primary_title = { # Can't dismiss existing spymaster if they are powerful and their appointment is protected
				has_law = protected_appointment_1
				PREVPREV = {
					is_powerful_vassal = yes
					has_position = job_spymaster
				}
			}
			trigger_if = {
				limit = { ai_rationality < -20 }
				always = yes # Dumb/insane AIs don't care 
			}
			# As AIs get more rational, the minimum floor for their spymaster gets higher
			trigger_else_if = {
				limit = { ai_rationality < 0 }
				OR = {
					trigger_if = {
						limit = {
							has_dlc = "Zeus"
							PREV = {
								is_powerful_vassal = yes
								emf_is_voter = no
							}
						}
						reverse_opinion = {
							who = PREV
							value = -65
						}
					}
					trigger_else = {
						reverse_opinion = {
							who = PREV
							value = -25
						}
					}
					NOT = {
						any_courtier_or_vassal = {
							can_be_spymaster_trigger = yes
							intrigue = 10
							trigger_if = {
								limit = {
									has_dlc = "Zeus"
									is_powerful_vassal = yes
									emf_is_voter = no
								}
								opinion = {
									who = PREV
									value = -65
								}
							}
							trigger_else = {
								opinion = {
									who = PREV
									value = -25
								}
							}
						}
					}
				}
			}
			trigger_else_if = {
				limit = { ai_rationality < 20 }
				OR = {
					trigger_if = {
						limit = {
							has_dlc = "Zeus"
							PREV = {
								is_powerful_vassal = yes
								emf_is_voter = no
							}
						}
						reverse_opinion = {
							who = PREV
							value = -40
						}
					}
					trigger_else = {
						reverse_opinion = {
							who = PREV
							value = 0
						}
					}
					AND = {
						NOT = {
							any_courtier_or_vassal = {
								can_be_spymaster_trigger = yes
								intrigue = 10
								trigger_if = {
									limit = {
										has_dlc = "Zeus"
										is_powerful_vassal = yes
										emf_is_voter = no
									}
									opinion = {
										who = PREV
										value = -40
									}
								}
								trigger_else = {
									opinion = {
										who = PREV
										value = 0
									}
								}
							}
						}
						OR = {
							trigger_if = {
								limit = {
									has_dlc = "Zeus"
									PREV = {
										is_powerful_vassal = yes
										emf_is_voter = no
									}
								}
								reverse_opinion = {
									who = PREV
									value = -65
								}
							}
							trigger_else = {
								reverse_opinion = {
									who = PREV
									value = -25
								}
							}
							NOT = {
								any_courtier_or_vassal = {
									can_be_spymaster_trigger = yes
									intrigue = 10
									trigger_if = {
										limit = {
											has_dlc = "Zeus"
											is_powerful_vassal = yes
											emf_is_voter = no
										}
										opinion = {
											who = PREV
											value = -65
										}
									}
									trigger_else = {
										opinion = {
											who = PREV
											value = -25
										}
									}
								}
							}
						}
					}
				}
			}
			trigger_else = {
				OR = {
					PREV = { # Let's not throw away a good spymaster
						has_position = job_spymaster
						opinion = {
							who = PREV
							value = 0
						}
					}
					trigger_if = {
						limit = {
							has_dlc = "Zeus"
							PREV = {
								is_powerful_vassal = yes
								emf_is_voter = no
							}
						}
						reverse_opinion = {
							who = PREV
							value = -30
						}
					}
					trigger_else = {
						reverse_opinion = {
							who = PREV
							value = 10
						}
					}
					AND = {
						NOT = {
							any_courtier_or_vassal = {
								can_be_spymaster_trigger = yes
								intrigue = 10
								trigger_if = {
									limit = {
										has_dlc = "Zeus"
										is_powerful_vassal = yes
										emf_is_voter = no
									}
									opinion = {
										who = PREV
										value = -30
									}
								}
								trigger_else = {
									opinion = {
										who = PREV
										value = 10
									}
								}
							}
						}
						OR = {
							trigger_if = {
								limit = {
									has_dlc = "Zeus"
									PREV = {
										is_powerful_vassal = yes
										emf_is_voter = no
									}
								}
								reverse_opinion = {
									who = PREV
									value = -40
								}
							}
							trigger_else = {
								reverse_opinion = {
									who = PREV
									value = 0
								}
							}
							AND = {
								NOT = {
									any_courtier_or_vassal = {
										can_be_spymaster_trigger = yes
										intrigue = 10
										trigger_if = {
											limit = {
												has_dlc = "Zeus"
												is_powerful_vassal = yes
												emf_is_voter = no
											}
											opinion = {
												who = PREV
												value = -40
											}
										}
										trigger_else = {
											opinion = {
												who = PREV
												value = 0
											}
										}
									}
								}
								OR = {
									trigger_if = {
										limit = {
											has_dlc = "Zeus"
											PREV = {
												is_powerful_vassal = yes
												emf_is_voter = no
											}
										}
										reverse_opinion = {
											who = PREV
											value = -65
										}
									}
									trigger_else = {
										reverse_opinion = {
											who = PREV
											value = -25
										}
									}
									NOT = {
										any_courtier_or_vassal = {
											can_be_spymaster_trigger = yes
											intrigue = 10
											trigger_if = {
												limit = {
													has_dlc = "Zeus"
													is_powerful_vassal = yes
													emf_is_voter = no
												}
												opinion = {
													who = PREV
													value = -65
												}
											}
											trigger_else = {
												opinion = {
													who = PREV
													value = -25
												}
											}
										}
									}
								}
							}
						}
					}
				}
			}
		}
	}
}
