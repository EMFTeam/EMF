# -*- ck2.scripted_triggers -*-

# Triggers intended to shepherd AI behavior to be less stupid

# Whether THIS would ever be hired as a spymaster by their liege
emf_in_consideration_for_spymaster = {
	liege = {
		OR = {
			ai = no
			PREV = {
				has_job_title = job_spymaster
				OR = {
					ai = no # Prevents player frustration
					AND = { # Can't dismiss existing spymaster if they are powerful and their appointment is protected
						is_powerful_vassal = yes
						PREV = { primary_title = { has_law = protected_appointment_1 } }
					}
				}
			}
			# As AIs get more rational, the minimum floor for their spymaster gets higher
			OR = {
				ai_rationality < 20
				PREV = {
					trigger_if = {
						limit = {
							has_dlc = "Zeus"
							is_powerful_vassal = yes
							emf_is_voter = no
						}
						opinion = {
							who = PREV
							value = -65
						}
					}
					trigger_else = {
						opinion = {
							who = PREV
							value = -25
						}
					}
				}
				NOT = {
					any_courtier_or_vassal = {
						can_be_spymaster_trigger = yes
						OR = {
							intrigue = 10
							attribute_diff = {
								character = PREVPREV
								attribute = intrigue
								value >= 1
							}
						}
						trigger_if = {
							limit = {
								has_dlc = "Zeus"
								is_powerful_vassal = yes
								emf_is_voter = no
							}
							opinion = {
								who = PREV
								value = -65
							}
						}
						trigger_else = {
							opinion = {
								who = PREV
								value = -25
							}
						}
					}
				}
			}
			OR = {
				ai_rationality < 0
				PREV = {
					trigger_if = {
						limit = {
							has_dlc = "Zeus"
							is_powerful_vassal = yes
							emf_is_voter = no
						}
						opinion = {
							who = PREV
							value = -40
						}
					}
					trigger_else = {
						opinion = {
							who = PREV
							value = 0
						}
					}
				}
				NOT = {
					any_courtier_or_vassal = {
						can_be_spymaster_trigger = yes
						OR = {
							intrigue = 10
							attribute_diff = {
								character = PREVPREV
								attribute = intrigue
								value >= 1
							}
						}
						trigger_if = {
							limit = {
								has_dlc = "Zeus"
								is_powerful_vassal = yes
								emf_is_voter = no
							}
							opinion = {
								who = PREV
								value = -40
							}
						}
						trigger_else = {
							opinion = {
								who = PREV
								value = 0
							}
						}
					}
				}
			}
			OR = {
				ai_rationality < 20
				PREV = { # Let's not throw away a good spymaster
					has_job_title = job_spymaster
					opinion = {
						who = PREV
						value = 0
					}
				}
				PREV = {
					trigger_if = {
						limit = {
							has_dlc = "Zeus"
							is_powerful_vassal = yes
							emf_is_voter = no
						}
						opinion = {
							who = PREV
							value = -30
						}
					}
					trigger_else = {
						opinion = {
							who = PREV
							value = 10
						}
					}
				}
				NOT = {
					any_courtier_or_vassal = {
						can_be_spymaster_trigger = yes
						OR = {
							intrigue = 10
							attribute_diff = {
								character = PREVPREV
								attribute = intrigue
								value >= 1
							}
						}
						trigger_if = {
							limit = {
								has_dlc = "Zeus"
								is_powerful_vassal = yes
								emf_is_voter = no
							}
							opinion = {
								who = PREV
								value = -30
							}
						}
						trigger_else = {
							opinion = {
								who = PREV
								value = 10
							}
						}
					}
				}
			}
		}
	}
}
