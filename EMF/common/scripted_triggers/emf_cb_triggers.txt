# -*- ck2.scripted_triggers -*-


#### Standard global CB triggers ####

emf_cb_can_use_gui_trigger = {
	custom_tooltip = {
		text = emf_cb_ctt_no_peace_pledge
		hidden_tooltip = { NOT = { has_ambition = obj_pledge_peace } }
	}
}
emf_cb_can_use_trigger = {
	ROOT = {
		OR = {
			ai = no
			NAND = {
				has_landed_title = e_mongol_empire
				NOR = {
					has_global_flag = emf_mongols_defeated
					has_character_flag = emf_horde_invasion_pass
				}
			}
			# NAND = {
			# 	OR = {
			# 		has_character_flag = emf_aim1 # restore byzantium
			# 		has_character_flag = emf_aim2 # take constantinople
			# 	}
			# 	NOT = { has_character_flag = emf_cb_pass }
			# }
		}
	}
}
emf_cb_can_use_title_trigger = {
	OR = {
		FROM = { ai = no }
		ROOT = { ai = no }
		ROOT = { is_merchant_republic = yes }
		FROM = {
			NAND = {
				is_merchant_republic = yes
				OR = {
					capital_scope = { county = { title = PREVPREVPREV } }
					capital_holding = { title = PREVPREV }
					primary_title = { title = PREVPREV }
					succ_law_title = { title = PREVPREV }
				}
			}
		}
	}
	FROM = {
		NAND = {
			is_nomadic = yes
			OR = {
				primary_title = { title = PREVPREV }
				clan_title = { title = PREVPREV }
			}
		}
	}
	holy_order = no
	mercenary = no
}
emf_cb_can_use_de_jure_title_trigger = {
	emf_cb_can_use_sahara_title_trigger = yes
	FROM = {
		OR = {
			ai = no
			is_merchant_republic = no
			ROOT = { is_merchant_republic = yes }
			ROOT = { ai = no }
			NOT = { capital_holding = { de_jure_liege_or_above = PREVPREV } }
		}
	}
}

## Helper triggers for the above (used by some non-DJ-title CBs too, like county conquest)
emf_cb_can_use_sahara_title_trigger = {
	OR = {
		NOT = { region = emf_region_sahara }
		ROOT = {
			OR = {
				ai = no
				capital_scope = { region = emf_region_sahara }
			}
		}
		FROM = {
			OR = {
				ai = no
				capital_scope = { NOT = { region = emf_region_sahara } }
			}
		}
	}
}

#### Standard global CB triggers (third-party variants) ####

emf_cb_thirdparty_can_use_gui_trigger = {
	custom_tooltip = {
		text = emf_cb_ctt_no_peace_pledge
		hidden_tooltip = { NOT = { has_ambition = obj_pledge_peace } }
	}
}
emf_cb_thirdparty_can_use_trigger = {
	FROMFROM = {
		OR = {
			ai = no
			NOT = { has_landed_title = e_mongol_empire }
			# NAND = {
			# 	OR = {
			# 		has_character_flag = emf_aim1 # restore byzantium
			# 		has_character_flag = emf_aim2 # take constantinople
			# 	}
			# 	NOT = { has_character_flag = emf_cb_pass }
			# }
		}
	}
}
emf_cb_thirdparty_can_use_title_trigger = {
	OR = {
		FROM = { ai = no }
		FROMFROM = { ai = no }
		FROMFROM = { is_merchant_republic = yes }
		FROM = {
			NAND = {
				is_merchant_republic = yes
				OR = {
					capital_scope = { county = { title = PREVPREVPREV } }
					capital_holding = { title = PREVPREV }
					primary_title = { title = PREVPREV }
					succ_law_title = { title = PREVPREV }
				}
			}
		}
	}
	FROM = {
		NAND = {
			is_nomadic = yes
			OR = {
				primary_title = { title = PREVPREV }
				clan_title = { title = PREVPREV }
			}
		}
	}
	holy_order = no
	mercenary = no
}
emf_cb_thirdparty_can_use_de_jure_title_trigger = {
	OR = {
		NOT = { region = emf_region_sahara }
		FROMFROM = {
			OR = {
				ai = no
				capital_scope = { region = emf_region_sahara }
			}
		}
		FROM = {
			OR = {
				ai = no
				capital_scope = { NOT = { region = emf_region_sahara } }
			}
		}
	}
	OR = {
		FROM = { ai = no }
		FROM = { is_merchant_republic = no }
		FROMFROM = { is_merchant_republic = yes }
		FROMFROM = { ai = no }
		NOT = { FROM = { capital_holding = { de_jure_liege_or_above = PREVPREV } } }
	}
}


#### Other, specific triggers ####

emf_cb_unexpelled_holy_order_trigger = {
	custom_tooltip = {
		text = emf_cb_ctt_unexpelled_holy_order
		hidden_tooltip = {
			holy_order = yes
			NOR = {
				AND = {
					primary_title = { title = d_knights_templar }
					ROOT = { has_character_modifier = expelled_d_knights_templar }
				}
				AND = {
					primary_title = { title = d_knights_hospitaler }
					ROOT = { has_character_modifier = expelled_d_knights_hospitaler }
				}
				AND = {
					primary_title = { title = d_teutonic_order }
					ROOT = { has_character_modifier = expelled_d_teutonic_order }
				}
				AND = {
					primary_title = { title = d_jomsvikings }
					ROOT = { has_character_modifier = expelled_d_jomsvikings }
				}
				AND = {
					primary_title = { title = d_hashshashin }
					ROOT = { has_character_modifier = expelled_d_hashshashin }
				}
				AND = {
					primary_title = { title = d_bektashi }
					ROOT = { has_character_modifier = expelled_d_bektashi }
				}
				AND = {
					primary_title = { title = d_haruriyyah }
					ROOT = { has_character_modifier = expelled_d_haruriyyah }
				}
				AND = {
					primary_title = { title = d_holy_sepulchre }
					ROOT = { has_character_modifier = expelled_d_holy_sepulchre }
				}
				AND = {
					primary_title = { title = d_saint_anthony }
					ROOT = { has_character_modifier = expelled_d_saint_anthony }
				}
				AND = {
					primary_title = { title = d_immortals }
					ROOT = { has_character_modifier = expelled_d_immortals }
				}
				AND = {
					primary_title = { title = d_zealots }
					ROOT = { has_character_modifier = expelled_d_zealots }
				}
				AND = {
					primary_title = { title = d_sky_lords }
					ROOT = { has_character_modifier = expelled_d_sky_lords }
				}
				AND = {
					primary_title = { title = d_spirit_guardians }
					ROOT = { has_character_modifier = expelled_d_spirit_guardians }
				}
				AND = {
					primary_title = { title = d_warriors_perun }
					ROOT = { has_character_modifier = expelled_d_warriors_perun }
				}
				AND = {
					primary_title = { title = d_chosen_perkunas }
					ROOT = { has_character_modifier = expelled_d_chosen_perkunas }
				}
				AND = {
					primary_title = { title = d_sons_kaleva }
					ROOT = { has_character_modifier = expelled_d_sons_kaleva }
				}
				AND = {
					primary_title = { title = d_huitzilopochtli }
					ROOT = { has_character_modifier = expelled_d_huitzilopochtli }
				}
				AND = {
					primary_title = { title = d_knights_santiago }
					ROOT = { has_character_modifier = expelled_d_knights_santiago }
				}
				AND = {
					primary_title = { title = d_knights_calatrava }
					ROOT = { has_character_modifier = expelled_d_knights_calatrava }
				}
				AND = {
					primary_title = { title = d_saint_addai }
					ROOT = { has_character_modifier = expelled_d_saint_addai }
				}
				AND = {
					primary_title = { title = d_zun_warriors }
					ROOT = { has_character_modifier = expelled_d_zun_warriors }
				}
				AND = {
					primary_title = { title = d_arsiyah }
					ROOT = { has_character_modifier = expelled_d_arsiyah }
				}
				AND = {
					primary_title = { title = d_saqaliba }
					ROOT = { has_character_modifier = expelled_d_saqaliba }
				}
			}
		}
	}
}
