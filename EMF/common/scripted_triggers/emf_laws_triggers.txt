
emf_laws_change_succ_prestige_cost_trigger = {
	OR = {
		custom_tooltip = {
			text = emf_laws_ctt_baron_tier_and_requires_125_prestige_cost
			hidden_tooltip = {
				tier = BARON
				holder_scope = { prestige = 125 }
			}
		}
		custom_tooltip = {
			text = emf_laws_ctt_count_tier_and_requires_250_prestige_cost
			hidden_tooltip = {
				tier = COUNT
				holder_scope = { prestige = 250 }
			}
		}
		custom_tooltip = {
			text = emf_laws_ctt_duke_tier_and_requires_500_prestige_cost
			hidden_tooltip = {
				tier = DUKE
				holder_scope = { prestige = 500 }
			}
		}
		custom_tooltip = {
			text = emf_laws_ctt_king_tier_and_requires_750_prestige_cost
			hidden_tooltip = {
				tier = KING
				holder_scope = { prestige = 750 }
			}
		}
		custom_tooltip = {
			text = emf_laws_ctt_emperor_tier_and_requires_1000_prestige_cost
			hidden_tooltip = {
				tier = EMPEROR
				holder_scope = { prestige = 1000 }
			}
		}
	}
}

# Standard (additional) requirements for any succession law adoption
emf_laws_change_succ_allow_trigger = {
	emf_laws_change_succ_prestige_cost_trigger = yes
}

# Vassals are almost (always) upset by a succession law change; these are the ones that are affected:
emf_laws_change_succ_affected_vassal_trigger = {
	OR = {
		primary_title = { de_jure_liege_or_above = event_target:emf_succ_title }
		event_target:emf_succ_title = { is_primary_holder_title = yes }
		event_target:emf_succ_title = { is_titular = yes }
	}
}

# The succession law change reactions of the new heir, former heir, new pretenders, and former pretenders are all handled
# by event and thus the succ_adopt_* effects should skip these characters in its blanket opinion effects.
emf_laws_change_succ_vip_trigger = {
	OR = {
		character = event_target:emf_former_heir
		character = event_target:emf_heir
		reverse_has_opinion_modifier = { who = event_target:emf_succ_changer modifier = opinion_succ_former_pretender }
		any_pretender_title = { title = event_target:emf_succ_title }
	}
}

# Additionally, as the succ_adopt_* effects hand-out blanket opinions, they do so in order of priority, and they mark each
# "already reacted to this succession law change" character as they go with the flags emf_succ_change_reaction,
# emf_bad_succ_change_reaction, and emf_good_succ_change_reaction so that we may exclude them from further reactions.
#
# Note that we distinguish the types of succession change reaction so that we may know which opinion modifier we've added
# from the character to the succession law changer _for this law change only_ so that actual opinions may properly stack from
# past reactions to law changes (alternative would be to check for the modifiers themselves, but that would not allow
# coherent stacking across multiple law changes by the same ruler).
emf_laws_change_succ_reaction_trigger = {
	OR = {
		has_character_flag = emf_good_succ_change_reaction
		has_character_flag = emf_succ_change_reaction
		has_character_flag = emf_bad_succ_change_reaction
		has_character_flag = emf_bad2_succ_change_reaction
	}
}

emf_laws_cognatic_potential_trigger = {
	holder_scope = {
		# Diff from vanilla:
		# - removed some logically redundant code related to merchant republics
		# - holders with a horde culture can be cognatic if a player
		# - cosmetic conversion of the excluded character classes into a NOR
		OR = {
			independent = yes
			NOT = {
				any_liege = {
					holy_order = yes
				}
			}
		}
		OR = {
			NOR = {
				religion_group = muslim
				religion = aztec
				religion = aztec_reformed
				is_tribal = yes
				is_nomadic = yes
				is_merchant_republic = yes
				is_patrician = yes
				AND = {
					has_horde_culture = yes
					ai = yes
				}
			}
			AND = {
				has_dlc = "Zeus"
				primary_title = {					
					OR = {
						has_law = status_of_women_3
						has_law = status_of_women_4
					}
				}
				OR = {
					is_patrician = no
					liege = {
						primary_title = {
							OR = {
								has_law = true_cognatic_succession
								has_law = cognatic_succession
							}
						}
					}
				}
			}
		}
	}
	OR = {
		AND = {
			tier = baron
			is_theocracy = no
			is_republic = no
		}
		holder_scope = {
			is_theocracy = no
			is_republic = no
		}
	}

	# Here, we've made an exception to the vanilla rule for landless/primary-type
	# titles if the title is temporary.  This should allow revolt titles to
	# be Absolute Cognatic if full Gender Equality is enabled. Here, we do exclude
	# adventurer titles (if that trigger even works-- I have my doubts) for safety,
	# as I'm already unsure whether Absolute Cognatic won't have any weird side
	# effects for revolt titles, and adventurers tend to be the wrong character
	# type anyhow.
	OR = {
		AND = {
			is_landless_type_title = no
			is_primary_type_title = no
		}
		AND = {
			has_global_flag = emf_gender_eq_law
			temporary = yes
			NOR = {
				adventurer = yes
				mercenary = yes
				clan = yes
				rebel = yes # major_revolt titles aren't rebel = yes
			}
		}
	}
}

# Used for most regular succession laws as PART of the potential. It's NOT common to every major succession type (e.g.,
# primogeniture and turkish succession don't use it); it's just a convenience to clarify the succession laws code.
emf_laws_succ_basic_potential_trigger = {
	holder_scope = {
		NOT = { religion_group = muslim }
		OR = {
			independent = yes
			NOR = {
				any_liege = { holy_order = yes }
				any_demesne_title = { is_vice_royalty = yes }
			}
		}
	}
	OR = {
		is_landless_type_title = no
		is_tribal_type_title = yes
		temporary = yes
	}
	is_primary_type_title = no
	is_vice_royalty = no
}

emf_laws_any_succ_change_opinion_trigger = {
	OR = {
		has_opinion_modifier = { who = PREV modifier = opinion_succ_law_change }
		has_opinion_modifier = { who = PREV modifier = opinion_good_succ_law_change }
		has_opinion_modifier = { who = PREV modifier = opinion_bad_succ_law_change }
	}
}
