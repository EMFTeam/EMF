# -*- ck2.events -*-

###########################################
#                                         #
# Introduce Heir events				      #
# by Alexander Oltner                     #
# ID      	              				  #
#                                         #
###########################################

namespace = ZE

# Try to mold heir to be more like me
character_event = {
	id = ZE.21900
	desc = EVTDESC_ZE_21900
	picture = GFX_evt_son_asking_father
	
	only_playable = yes
	prisoner = no
	capable_only = yes
	min_age = 28
	
	trigger = {
		has_ambition = obj_groom_an_heir
		any_child = {
			any_heir_title = {
				tier = COUNT
				holder = ROOT
				location = { is_capital = yes }
			}
			prisoner = no
			host = { character = ROOT }
			age = 12
			OR = {
				AND = {
					NOT = { trait = diligent }
					NOT = { trait = slothful }
					ROOT = { trait = diligent }
				}
				AND = {
					NOT = { trait = charitable }
					NOT = { trait = greedy }
					ROOT = { trait = charitable }
				}
				AND = {
					NOT = { trait = kind }
					NOT = { trait = cruel }
					NOT = { trait = envious }
					ROOT = { trait = kind }
				}
				AND = {
					NOT = { trait = patient }
					NOT = { trait = wroth }
					ROOT = { trait = patient }
				}
				AND = {
					NOT = { trait = honest }
					NOT = { trait = deceitful }
					ROOT = { trait = honest }
				}
				AND = {
					NOT = { trait = brave }
					NOT = { trait = craven }
					ROOT = { trait = brave }
				}
				AND = {
					NOT = { trait = just }
					NOT = { trait = arbitrary }
					ROOT = { trait = just }
				}
				AND = {
					NOT = { trait = zealous }
					NOT = { trait = cynical }
					ROOT = { trait = zealous }
				}
			}
			OR = {
				NOT = { has_character_flag = heir_grooming_event }
				had_character_flag = { flag = heir_grooming_event days = 365 }
			}
			NOR = {
				age = 20
				trait = incapable
				is_inaccessible_trigger = yes
				trait = inbred
				trait = imbecile
				has_character_modifier = groomed_to_perfection
				has_character_flag = introduced_heir
			}
		}
	}
	
	mean_time_to_happen = {
		months = 18
		modifier = {
			factor = 0.5
			trait = diligent
		}
		modifier = {
			factor = 0.75
			trait = cruel
		}
		modifier = {
			factor = 1.5
			trait = kind
		}
		modifier = {
			factor = 1.5
			trait = patient
		}
		modifier = {
			factor = 2
			trait = slothful
		}
	}
	
	immediate = {
		random_child = {
			limit = {
				any_heir_title = {
					tier = COUNT
					holder = ROOT
					location = { is_capital = yes }
				}
			}
			set_character_flag = heir_grooming_event
			save_event_target_as = groomed_heir
		}
	}
	
	option = {
		name = EVTOPTA_ZE_21900 # Yes, I have to try
		ai_chance = {
			factor = 50
		}
		event_target:groomed_heir = {
			random_list = {
				10 = {
					modifier = {
						factor = 0
						OR = {
							trait = diligent
							trait = slothful
							ROOT = { NOT = { trait = diligent } }
						}
					}
					emf_notify_add_diligent_effect = yes
				}
				10 = {
					modifier = {
						factor = 0
						OR = {
							trait = charitable
							trait = greedy
							ROOT = { NOT = { trait = charitable } }
						}
					}
					emf_notify_add_charitable_effect = yes
				}
				10 = {
					modifier = {
						factor = 0
						OR = {
							trait = kind
							trait = cruel
							trait = envious
							ROOT = { NOT = { trait = kind } }
						}
					}
					emf_notify_add_kind_effect = yes
				}
				10 = {
					modifier = {
						factor = 0
						OR = {
							trait = patient
							trait = wroth
							ROOT = { NOT = { trait = patient } }
						}
					}
					emf_notify_add_patient_effect = yes
				}
				10 = {
					modifier = {
						factor = 0
						OR = {
							trait = brave
							trait = craven
							ROOT = { NOT = { trait = brave } }
						}
					}
					emf_notify_add_brave_effect = yes
				}
				10 = {
					modifier = {
						factor = 0
						OR = {
							trait = just
							trait = arbitrary
							ROOT = { NOT = { trait = just } }
						}
					}
					emf_notify_add_just_effect = yes
				}
				10 = {
					modifier = {
						factor = 0
						OR = {
							trait = zealous
							trait = cynical
							ROOT = { NOT = { trait = zealous } }
						}
					}
					emf_notify_add_zealous_effect = yes
				}
				20 = {
					modifier = {
						factor = 0
						trait = stressed
					}
					emf_notify_add_stressed_effect = yes
				}
				20 = {
					modifier = {
						factor = 0
						trait = depressed
					}
					emf_notify_add_depressed_effect = yes
				}
				10 = {
					modifier = {
						factor = 0.5
						NOT = { trait = depressed }
						NOT = { trait = stressed }
					}
					modifier = {
						factor = 2
						trait = depressed
					}
					modifier = {
						factor = 2
						trait = stressed
					}
					opinion = { who = ROOT modifier = opinion_angry years = 25 }
				}
			}
		}
	}
	option = {
		name = EVTOPTC_ZE_21900 # No, let him have some fun
		ai_chance = {
			factor = 50
			modifier = {
				factor = 0
				trait = cruel
			}
			modifier = {
				factor = 0.5
				trait = diligent
			}
			modifier = {
				factor = 3
				trait = kind
			}
		}
		opinion = { who = ROOT modifier = opinion_happy_with_guardian multiplier = 2 years = 25 }
	}
}

character_event = {
	id = ZE.21901
	desc = EVTDESC_ZE_21901
	picture = GFX_evt_son_asking_father
	
	only_playable = yes
	prisoner = no
	capable_only = yes
	min_age = 28
	
	trigger = {
		has_ambition = obj_groom_an_heir
		any_child = {
			any_heir_title = {
				tier = COUNT
				holder = ROOT
				location = { is_capital = yes }
			}
			prisoner = no
			host = { character = ROOT }
			age = 12
			OR = {
				AND = {
					trait = slothful
					ROOT = { trait = diligent }
				}
				AND = {
					trait = greedy
					ROOT = { trait = charitable }
				}
				AND = {
					trait = cruel
					ROOT = { trait = kind }
				}
				AND = {
					trait = envious
					ROOT = { trait = kind }
				}
				AND = {
					trait = wroth
					ROOT = { trait = patient }
				}
				AND = {
					trait = deceitful
					ROOT = { trait = honest }
				}
				AND = {
					trait = craven
					ROOT = { trait = brave }
				}
				AND = {
					trait = arbitrary
					ROOT = { trait = just }
				}
				AND = {
					trait = cynical
					ROOT = { trait = zealous }
				}
			}
			OR = {
				NOT = { has_character_flag = heir_grooming_event }
				had_character_flag = { flag = heir_grooming_event days = 365 }
			}
			NOR = {
				age = 20
				trait = incapable
				is_inaccessible_trigger = yes
				trait = inbred
				trait = imbecile
				has_character_modifier = groomed_to_perfection
				has_character_flag = introduced_heir
			}
		}
	}
	
	mean_time_to_happen = {
		months = 18
		modifier = {
			factor = 0.5
			trait = diligent
		}
		modifier = {
			factor = 0.75
			trait = cruel
		}
		modifier = {
			factor = 1.5
			trait = kind
		}
		modifier = {
			factor = 1.5
			trait = patient
		}
		modifier = {
			factor = 2
			trait = slothful
		}
	}
	
	immediate = {
		random_child = {
			limit = {
				any_heir_title = {
					tier = COUNT
					holder = ROOT
					location = { is_capital = yes }
				}
			}
			set_character_flag = heir_grooming_event
			save_event_target_as = groomed_heir
		}
	}
	
	option = {
		name = EVTOPTA_ZE_21900 # Yes, I have to try
		ai_chance = {
			factor = 50
		}
		event_target:groomed_heir = {
			random_list = {
				10 = {
					modifier = {
						factor = 0
						OR = {
							NOT = { trait = slothful }
							ROOT = { NOT = { trait = diligent } }
						}
					}
					emf_notify_remove_slothful_effect = yes
				}
				10 = {
					modifier = {
						factor = 0
						OR = {
							NOT = { trait = greedy }
							ROOT = { NOT = { trait = charitable } }
						}
					}
					emf_notify_remove_greedy_effect = yes
				}
				10 = {
					modifier = {
						factor = 0
						OR = {
							NOT = { trait = cruel }
							ROOT = { NOT = { trait = kind } }
						}
					}
					emf_notify_remove_cruel_effect = yes
				}
				10 = {
					modifier = {
						factor = 0
						OR = {
							NOT = { trait = envious }
							ROOT = { NOT = { trait = kind } }
						}
					}
					emf_notify_remove_envious_effect = yes
				}
				10 = {
					modifier = {
						factor = 0
						OR = {
							NOT = { trait = wroth }
							ROOT = { NOT = { trait = patient } }
						}
					}
					emf_notify_remove_wroth_effect = yes
				}
				10 = {
					modifier = {
						factor = 0
						OR = {
							NOT = { trait = craven }
							ROOT = { NOT = { trait = brave } }
						}
					}
					emf_notify_remove_craven_effect = yes
				}
				10 = {
					modifier = {
						factor = 0
						OR = {
							NOT = { trait = arbitrary }
							ROOT = { NOT = { trait = just } }
						}
					}
					emf_notify_remove_arbitrary_effect = yes
				}
				10 = {
					modifier = {
						factor = 0
						OR = {
							NOT = { trait = cynical }
							ROOT = { NOT = { trait = zealous } }
						}
					}
					emf_notify_remove_cynical_effect = yes
				}
				20 = {
					modifier = {
						factor = 0
						trait = stressed
					}
					emf_notify_add_stressed_effect = yes
				}
				20 = {
					modifier = {
						factor = 0
						trait = depressed
					}
					emf_notify_add_depressed_effect = yes
				}
				10 = {
					modifier = {
						factor = 0.5
						NOT = { trait = depressed }
						NOT = { trait = stressed }
					}
					modifier = {
						factor = 2
						trait = depressed
					}
					modifier = {
						factor = 2
						trait = stressed
					}
					opinion = { who = ROOT modifier = opinion_angry multiplier = 2 years = 25 }
				}
			}
		}
	}
	option = {
		name = EVTOPTC_ZE_21900 # No, let him have some fun
		ai_chance = {
			factor = 50
			modifier = {
				factor = 0
				trait = cruel
			}
			modifier = {
				factor = 0.5
				trait = diligent
			}
			modifier = {
				factor = 3
				trait = kind
			}
		}
		opinion = { who = ROOT modifier = opinion_happy_with_guardian multiplier = 2 years = 25 }
	}
}

# Introduce Heir Start Event
character_event = {
	id = ZE.22900
	desc = EVTDESC_ZE_22900
	picture = GFX_evt_son_asking_father
	
	is_triggered_only = yes
	major = yes
	
	major_trigger = {
		OR = {
			character = ROOT
			vassal_of = ROOT
		}
	}
	
	immediate = {
		FROM = {
			set_character_flag = introduced_heir
			save_event_target_as = introduced_heir
		}
	}
	
	option = {
		name = EVTOPTA_ZE_22900
		trigger = { character = ROOT }
		event_target:introduced_heir = {
			custom_tooltip = {
				text = HEIR_INTRODUCED
				hidden_tooltip = {
					ROOT = { character_event = { id = ZE.21902 days = 11 } }
				}
			}
		}
	}
	option = {
		name = EVTOPTB_ZE_22900
		trigger = { NOT = { character = ROOT } }
		event_target:introduced_heir = {
			custom_tooltip = { text = HEIR_INTRODUCED }
		}
	}
}

# Bounce event
character_event = {
	id = ZE.21902
	
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		# Chain is now invalid
		if = {
			limit = { NOT = { has_ambition = obj_groom_an_heir } }
			event_target:introduced_heir = {
				clr_character_flag = introduced_heir
				clr_character_flag = groom_heir_war_warning
				clr_character_flag = groom_heir_illness_warning
			}
			break = yes
		}
		if = {
			limit = {
				event_target:introduced_heir = {
					NAND = {
						is_alive = yes
						host = { character = ROOT }
						any_heir_title = {
							tier = COUNT
							holder = ROOT
							location = { is_capital = yes }
						}
					}
				}
			}
			event_target:introduced_heir = {
				clr_character_flag = introduced_heir
				clr_character_flag = groom_heir_war_warning
				clr_character_flag = groom_heir_illness_warning
			}
			break = yes
		}
		# Father can no longer continue introduction
		if = {
			limit = {
				OR = {
					prisoner = yes
					is_inaccessible_trigger = yes
				}
			}
			character_event = { id = ZE.21903 }
			break = yes
		}
		# Child can no longer continue introduction
		if = {
			limit = {
				event_target:introduced_heir = {
					OR = {
						age = 22
						prisoner = yes
						is_inaccessible_trigger = yes
					}
				}
			}
			character_event = { id = ZE.21904 }
			break = yes
		}
		# War delays things
		if = {
			limit = { war = yes }
			if = {
				limit = {
					event_target:introduced_heir = {
						NOT = { has_character_flag = groom_heir_war_warning }
					}
				}
				character_event = { id = ZE.21905 }
			}
			repeat_event = { id = ZE.21902 days = 30 }
			break = yes
		}
		# Illness delays things
		if = {
			limit = {
				event_target:introduced_heir = { is_ill = yes }
			}
			if = {
				limit = {
					event_target:introduced_heir = {
						NOT = { has_character_flag = groom_heir_illness_warning }
					}
				}
				character_event = { id = ZE.21906 }
			}
			repeat_event = { id = ZE.21902 days = 30 }
			break = yes
		}
		
		# Heir is groomed!
		if = {
			limit = {
				event_target:introduced_heir = {
					check_variable = { which = "groomed_heir" value = 9.5 }
				}
			}
			character_event = { id = ZE.22901 }
			break = yes
		}
		
		repeat_event = { id = ZE.21902 days = 11 random = 5 }
		
		event_target:introduced_heir = { prestige = 5 }
		
		# Pick a court event
		random_list = {
			10 = {
				modifier = {
					factor = 0
					NOT = {
						any_vassal = {
							ai = yes
							religion = ROOT
							prisoner = no
							is_adult = yes
							piety = 0
							NOR = {
								holds_favor_on = ROOT
								trait = incapable
								is_inaccessible_trigger = yes
								trait = cynical
								trait = slothful
							}
							OR = {
								trait = theologian
								trait = scholar
								learning = 12
							}
						}
					}
				}
				modifier = {
					factor = 0
					event_target:introduced_heir = { has_character_flag = groom_heir_taught_scripture }
				}
				# Vassal offers to teach heir the scripture for a favor
				character_event = { id = ZE.22902 }
			}
			10 = {
				modifier = {
					factor = 0
					NOT = {
						any_vassal = {
							ai = yes
							is_adult = yes
							prisoner = no
							war = no
							NOR = {
								trait = incapable
								is_inaccessible_trigger = yes
								has_opinion_modifier = { modifier = insulted who = event_target:introduced_heir }
								has_opinion_modifier = { modifier = opinion_impressed who = event_target:introduced_heir }
							}
						}
					}
				}
				modifier = {
					factor = 0
					event_target:introduced_heir = {
						NOR = {
							trait = affectionate
							has_character_flag = was_affectionate
							trait = playful
							has_character_flag = was_playful
							trait = curious
							has_character_flag = was_curious
							trait = conscientious
							has_character_flag = was_conscientious
							trait = idolizer
							has_character_flag = was_idolizer
						}
					}
				}
				modifier = {
					factor = 0.25
					event_target:introduced_heir = { has_character_flag = groom_heir_impressed_vassal }
				}
				# Heir impresses visiting vassal
				character_event = { id = ZE.22903 }
			}
			10 = {
				modifier = {
					factor = 0
					NOT = {
						any_vassal = {
							ai = yes
							prisoner = no
							is_adult = yes
							war = no
							NOR = {
								trait = incapable
								is_inaccessible_trigger = yes
								has_opinion_modifier = { modifier = insulted who = event_target:introduced_heir }
								has_opinion_modifier = { modifier = opinion_impressed who = event_target:introduced_heir }
							}
						}
					}
				}
				modifier = {
					factor = 0
					event_target:introduced_heir = {
						NOR = {
							trait = haughty
							has_character_flag = was_haughty
							trait = rowdy
							has_character_flag = was_rowdy
							trait = willful
							has_character_flag = was_willful
							trait = indolent
							has_character_flag = was_indolent
							trait = fussy
							has_character_flag = was_fussy
						}
					}
				}
				modifier = {
					factor = 0.25
					event_target:introduced_heir = { has_character_flag = groom_heir_insulted_vassal }
				}
				# Heir accidently insults visiting vassal
				character_event = { id = ZE.22904 }
			}
			10 = {
				modifier = {
					factor = 0
					event_target:introduced_heir = {
						OR = {
							trait = timid
							has_character_flag = was_timid
						}
					}
				}
				modifier = {
					factor = 0
					NOT = {
						any_realm_character = {
							ai = yes
							prisoner = no
							OR = {
								father = { vassal_of = ROOT }
								mother = { vassal_of = ROOT }
								vassal_of = ROOT
							}
							NOR = {
								age = 23
								is_friend = event_target:introduced_heir 
								is_rival = event_target:introduced_heir
								is_child_of = ROOT
								age_diff = { who = event_target:introduced_heir years = 5 }
								trait = incapable
								is_inaccessible_trigger = yes
							}
						}
					}
				}
				modifier = {
					factor = 0
					event_target:introduced_heir = { has_character_flag = groom_heir_befriend_child }
				}
				# Heir befriends vassal child
				character_event = { id = ZE.22905 }
			}
			10 = {
				modifier = {
					factor = 0
					event_target:introduced_heir = {
						OR = {
							trait = affectionate
							has_character_flag = was_affectionate
						}
					}
				}
				modifier = {
					factor = 0
					NOT = {
						any_realm_character = {
							ai = yes
							prisoner = no
							OR = {
								father = { vassal_of = ROOT }
								mother = { vassal_of = ROOT }
								vassal_of = ROOT
							}
							NOR = {
								age = 23
								is_friend = event_target:introduced_heir 
								is_rival = event_target:introduced_heir
								is_child_of = ROOT
								age_diff = { who = event_target:introduced_heir years = 5 }
								trait = incapable
								is_inaccessible_trigger = yes
							}
						}
					}
				}
				modifier = {
					factor = 0
					event_target:introduced_heir = { has_character_flag = groom_heir_rival_child }
				}
				# Heir rivals vassal child
				character_event = { id = ZE.22906 }
			}
			10 = {
				modifier = {
					factor = 0
					event_target:introduced_heir = {
						OR = {
							trait = depressed 
							trait = indolent
							has_character_flag = was_indolent
						}
					}
				}
				modifier = {
					factor = 0
					event_target:introduced_heir = {
						NOR = {
							trait = brooding
							has_character_flag = was_brooding
							trait = conscientious
							has_character_flag = was_conscientious
							trait = fussy
							has_character_flag = was_fussy
							trait = stressed
							is_dumb_trigger = yes
						}
					}
				}
				modifier = {
					factor = 2
					event_target:introduced_heir = { is_dumb_trigger = yes }
				}
				modifier = {
					factor = 0
					event_target:introduced_heir = { has_character_flag = groom_heir_becomes_depressed }
				}
				# Heir underperforms and becomes depressed
				character_event = { id = ZE.22907 }
			}
			10 = {
				modifier = {
					factor = 0
					NOT = {
						any_vassal = {
							ai = yes
							prisoner = no
							is_adult = yes
							war = no
							NOR = {
								holds_favor_on = ROOT
								trait = incapable
								is_inaccessible_trigger = yes
							}
							OR = {
								trait = strategist
								trait = duelist
								martial = 12
							}
						}
					}
				}
				modifier = {
					factor = 0
					event_target:introduced_heir = { has_character_flag = groom_heir_taught_to_fight }
				}
				# Vassal offers to teach heir to fight for a favor
				character_event = { id = ZE.22908 }
			}
			10 = {
				modifier = {
					factor = 0
					event_target:introduced_heir = {
						OR = {
							trait = homosexual
							trait = chaste
							is_female = yes
						}
					}
				}
				modifier = {
					factor = 2
					event_target:introduced_heir = { trait = lustful }
				}
				modifier = {
					factor = 0
					NOT = {
						any_vassal = {
							is_female = no
							ai = yes
							is_married = yes
							prisoner = no
							war = no
							NOR = {
								trait = incapable
								is_inaccessible_trigger = yes
							}
							any_spouse = {
								is_female = yes
								ai = yes
								is_ill = no
								prisoner = no
								is_landed = no
								NOT = { age = 30 }
								NOR = {
									trait = ugly
									trait = clubfooted
									trait = harelip
									trait = hunchback
									trait = dwarf
									trait = imbecile
									trait = inbred
									trait = wrymouth
									is_dumb_trigger = yes
									trait = incapable
									is_inaccessible_trigger = yes
									is_rival = event_target:introduced_heir
								}
							}
						}
					}
				}
				modifier = {
					factor = 0
					event_target:introduced_heir = { has_character_flag = groom_heir_infatuation }
				}
				# Heir is infatuated with Vassal's spouse
				character_event = { id = ZE.22909 }
			}
			10 = {
				modifier = {
					factor = 0
					event_target:introduced_heir = { has_character_flag = groom_heir_learns_stewardship }
				}
				# Heir learns about stewardship
				character_event = { id = ZE.21907 }
			}
			10 = {
				modifier = {
					factor = 0
					event_target:introduced_heir = { has_character_flag = groom_heir_learns_diplomacy }
				}
				# Heir learns about diplomacy
				character_event = { id = ZE.21908 }
			}
			10 = {
				modifier = {
					factor = 0
					event_target:introduced_heir = { has_character_flag = groom_heir_learns_martial }
				}
				# Heir learns about martial
				character_event = { id = ZE.21909 }
			}
			10 = {
				modifier = {
					factor = 0
					event_target:introduced_heir = { has_character_flag = groom_heir_learns_intrigue }
				}
				# Heir learns about intrigue
				character_event = { id = ZE.21910 }
			}
			10 = {
				modifier = {
					factor = 0
					event_target:introduced_heir = {
						OR = {
							personality_traits = 6
							NOT = { can_copy_personality_trait_from = PREV }
						}
					}
				}
				modifier = {
					factor = 0
					event_target:introduced_heir = { has_character_flag = groom_heir_watching_me }
				}
				# Heir has been watching me
				character_event = { id = ZE.21911 }
			}
			25 = {
				# Nothing
				event_target:introduced_heir = {
					change_variable = { which = "groomed_heir" value = 1 }
				}
			}
		}
	}
}

# Father can no longer continue introduction
character_event = {
	id = ZE.21903
	picture = GFX_evt_son_asking_father
	
	desc = {
		text = EVTDESC_ZE_21903_prisoner
		trigger = {
			prisoner = yes
		}
	}
	desc = {
		text = EVTDESC_ZE_21903_hiding
		trigger = {
			prisoner = no
			is_inaccessible_trigger = yes
		}
	}
	
	is_triggered_only = yes
	major = yes
	
	major_trigger = {
		OR = {
			character = ROOT
			vassal_of = ROOT
		}
	}
	
	immediate = {
		event_target:introduced_heir = {
			clr_character_flag = introduced_heir
			clr_character_flag = groom_heir_war_warning
			clr_character_flag = groom_heir_illness_warning
		}
	}
	
	option = {
		name = OK
	}
}

# Heir can no longer continue introduction
character_event = {
	id = ZE.21904
	picture = GFX_evt_son_asking_father
	
	desc = {
		text = EVTDESC_ZE_21904_prisoner
		trigger = {
			prisoner = yes
		}
	}
	desc = {
		text = EVTDESC_ZE_21904_hiding
		trigger = {
			prisoner = no
			is_inaccessible_trigger = yes
		}
	}
	desc = {
		text = EVTDESC_ZE_21904_age
		trigger = {
			prisoner = no
			NOT = { is_inaccessible_trigger = yes }
			age = 22
		}
	}
	
	is_triggered_only = yes
	major = yes
	
	major_trigger = {
		OR = {
			character = ROOT
			vassal_of = ROOT
		}
	}
	
	immediate = {
		event_target:introduced_heir = {
			clr_character_flag = introduced_heir
			clr_character_flag = groom_heir_war_warning
			clr_character_flag = groom_heir_illness_warning
		}
	}
	
	option = {
		name = OK
	}
}	

# War delays things
character_event = {
	id = ZE.21905
	desc = EVTDESC_ZE_21905
	picture = GFX_evt_son_asking_father
	
	is_triggered_only = yes
	
	trigger = {
		ai = no
	}
	
	immediate = {
		event_target:introduced_heir = { set_character_flag = groom_heir_war_warning }
	}
	
	option = {
		name = OK
	}
}

# Illness delays things
character_event = {
	id = ZE.21906
	desc = EVTDESC_ZE_21906
	picture = GFX_evt_son_asking_father
	
	is_triggered_only = yes
	
	trigger = {
		ai = no
	}
	
	immediate = {
		event_target:introduced_heir = { set_character_flag = groom_heir_illness_warning }
	}
	
	option = {
		name = OK
	}
}

# Heir learns about stewardship
character_event = {
	id = ZE.21907
	desc = EVTDESC_ZE_21907
	picture = GFX_evt_son_asking_father
	
	is_triggered_only = yes
	
	immediate = {
		event_target:introduced_heir = {
			set_character_flag = groom_heir_learns_stewardship
			change_variable = { which = "groomed_heir" value = 1 }
		}
	}

	option = {
		name = EVTOPTA_ZE_21907
		
		event_target:introduced_heir = {
			random_list = {
				10 = {
					modifier = {
						factor = 0
						is_smart_trigger = no
					}
					modifier = {
						factor = 2
						trait = genius
					}
					modifier = {
						factor = 1.1
						ROOT = { stewardship = 12 }
					}
					modifier = {
						factor = 1.1
						ROOT = { stewardship = 14 }
					}
					modifier = {
						factor = 1.1
						ROOT = { stewardship = 16 }
					}
					modifier = {
						factor = 1.1
						ROOT = { stewardship = 18 }
					}
					modifier = {
						factor = 1.1
						ROOT = { stewardship = 20 }
					}
					change_stewardship = 2
				}
				50 = {
					modifier = {
						factor = 1.5
						is_smart_trigger = yes
					}
					modifier = {
						factor = 1.1
						ROOT = { stewardship = 12 }
					}
					modifier = {
						factor = 1.1
						ROOT = { stewardship = 14 }
					}
					modifier = {
						factor = 1.1
						ROOT = { stewardship = 16 }
					}
					modifier = {
						factor = 1.1
						ROOT = { stewardship = 18 }
					}
					modifier = {
						factor = 1.1
						ROOT = { stewardship = 20 }
					}
					change_stewardship = 1
				}
				50 = {
					modifier = {
						factor = 1.5
						is_dumb_trigger = yes
					}
					modifier = {
						factor = 1.1
						ROOT = { NOT = { stewardship = 10 } }
					}
					modifier = {
						factor = 1.1
						ROOT = { NOT = { stewardship = 8 } }
					}
					modifier = {
						factor = 1.1
						ROOT = { NOT = { stewardship = 6 } }
					}
					modifier = {
						factor = 1.1
						ROOT = { NOT = { stewardship = 4 } }
					}
					modifier = {
						factor = 1.1
						ROOT = { NOT = { stewardship = 2 } }
					}
					change_stewardship = -1
				}
				10 = {
					modifier = {
						factor = 0
						is_dumb_trigger = no
					}
					modifier = {
						factor = 2
						trait = imbecile
					}
					modifier = {
						factor = 1.1
						ROOT = { NOT = { stewardship = 10 } }
					}
					modifier = {
						factor = 1.1
						ROOT = { NOT = { stewardship = 8 } }
					}
					modifier = {
						factor = 1.1
						ROOT = { NOT = { stewardship = 6 } }
					}
					modifier = {
						factor = 1.1
						ROOT = { NOT = { stewardship = 4 } }
					}
					modifier = {
						factor = 1.1
						ROOT = { NOT = { stewardship = 2 } }
					}
					change_stewardship = -2
				}
			}
		}
	}
}
	
# Heir learns about diplomacy
character_event = {
	id = ZE.21908
	desc = EVTDESC_ZE_21908
	picture = GFX_evt_son_asking_father
	
	is_triggered_only = yes
	
	immediate = {
		event_target:introduced_heir = {
			set_character_flag = groom_heir_learns_diplomacy
			change_variable = { which = "groomed_heir" value = 1 }
		}
	}

	option = {
		name = EVTOPTA_ZE_21907
		
		event_target:introduced_heir = {
			random_list = {
				10 = {
					modifier = {
						factor = 0
						is_smart_trigger = no
					}
					modifier = {
						factor = 2
						trait = genius
					}
					modifier = {
						factor = 1.1
						ROOT = { diplomacy = 12 }
					}
					modifier = {
						factor = 1.1
						ROOT = { diplomacy = 14 }
					}
					modifier = {
						factor = 1.1
						ROOT = { diplomacy = 16 }
					}
					modifier = {
						factor = 1.1
						ROOT = { diplomacy = 18 }
					}
					modifier = {
						factor = 1.1
						ROOT = { diplomacy = 20 }
					}
					change_diplomacy = 2
				}
				50 = {
					modifier = {
						factor = 1.5
						is_smart_trigger = yes
					}
					modifier = {
						factor = 1.1
						ROOT = { diplomacy = 12 }
					}
					modifier = {
						factor = 1.1
						ROOT = { diplomacy = 14 }
					}
					modifier = {
						factor = 1.1
						ROOT = { diplomacy = 16 }
					}
					modifier = {
						factor = 1.1
						ROOT = { diplomacy = 18 }
					}
					modifier = {
						factor = 1.1
						ROOT = { diplomacy = 20 }
					}
					change_diplomacy = 1
				}
				50 = {
					modifier = {
						factor = 1.5
						is_dumb_trigger = yes
					}
					modifier = {
						factor = 1.1
						ROOT = { NOT = { diplomacy = 10 } }
					}
					modifier = {
						factor = 1.1
						ROOT = { NOT = { diplomacy = 8 } }
					}
					modifier = {
						factor = 1.1
						ROOT = { NOT = { diplomacy = 6 } }
					}
					modifier = {
						factor = 1.1
						ROOT = { NOT = { diplomacy = 4 } }
					}
					modifier = {
						factor = 1.1
						ROOT = { NOT = { diplomacy = 2 } }
					}
					change_diplomacy = -1
				}
				10 = {
					modifier = {
						factor = 0
						is_dumb_trigger = no
					}
					modifier = {
						factor = 2
						trait = imbecile
					}
					modifier = {
						factor = 1.1
						ROOT = { NOT = { diplomacy = 10 } }
					}
					modifier = {
						factor = 1.1
						ROOT = { NOT = { diplomacy = 8 } }
					}
					modifier = {
						factor = 1.1
						ROOT = { NOT = { diplomacy = 6 } }
					}
					modifier = {
						factor = 1.1
						ROOT = { NOT = { diplomacy = 4 } }
					}
					modifier = {
						factor = 1.1
						ROOT = { NOT = { diplomacy = 2 } }
					}
					change_diplomacy = -2
				}
			}
		}
	}
}

# Heir learns about martial
character_event = {
	id = ZE.21909
	desc = EVTDESC_ZE_21909
	picture = GFX_evt_son_asking_father
	
	is_triggered_only = yes
	
	immediate = {
		event_target:introduced_heir = {
			set_character_flag = groom_heir_learns_martial
			change_variable = { which = "groomed_heir" value = 1 }
		}
	}

	option = {
		name = EVTOPTA_ZE_21907
		
		event_target:introduced_heir = {
			random_list = {
				10 = {
					modifier = {
						factor = 0
						is_smart_trigger = no
					}
					modifier = {
						factor = 2
						trait = genius
					}
					modifier = {
						factor = 1.1
						ROOT = { martial = 12 }
					}
					modifier = {
						factor = 1.1
						ROOT = { martial = 14 }
					}
					modifier = {
						factor = 1.1
						ROOT = { martial = 16 }
					}
					modifier = {
						factor = 1.1
						ROOT = { martial = 18 }
					}
					modifier = {
						factor = 1.1
						ROOT = { martial = 20 }
					}
					change_martial = 2
				}
				50 = {
					modifier = {
						factor = 1.5
						is_smart_trigger = yes
					}
					modifier = {
						factor = 1.1
						ROOT = { martial = 12 }
					}
					modifier = {
						factor = 1.1
						ROOT = { martial = 14 }
					}
					modifier = {
						factor = 1.1
						ROOT = { martial = 16 }
					}
					modifier = {
						factor = 1.1
						ROOT = { martial = 18 }
					}
					modifier = {
						factor = 1.1
						ROOT = { martial = 20 }
					}
					change_martial = 1
				}
				50 = {
					modifier = {
						factor = 1.5
						is_dumb_trigger = yes
					}
					modifier = {
						factor = 1.1
						ROOT = { NOT = { martial = 10 } }
					}
					modifier = {
						factor = 1.1
						ROOT = { NOT = { martial = 8 } }
					}
					modifier = {
						factor = 1.1
						ROOT = { NOT = { martial = 6 } }
					}
					modifier = {
						factor = 1.1
						ROOT = { NOT = { martial = 4 } }
					}
					modifier = {
						factor = 1.1
						ROOT = { NOT = { martial = 2 } }
					}
					change_martial = -1
				}
				10 = {
					modifier = {
						factor = 0
						is_dumb_trigger = no
					}
					modifier = {
						factor = 2
						trait = imbecile
					}
					modifier = {
						factor = 1.1
						ROOT = { NOT = { martial = 10 } }
					}
					modifier = {
						factor = 1.1
						ROOT = { NOT = { martial = 8 } }
					}
					modifier = {
						factor = 1.1
						ROOT = { NOT = { martial = 6 } }
					}
					modifier = {
						factor = 1.1
						ROOT = { NOT = { martial = 4 } }
					}
					modifier = {
						factor = 1.1
						ROOT = { NOT = { martial = 2 } }
					}
					change_martial = -2
				}
			}
		}
	}
}

# Heir learns about intrigue
character_event = {
	id = ZE.21910
	desc = EVTDESC_ZE_21910
	picture = GFX_evt_son_asking_father
	
	is_triggered_only = yes
	
	immediate = {
		event_target:introduced_heir = {
			set_character_flag = groom_heir_learns_intrigue
			change_variable = { which = "groomed_heir" value = 1 }
		}
	}

	option = {
		name = EVTOPTA_ZE_21907
		
		event_target:introduced_heir = {
			random_list = {
				10 = {
					modifier = {
						factor = 0
						is_smart_trigger = no
					}
					modifier = {
						factor = 2
						trait = genius
					}
					modifier = {
						factor = 1.1
						ROOT = { intrigue = 12 }
					}
					modifier = {
						factor = 1.1
						ROOT = { intrigue = 14 }
					}
					modifier = {
						factor = 1.1
						ROOT = { intrigue = 16 }
					}
					modifier = {
						factor = 1.1
						ROOT = { intrigue = 18 }
					}
					modifier = {
						factor = 1.1
						ROOT = { intrigue = 20 }
					}
					change_intrigue = 2
				}
				50 = {
					modifier = {
						factor = 1.5
						is_smart_trigger = yes
					}
					modifier = {
						factor = 1.1
						ROOT = { intrigue = 12 }
					}
					modifier = {
						factor = 1.1
						ROOT = { intrigue = 14 }
					}
					modifier = {
						factor = 1.1
						ROOT = { intrigue = 16 }
					}
					modifier = {
						factor = 1.1
						ROOT = { intrigue = 18 }
					}
					modifier = {
						factor = 1.1
						ROOT = { intrigue = 20 }
					}
					change_intrigue = 1
				}
				50 = {
					modifier = {
						factor = 1.5
						is_dumb_trigger = yes
					}
					modifier = {
						factor = 1.1
						ROOT = { NOT = { intrigue = 10 } }
					}
					modifier = {
						factor = 1.1
						ROOT = { NOT = { intrigue = 8 } }
					}
					modifier = {
						factor = 1.1
						ROOT = { NOT = { intrigue = 6 } }
					}
					modifier = {
						factor = 1.1
						ROOT = { NOT = { intrigue = 4 } }
					}
					modifier = {
						factor = 1.1
						ROOT = { NOT = { intrigue = 2 } }
					}
					change_intrigue = -1
				}
				10 = {
					modifier = {
						factor = 0
						is_dumb_trigger = no
					}
					modifier = {
						factor = 2
						trait = imbecile
					}
					modifier = {
						factor = 1.1
						ROOT = { NOT = { intrigue = 10 } }
					}
					modifier = {
						factor = 1.1
						ROOT = { NOT = { intrigue = 8 } }
					}
					modifier = {
						factor = 1.1
						ROOT = { NOT = { intrigue = 6 } }
					}
					modifier = {
						factor = 1.1
						ROOT = { NOT = { intrigue = 4 } }
					}
					modifier = {
						factor = 1.1
						ROOT = { NOT = { intrigue = 2 } }
					}
					change_intrigue = -2
				}
			}
		}
	}
}

# Heir has been watching me
character_event = {
	id = ZE.21911
	desc = EVTDESC_ZE_21911
	picture = GFX_evt_son_asking_father
	
	is_triggered_only = yes
	
	immediate = {
		event_target:introduced_heir = {
			set_character_flag = groom_heir_watching_me
			change_variable = { which = "groomed_heir" value = 1 }
		}
	}

	option = {
		name = EVTOPTA_ZE_21911
		event_target:introduced_heir = {
			copy_random_personality_trait = ROOT
		}
	}
}

# Introduce Heir End Event
character_event = {
	id = ZE.22901
	desc = EVTDESC_ZE_22901
	picture = GFX_evt_son_asking_father
	
	is_triggered_only = yes
	
	trigger = {
		event_target:introduced_heir = { is_alive = yes }
	}
	
	option = {
		name = EVTOPTA_ZE_22901
		
		event_target:introduced_heir = { 
			clr_character_flag = introduced_heir
			clr_character_flag = groom_heir_war_warning
			clr_character_flag = groom_heir_illness_warning
			add_character_modifier = {
				modifier = groomed_to_perfection
				years = 20
			}
		}
		
	}
}

# Vassal offers to teach heir the Scripture
character_event = {
	id = ZE.22902
	desc = EVTDESC_ZE_22902
	picture = GFX_evt_church_council
	
	is_triggered_only = yes
	
	immediate = {
		random_vassal = {
			limit = {
				ai = yes
				religion = ROOT
				prisoner = no
				piety = 0
				NOR = {
					holds_favor_on = ROOT
					trait = incapable
					is_inaccessible_trigger = yes
				}
				OR = {
					trait = theologian
					trait = scholar
					learning = 12
				}
			}
			save_event_target_as = vassal_teacher
		}
		event_target:introduced_heir = {
			set_character_flag = groom_heir_taught_scripture
			change_variable = { which = "groomed_heir" value = 1 }
		}
	}
	
	#Accept offer
	option = {
		name = EVTOPTA_ZE_22902
		
		event_target:introduced_heir = { 
			change_learning = 1
			piety = 50
		}
		event_target:vassal_teacher = { 
			add_favor = ROOT 
		}
	}
	
	#Decline offer
	option = {
		name = EVTOPTB_ZE_22902
		
		piety = -50
		
		event_target:vassal_teacher = { 
			opinion = {
				modifier = opinion_disappointed
				who = ROOT
				years = 10
			}
		}

	}
}

# Heir impresses vassal
character_event = {
	id = ZE.22903
	desc = EVTDESC_ZE_22903
	picture = GFX_evt_dancing
	
	is_triggered_only = yes
	
	immediate = {
		random_vassal = {
			limit = {
				ai = yes
				is_adult = yes
				prisoner = no
				war = no
				NOR = {
					trait = incapable
					is_inaccessible_trigger = yes
					has_opinion_modifier = {
						modifier = insulted
						who = event_target:introduced_heir
					}
					has_opinion_modifier = {
						modifier = opinion_impressed
						who = event_target:introduced_heir
					}
				}
			}
			save_event_target_as = compliment_vassal
		}
		event_target:introduced_heir = {
			set_character_flag = groom_heir_impressed_vassal
			change_variable = { which = "groomed_heir" value = 1 }
		}
	}
	
	option = {
		name = EVTOPTA_ZE_22903
		
		event_target:compliment_vassal = {
			opinion = {
				modifier = opinion_impressed
				who = event_target:introduced_heir
				years = 20
			}
		}
		
	}
}

# Heir insults vassal
character_event = {
	id = ZE.22904
	desc = EVTDESC_ZE_22904
	picture = GFX_evt_accused
	
	is_triggered_only = yes
	
	immediate = {
		random_vassal = {
			limit = {
				ai = yes
				prisoner = no
				is_adult = yes
				war = no
				NOR = {
					trait = incapable
					is_inaccessible_trigger = yes
					has_opinion_modifier = {
						modifier = insulted
						who = event_target:introduced_heir
					}
					has_opinion_modifier = {
						modifier = opinion_impressed
						who = event_target:introduced_heir
					}
				}
			}
			save_event_target_as = insult_vassal
		}
		event_target:introduced_heir = {
			set_character_flag = groom_heir_insulted_vassal
			change_variable = { which = "groomed_heir" value = 1 }
		}
	}
	
	option = {
		name = EVTOPTA_ZE_22904
		
		event_target:insult_vassal = {
			opinion = {
				modifier = insulted
				who = event_target:introduced_heir
				years = 20
			}
		}
		
	}
}

# Heir befriends vassal child
character_event = {
	id = ZE.22905
	picture = GFX_evt_child_sword
	
	desc = {
		text = EVTDESC_ZE_22905
		trigger = {
			event_target:befriended_child = {
				NOT = { vassal_of = ROOT }
			}
		}
	}
	desc = {
		text = EVTDESC_ZE_22905_vassal
		trigger = {
			event_target:befriended_child = {
				vassal_of = ROOT
			}
		}
	}			
	
	is_triggered_only = yes
	
	immediate = {
		random_realm_character = {
			limit = {
				ai = yes
				prisoner = no
				OR = {
					father = { vassal_of = ROOT }
					mother = { vassal_of = ROOT }
					vassal_of = ROOT
				}
				NOR = {
					age = 23
					is_friend = event_target:introduced_heir 
					is_rival = event_target:introduced_heir
					is_child_of = ROOT
					age_diff = { who = event_target:introduced_heir years = 5 }
					trait = incapable
					is_inaccessible_trigger = yes
				}
			}
			save_event_target_as = befriended_child
		}
		event_target:introduced_heir = {
			set_character_flag = groom_heir_befriend_child
			change_variable = { which = "groomed_heir" value = 1 }
		}
	}
	
	option = {
		name = EVTOPTA_ZE_22905
		
		event_target:introduced_heir = { 
			add_friend = event_target:befriended_child
		}
		
	}
}

# Heir rivals vassal child
character_event = {
	id = ZE.22906
	picture = GFX_evt_child_bully
	
	desc = {
		text = EVTDESC_ZE_22906
		trigger = {
			event_target:rival_child = {
				NOT = { vassal_of = ROOT }
			}
		}
	}
	desc = {
		text = EVTDESC_ZE_22906_vassal
		trigger = {
			event_target:rival_child = {
				vassal_of = ROOT
			}
		}
	}
	
	is_triggered_only = yes
	
	immediate = {
		random_realm_character = {
			limit = {
				ai = yes
				prisoner = no
				OR = {
					father = { vassal_of = ROOT }
					mother = { vassal_of = ROOT }
					vassal_of = ROOT
				}
				NOR = {
					age = 23
					is_friend = event_target:introduced_heir 
					is_rival = event_target:introduced_heir
					is_child_of = ROOT
					age_diff = { who = event_target:introduced_heir years = 5 }
					trait = incapable
					is_inaccessible_trigger = yes
				}
			}
			save_event_target_as = rival_child
		}
		event_target:introduced_heir = {
			set_character_flag = groom_heir_rival_child
			change_variable = { which = "groomed_heir" value = 1 }
		}
	}
	
	option = {
		name = EVTOPTA_ZE_22906
		
		event_target:introduced_heir = { 
			add_rival = event_target:rival_child
		}
		
	}
}

# Heir becomes depressed
character_event = {
	id = ZE.22907
	desc = EVTDESC_ZE_22907
	picture = GFX_evt_bad_news
	
	is_triggered_only = yes
	
	immediate = {
		event_target:introduced_heir = {
			set_character_flag = groom_heir_becomes_depressed
			change_variable = { which = "groomed_heir" value = 1 }
		}
	}
	
	option = {
		name = EVTOPTA_ZE_22907
		
		event_target:introduced_heir = {
			emf_notify_add_depressed_effect = yes
			hidden_tooltip = {
				character_event = {	id = 38314 days = 1000 random = 800 }
			}
		}
		
	}
}

# Vassal offers to teach heir to fight
character_event = {
	id = ZE.22908
	desc = EVTDESC_ZE_22908
	picture = GFX_evt_family_feud_republic
	
	is_triggered_only = yes
	
	immediate = {
		random_vassal = {
			limit = {
				ai = yes
				prisoner = no
				is_adult = yes
				war = no
				NOR = {
					holds_favor_on = ROOT
					trait = incapable
					is_inaccessible_trigger = yes
				}
				OR = {
					trait = strategist
					trait = duelist
					martial = 12
				}
			}
			save_event_target_as = vassal_teacher_martial
		}
		event_target:introduced_heir = {
			set_character_flag = groom_heir_taught_to_fight
			change_variable = { which = "groomed_heir" value = 1 }
		}
	}
	
	#Accept offer
	option = {
		name = EVTOPTA_ZE_22908
		
		event_target:introduced_heir = { 
			change_martial = 1
			prestige = 50
		}
		event_target:vassal_teacher_martial = { 
			add_favor = ROOT 
		}
	}
	
	#Decline offer
	option = {
		name = EVTOPTB_ZE_22908
		
		prestige = -50
		
		event_target:vassal_teacher_martial = { 
			opinion = {
				modifier = opinion_disappointed
				who = ROOT
				years = 10
			}
		}

	}
}

# Heir is infatuated with vassal's spouse
character_event = {
	id = ZE.22909
	desc = EVTDESC_ZE_22909
	picture = GFX_evt_princess_byzantine
	
	is_triggered_only = yes
	
	immediate = {
		random_vassal = {
			limit = {
				is_female = no
				ai = yes
				is_married = yes
				prisoner = no
				war = no
				NOR = {
					trait = incapable
					is_inaccessible_trigger = yes
				}
				any_spouse = {
					is_female = yes
					ai = yes
					is_ill = no
					prisoner = no
					is_landed = no
					NOT = { age = 30 }
					NOR = {
						trait = ugly
						trait = clubfooted
						trait = harelip
						trait = hunchback
						trait = dwarf
						trait = imbecile
						trait = inbred
						trait = wrymouth
						is_dumb_trigger = yes
						trait = incapable
						is_inaccessible_trigger = yes
						is_rival = event_target:introduced_heir
					}
				}
			}
			save_event_target_as = husband_target
			random_spouse = {
				limit = {
					is_female = yes
					ai = yes
					is_ill = no
					prisoner = no
					is_landed = no
					NOT = { age = 30 }
					NOR = {
						trait = ugly
						trait = clubfooted
						trait = harelip
						trait = hunchback
						trait = dwarf
						trait = imbecile
						trait = inbred
						trait = wrymouth
						is_dumb_trigger = yes
						trait = incapable
						is_inaccessible_trigger = yes
						is_rival = event_target:introduced_heir
					}
				}
				save_event_target_as = wife_target
			}
		}
		event_target:introduced_heir = {
			set_character_flag = groom_heir_infatuation
			change_variable = { which = "groomed_heir" value = 1 }
		}
	}
	
	option = {
		name = EVTOPTA_ZE_22909
		
		event_target:introduced_heir = {
			opinion = {
				modifier = teenage_infatuation
				who = event_target:wife_target
				years = 10
			}
		}
		
		event_target:husband_target = {
			opinion = {
				modifier = opinion_disapprove
				who = event_target:introduced_heir
				years = 10
			}
		}
		
	}
}

