# -*- ck2.events -*-

###################################
#
# Events for Feasts
#
# Id 72000 - 72999 is reserved
#
# Fired from on actions
#
###################################
#
# Designed by Johan Andersson
# Written by Sara Wendel-Örtqvist

###################################
#Events before the Feast
###################################

character_event = {
	id = 72109
	desc = "EVTDESC72109"
	picture = GFX_evt_feast
	
	is_triggered_only = yes

	option = {
		name = "EVTOPTA72109"
		hidden_tooltip = {
			random_list = {
				20 = { #Jongleurs seek your patronage
					character_event = { id = 72000 days = 5 }
				}
				20 = { #Minstrel seeks your patronage
					character_event = { id = 72001 days = 5 }
				}
				20 = { #Musicians seek your patronage
					character_event = { id = 72002 days = 5 }
				}
				20 = { #Fire-eaters seek your patronage
					character_event = { id = 72006 days = 5 }
				}
				20 = { #Conjurer seeks your patronage
					character_event = { id = 72007 days = 5 }
				}
				20 = { #Acrobats seek your patronage
					character_event = { id = 72009 days = 5 }
				}
				20 = { #Travelling Dancers seek your patronage
					character_event = { id = 72120 days = 5 }
				}
			}
			random_list = {
				15 = { #Jongleurs seek your patronage #2
					character_event = { id = 72000 days = 10 }
				}
				15 = { #Minstrel seeks your patronage #2
					character_event = { id = 72001 days = 10 }
				}
				15 = { #Musicians seek your patronage #2
					character_event = { id = 72002 days = 10 }
				}
				15 = { #Fire-eaters seek your patronage #2
					character_event = { id = 72006 days = 10 }
				}
				15 = { #Conjurer seeks your patronage #2
					character_event = { id = 72007 days = 10 }
				}
				15 = { #Acrobats seek your patronage #2
					character_event = { id = 72009 days = 10 }
				}
				15 = { #Travelling Dancers seek your patronage #2
					character_event = { id = 72120 days = 10 }
				}
				5 = { #Castle problems
					modifier = {
						factor = 0
						NOT = {
							any_courtier = {
								has_job_title = job_treasurer
							}
						}
					}
					character_event = { id = 72004 days = 10 }
				}
				5 = { #Highway Robber Band
					modifier = {
						factor = 0
						NOR = {
							any_courtier = {
								has_job_title = job_marshal
							}
							location = {
								has_province_modifier = highway_robber_band
							}
						}
					}
					character_event = { id = 72005 days = 10 }
				}
				30 = { #Hunt for boars for winter feast
					modifier = {
						factor = 0
						NOT = {
							any_courtier = {
								has_job_title = job_marshal
							}
						}
					}
					character_event = { id = 72008 days = 10 }
				}
			}
			character_event = {
				id = 72003
				days = 15
				random = 2
			}
		}
	}
}

### A troop of wandering jongleurs seek your patronage ###
character_event = {
	id = 72000
	desc = "EVTDESC72000"
	picture = GFX_evt_jugglers

	prisoner = no
	only_rulers = yes
	capable_only = yes
	war = no

	is_triggered_only = yes

	trigger = {
		has_character_modifier = holding_large_feast
		NOT = {
			has_character_flag = feast_jongleur
		}
	}

	option = {
		name = "EVTOPTA72000"
		ai_chance = {
			factor = 5

			modifier = {
				factor = 0.1
				NOT = {
					treasury = 30
				}
			}
			modifier = {
				factor = 30
				treasury = 30
			}
		}
		treasury = -10
		set_character_flag = feast_jongleur
	}
	option = {
		name = "EVTOPTB72000"
		ai_chance = {
			factor = 5

			modifier = {
				factor = 30
				NOT = {
					treasury = 30
				}
			}
			modifier = {
				factor = 0.1
				treasury = 30
			}
		}
		prestige = -10
	}
}

#A traveling minstrel seeks your patronage
character_event = {
	id = 72001
	desc = "EVTDESC72001"
	picture = GFX_evt_feast

	prisoner = no
	only_rulers = yes
	capable_only = yes
	war = no

	is_triggered_only = yes

	trigger = {
		has_character_modifier = holding_large_feast
		NOT = {
			has_character_flag = feast_minstrel
		}
	}

	option = {
		name = "EVTOPTA72001"
		ai_chance = {
			factor = 5

			modifier = {
				factor = 0.1
				NOT = {
					treasury = 30
				}
			}
			modifier = {
				factor = 30
				treasury = 30
			}
		}
		set_character_flag = feast_minstrel
		treasury = -10
	}
	option = {
		name = "EVTOPTB72001"
		ai_chance = {
			factor = 5

			modifier = {
				factor = 30
				NOT = {
					treasury = 30
				}
			}
			modifier = {
				factor = 0.1
				treasury = 30
			}
		}
		prestige = -10
	}
}

#Musicians seek your patronage
character_event = {
	id = 72002
	desc = "EVTDESC72002"
	picture = GFX_evt_feast

	only_rulers = yes
	capable_only = yes
	prisoner = no
	war = no

	is_triggered_only = yes

	trigger = {
		has_character_modifier = holding_large_feast
		NOT = {
			has_character_flag = feast_musicians
		}
	}

	option = {
		name = "EVTOPTA72002"
		ai_chance = {
			factor = 5

			modifier = {
				factor = 0.1
				NOT = {
					treasury = 30
				}
			}
			modifier = {
				factor = 30
				treasury = 30
			}
		}
		set_character_flag = feast_musicians
		treasury = -10
	}
	option = {
		name = "EVTOPTB72002"
		ai_chance = {
			factor = 5

			modifier = {
				factor = 30
				NOT = {
					treasury = 30
				}
			}
			modifier = {
				factor = 0.1
				treasury = 30
			}
		}
		prestige = -10
	}
}

#Food Preparations
character_event = {
	id = 72003
	desc = "EVTDESC72003"
	picture = GFX_evt_feast

	only_rulers = yes
	capable_only = yes
	prisoner = no
	war = no

	is_triggered_only = yes

	trigger = {
		has_character_modifier = holding_large_feast
		NOT = {
			has_character_flag = lavishly_food
		}
		NOT = {
			has_character_flag = medium_food
		}
		NOT = {
			has_character_flag = low_food
		}
	}

	option = {
		name = "EVTOPTA72003" #Spend lavishly on food
		trigger = { NOT = { trait = temperate } }
		ai_chance = {

			factor = 30

			modifier = {
				factor = 0.5
				trait = greedy
			}
			modifier = {
				factor = 3
				trait = gluttonous
			}
			modifier = {
				factor = 0.1
				trait = temperate
			}
			modifier = {
				factor = 2
				primary_title = { higher_tier_than = DUKE }
			}
		}
		set_character_flag = lavishly_food
		treasury = -20
		prestige = 10
		hidden_tooltip = {
			character_event = {
				id = 72010
				days = 2
				random = 5
			}
		}
	}
	option = {
		name = "EVTOPTB72003" #Spend medium on food
		ai_chance = {
			factor = 30

			modifier = {
				factor = 0.5
				NOT = { trait = greedy }
			}
			modifier = {
				factor = 2
				NOT = { trait = gluttonous }
			}
			modifier = {
				factor = 2
				primary_title = { tier = DUKE }
			}
		}
		set_character_flag = medium_food
		treasury = -10
		hidden_tooltip = {
			character_event = {
				id = 72010
				days = 2
				random = 5
			}
		}

	}
	option = {
		name = "EVTOPTC72003" #Spend low on food
		trigger = { NOT = { trait = gluttonous } }
		ai_chance = {
			factor = 30

			modifier = {
				factor = 2.5
				trait = greedy
			}
			modifier = {
				factor = 0.1
				trait = gluttonous
			}
			modifier = {
				factor = 2
				primary_title = { tier = COUNT }
			}
		}
		set_character_flag = low_food
		treasury = -5
		prestige = -5
		hidden_tooltip = {
			character_event = {
				id = 72010
				days = 2
				random = 5
			}
		}

	}
}

#Castle problems
character_event = {
	id = 72004
	desc = "EVTDESC72004"
	picture = GFX_evt_castle_construction

	only_rulers = yes
	capable_only = yes
	prisoner = no
	war = no

	is_triggered_only = yes

	trigger = {
		has_character_modifier = holding_large_feast
		NOT = {
			has_character_flag = castle_problems
		}
		NOT = {
			has_character_flag = sent_invitations
		}
		any_courtier = {
			has_job_title = job_treasurer
		}
	}

	option = {
		name = "EVTOPTA72004"
		set_character_flag = castle_problems
		scaled_wealth = -0.2
	}
}

#Send Marshal to deal with Highway Robber Band
character_event = {
	id = 72005
	desc = "EVTDESC72005"
	picture = GFX_evt_bandits

	only_rulers = yes
	capable_only = yes
	prisoner = no
	war = no

	is_triggered_only = yes

	trigger = {
		has_character_modifier = holding_large_feast
		NOT = {
			has_character_flag = sent_invitations
		}
		any_courtier = {
			has_job_title = job_marshal
		}
		location = {
			has_province_modifier = highway_robber_band
		}
	}

	option = {
		name = "EVTOPTA72005"
		job_marshal = {
			random_list = {
				5 = {
					death = { death_reason = death_rabble }
				}
				50 = {
					ROOT = {
						location = {
							remove_province_modifier = highway_robber_band
						}
					}
				}
				45 = {
				}
			}
		}
	}
	option = {
		name = "EVTOPTB72005"
		prestige = -10
	}
}

#Fire-eaters seek your patronage
character_event = {
	id = 72006
	desc = "EVTDESC72006"
	picture = GFX_evt_feast

	only_rulers = yes
	capable_only = yes
	prisoner = no
	war = no

	is_triggered_only = yes

	trigger = {
		has_character_modifier = holding_large_feast
		NOT = {
			has_character_flag = sent_invitations
		}
		NOT = {
			has_character_flag = host_feast_started
		}
		NOT = {
			has_character_flag = feast_fireeaters
		}
	}

	option = {
		name = "EVTOPTA72006"
		ai_chance = {
			factor = 5

			modifier = {
				factor = 0.1
				NOT = {
					treasury = 30
				}
			}
			modifier = {
				factor = 20
				treasury = 30
			}
		}
		set_character_flag = feast_fireeaters
		treasury = -10
	}
	option = {
		name = "EVTOPTB72006"
		ai_chance = {
			factor = 5

			modifier = {
				factor = 20
				NOT = {
					treasury = 30
				}
			}
			modifier = {
				factor = 0.1
				treasury = 30
			}
		}
		prestige = -10
	}
}

#A Conjurer seeks your patronage
character_event = {
	id = 72007
	desc = "EVTDESC72007"
	picture = GFX_evt_feast

	only_rulers = yes
	capable_only = yes
	prisoner = no
	war = no

	is_triggered_only = yes

	trigger = {
		has_character_modifier = holding_large_feast
		NOT = {
			has_character_flag = sent_invitations
		}
		NOT = {
			has_character_flag = host_feast_started
		}
		NOT = {
			has_character_flag = feast_conjurer
		}
	}

	option = {
		name = "EVTOPTA72007"
		ai_chance = {
			factor = 5

			modifier = {
				factor = 0.1
				NOT = {
					treasury = 30
				}
			}
			modifier = {
				factor = 20
				treasury = 30
			}
		}
		set_character_flag = feast_conjurer
		treasury = -10
	}
	option = {
		name = "EVTOPTB72007"
		ai_chance = {
			factor = 5

			modifier = {
				factor = 20
				NOT = {
					treasury = 30
				}
			}
			modifier = {
				factor = 0.1
				treasury = 30
			}
		}
		prestige = -10
	}
}

#Hunt for boars for winter feast
character_event = {
	id = 72008
	desc = "EVTDESC72008"
	picture = GFX_evt_hunt

	prisoner = no
	capable_only = yes
	war = no

	is_triggered_only = yes

	trigger = {
		NOT = { religion_group = jewish_group }
		has_character_modifier = holding_large_feast
		NOT = {
			has_character_flag = sent_invitations
		}
		NOT = {
			has_character_flag = feast_boar_hunt
		}
		NOT = {
			has_character_flag = host_feast_started
		}
		any_courtier = {
			has_job_title = job_marshal
		}
	}

	immediate = {
		set_character_flag = feast_boar_hunt
	}

	option = {
		name = "EVTOPTA72008"
		job_marshal = {
			prestige = 10
			opinion = {
				modifier = opinion_flattered
				who = ROOT
				years = 10
			}
			random_list = {
				80 = { }
				10 = { change_martial = 1 }
				7 = {
					add_trait = wounded
					hidden_tooltip = { character_event = { id = 38280 } }
				}
				2 = {
					add_maimed_trait_effect = yes
					hidden_tooltip = { character_event = { id = 38281 } }
				}
				1 = {
					death = { death_reason = death_accident_boar }
				}
			}
		}
	}
	option = {
		name = "EVTOPTB72008"
		trigger = {
			any_child = {
				age = 14
				is_female = no
				is_abroad = no
				prisoner = no
				liege = { character = ROOT }
				NOT = { health_traits = 1 }
				is_alive = yes
			}
		}
		random_child = {
			limit = {
				age = 14
				is_female = no
				is_abroad = no
				prisoner = no
				liege = { character = ROOT }
				NOT = { health_traits = 1 }
				is_alive = yes
			}
			prestige = 10
			opinion = {
				modifier = opinion_flattered
				who = ROOT
				years = 10
			}
			random_list = {
				80 = { }
				10 = { change_martial = 1 }
				7 = {
					add_trait = wounded
					hidden_tooltip = { character_event = { id = 38280 } }
				}
				2 = {
					add_maimed_trait_effect = yes
				}
				1 = {
					death = { death_reason = death_accident_boar }
				}
			}
		}
	}
	option = {
		name = "EVTOPTC72008"
		trigger = {
			age = 14
			is_female = no
			NOT = { health_traits = 1 }
			NOT = { trait = craven }
		}
		prestige = 10
		random_list = {
			80 = { }
			10 = { change_martial = 1 }
			7 = {
				add_trait = wounded
				hidden_tooltip = { character_event = { id = 38280 } }
			}
			2 = {
				add_maimed_trait_effect = yes
			}
			1 = {
				death = { death_reason = death_accident_boar }
			}
		}
	}
	option = {
		name = "EVTOPTD72008"
	}
}

#Acrobats seek your patronage
character_event = {
	id = 72009
	desc = "EVTDESC72009"
	picture = GFX_evt_feast

	only_rulers = yes
	capable_only = yes
	prisoner = no
	war = no

	is_triggered_only = yes

	trigger = {
		has_character_modifier = holding_large_feast
		NOT = {
			has_character_flag = sent_invitations
		}
		NOT = {
			has_character_flag = host_feast_started
		}
		NOT = {
			has_character_flag = feast_acrobats
		}
	}

	option = {
		name = "EVTOPTA72009"
		ai_chance = {
			factor = 5

			modifier = {
				factor = 0.1
				NOT = {
					treasury = 30
				}
			}
			modifier = {
				factor = 20
				treasury = 30
			}
		}
		set_character_flag = feast_acrobats
		treasury = -10
	}
	option = {
		name = "EVTOPTB72009"
		ai_chance = {
			factor = 5

			modifier = {
				factor = 20
				NOT = {
					treasury = 30
				}
			}
			modifier = {
				factor = 0.1
				treasury = 30
			}
		}
		prestige = -10
	}
}

###################################
#Invitations to Feast
###################################

#Send invites
character_event = {
	id = 72010
	desc = "EVTDESC72010"
	picture = GFX_evt_feast

	is_triggered_only = yes

	only_rulers = yes
	capable_only = yes
	prisoner = no
	war = no

	trigger = {
		has_character_modifier = holding_large_feast
		OR = {
			has_character_flag = lavishly_food
			has_character_flag = medium_food
			has_character_flag = low_food
		}
		NOT = {
			has_character_flag = sent_invitations
		}
	}
	
	option = {
		name = "EVTOPTA72010"
		set_character_flag = sent_invitations
		custom_tooltip = {
			text = EVTTOOLTIP1_RoI_1000
		}
		hidden_tooltip = {
			character_event = { id = 72015 days = 20 }
			any_vassal = {
				limit = {
					NOT = { is_inaccessible_trigger = yes }
					prisoner = no
					NOT = { has_character_flag = do_not_disturb }
					NOT = { trait = incapable }
					NOT = { has_character_modifier = holding_large_feast }
					war = no
					is_adult = yes
				}
				letter_event = {
					id = 72011
					days = 2
					#tooltip = "EVTTOOLTIP72011"
				}
			}
		}
	}
}

#Vassal is invited to the feast
letter_event = {
	id = 72011
	desc = "EVTDESC72011"

	is_triggered_only = yes
	
	trigger = { NOT = { is_inaccessible_trigger = yes } }

	option = {
		name = "EVTOPTA72011" #Travel to the feast
		ai_chance = {
			factor = 1
			modifier = {
				factor = 2
				opinion = { who = from value = -40 }
			}
			modifier  = {
				factor = 2
				opinion = { who = from value = -20 }
			}
		}
		set_character_flag = coming_to_feast
	}
	option = {
		name = "EVTOPTB72011" #Refuse
		ai_chance = {
			factor = 1
			modifier  = {
				factor = 2
				NOT = { opinion = { who = from value = -60 } }
			}
			modifier  = {
				factor = 2
				NOT = { opinion = { who = from value = -80 } }
			}
		}
		FROM = {
			letter_event = {
				id = 72012
				days = 1
				random = 2
				tooltip = "EVTTOOLTIP72012"
			}
		}
	}
}

#Vassal refused to come to the feast
letter_event = {
	id = 72012
	desc = "EVTDESC72012"

	is_triggered_only = yes

	option = {
		name = "EVTOPTA72012"
		opinion = {
			modifier = opinion_dislike
			who = FROM
			years = 10
		}
	}
}

###################################
#Events during feast
###################################

#The guests have arrived
character_event = {
	id = 72015
	desc = "EVTDESC72015"
	picture = GFX_evt_feast

	only_rulers = yes
	capable_only = yes
	prisoner = no
	war = no

	is_triggered_only = yes

	trigger = {
		has_character_modifier = holding_large_feast
		has_character_flag = sent_invitations
		NOT = {
			has_character_flag = host_feast_started
		}
		any_vassal = {
			NOT = {
				has_character_flag = guest_feast_started
			}
			has_character_flag = coming_to_feast
		}
	}

	option = {
		name = "EVTOPTA72015"
		set_character_flag = host_feast_started
		hidden_tooltip = { 
			any_vassal = {
				limit = {
					has_character_flag =  coming_to_feast
				}
				character_event = {
					id = 72016
					tooltip = "EVTTOOLTIP72016"
				}
			}
			random_list = { #First wave of events
				10 = { #Lavish food (vassal)
					modifier = {
						factor = 0
						NOR = {
							has_character_flag = lavishly_food
							any_vassal = {
								has_character_flag = guest_feast_started
								war = no
							}
						}
					}
					random_vassal = {
						limit = { 
							has_character_flag = guest_feast_started
							war = no
						}
						character_event = { id = 72020 days = 3 }
					}
				}
				10 = { #Medium food (vassal)
					modifier = {
						factor = 0
						NOR = {
							has_character_flag = medium_food
							any_vassal = {
								has_character_flag = guest_feast_started
								war = no
							}
						}
					}
					random_vassal = {
						limit = { 
							has_character_flag = guest_feast_started
							war = no
						}
						character_event = { id = 72021 days = 3 }
					}
				}
				10 = { #Low food (vassal)
					modifier = {
						factor = 0
						NOR = {
							has_character_flag = low_food
							any_vassal = {
								has_character_flag = guest_feast_started
								war = no
							}
						}
					}
					random_vassal = {
						limit = { 
							has_character_flag = guest_feast_started
							war = no
						}
						character_event = { id = 72022 days = 3 }
					}
				}
				10 = { #Jongleurs entertain guest (liege)
					modifier = {
						factor = 0
						NOR = {
							has_character_flag = feast_jongleur
							any_vassal = {
								war = no
								has_character_flag = guest_feast_started
							}
						}
					}
					character_event = { id = 72063 days = 3 }
				}
				10 = { #Ministrel entertain the guests (liege)
					modifier = {
						factor = 0
						NOR = {
							has_character_flag = feast_minstrel
							any_vassal = {
								war = no
								has_character_flag = guest_feast_started
							}
						}
					}
					character_event = { id = 72065 days = 3 }
				}
				10 = { #Musicians entertain the guests (liege)
					modifier = {
						factor = 0
						NOR = {
							has_character_flag = feast_musicians
							any_vassal = {
								war = no
								has_character_flag = guest_feast_started
							}
						}
					}
					character_event = { id = 72067 days = 3 }
				}
				10 = { #Fire-eaters entertain the guests (liege)
					modifier = {
						factor = 0
						NOR = {
							has_character_flag = feast_fireeaters
							any_vassal = {
								war = no
								has_character_flag = guest_feast_started
							}
						}
					}
					character_event = { id = 72069 days = 3 }
				}
				10 = { #Conjurer entertain the guests (liege)
					modifier = {
						factor = 0
						NOR = {
							has_character_flag = feast_conjurer
							any_vassal = {
								war = no
								has_character_flag = guest_feast_started
							}
						}
					}
					character_event = { id = 72071 days = 3 }
				}
				10 = { #Conjurer entertain the guests (liege)
					modifier = {
						factor = 0
						NOR = {
							war = no
							in_command = no
							has_character_flag = feast_dancers
							has_character_modifier = holding_large_feast
							has_character_flag = host_feast_started
						}
					}
					character_event = { id = 4165 days = 3 }
				}
				10 = { #Conjurer entertain the guests (liege)
					modifier = {
						factor = 0
						NOR = {
							war = no
							in_command = no
							has_character_flag = feast_acrobats
							has_character_modifier = holding_large_feast
							has_character_flag = host_feast_started
						}
					}
					character_event = { id = 4160 days = 3 }
				}
				#10 = {} #Empty as fallback
			}
			random_list = { # Second wave of events
				10 = { #Jester makes bad joke (Liege)
					modifier = {
						factor = 0
						NOR = {
							any_courtier = {
								has_minor_title = title_court_jester
								NOT = {
									opinion = { who = ROOT value = 25 }
								}
							}
							any_vassal = {
								has_character_flag = guest_feast_started
							}
						}
					}
					character_event = { id = 72060 days = 10 }
				}
				10 = { #Highway robber band (vassal)
					modifier = {
						factor = 0
						NOR = {
							any_vassal = {
								war = no
								has_character_flag = guest_feast_started
								any_liege = {
									war = no
									has_character_flag = host_feast_started
									has_character_modifier = holding_large_feast
									location = {
										has_province_modifier = highway_robber_band
									}
								}
							}
						}
					}
					random_vassal = {
						limit = {
							war = no
							has_character_flag = guest_feast_started
							any_liege = {
								war = no
								has_character_flag = host_feast_started
								has_character_modifier = holding_large_feast
								location = {
									has_province_modifier = highway_robber_band
								}
							}
						}
						character_event = { id = 72050 days = 10 }
					}
				}
				10 = { #Claim on visitors title (Liege)
					modifier = {
						factor = 0
						NOR = {
							war = no
							has_character_flag = host_feast_started
							has_character_modifier = holding_large_feast
							any_claim = {
								holder_scope = {
									war = no
									has_character_flag = guest_feast_started
									vassal_of = ROOT
								}
							}
						}
					}
					character_event = { id = 72085 days = 10 }
				}
				30 = { #Duel (vassal)
					modifier = {
						factor = 0
						NOR = {
							any_vassal = {
								is_adult = yes
								war = no
								has_character_flag = guest_feast_started
								can_be_maimed_trigger = yes
								NOT = {
									trait = wounded
								}
								martial = 9
								OR = {
									trait = duelist
									trait = brave
									trait = wroth
									trait = cruel
								}
								NOT = {
									trait = craven
								}
								any_liege = {
									war = no
									has_character_modifier = holding_large_feast
									has_character_flag = host_feast_started
									any_vassal = {
										is_adult = yes
										has_character_flag = guest_feast_started
										NOT = {
											character = PREVPREV
										}
										NOT = {
											reverse_opinion = { who = PREVPREV value = -50 }
										}
										NOT = {
											opinion = { who = PREVPREV value = -50 }
										}
										NOT = {
											trait = wounded
										}
										can_be_maimed_trigger = yes
									}
								}
							}
						}
					}
					random_vassal = {
						limit = {
							is_adult = yes
							war = no
							has_character_flag = guest_feast_started
							NOT = {
								trait = wounded
							}
							can_be_maimed_trigger = yes
							martial = 9
							OR = {
								trait = duelist
								trait = brave
								trait = wroth
								trait = cruel
							}
							NOT = {
								trait = craven
							}
							any_liege = {
								war = no
								has_character_modifier = holding_large_feast
								has_character_flag = host_feast_started
								any_vassal = {
									is_adult = yes
									has_character_flag = guest_feast_started
									NOT = {
										character = PREVPREV
									}
									NOT = {
										reverse_opinion = { who = PREVPREV value = -50 }
									}
									NOT = {
										opinion = { who = PREVPREV value = -50 }
									}
									NOT = {
										trait = wounded
									}
									can_be_maimed_trigger = yes
								}
							}
						}
						character_event = { id = 72030 days = 10 }
					}
				}
				10 = { #Late night talk become friends 1 (vassal)
					modifier = {
						factor = 0
						NOR = {
							any_vassal = {
								is_adult = yes
								war = no
								NOT = { num_of_friends = 3 }
								has_character_flag = guest_feast_started
								any_realm_character = {
									same_liege = PREV
									liege = {
										has_character_flag = host_feast_started
										has_character_modifier = holding_large_feast
									}
									is_adult = yes
									NOT = { num_of_friends = 3 }
									has_character_flag = guest_feast_started
									NOT = {
										character = PREV
										any_claim = {
											holder_scope = {
												character = PREV
											}
										}
										PREV = {
											any_claim = {
												holder_scope = {
													character = PREVPREV
												}
											}
										}
									}
									NOT = { is_friend = PREV }
								}
							}
						}
					}
					random_vassal = {
						limit = {
							is_adult = yes
							war = no
							NOT = { num_of_friends = 3 }
							has_character_flag = guest_feast_started
							any_realm_character = {
								same_liege = PREV
								liege = {
									has_character_flag = host_feast_started
									has_character_modifier = holding_large_feast
								}
								is_adult = yes
								NOT = { num_of_friends = 3 }
								has_character_flag = guest_feast_started
								NOT = {
									character = PREV
									any_claim = {
										holder_scope = {
											character = PREV
										}
									}
									PREV = {
										any_claim = {
											holder_scope = {
												character = PREVPREV
											}
										}
									}
								}
								NOT = { is_friend = PREV }
							}
						}
						character_event = { id = 72025 days = 10 }
					}
				}
				10 = { #Late night talk become friends 2 (vassal)
					modifier = {
						factor = 0
						NOR = {
							any_vassal = {
								is_adult = yes
								war = no
								NOT = { num_of_friends = 3 }
								has_character_flag = guest_feast_started
								any_liege = {
									has_character_flag = host_feast_started
									has_character_modifier = holding_large_feast
									NOT = {
										reverse_opinion = { who = PREV value = 0 }
									}
									any_vassal = {
										is_adult = yes
										NOT = { num_of_friends = 3 }
										has_character_flag = guest_feast_started
										NOT = {
											character = PREVPREV
										}
										NOT = {
											opinion = { who = PREV value = 0 }
										}
										NOT = {
											any_claim = {
												holder_scope = {
													character = PREVPREV
												}
											}
											PREVPREV = {
												any_claim = {
													holder_scope = {
														character = PREVPREV
													}
												}
											}
										}
										NOT = { is_friend = PREVPREV }
									}
								}
							}
						}
					}
					random_vassal = {
						limit = {
							is_adult = yes
							war = no
							NOT = { num_of_friends = 3 }
							has_character_flag = guest_feast_started
							any_liege = {
								has_character_flag = host_feast_started
								has_character_modifier = holding_large_feast
								NOT = {
									reverse_opinion = { who = PREV value = 0 }
								}
								any_vassal = {
									is_adult = yes
									NOT = { num_of_friends = 3 }
									has_character_flag = guest_feast_started
									NOT = {
										character = PREVPREV
									}
									NOT = {
										opinion = { who = PREV value = 0 }
									}
									NOT = {
										any_claim = {
											holder_scope = {
												character = PREVPREV
											}
										}
										PREVPREV = {
											any_claim = {
												holder_scope = {
													character = PREVPREV
												}
											}
										}
									}
									NOT = { is_friend = PREVPREV }
								}
							}
						}
						character_event = { id = 72027 days = 10 }
					}
				}
				10 = { #Late night talk (Liege)
					modifier = {
						factor = 0
						NOR = {
							is_adult = yes
							war = no
							NOT = { num_of_friends = 3 }
							has_character_flag = host_feast_started
							has_character_modifier = holding_large_feast
							any_vassal = {
								war = no
								has_character_flag = guest_feast_started
								NOT = { num_of_friends = 3 }
								NOT = { is_friend = ROOT }
							}
						}
					}
					character_event = { id = 72080 days = 10 }
				}
				#10 = {} #Empty as fallback
			}
			random_list = { #Third wave of events
				10 = { #Guest kills servant (vassal)
					modifier = {
						factor = 0
						NOR = {
							any_vassal = {
								war = no
								has_character_flag = guest_feast_started
								OR = {
									trait = wroth
									trait = cruel
									trait = impaler
								}
								OR = {
									tier = BARON
									tier = COUNT
								}
								NOT = {
									trait = just
								}
								any_liege = {
									war = no
									NOT = { personality_traits  = 6 }
									has_character_flag = host_feast_started
									has_character_modifier = holding_large_feast
									NOT = {
										location = {
											has_province_modifier = peasants_upset
										}
									}
								}
							}
						}
					}
					random_vassal = {
						limit = {
							war = no
							has_character_flag = guest_feast_started
							OR = {
								trait = wroth
								trait = cruel
								trait = impaler
							}
							OR = {
								tier = BARON
								tier = COUNT
							}
							NOT = {
								trait = just
							}
							any_liege = {
								war = no
								NOT = { personality_traits  = 6 }
								has_character_flag = host_feast_started
								has_character_modifier = holding_large_feast
								NOT = {
									location = {
										has_province_modifier = peasants_upset
									}
								}
							}
						}
						character_event = { id = 72055 days = 14 }
					}
				}
				10 = { #Drunkard (vassal)
					modifier = {
						factor = 0
						NOR = {
							any_vassal = {
								is_adult = yes
								war = no
								has_character_flag = guest_feast_started
								NOT = {
									trait = drunkard
								}
								any_liege = {
									war = no
									has_character_flag = host_feast_started
									has_character_modifier = holding_large_feast
								}
							}
						}
					}
					random_vassal = {
						limit = {
							is_adult = yes
							war = no
							has_character_flag = guest_feast_started
							NOT = {
								trait = drunkard
							}
							any_liege = {
								war = no
								has_character_flag = host_feast_started
								has_character_modifier = holding_large_feast
							}
						}
						character_event = { id = 72045 days = 14 }
					}
				}
				10 = { #Drink and embarass self (vassal)
					modifier = {
						factor = 0
						NOR = {
							any_vassal = {
								is_adult = yes
								war = no
								has_character_flag = guest_feast_started
								trait = drunkard
								any_liege = {
									war = no
									has_character_flag = host_feast_started
									has_character_modifier = holding_large_feast
									NOT = {
										has_character_flag = feast_drunkard_guest
									}
									any_courtier = {
										has_job_title = job_treasurer
										NOT = {
											trait = drunkard
										}
									}
								}
							}
						}
					}
					random_vassal = {
						limit = {
							is_adult = yes
							war = no
							has_character_flag = guest_feast_started
							trait = drunkard
							any_liege = {
								war = no
								has_character_flag = host_feast_started
								has_character_modifier = holding_large_feast
								NOT = {
									has_character_flag = feast_drunkard_guest
								}
								any_courtier = {
									has_job_title = job_treasurer
									NOT = {
										trait = drunkard
									}
								}
							}
						}
						character_event = { id = 72046 days = 14 }
					}
				}
				10 = { #Drink and embarass self (vassal)
					modifier = {
						factor = 0
						NOR = {
							any_vassal = {
								is_adult = yes
								war = no
								has_character_flag = guest_feast_started
								trait = drunkard
								any_liege = {
									war = no
									has_character_flag = host_feast_started
									has_character_modifier = holding_large_feast
									NOT = {
										has_character_flag = feast_drunkard_guest
									}
								}
							}
						}
					}
					random_vassal = {
						limit = {
							is_adult = yes
							war = no
							has_character_flag = guest_feast_started
							trait = drunkard
							any_liege = {
								war = no
								has_character_flag = host_feast_started
								has_character_modifier = holding_large_feast
								NOT = {
									has_character_flag = feast_drunkard_guest
								}
							}
						}
						character_event = { id = 72048 days = 14 }
					}
				}
				10 = { #Friendly with another spouse (liege)
					modifier = {
						factor = 0
						NOR = {
							is_adult = yes
							war = no
							has_character_flag = host_feast_started
							has_character_modifier = holding_large_feast
							NOR = {
								trait = celibate
								trait = chaste
								trait = eunuch
								trait = homosexual
							}
							fertility = 0.4
							any_vassal = {
								war = no
								has_character_flag = guest_feast_started
								OR = {
									AND = {
										is_female = no
										is_married = yes
										spouse = {
											is_adult = yes
											NOR = {
												is_close_relative = ROOT
												age = 40
												trait = celibate
												trait = chaste
												trait = homosexual
											}
											is_female = yes
											is_pregnant = no
											is_alive = yes
											is_abroad = no
											prisoner = no
											opinion = { who = ROOT value = 20 }
										}
									}
									AND = {
										is_adult = yes
										NOR = {
											is_close_relative = ROOT
											age = 40
											trait = celibate
											trait = chaste
											trait = homosexual
										}
										is_female = yes
										is_pregnant = no
										is_alive = yes
										is_abroad = no
										prisoner = no
										opinion = { who = ROOT value = 20 }
									}
								}
							}
						}
					}
					character_event = { id = 72075 days = 14 }
				}
				10 = { #Friedly with spouse (vassal)
					modifier = {
						factor = 0
						NOR = {
							any_vassal = {
								is_adult = yes
								war = no
								has_character_flag = guest_feast_started
								is_married = yes
								fertility = 0.4
								any_realm_character = {
									same_liege = PREV
									liege = {
										war = no
										has_character_flag = host_feast_started
										has_character_modifier = holding_large_feast
									}
									NOT = { character = PREV }
									has_character_flag = guest_feast_started
									spouse = {
										prisoner = no
										is_adult = yes
										is_pregnant = no
										is_alive = yes
										is_abroad = no
										NOT = {
											trait = celibate
										}
										NOT = { trait = eunuch }
										NOT = {
											age = 30
										}
										opinion = { who = PREVPREV value = 20 }
										NOT = { is_close_relative = PREVPREV }

										OR = {
											AND = {
												is_female = yes
												is_pregnant = no
												PREVPREV = {
													is_female = no
												}
											}
											AND = {
												is_female = no
												PREVPREV = {
													is_female = yes
													is_pregnant = no
												}
											}
										}
									}
								}
							}
						}
					}
					random_vassal = {
						limit = {
							is_adult = yes
							war = no
							has_character_flag = guest_feast_started
							is_married = yes
							fertility = 0.4
							any_realm_character = {
								same_liege = PREV
								liege = {
									war = no
									has_character_flag = host_feast_started
									has_character_modifier = holding_large_feast
								}
								NOT = { character = PREV }
								has_character_flag = guest_feast_started
								spouse = {
									prisoner = no
									is_adult = yes
									is_pregnant = no
									is_alive = yes
									is_abroad = no
									NOT = {
										trait = celibate
									}
									NOT = { trait = eunuch }
									NOT = {
										age = 30
									}
									opinion = { who = PREVPREV value = 20 }
									NOT = { is_close_relative = PREVPREV }

									OR = {
										AND = {
											is_female = yes
											is_pregnant = no
											PREVPREV = {
												is_female = no
											}
										}
										AND = {
											is_female = no
											PREVPREV = {
												is_female = yes
												is_pregnant = no
											}
										}
									}
								}
							}
						}
						character_event = { id = 72040 days = 14 }
					}
				}
				10 = { #Falling in love (Liege or child)
					modifier = {
						factor = 0
						NOR = {
							any_realm_character = {
								OR = {
									character = ROOT
									liege = { character = ROOT }
								}
								OR = {
									AND = {
										is_betrothed = no
										is_married = no
									}
									NOT = { trait = chaste }
								}
								OR = {
									religion_group = christian
									religion_group = jewish_group
								}
								has_lover = no
								NOT = { trait = shy }
								fertility = 0.4
								OR = {
									AND = {
										NOT = {
											num_of_children = 1
										}
										war = no
										has_character_flag = host_feast_started
										has_character_modifier = holding_large_feast
									}
									AND = {
										is_adult = yes
										NOT = {
											age = 26
										}
										father = {
											war = no
											has_character_flag = host_feast_started
											has_character_modifier = holding_large_feast
										}
									}
								}
								OR = {
									father = {
										any_vassal = {
											has_character_flag = guest_feast_started
											any_child = {
												is_female = yes
												is_married = no
												is_betrothed = no
												has_lover = no
												NOT = { is_close_relative = PREVPREV }
												is_adult = yes
												NOT = {
													age = 26
												}
												is_abroad = no
												opinion = { who = PREVPREV value = 20 }
											}
										}
									}
									any_vassal = {
										has_character_flag = guest_feast_started
										any_child = {
											is_female = yes
											is_married = no
											is_betrothed = no
											has_lover = no
											fertility = 0.4
											NOT = { is_close_relative = PREVPREV }
											is_adult = yes
											NOT = {
												age = 26
											}
											is_abroad = no
											opinion = { who = PREVPREV value = 20 }
										}
									}
								}
							}
						}
					}
					random_realm_character = {
						limit = {
							OR = {
								character = ROOT
								liege = { character = ROOT }
							}
							OR = {
								AND = {
									is_betrothed = no
									is_married = no
								}
								NOT = { trait = chaste }
							}
							OR = {
								religion_group = christian
								religion_group = jewish_group
							}
							has_lover = no
							NOT = { trait = shy }
							fertility = 0.4
							OR = {
								AND = {
									NOT = {
										num_of_children = 1
									}
									war = no
									has_character_flag = host_feast_started
									has_character_modifier = holding_large_feast
								}
								AND = {
									is_adult = yes
									NOT = {
										age = 26
									}
									father = {
										war = no
										has_character_flag = host_feast_started
										has_character_modifier = holding_large_feast
									}
								}
							}
							OR = {
								father = {
									any_vassal = {
										has_character_flag = guest_feast_started
										any_child = {
											is_female = yes
											is_married = no
											is_betrothed = no
											has_lover = no
											NOT = { is_close_relative = PREVPREV }
											is_adult = yes
											NOT = {
												age = 26
											}
											is_abroad = no
											opinion = { who = PREVPREV value = 20 }
										}
									}
								}
								any_vassal = {
									has_character_flag = guest_feast_started
									any_child = {
										is_female = yes
										is_married = no
										is_betrothed = no
										has_lover = no
										fertility = 0.4
										NOT = { is_close_relative = PREVPREV }
										is_adult = yes
										NOT = {
											age = 26
										}
										is_abroad = no
										opinion = { who = PREVPREV value = 20 }
									}
								}
							}
						}
						character_event = { id = 72090 days = 14 }
					}
				}
				#10 = {} #Empty as fallback
			}
			character_event = { id = 72110 days = 20 }
		}
	}
}

#Welcome to the feast!
character_event = {
	id = 72016
	desc = "EVTDESC72016"
	picture = GFX_evt_feast

	is_triggered_only = yes

	option = {
		name = "EVTOPTA72016"
		set_character_flag = guest_feast_started
	}
}

#Lavish Food
character_event = {
	id = 72020
	desc = "EVTDESC72020"
	picture = GFX_evt_feast

	only_rulers = yes
	capable_only = yes
	prisoner = no

	is_triggered_only = yes

	option = {
		name = "EVTOPTA72020" #Approve publicly
		trigger = {
			NOT = { trait = temperate }
		}
		ai_chance = {
			factor = 40

			modifier = {
				factor = 5
				trait = gluttonous
			}
		}
		any_liege = {
			limit = {
				has_character_flag = host_feast_started
				has_character_modifier = holding_large_feast
				has_character_flag = lavishly_food
			}
			hidden_tooltip = {
				add_character_modifier = {
					name = compliment_food_timer
					duration = 14
					hidden = yes
				}
			}
			character_event = {
				id = 72023
				tooltip = "EVTTOOLTIP72023" #Liege is glad you liked it
			}
		}
	}
	option = {
		name = "EVTOPTB72020" #Disapprove
		trigger = {
			NOT = { trait = gluttonous }
		}
		ai_chance = {
			factor = 20

			modifier = {
				factor = 5
				trait = temperate
			}
		}
		any_liege = {
			limit = {
				has_character_flag = host_feast_started
				has_character_modifier = holding_large_feast
				has_character_flag = lavishly_food
			}
			hidden_tooltip = {
				add_character_modifier = {
					name = complain_food_timer
					duration = 14
					hidden = yes
				}
			}
			character_event = {
				id = 72024
				tooltip = "EVTTOOLTIP72024" #Liege dislike you complaining about the food
			}
		}
	}
	option = {
		name = "EVTOPTC72020"
		prestige = -10
	}
}

#Medium Food
character_event = {
	id = 72021
	desc = "EVTDESC72021"
	picture = GFX_evt_feast

	only_rulers = yes
	capable_only = yes
	prisoner = no

	is_triggered_only = yes

	option = {
		name = "EVTOPTA72021" #Approve publicly
		any_liege = {
			limit = {
				has_character_flag = host_feast_started
				has_character_modifier = holding_large_feast
				has_character_flag = medium_food
			}
			hidden_tooltip = {
				add_character_modifier = {
					name = compliment_food_timer
					duration = 14
					hidden = yes
				}
			}
			character_event = {
				id = 72023
				tooltip = "EVTTOOLTIP72023" #Liege is glad you liked it
			}
		}
	}
	option = {
		name = "EVTOPTB72021" #Disapprove
		any_liege = {
			limit = {
				has_character_flag = host_feast_started
				has_character_modifier = holding_large_feast
				has_character_flag = medium_food
			}

			hidden_tooltip = {
				add_character_modifier = {
					name = complain_food_timer
					duration = 14
					hidden = yes
				}
			}
			character_event = {
				id = 72024
				tooltip = "EVTTOOLTIP72024" #Liege dislike you complaining about the food
			}
		}
	}
	option = {
		name = "EVTOPTC72021"
		prestige = -10
	}
}

#Low Food
character_event = {
	id = 72022
	desc = "EVTDESC72022"
	picture = GFX_evt_feast

	only_rulers = yes
	capable_only = yes
	prisoner = no

	is_triggered_only = yes

	option = {
		name = "EVTOPTA72022" #Approve publicly
		trigger = {
			NOT = { trait = gluttonous }
		}
		ai_chance = {
			factor = 20

			modifier = {
				factor = 5
				trait = temperate
			}
		}
		any_liege = {
			limit = {
				has_character_flag = host_feast_started
				has_character_modifier = holding_large_feast
				has_character_flag = low_food
			}
			hidden_tooltip = {
				add_character_modifier = {
					name = compliment_food_timer
					duration = 14
					hidden = yes
				}
			}
			character_event = {
				id = 72023
				tooltip = "EVTTOOLTIP72023" #Liege is glad you liked it
			}
		}
	}
	option = {
		name = "EVTOPTB72022" #Disapprove
		trigger = {
			NOT = { trait = temperate }
		}
		ai_chance = {
			factor = 40

			modifier = {
				factor = 5
				trait = gluttonous
			}
		}
		any_liege = {
			limit = {
				has_character_flag = host_feast_started
				has_character_modifier = holding_large_feast
				has_character_flag = low_food
			}
			hidden_tooltip = {
				add_character_modifier = {
					name = complain_food_timer
					duration = 14
					hidden = yes
				}
			}
			character_event = {
				id = 72024
				tooltip = "EVTTOOLTIP72024" #Liege dislike you complaining about the food
			}
		}
	}
	option = {
		name = "EVTOPTC72022"
		prestige = -10
	}
}

#Liege is glad you liked the food at the feast
character_event = {
	id = 72023
	desc = "EVTDESC72023"
	picture = GFX_evt_feast

	is_triggered_only = yes

	option = {
		name = "EVTOPTA72023"
		opinion = {
			modifier = opinion_happy
			who = FROM
			years = 10
		}
		reverse_opinion = {
			modifier = opinion_approves
			who = FROM
			years = 10
		}
	}
}

#Liege dislikes you complaining about the food at the feast
character_event = {
	id = 72024
	desc = "EVTDESC72024"
	picture = GFX_evt_feast

	is_triggered_only = yes

	option = {
		name = "EVTOPTA72024"
		opinion = {
			modifier = opinion_irritated
			who = FROM
			years = 10
		}
		reverse_opinion = {
			modifier = opinion_disapprove
			who = FROM
			years = 10
		}
	}
}

#Late night talk: First person
character_event = {
	id = 72025
	desc = "EVTDESC72025"
	picture = GFX_evt_feast

	capable_only = yes
	prisoner = no
	min_age = 16
	war = no
	has_character_flag = guest_feast_started

	is_triggered_only = yes

	trigger = {
		NOT = { num_of_friends = 3 }
		any_realm_character = {
			same_liege = ROOT
			liege = {
				has_character_flag = host_feast_started
				has_character_modifier = holding_large_feast
			}
			is_adult = yes
			NOT = { num_of_friends = 3 }
			has_character_flag = guest_feast_started
			NOT = {
				character = ROOT
				any_claim = {
					holder_scope = {
						character = ROOT
					}
				}
				ROOT = {
					any_claim = {
						holder_scope = {
							character = PREVPREV
						}
					}
				}
			}
			NOT = {
				is_friend = ROOT
			}
		}
	}

	option = {
		name = "EVTOPTA72025"
		random_realm_character = {
			limit = {
				same_liege = ROOT
				liege = {
					has_character_flag = host_feast_started
					has_character_modifier = holding_large_feast
				}
				is_adult = yes
				NOT = { num_of_friends = 3 }
				has_character_flag = guest_feast_started
				NOT = {
					character = ROOT
					any_claim = {
						holder_scope = {
							character = ROOT
						}
					}
					ROOT = {
						any_claim = {
							holder_scope = {
								character = PREVPREV
							}
						}
					}
				}
				NOT = {
					is_friend = ROOT
				}
			}
			add_friend = ROOT
			character_event = {
				id = 72026
				tooltip = "EVTTOOLTIP72026"
			}
		}
	}
}

#Late night talk: Second person
character_event = {
	id = 72026
	desc = "EVTDESC72026"
	picture = GFX_evt_feast

	is_triggered_only = yes

	option = {
		name = "EVTOPTA72026"
		FROM = {
			add_friend = ROOT
		}
	}
}

#Late night talk: First person
character_event = {
	id = 72027
	desc = "EVTDESC72027"
	picture = GFX_evt_feast

	min_age = 16
	capable_only = yes
	prisoner = no
	war = no
	has_character_flag = guest_feast_started

	is_triggered_only = yes

	trigger = {
		NOT = { num_of_friends = 3 }
		any_liege = {
			has_character_flag = host_feast_started
			has_character_modifier = holding_large_feast
			NOT = {
				reverse_opinion = { who = ROOT value = 0 }
			}
			any_vassal = {
				is_adult = yes
				NOT = { num_of_friends = 3 }
				has_character_flag = guest_feast_started
				NOT = {
					character = ROOT
				}
				NOT = {
					opinion = { who = PREV value = 0 }
				}
				NOT = {
					any_claim = {
						holder_scope = {
							character = ROOT
						}
					}
					ROOT = {
						any_claim = {
							holder_scope = {
								character = PREVPREV
							}
						}
					}
				}
				NOT = {
					is_friend = ROOT
				}
			}
		}
	}

	option = {
		name = "EVTOPTA72027"
		any_liege = {
			limit = {
				has_character_flag = host_feast_started
				has_character_modifier = holding_large_feast
			}
			random_vassal = {
				limit = {
					has_character_flag = guest_feast_started
					is_adult = yes
					NOT = { num_of_friends = 3 }

					NOT = {
						character = ROOT
					}
					NOT = {
						opinion = { who = PREV value = 0 }
					}
					NOT = {
						any_claim = {
							holder_scope = {
								character = ROOT
							}
						}
						ROOT = {
							any_claim = {
								holder_scope = {
									character = PREVPREV
								}
							}
						}
					}
					NOT = {
						is_friend = ROOT
					}
				}
				add_friend = ROOT
				character_event = {
					id = 72028
					tooltip = "EVTTOOLTIP72028"
				}
			}
		}
	}
}

#Late night talk: Second person
character_event = {
	id = 72028
	desc = "EVTDESC72028"
	picture = GFX_evt_feast

	is_triggered_only = yes

	option = {
		name = "EVTOPTA72028"
		add_friend = FROM
	}
}

#Duel: Start
character_event = {
	id = 72030
	desc = "EVTDESC72030"
	picture = GFX_evt_melee

	min_age = 16
	only_men = yes
	capable_only = yes
	prisoner = no
	war = no
	has_character_flag = guest_feast_started

	is_triggered_only = yes

	trigger = {
		NOT = {
			trait = wounded
		}
		can_be_maimed_trigger = yes
		martial = 9
		OR = {
			trait = duelist
			trait = brave
			trait = wroth
			trait = cruel
		}
		NOT = {
			trait = craven
		}
		any_liege = {
			war = no
			has_character_modifier = holding_large_feast
			has_character_flag = host_feast_started
			any_vassal = {
				is_adult = yes
				has_character_flag = guest_feast_started
				NOT = {
					character = ROOT
				}
				NOT = {
					reverse_opinion = { who = ROOT value = -50 }
				}
				NOT = {
					opinion = { who = ROOT value = -50 }
				}
				NOT = {
					trait = wounded
				}
				can_be_maimed_trigger = yes
			}
		}
	}

	immediate = {
		any_liege = {
			random_vassal = {
				limit = {
					is_adult = yes
					has_character_flag = guest_feast_started
					NOT = {
						character = ROOT
					}
					NOT = {
						reverse_opinion = { who = ROOT value = -50 }
					}
					NOT = {
						opinion = { who = ROOT value = -50 }
					}
					NOT = {
						trait = wounded
					}
					can_be_maimed_trigger = yes
				}
				save_event_target_as = feast_duel_target
			}
		}
	}

	option = {
		name = "EVTOPTA72030"
		any_liege = {
			limit = {
				has_character_flag = host_feast_started
				has_character_modifier = holding_large_feast
			}
			set_character_flag = feast_duel

		}
		event_target:feast_duel_target = {
			character_event = {
				id = 72031
				tooltip = "EVTTOOLTIP72031"
			}
		}
	}
	option = {
		name = "EVTOPTB72030" #Decline
		prestige = -10
	}
}

#Duel: Accept or Decline
character_event = {
	id = 72031
	desc = "EVTDESC72031"
	picture = GFX_evt_melee

	is_triggered_only = yes

	option = {
		name = "EVTOPTA72031" #Accept
		random_list = {
			35 = {
				add_trait = wounded
				hidden_tooltip = {
					FROM = {
						set_character_flag = wounded_opponent
						character_event = {
							id = 72032
						}
					}
				}
			}
			35 = {
				add_maimed_trait_effect = yes
				hidden_tooltip = {
					FROM = {
						set_character_flag = maimed_opponent
						character_event = {
							id = 72032
						}
					}
				}
			}
			10 = {
				death = { death_reason = death_duel }
				hidden_tooltip = {
					FROM = {
						set_character_flag = killed_opponent
						character_event = {
							id = 72033
						}
					}
				}
			}
			20 = {
				any_liege = {
					limit = {
						has_character_flag = host_feast_started
						has_character_modifier = holding_large_feast
					}
					character_event = {
						id = 72034
						tooltip = "EVTTOOLTIP72034"
					}
				}
			}
		}
	}
	option = {
		name = "EVTOPTB72031" #Decline
		prestige = -10
	}
}

#Duel: Opponent is killed/maimed/wounded/nothing
character_event = {
	id = 72032
	desc = "EVTDESC72032"
	picture = GFX_evt_melee

	is_triggered_only = yes

	option = {
		name = "EVTOPTA72032"
		trigger = {
			has_character_flag = wounded_opponent
		}
		random_list = {
			10 = {
				death = { death_reason = death_duel }
				hidden_tooltip = {
					FROM = {
						set_character_flag = killed_opponent
						character_event = {
							id = 72033
							tooltip = "EVTTOOLTIP72033"
						}
					}
				}
			}
			20 = {
				add_maimed_trait_effect = yes
				hidden_tooltip = {
					FROM = {
						set_character_flag = maimed_opponent
						character_event = {
							id = 72033
							tooltip = "EVTTOOLTIP72033"
						}
					}
				}
			}
			30 = {
				add_trait = wounded
				hidden_tooltip = {
					FROM = {
						set_character_flag = wounded_opponent
						character_event = {
							id = 72033
							tooltip = "EVTTOOLTIP72033"
						}
					}
				}
			}
			40 = {
				any_liege = {
					limit = {
						has_character_flag = host_feast_started
						has_character_modifier = holding_large_feast
					}
					character_event = {
						id = 72034
						tooltip = "EVTTOOLTIP72034"
					}
				}
			}
		}
	}

	option = {
		name = "EVTOPTB72032"
		trigger = {
			has_character_flag = maimed_opponent
		}
		random_list = {
			1 = {
				death = { death_reason = death_duel }
				FROM = {
					set_character_flag = killed_opponent
					character_event = {
						id = 72033
						tooltip = "EVTTOOLTIP72033"
					}
				}
			}
			10 = {
				add_maimed_trait_effect = yes
				FROM = {
					set_character_flag = maimed_opponent
					character_event = {
						id = 72033
						tooltip = "EVTTOOLTIP72033"
					}
				}
			}
			19 = {
				add_trait = wounded
				FROM = {
					set_character_flag = wounded_opponent
					character_event = {
						id = 72033
						tooltip = "EVTTOOLTIP72033"
					}
				}
			}
			70 = {
				any_liege = {
					limit = {
						has_character_flag = host_feast_started
						has_character_modifier = holding_large_feast
					}
					character_event = {
						id = 72034
						tooltip = "EVTTOOLTIP72034"
					}
				}
			}
		}
	}
}

#Duel
character_event = {
	id = 72033
	desc = "EVTDESC72033"
	picture = GFX_evt_melee

	is_triggered_only = yes

	option = {
		name = "EVTOPTA72033"
		trigger = {
			has_character_flag = wounded_opponent
		}
		FROM = {
			clr_character_flag = wounded_opponent
			clr_character_flag = maimed_opponent
		}
		any_liege = {
			limit = {
				has_character_flag = host_feast_started
				has_character_modifier = holding_large_feast
			}
			character_event = {
				id = 72036
				tooltip = "EVTTOOLTIP72036"
			}
		}
		clr_character_flag = wounded_opponent
		change_martial = 1
	}

	option = {
		name = "EVTOPTB72033"
		trigger = {
			has_character_flag = maimed_opponent
		}
		FROM = {
			clr_character_flag = wounded_opponent
			clr_character_flag = maimed_opponent
		}
		any_liege = {
			limit = {
				has_character_flag = host_feast_started
				has_character_modifier = holding_large_feast
			}
			character_event = {
				id = 72037
				tooltip = "EVTTOOLTIP72037"
			}
		}
		clr_character_flag = maimed_opponent
		change_martial = 2
	}

	option = {
		name = "EVTOPTC72033"
		trigger = {
			has_character_flag = killed_opponent
		}
		clr_character_flag = killed_opponent
		change_martial = 3
		any_liege = {
			limit = {
				has_character_flag = host_feast_started
				has_character_modifier = holding_large_feast
			}
			character_event = {
				id = 72035
				tooltip = "EVTTOOLTIP72035"
			}
		}
		hidden_tooltip = {
			if = {
				limit = { 
					has_focus = focus_war
					has_dlc = "Way of Life"
				}
				character_event = { id = WoL.11200 days = 3 } # fire focus success
			}
		}
	}
}

#Duel: The End
character_event = {
	id = 72034
	desc = "EVTDESC72034"
	picture = GFX_evt_melee

	is_triggered_only = yes

	option = {
		name = "EVTOPTA72034"
		opinion = {
			modifier = opinion_dislike
			who = FROM
			years = 10
		}
		FROM = {
			FROM = {
				reverse_opinion = {
					modifier = opinion_dislike
					who = Root
					years = 10
				}
			}
		}
	}
}

#Duel: The End
character_event = {
	id = 72035
	desc = "EVTDESC72035"
	picture = GFX_evt_melee

	is_triggered_only = yes

	option = {
		name = "EVTOPTA72035"
		opinion = {
			modifier = opinion_dislike
			who = FROM
			years = 10
		}
	}
	option = {
		name = "EVTOPTB72035"
		opinion = {
			modifier = opinion_satisfied
			who = FROM
			years = 10
		}
	}
	option = {
		name = "EVTOPTC72035"
		reverse_opinion = {
			modifier = opinion_dislike
			who = FROM
			years = 10
		}
	}
}

#Duel: Liege is notified about wounded opponent
character_event = {
	id = 72036
	desc = "EVTDESC72036"
	picture = GFX_evt_melee

	is_triggered_only = yes

	option = {
		name = "EVTOPTA72036"
		opinion = {
			modifier = opinion_dislike
			who = FROM
			years = 10
		}
	}
	option = {
		name = "EVTOPTB72036"
		opinion = {
			modifier = opinion_satisfied
			who = FROM
			years = 10
		}
	}
	option = {
		name = "EVTOPTC72036"
		reverse_opinion = {
			modifier = opinion_dislike
			who = FROM
			years = 10
		}
	}
}

#Duel: Liege is notified about maimed opponent
character_event = {
	id = 72037
	desc = "EVTDESC72037"
	picture = GFX_evt_melee

	is_triggered_only = yes

	option = {
		name = "EVTOPTA72037"
		opinion = {
			modifier = opinion_dislike
			who = FROM
			years = 10
		}
	}
	option = {
		name = "EVTOPTB72037"
		opinion = {
			modifier = opinion_satisfied
			who = FROM
			years = 10
		}
	}
	option = {
		name = "EVTOPTC72037"
		reverse_opinion = {
			modifier = opinion_dislike
			who = FROM
			years = 10
		}
	}
}

#Friendly with another guest's spouse
character_event = {
	id = 72040
	desc = "EVTDESC72040"
	picture = GFX_evt_feast

	min_age = 16
	max_age = 60
	prisoner = no
	only_rulers = yes
	capable_only = yes
	war = no
	has_character_flag = guest_feast_started
	is_married = yes

	is_triggered_only = yes

	trigger = {
		fertility = 0.4
		any_realm_character = {
			same_liege = ROOT
			liege = {
				war = no
				has_character_flag = host_feast_started
				has_character_modifier = holding_large_feast
			}
			NOT = { character = ROOT }
			has_character_flag = guest_feast_started
			spouse = {
				prisoner = no
				is_adult = yes
				is_pregnant = no
				is_alive = yes
				is_abroad = no
				NOT = {
					trait = celibate
				}
				NOT = { trait = eunuch }
				NOT = {
					age = 30
				}
				opinion = { who = ROOT value = 20 }
				NOT = { is_close_relative = root }

				OR = {
					AND = {
						is_female = yes
						is_pregnant = no
						ROOT = {
							is_female = no
						}
					}
					AND = {
						is_female = no
						ROOT = {
							is_female = yes
							is_pregnant = no
						}
					}
				}
			}
		}
	}

	option = {
		name = "EVTOPTA72040"
		prestige = -5
	}

	option = {
		name = "EVTOPTB72040"
		random_realm_character = {
			limit = {
				same_liege = ROOT
				liege = {
					has_character_flag = host_feast_started
					has_character_modifier = holding_large_feast
				}
				NOT = { character = ROOT }
				has_character_flag = guest_feast_started
				spouse = {
					prisoner = no
					is_adult = yes
					is_pregnant = no
					is_alive = yes
					is_abroad = no
					NOT = {
						trait = celibate
					}
					NOT = { trait = eunuch }
					NOT = {
						age = 30
					}
					opinion = { who = ROOT value = 20 }
					NOT = { is_close_relative = root }
					OR = {
						AND = {
							is_female = yes
							is_pregnant = no
							ROOT = {
								is_female = no
							}
						}
						AND = {
							is_female = no
							ROOT = {
								is_female = yes
								is_pregnant = no
							}
						}
					}
				}
			}
			spouse = {
				character_event = {
					id = 72041
					tooltip = "EVTTOOLTIP72041"
				}
			}
		}
	}
}

#Spouse answers the 'invitation'
character_event = {
	id = 72041
	desc = "EVTDESC72041"
	picture = GFX_evt_lovers

	is_triggered_only = yes

	option = {
		name = "EVTOPTA72041"
		trigger = {
			is_female = yes
		}
		random = {
			chance = 25

			FROM = {
				impregnate = ROOT
				character_event = {
					id = 72042
					days = 60
					tooltip = "EVTTOOLTIP72042"
				}
			}
		}
	}
	option = {
		name = "EVTOPTB72041"
		trigger = {
			is_female = no
		}
		random = {
			chance = 25

			impregnate = FROM
			character_event = {
				id = 72042
				days = 60
				tooltip = "EVTTOOLTIP72042"
			}
		}
		hidden_tooltip = {
			random = {
				chance = 50
				venereal_disease_effect = yes
			}
		}
	}
	option = {
		name = "EVTOPTC72041"
		piety = 5
	}
}

#Their night together resulted in a child
character_event = {
	id = 72042
	desc = "EVTDESC72042"
	picture = GFX_evt_pregnancy

	is_triggered_only = yes

	option = {
		name = "EVTOPTA72042"
		FROM = {
			spouse = {
				opinion = {
					modifier = opinion_cuckolded_private
					who = ROOT
					years = 100
				}
			}
		}
	}
}

#Drink too much wine: become drunkard or insult host
character_event = {
	id = 72045
	desc = "EVTDESC72045"
	picture = GFX_evt_feast

	min_age = 16
	prisoner = no
	capable_only = yes
	war = no
	has_character_flag = guest_feast_started

	is_triggered_only = yes

	trigger = {
		NOT = {
			trait = drunkard
		}
		any_liege = {
			war = no
			has_character_flag = host_feast_started
			has_character_modifier = holding_large_feast
		}
	}

	option = {
		name = "EVTOPTA72045"
		random = {
			chance = 25

			emf_notify_add_drunkard_effect = yes
			any_liege = {
				limit = {
					has_character_flag = host_feast_started
					has_character_modifier = holding_large_feast
				}
				set_character_flag = feast_drunkard_guest
			}
		}
	}
	option = {
		name = "EVTOPTB72045"
		any_liege = {
			limit = {
				has_character_flag = host_feast_started
				has_character_modifier = holding_large_feast
			}
			set_character_flag = feast_drunkard_guest
			character_event = {
				id = 72052
				tooltip = "EVTTOOLTIP72052"
			}
		}
	}
}

#Liege is insulted when guest refuses more wine
character_event = {
	id = 72052
	desc = "EVTDESC72052"
	picture = GFX_evt_drunk

	is_triggered_only = yes

	option = {
		name = "EVTOPTA72052"
		opinion = {
			modifier = opinion_insulted
			who = FROM
			years = 10
		}
	}
}

#Drink too much wine: Embarass yourself
character_event = {
	id = 72046
	desc = "EVTDESC72046"
	picture = GFX_evt_feast

	min_age = 16
	prisoner = no
	capable_only = yes
	war = no
	has_character_flag = guest_feast_started

	is_triggered_only = yes

	trigger = {
		trait = drunkard
		any_liege = {
			war = no
			has_character_flag = host_feast_started
			has_character_modifier = holding_large_feast
			NOT = {
				has_character_flag = feast_drunkard_guest
			}
			any_courtier = {
				has_job_title = job_treasurer
				NOT = {
					trait = drunkard
				}
			}
		}
	}

	option = {
		name = "EVTOPTA72046"
		any_liege = {
			limit = {
				has_character_flag = host_feast_started
				has_character_modifier = holding_large_feast
				has_character_flag = lavishly_food
			}
			set_character_flag = feast_drunkard_guest
			character_event = {
				id = 72047
				tooltip = "EVTTOOLTIP72047"
			}
			random_courtier = {
				limit = {
					has_job_title = job_treasurer
					NOT = {
						trait = drunkard
					}
				}
				opinion = {
					modifier = opinion_dislike
					who = ROOT
					years = 10
				}
			}
		}
	}
}

#Host is not happy about drunkard falling asleep
character_event = {
	id = 72047
	desc = "EVTDESC72047"
	picture = GFX_evt_drunk

	is_triggered_only = yes

	option = {
		name = "EVTOPTA72047"
		opinion = {
			modifier = opinion_disgusted
			who = FROM
			years = 10
		}
	}
}

#Drink too much wine: Fall asleep
character_event = {
	id = 72048
	desc = "EVTDESC72048"
	picture = GFX_evt_feast

	min_age = 16
	prisoner = no
	capable_only = yes
	war = no
	has_character_flag = guest_feast_started

	is_triggered_only = yes

	trigger = {
		trait = drunkard
		any_liege = {
			war = no
			has_character_flag = host_feast_started
			has_character_modifier = holding_large_feast
			NOT = {
				has_character_flag = feast_drunkard_guest
			}
		}
	}

	option = {
		name = "EVTOPTA72048"
		prestige = -10
		any_liege = {
			limit = {
				has_character_flag = host_feast_started
				has_character_modifier = holding_large_feast
				has_character_flag = lavishly_food
			}
			set_character_flag = feast_drunkard_guest
			character_event = {
				id = 72049
				tooltip = "EVTTOOLTIP72049"
			}
		}
	}
}

#Host is not happy about drunkard falling asleep
character_event = {
	id = 72049
	desc = "EVTDESC72049"
	picture = GFX_evt_drunk

	is_triggered_only = yes

	option = {
		name = "EVTOPTA72049"
		opinion = {
			modifier = opinion_disgusted
			who = FROM
			years = 10
		}
	}
}

#Highway Robber Band: Guest Complains
character_event = {
	id = 72050
	desc = "EVTDESC72050"
	picture = GFX_evt_bandits

	min_age = 16
	prisoner = no
	capable_only = yes
	war = no
	has_character_flag = guest_feast_started

	is_triggered_only = yes

	trigger = {
		any_liege = {
			war = no
			has_character_flag = host_feast_started
			has_character_modifier = holding_large_feast
			location = {
				has_province_modifier = highway_robber_band
			}
		}
	}

	option = {
		name = "EVTOPTA72050"
		any_liege = {
			limit = {
				has_character_flag = host_feast_started
				has_character_modifier = holding_large_feast
				location = {
					has_province_modifier = highway_robber_band
				}
			}
			character_event = {
				id = 72051
				tooltip = "EVTTOOLTIP72051"
			}
		}
	}
}

#Highway Robber Band: The End
character_event = {
	id = 72051
	desc = "EVTDESC72051"
	picture = GFX_evt_bandits

	is_triggered_only = yes

	option = {
		name = "EVTOPTA72051"
		FROM = {
			opinion = {
				modifier = opinion_dislike
				who = ROOT
				years = 10
			}
		}
	}
}

#Guest kills Host's servant
character_event = {
	id = 72055
	desc = "EVTDESC72055"
	picture = GFX_evt_feast

	only_rulers = yes
	min_age = 16
	prisoner = no
	capable_only = yes
	war = no
	has_character_flag = guest_feast_started

	is_triggered_only = yes

	trigger = {
		OR = {
			trait = wroth
			trait = cruel
			trait = impaler
		}
		OR = {
			tier = BARON
			tier = COUNT
		}
		NOT = {
			trait = just
		}
		any_liege = {
			war = no
			NOT = { personality_traits  = 6 }
			has_character_flag = host_feast_started
			has_character_modifier = holding_large_feast
			NOT = {
				location = {
					has_province_modifier = peasants_upset
				}
			}
		}
	}

	option = {
		name = "EVTOPTA72055"
		any_liege = {
			limit = {
				has_character_flag = host_feast_started
				has_character_modifier = holding_large_feast
				NOT = {
					location = {
						has_province_modifier = peasants_upset
					}
				}
			}
			character_event = {
				id = 72056
				tooltip = "EVTTOOLTIP72056"
			}
		}
	}
}

#Guest kills Host's servant: Imprison?
character_event = {
	id = 72056
	desc = "EVTDESC72056"
	picture = GFX_evt_scandal

	is_triggered_only = yes

	option = {
		name = "EVTOPTA72056"
		FROM = {
			imprison = ROOT
			hidden_tooltip = {
				character_event = {
					id = 72057
				}
			}
		}
		if = {
			limit = {
				NOT = { trait = just }
			}
			emf_notify_add_just_effect = yes
		}
	}
	option = {
		name = "EVTOPTC72056"
		scaled_wealth = -0.10
	}
	option = {
		name = "EVTOPTB72056"
		if = {
			limit = {
				NOT = { trait = arbitrary }
			}
			emf_notify_add_arbitrary_effect = yes
		}
		location = {
			add_province_modifier = {
				name = peasants_upset
				duration = 90
			}
		}
	}
}

#Guest kills Host's servant: The end
character_event = {
	id = 72057
	desc = "EVTDESC72057"
	picture = GFX_evt_into_the_dungeon

	is_triggered_only = yes

	option = {
		name = "EVTOPTA72057"
		opinion = {
			modifier = opinion_angry
			who = FROM
			years = 20
		}
		clr_character_flag = coming_to_feast
		clr_character_flag = guest_feast_started
		clr_character_flag = wounded_opponent
		clr_character_flag = maimed_opponent
		clr_character_flag = killed_opponent
	}
}

#Jester jokes about your rule
character_event = {
	id = 72060
	desc = "EVTDESC72060"
	picture = GFX_evt_jugglers

	only_rulers = yes
	prisoner = no
	capable_only = yes
	war = no
	has_character_flag = host_feast_started
	
	is_triggered_only = yes

	trigger = {
		has_character_modifier = holding_large_feast
		any_courtier = {
			has_minor_title = title_court_jester
			NOT = {
				opinion = { who = ROOT value = 25 }
			}
		}
		any_vassal = {
			has_character_flag = guest_feast_started
		}
	}
	
	immediate = {
		random_courtier = {
			limit = {
				has_minor_title = title_court_jester
				NOT = {
					opinion = { who = ROOT value = 25 }
				}
			}
			save_event_target_as = insulting_jester
		}
	
	}

	option = {
		name = "EVTOPTA72060"
		if = {
			limit = {
				trait = arbitrary
				NOT = {
					trait = cruel
				}
			}
			random = {
				chance = 20

				emf_notify_add_cruel_effect = yes
			}
		}
		if = {
			limit = {
				trait = cruel
				NOT = {
					trait = arbitrary
				}
			}
			random = {
				chance = 20

				emf_notify_add_arbitrary_effect = yes
			}
		}
		event_target:insulting_jester = {
			imprison = ROOT
		}
		any_vassal = {
			limit = {
				has_character_flag = guest_feast_started
				NOT = {
					opinion = { who = ROOT value = 5 }
				}
			}
			character_event = {
				id = 72061
				tooltip = "EVTTOOLTIP72061"
			}
		}
	}
	option = {
		name = "EVTOPTB72060"
		prestige = -10
		any_vassal = {
			limit = {
				has_character_flag = guest_feast_started
			}
			character_event = {
				id = 72062
				tooltip = "EVTTOOLTIP72062"
			}
		}
	}
}

#Jester is thrown into dungeon: Guests react
character_event = {
	id = 72061
	desc = "EVTDESC72061"
	picture = GFX_evt_jugglers

	is_triggered_only = yes

	option = {
		name = "EVTOPTA72061"
		opinion = {
			modifier = opinion_disappointed
			who = FROM
			years = 10
		}
	}
}

#Jester is ignored: Guests react
character_event = {
	id = 72062
	desc = "EVTDESC72062"
	picture = GFX_evt_jugglers

	is_triggered_only = yes

	option = {
		name = "EVTOPTA72062"
		opinion = {
			modifier = opinion_approves
			who = FROM
			years = 10
		}
	}
}

#Jongleurs entertain the guests
character_event = {
	id = 72063
	desc = "EVTDESC72063"
	picture = GFX_evt_jugglers

	only_rulers = yes
	prisoner = no
	capable_only = yes
	war = no
	has_character_flag = host_feast_started

	is_triggered_only = yes

	trigger = {
		has_character_modifier = holding_large_feast
		has_character_flag = feast_jongleur
		any_vassal = {
			war = no
			has_character_flag = guest_feast_started
		}
	}

	option = {
		name = "EVTOPTA72063"
		prestige = 10
		if = {
			limit = {
				NOT = {
					trait = gregarious
				}
				NOT = {
					num_of_traits = 5
				}
			}
			random = {
				chance = 25

				emf_notify_add_gregarious_effect = yes
			}
		}
		if = {
			limit = {
				NOT = {
					trait = charitable
				}
				NOT = {
					num_of_traits = 5
				}
			}
			random = {
				chance = 25

				emf_notify_add_charitable_effect = yes
			}
		}
		random_vassal = {
			limit = {
				has_character_flag = guest_feast_started
			}
			character_event = {
				id = 72064
				tooltip = "EVTTOOLTIP72064"
			}
		}
	}
}

#Visitor likes jongleurs
character_event = {
	id = 72064
	desc = "EVTDESC72064"
	picture = GFX_evt_jugglers

	is_triggered_only = yes

	option = {
		name = "EVTOPTA72064"
		opinion = {
			modifier = opinion_approves
			who = FROM
			years = 10
		}
	}
}

#Minstrel entertain the guests
character_event = {
	id = 72065
	desc = "EVTDESC72065"
	picture = GFX_evt_feast

	only_rulers = yes
	prisoner = no
	capable_only = yes
	war = no
	has_character_flag = host_feast_started

	is_triggered_only = yes

	trigger = {
		has_character_modifier = holding_large_feast
		has_character_flag = feast_minstrel
		any_vassal = {
			war = no
			has_character_flag = guest_feast_started
		}
	}


	option = {
		name = "EVTOPTA72065"
		if = {
			limit = {
				NOT = {
					trait = gregarious
				}
				NOT = {
					num_of_traits = 5
				}
			}
			random = {
				chance = 25

				emf_notify_add_gregarious_effect = yes
			}
		}
		if = {
			limit = {
				NOT = {
					trait = charitable
				}
				NOT = {
					num_of_traits = 5
				}
			}
			random = {
				chance = 25

				emf_notify_add_charitable_effect = yes
			}
		}
		prestige = 10
		random_vassal = {
			limit = {
				has_character_flag = guest_feast_started
			}
			character_event = {
				id = 72066
				tooltip = "EVTTOOLTIP72066"
			}
		}
	}
}

#Visitor likes minstrel
character_event = {
	id = 72066
	desc = "EVTDESC72066"
	picture = GFX_evt_jugglers

	is_triggered_only = yes

	option = {
		name = "EVTOPTA72066"
		opinion = {
			modifier = opinion_approves
			who = FROM
			years = 10
		}
	}
}

#Musicians entertain the guests
character_event = {
	id = 72067
	desc = "EVTDESC72067"
	picture = GFX_evt_feast

	only_rulers = yes
	prisoner = no
	capable_only = yes
	war = no
	has_character_flag = host_feast_started

	is_triggered_only = yes

	trigger = {
		has_character_modifier = holding_large_feast
		has_character_flag = feast_musicians
		any_vassal = {
			war = no
			has_character_flag = guest_feast_started
		}
	}


	option = {
		name = "EVTOPTA72067"
		if = {
			limit = {
				NOT = {
					trait = gregarious
				}
				NOT = {
					num_of_traits = 5
				}
			}
			random = {
				chance = 25

				emf_notify_add_gregarious_effect = yes
			}
		}
		if = {
			limit = {
				NOT = {
					trait = charitable
				}
				NOT = {
					num_of_traits = 5
				}
			}
			random = {
				chance = 25

				emf_notify_add_charitable_effect = yes
			}
		}
		prestige = 10
		random_vassal = {
			limit = {
				has_character_flag = guest_feast_started
			}
			character_event = {
				id = 72068
				tooltip = "EVTTOOLTIP72068"
			}
		}
	}
}

#Visitor likes musicians
character_event = {
	id = 72068
	desc = "EVTDESC72068"
	picture = GFX_evt_feast

	is_triggered_only = yes

	option = {
		name = "EVTOPTA72068"
		opinion = {
			modifier = opinion_approves
			who = FROM
			years = 10
		}
	}
}

#Fire-eaters entertain the guests
character_event = {
	id = 72069
	desc = "EVTDESC72069"
	picture = GFX_evt_feast

	only_rulers = yes
	prisoner = no
	capable_only = yes
	war = no
	has_character_flag = host_feast_started

	is_triggered_only = yes

	trigger = {
		has_character_modifier = holding_large_feast
		has_character_flag = feast_fireeaters
		any_vassal = {
			war = no
			has_character_flag = guest_feast_started
		}
	}


	option = {
		name = "EVTOPTA72069"
		if = {
			limit = {
				NOT = {
					trait = gregarious
				}
				NOT = {
					num_of_traits = 5
				}
			}
			random = {
				chance = 25

				emf_notify_add_gregarious_effect = yes
			}
		}
		if = {
			limit = {
				NOT = {
					trait = charitable
				}
				NOT = {
					num_of_traits = 5
				}
			}
			random = {
				chance = 25

				emf_notify_add_charitable_effect = yes
			}
		}
		prestige = 10
		random_vassal = {
			limit = {
				has_character_flag = guest_feast_started
			}
			character_event = {
				id = 72070
				tooltip = "EVTTOOLTIP72070"
			}
		}
	}
}

#Visitor likes fire-eaters
character_event = {
	id = 72070
	desc = "EVTDESC72070"
	picture = GFX_evt_feast

	is_triggered_only = yes

	option = {
		name = "EVTOPTA72070"
		opinion = {
			modifier = opinion_approves
			who = FROM
			years = 10
		}
	}
}

#Conjurer entertain the guests
character_event = {
	id = 72071
	desc = "EVTDESC72071"
	picture = GFX_evt_feast

	only_rulers = yes
	prisoner = no
	capable_only = yes
	war = no
	has_character_flag = host_feast_started

	is_triggered_only = yes

	trigger = {
		has_character_modifier = holding_large_feast
		has_character_flag = feast_conjurer
		any_vassal = {
			war = no
			has_character_flag = guest_feast_started
		}
	}


	option = {
		name = "EVTOPTA72071"
		if = {
			limit = {
				NOT = {
					trait = gregarious
				}
				NOT = {
					num_of_traits = 5
				}
			}
			random = {
				chance = 25

				emf_notify_add_gregarious_effect = yes
			}
		}
		if = {
			limit = {
				NOT = {
					trait = charitable
				}
				NOT = {
					num_of_traits = 5
				}
			}
			random = {
				chance = 25

				emf_notify_add_charitable_effect = yes
			}
		}
		prestige = 10
		random_vassal = {
			limit = {
				has_character_flag = guest_feast_started
			}
			character_event = {
				id = 72072
				tooltip = "EVTTOOLTIP72072"
			}
		}
	}
}

#Visitor likes Conjurer
character_event = {
	id = 72072
	desc = "EVTDESC72072"
	picture = GFX_evt_feast

	is_triggered_only = yes

	option = {
		name = "EVTOPTA72072"
		opinion = {
			modifier = opinion_approves
			who = FROM
			years = 10
		}
	}
}

#Friendly with another guest's spouse
character_event = {
	id = 72075
	desc = "EVTDESC72075"
	picture = GFX_evt_feast

	only_men = yes
	min_age = 16
	max_age = 60
	prisoner = no
	only_rulers = yes
	capable_only = yes
	war = no
	has_character_flag = host_feast_started

	is_triggered_only = yes

	trigger = {
		has_character_modifier = holding_large_feast
		NOR = {
			trait = celibate
			trait = chaste
			trait = eunuch
			trait = homosexual
		}
		fertility = 0.4
		any_vassal = {
			war = no
			has_character_flag = guest_feast_started
			OR = {
				AND = {
					is_female = no
					is_married = yes
					spouse = {
						is_adult = yes
						NOR = {
							is_close_relative = ROOT
							age = 40
							trait = celibate
							trait = chaste
							trait = homosexual
						}
						is_female = yes
						is_pregnant = no
						is_alive = yes
						is_abroad = no
						prisoner = no
						opinion = { who = ROOT value = 20 }
					}
				}
				AND = {
					is_adult = yes
					NOR = {
						is_close_relative = ROOT
						age = 40
						trait = celibate
						trait = chaste
						trait = homosexual
					}
					is_female = yes
					is_pregnant = no
					is_alive = yes
					is_abroad = no
					prisoner = no
					opinion = { who = ROOT value = 20 }
				}
			}
		}
	}

	immediate = {
		random_vassal = {
			limit = {
				war = no
				has_character_flag = guest_feast_started
				OR = {
					AND = {
						is_female = no
						is_married = yes
						spouse = {
							is_adult = yes
							NOR = {
								is_close_relative = ROOT
								age = 40
								trait = celibate
								trait = chaste
								trait = homosexual
							}
							is_female = yes
							is_pregnant = no
							is_alive = yes
							is_abroad = no
							prisoner = no
							opinion = { who = ROOT value = 20 }
						}
					}
					AND = {
						is_adult = yes
						NOR = {
							is_close_relative = ROOT
							age = 40
							trait = celibate
							trait = chaste
							trait = homosexual
						}
						is_female = yes
						is_pregnant = no
						is_alive = yes
						is_abroad = no
						prisoner = no
						opinion = { who = ROOT value = 20 }
					}
				}
			}
			if = {
				limit = {
					is_female = yes
				}
				save_event_target_as = passionated_guest
				break = yes
			}
			spouse = {
				save_event_target_as = passionated_guest
			}
		}
	}

	option = {
		name = "EVTOPTA72075"
		prestige = -5
	}

	option = {
		name = "EVTOPTB72075"
		event_target:passionated_guest = {
			character_event = {
				id = 72076
				tooltip = "EVTTOOLTIP72076"
			}
		}
	}
}

#Spouse answers the 'invitation'
character_event = {
	id = 72076
	desc = "EVTDESC72076"
	picture = GFX_evt_lovers

	is_triggered_only = yes

	option = {
		name = "EVTOPTA72076"
		random = {
			chance = 25

			FROM = {
				impregnate = ROOT
				character_event = {
					id = 72077
					days = 60
					tooltip = "EVTTOOLTIP72077"
				}
			}
		}
	}
	option = {
		name = "EVTOPTB72076"
		piety = 2
	}
}

#Their night together resulted in a child
character_event = {
	id = 72077
	desc = "EVTDESC72077"
	picture = GFX_evt_pregnancy

	is_triggered_only = yes

	option = {
		name = "EVTOPTA72077"
		FROM = {
			spouse = {
				opinion = {
					modifier = opinion_hate
					who = ROOT
					years = 100
				}
			}
		}
	}
}

#Late night talk: First person
character_event = {
	id = 72080
	desc = "EVTDESC72080"
	picture = GFX_evt_feast

	min_age = 16
	capable_only = yes
	prisoner = no
	war = no
	has_character_flag = host_feast_started

	is_triggered_only = yes

	trigger = {
		NOT = { num_of_friends = 3 }
		has_character_modifier = holding_large_feast
		any_vassal = {
			war = no
			has_character_flag = guest_feast_started
			NOT = { num_of_friends = 3 }
			NOT = { is_friend = ROOT }
		}
	}

	option = {
		name = "EVTOPTA72080"
		random_vassal = {
			limit = {
				has_character_flag = guest_feast_started
				NOT = { num_of_friends = 3 }
				NOT = { is_friend = ROOT }
			}
			add_friend = ROOT
			character_event = {
				id = 72081
				tooltip = "EVTTOOLTIP72081"
			}
		}
	}
}

#Late night talk: Second person
character_event = {
	id = 72081
	desc = "EVTDESC72081"
	picture = GFX_evt_feast

	is_triggered_only = yes

	option = {
		name = "EVTOPTA72081"
		add_friend = FROM
	}
}

#Claim on visitor's title
character_event = {
	id = 72085
	desc = "EVTDESC72085"
	picture = GFX_evt_feast

	capable_only = yes
	prisoner = no
	war = no
	has_character_flag = host_feast_started

	is_triggered_only = yes

	trigger = {
		has_character_modifier = holding_large_feast
		any_claim = {
			holder_scope = {
				war = no
				has_character_flag = guest_feast_started
				vassal_of = ROOT
			}
		}
	}

	option = {
		name = "EVTOPTA72085"
		prestige = -10
		random_claim = {
			limit = {
				holder_scope = {
					has_character_flag = guest_feast_started
					vassal_of = ROOT
				}
			}
			holder_scope = {
				imprison = ROOT
				hidden_tooltip = {
					character_event = {
						id = 72089
					}
				}
			}
		}
		any_vassal = {
			limit = {
				prisoner = no
				has_character_flag = guest_feast_started
			}
			opinion = {
				modifier = opinion_angry
				who = ROOT
				years = 10
			}
		}
	}
	option = {
		name = "EVTOPTB72085"
		random_claim = {
			limit = {
				can_be_given_away = yes
				holder_scope = {
					has_character_flag = guest_feast_started
					vassal_of = ROOT

				}
			}
			holder_scope = {
				character_event = {
					id = 72086
					tooltip = "EVTTOOLTIP72086"
				}
			}
		}
	}
	option = {
		name = "EVTOPTC72085"
		prestige = -10
		random_claim = {
			limit = {
				can_be_given_away = yes
				holder_scope = {
					has_character_flag = guest_feast_started
					vassal_of = ROOT

				}
			}
			remove_claim = ROOT
		}
	}
}

#Vassal decides if any_liege gets title
character_event = {
	id = 72086
	desc = "EVTDESC72086"
	picture = GFX_evt_feast

	is_triggered_only = yes

	option = {
		name = "EVTOPTA72086" #Grant any_liege title
		character_event = {
			id = 72087
			tooltip = "EVTTOOLTIP72087"
		}
	}
	option = {
		name = "EVTOPTB72086" #Refuse
		character_event = {
			id = 72088
			tooltip = "EVTTOOLTIP72088"
		}
	}
}

#Liege gets title
character_event = {
	id = 72087
	desc = "EVTDESC72087"
	picture = GFX_evt_feast

	is_triggered_only = yes

	option = {
		name = "EVTOPTA72087"
		random_claim = {
			limit = {
				can_be_given_away = yes
				holder = FROM
			}
			grant_title = ROOT
		}
	}
}

#Liege does not get title
character_event = {
	id = 72088
	desc = "EVTDESC72088"
	picture = GFX_evt_feast

	is_triggered_only = yes

	option = {
		name = "EVTOPTA72088"
		opinion = {
			modifier = opinion_disappointed
			who = FROM
			years = 20
		}
	}
}

#Imprisoned by liege who wants title
character_event = {
	id = 72089
	desc = "EVTDESC72089"
	picture = GFX_evt_into_the_dungeon

	is_triggered_only = yes

	option = {
		name = "EVTOPTA72089"
		tooltip = {
			imprison = FROM
		}
	}

	option = {
		name = "EVTOPTB72089"
		FROM = {
			random_claim = {
				limit = {
					can_be_given_away = yes
					holder = ROOT
				}
				grant_title = FROM
			}
		}
		prisoner = no
	}
}

#Host or Host's son "falls in love" with unmarried daughter of vassal
character_event = {
	id = 72090
	desc = "EVTDESC72090"
	picture = GFX_evt_feast

	only_men = yes
	capable_only = yes
	prisoner = no

	is_triggered_only = yes

	immediate = {
		father = {
			if = {
				limit = {
					has_character_flag = host_feast_started
					has_character_modifier = holding_large_feast
				}
				random_vassal = {
					limit = {
						has_character_flag = guest_feast_started
					}
					random_child = {
						limit = {
							is_female = yes
							is_married = no
							is_pregnant = no
							is_betrothed = no
							has_lover = no
							fertility = 0.4
							NOT = { is_close_relative = ROOT }
							is_adult = yes
							NOT = { age = 26 }
							opinion = { who = ROOT value = 20 }
						}
						save_event_target_as = vassals_daughter
						break = yes
					}
				}
			}
		}
		if = {
			limit = {
				has_character_flag = host_feast_started
				has_character_modifier = holding_large_feast
				is_married = no
			}
			random_vassal = {
				limit = { has_character_flag = guest_feast_started }
				random_child = {
					limit = {
						is_female = yes
						is_married = no
						is_betrothed = no
						has_lover = no
						is_pregnant = no
						fertility = 0.4
						NOT = { is_close_relative = root }
						is_adult = yes
						NOT = { age = 26 }
						opinion = { who = ROOT value = 20 }
					}
					save_event_target_as = vassals_daughter
				}
			}
		}
	}
	

	option = {
		name = "EVTOPTA72090" #Flirt

		event_target:vassals_daughter = {
			opinion = {
				modifier = opinion_flattered
				who = ROOT
				years = 10
			}
			father = {
				character_event = {
					id = 72091
					tooltip = "EVTTOOLTIP72091"
				}
			}
		}
	}

	option = {
		name = "EVTOPTB72090" #Tumble
		
		prestige = 15
		event_target:vassals_daughter = {
			random = {
				chance = 25
				impregnate = ROOT
				set_character_flag = impregnated_by_root
				ROOT = { set_character_flag = impregnated_vassal_daughter }
				hidden_tooltip = { father = { character_event = { id = 72097 days = 60 random = 15 } } }
			}
			add_lover = ROOT
			father = {
				character_event = {
					id = 72092
					tooltip = "EVTTOOLTIP72092"
				}
			}
		}
	}
}

#Liege or liege's son flirted with my daughter! I'm so proud!
character_event = {
	id = 72091
	desc = "EVTDESC72091"
	picture = GFX_evt_feast

	is_triggered_only = yes

	option = {
		name = "EVTOPTA72091"
		prestige = 10
	}
}

#Liege or liege's son seduced my daughter!
character_event = {
	id = 72092
	desc = "EVTDESC72092"
	picture = GFX_evt_feast

	is_triggered_only = yes

	option = {
		name = "EVTOPTA72092"
		trigger = {
			FROM = {
				father = {
					has_character_flag = host_feast_started
					has_character_modifier = holding_large_feast
				}
			}
		}
		prestige = -10
		FROM = {
			father = {
				character_event = {
					id = 72093
					tooltip = "EVTTOOLTIP72093"
				}
			}
		}
	}
	option = {
		name = "EVTOPTB72092"
		trigger = {
			FROM = {
				has_character_flag = host_feast_started
				has_character_modifier = holding_large_feast
			}
		}
		prestige = -10
		FROM = {
			character_event = {
				id = 72094
				tooltip = "EVTTOOLTIP72094"
			}
		}
	}
	option = {
		name = "EVTOPTC72092" #Grovel
		trigger = {
			FROM = {
				father = {
					has_character_flag = host_feast_started
					has_character_modifier = holding_large_feast
				}
			}
		}
		prestige = -10
		FROM = {
			father = {
				character_event = {
					id = 72095
					tooltip = "EVTTOOLTIP72095"
				}
			}
		}
	}
	option = {
		name = "EVTOPTD72092" #Grovel
		trigger = {
			FROM = {
				has_character_flag = host_feast_started
				has_character_modifier = holding_large_feast
			}
		}
		prestige = -10
		FROM = {
			character_event = {
				id = 72096
				tooltip = "EVTTOOLTIP72096"
			}
		}
	}
}

#My son seduced a vassal's daughter and now he's angry
character_event = {
	id = 72093
	desc = "EVTDESC72093"
	picture = GFX_evt_pregnancy

	is_triggered_only = yes

	option = {
		name = "EVTOPTA72093"
		opinion = {
			modifier = opinion_angry
			who = FROM
			years = 10
		}
		reverse_opinion = {
			modifier = opinion_angry
			who = FROM
			years = 10
		}
	}
}

#I seduced a vassal's daughter and now he's angry
character_event = {
	id = 72094
	desc = "EVTDESC72094"
	picture = GFX_evt_pregnancy

	is_triggered_only = yes

	option = {
		name = "EVTOPTA72094"
		opinion = {
			modifier = opinion_angry
			who = FROM
			years = 10
		}
		reverse_opinion = {
			modifier = opinion_angry
			who = FROM
			years = 10
		}
	}
}

#My son seduced a vassal's daughter and he is upset
character_event = {
	id = 72095
	desc = "EVTDESC72095"
	picture = GFX_evt_pregnancy

	is_triggered_only = yes

	option = {
		name = "EVTOPTA72095"
		reverse_opinion = {
			modifier = opinion_upset
			who = FROM
			years = 10
		}
	}
}

#I seduced a vassal's daughter and he is upset
character_event = {
	id = 72096
	desc = "EVTDESC72096"
	picture = GFX_evt_pregnancy

	is_triggered_only = yes

	option = {
		name = "EVTOPTA72096"
		reverse_opinion = {
			modifier = opinion_upset
			who = FROM
			years = 10
		}
	}
}

#Two months later...
character_event = {
	id = 72097
	desc = "EVTDESC72097"
	picture = GFX_evt_pregnancy

	prisoner = no
	is_triggered_only = yes

	trigger = {
		event_target:vassals_daughter = {
			is_alive = yes
			is_pregnant = yes
		}
		war = no
		FROM = {
			is_married = no
			is_betrothed = no
		}
	}

	option = { 
		name = {
			text = "EVTOPTA72097" #The seducer (FROM) must marry my daughter!
			trigger = {
				FROM = {
					is_liege_of = ROOT
				}
			}
		}
		name = {
			text = "EVTOPTB72097" #My liege must order the seducer (FROM) to marry my daughter!
			trigger = {
				NOT = {
					FROM = {
						is_liege_of = ROOT
					}
				}
			}
		}
		if = {
			limit = {
				FROM = {
					is_liege_of = ROOT
				}
			}
			FROM = { character_event = { id = 72098 tooltip = "EVTTOOLTIP72098" } }
			break = yes
		}
		FROM = { character_event = { id = 72099 tooltip = "EVTTOOLTIP72099" } }	
	}

	option = {
		name = "EVTOPTC72097" #Hold my anger
		prestige = 10
	}
}

#FROM demands ROOT to marry pregnant daughter
character_event = {
	id = 72098
	desc = "EVTDESC72098"
	picture = GFX_evt_marriage

	is_triggered_only = yes

	option = {
		name = "EVTOPTA72098" #Accept
		FROM = {
			random_child = {
				limit = {
					has_character_flag = impregnated_by_root
				}
				add_spouse = ROOT
				clr_character_flag = impregnated_by_root
			}
		}
	}
	option = {
		name = "EVTOPTB72098" #Refuse
		reverse_opinion = {
			modifier = grievously_offended
			who = FROM
			years = 20
		}
		FROM = {
			random_child = {
				limit = {
					has_character_flag = impregnated_by_root
				}
				clr_character_flag = impregnated_by_root
			}
		}
	}
}

#FROM demands ROOT to marry pregnant daughter with his son
character_event = {
	id = 72099
	desc = "EVTDESC72099"
	picture = GFX_evt_marriage

	is_triggered_only = yes

	option = {
		name = "EVTOPTA72099" #Accept
		any_child = {
			limit = {
				has_character_flag = impregnated_vassal_daughter
			}
			character_event = {
				id = 72100
				tooltip = "EVTTOOLTIP72100"
			}
		}
	}
	option = {
		name = "EVTOPTB72099" #Refuse
		reverse_opinion = {
			modifier = grievously_offended
			who = FROM
			years = 20
		}
	}
}

#Liege's son marries vassal's pregnant daughter
character_event = {
	id = 72100
	desc = "EVTDESC72100"
	picture = GFX_evt_marriage

	is_triggered_only = yes

	option = {
		name = "EVTOPTA72100" #Accept
		FROM = {
			any_vassal = {
				random_child = {
					limit = {
						has_character_flag = impregnated_by_root
					}
					add_spouse = ROOT
				}
			}
		}
	}
}

###################################
#Events to end the Feast
###################################

#The feast has ended
character_event = {
	id = 72110
	desc = "EVTDESC72110"
	picture = GFX_evt_feast

	capable_only = yes
	prisoner = no

	is_triggered_only = yes

	trigger = {
		has_character_modifier = holding_large_feast
	}

	option = {
		name = "EVTOPTA72110"
		prestige = 10
		remove_character_modifier = holding_large_feast
		set_character_flag = recent_feast
		clr_character_flag = sent_invitations
		clr_character_flag = host_feast_started
		clr_character_flag = feast_jongleur
		clr_character_flag = feast_musicians
		clr_character_flag = feast_minstrel
		clr_character_flag = feast_fireeaters
		clr_character_flag = feast_conjurer
		clr_character_flag = lavishly_food
		clr_character_flag = medium_food
		clr_character_flag = low_food
		clr_character_flag = castle_problems
		clr_character_flag = feast_jester
		clr_character_flag = feast_drunkard_guest
		clr_character_flag = feast_duel
		clr_character_flag = feast_boar_hunt
		clr_character_flag = do_not_disturb

		any_vassal = {
			limit = {
				has_character_flag = guest_feast_started
			}
			hidden_tooltip = {
				character_event = {
					id = 72111
				}
				remove_opinion = {
					modifier = opinion_enjoyed_feast
					who = ROOT
				}
			}
			opinion = {
				modifier = opinion_enjoyed_feast
				who = ROOT
				years = 2
			}
			clr_character_flag = coming_to_feast
			clr_character_flag = guest_feast_started
			clr_character_flag = wounded_opponent
			clr_character_flag = maimed_opponent
			clr_character_flag = killed_opponent
		}
	}
}

#Vassal: Feast ended
character_event = {
	id = 72111
	desc = "EVTDESC72111"
	picture = GFX_evt_feast

	is_triggered_only = yes

	option = {
		name = "EVTOPTA72111"
		prestige = 5
	}
}

#The feast is cancelled
character_event = {
	id = 72112
	desc = "EVTDESC72112"
	picture = GFX_evt_feast

	only_rulers = yes
	war = yes

	trigger = {
		has_character_modifier = holding_large_feast
	}

	mean_time_to_happen = {
		days = 1
	}

	option = {
		name = "EVTOPTA72112"
		remove_character_modifier = holding_large_feast
		set_character_flag = recent_feast
		clr_character_flag = sent_invitations
		clr_character_flag = host_feast_started
		clr_character_flag = feast_jongleur
		clr_character_flag = feast_musicians
		clr_character_flag = feast_minstrel
		clr_character_flag = feast_fireeaters
		clr_character_flag = feast_conjurer
		clr_character_flag = lavishly_food
		clr_character_flag = medium_food
		clr_character_flag = low_food
		clr_character_flag = castle_problems
		clr_character_flag = feast_jester
		clr_character_flag = feast_drunkard_guest
		clr_character_flag = feast_duel
		clr_character_flag = feast_boar_hunt

		any_vassal = {
			limit = {
				has_character_flag = guest_feast_started
			}
			letter_event = {
				id = 72113
				tooltip = "EVTTOOLTIP72113"
			}
			clr_character_flag = coming_to_feast
			clr_character_flag = guest_feast_started
			clr_character_flag = wounded_opponent
			clr_character_flag = maimed_opponent
			clr_character_flag = killed_opponent
		}
	}
}

#Feast cancelled: notify invited vassals
letter_event = {
	id = 72113
	desc = "EVTDESC72113"

	is_triggered_only = yes

	option = {
		name = "EVTOPTA72113"
	}
}

#Travelling Acrobats
character_event = {
	id = 4160
	desc = "EVTDESC4160"
	picture = "GFX_evt_jugglers"

	min_age = 20
	only_playable = yes
	only_men = yes
	capable_only = yes
	prisoner = no
	war = no
	has_character_flag = host_feast_started

	is_triggered_only = yes

	trigger = {
		in_command = no
		has_character_flag = feast_acrobats
		has_character_modifier = holding_large_feast
	}

	immediate = {
		hidden_tooltip = {
			random_vassal = {
				limit = {
					has_character_flag = guest_feast_started
				}
				character_event = {
					id = 72115
				}
			}
		}
	}
	option = {
		name = "EVTOPTD4160"
		prestige = 10
	}
}

#Visitor likes acrobats
character_event = {
	id = 72115
	desc = "EVTDESC72115"
	picture = GFX_evt_jugglers

	is_triggered_only = yes

	option = {
		name = "EVTOPTA72115"
		opinion = {
			modifier = opinion_approves
			who = FROM
			years = 10
		}
		hidden_tooltip = {
			FROM = {
				character_event = {
					id = 72116
				}
			}
		}
	}
}

#Liege likes that visitor likes acrobats
character_event = {
	id = 72116
	desc = "EVTDESC72116"
	picture = GFX_evt_jugglers

	is_triggered_only = yes

	option = {
		name = "EVTOPTA72116"
		opinion = {
			modifier = opinion_approves
			who = FROM
			years = 10
		}
	}
}

#Travelling Dancers seek your patronage
character_event = {
	id = 72120
	desc = EVTDESC72120
	picture = GFX_evt_jugglers

	only_rulers = yes
	capable_only = yes
	prisoner = no
	war = no

	is_triggered_only = yes

	trigger = {
		has_character_modifier = holding_large_feast
		NOT = {
			has_character_flag = sent_invitations
		}
		NOT = {
			has_character_flag = host_feast_started
		}
		NOT = {
			has_character_flag = feast_dancers
		}
	}

	option = {
		name = EVTOPTA72120
		ai_chance = {
			factor = 5

			modifier = {
				factor = 0.1
				NOT = {
					treasury = 30
				}
			}
			modifier = {
				factor = 20
				treasury = 30
			}
		}
		set_character_flag = feast_dancers
		wealth = -10
	}
	option = {
		name = EVTOPTB72120
		ai_chance = {
			factor = 5

			modifier = {
				factor = 20
				NOT = {
					treasury = 30
				}
			}
			modifier = {
				factor = 0.1
				treasury = 30
			}
		}
		prestige = -10
	}
}

#Travelling Dancers
character_event = {
	id = 4165
	desc = EVTDESC4165
	picture = GFX_evt_jugglers
	
	only_playable = yes
	war = no
	has_character_flag = host_feast_started

	trigger = {
		in_command = no
		has_character_flag = feast_dancers
		has_character_modifier = holding_large_feast
	}

	is_triggered_only = yes

	option = {
		name = EVTOPTA4165
		prestige = 15
	}
}

###########################################
# Flag management                         #
###########################################

# Safety catch - clears character flags and modifiers
character_event = {
	id = 72999

	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		remove_character_modifier = holding_large_feast
		clr_character_flag = sent_invitations
		clr_character_flag = host_feast_started
		clr_character_flag = feast_jongleur
		clr_character_flag = feast_musicians
		clr_character_flag = feast_minstrel
		clr_character_flag = feast_fireeaters
		clr_character_flag = feast_conjurer
		clr_character_flag = lavishly_food
		clr_character_flag = medium_food
		clr_character_flag = low_food
		clr_character_flag = castle_problems
		clr_character_flag = feast_jester 
		clr_character_flag = feast_drunkard_guest
		clr_character_flag = feast_duel
		clr_character_flag = feast_boar_hunt
		clr_character_flag = coming_to_feast
		clr_character_flag = guest_feast_started
		clr_character_flag = wounded_opponent
		clr_character_flag = maimed_opponent
		clr_character_flag = killed_opponent
		clr_character_flag = do_not_disturb
	}
}
