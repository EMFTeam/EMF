# -*- ck2.events -*-

#################################
#
# THE REPUBLIC
# - dynasty Feud Events
#
#################################

# Written by Henrik Eklund
# Heavily modified by Delnar_Ersike to accommodate for multiple feuds in one republic and to allow for AI-AI and Human-Human feuds.

namespace = REP

# The Great Ball (AI) - EMF: Instigator can now be human
character_event = {
	id = REP.100
	title = EVTNAME_REP_100
	desc = EVTDESC_REP_100
	picture = GFX_evt_courtiers_talking
	min_age = 16
	is_patrician = yes
	capable_only = yes
	prisoner = no
	
	trigger = {
		has_dlc = "The Republic"
		liege = { is_merchant_republic = yes }
		in_command = no
		OR = {
			liege = { 
				is_patrician = yes
				is_adult = yes
				in_command = no
				prisoner = no
				is_incapable = no
				NOT = { reverse_opinion = { who = ROOT value = 0 } }
				NOT = { has_dynasty_flag = the_victims }
				NOT = { has_character_flag = the_grand_ball }
				NOT = { is_inaccessible_trigger = yes }
				NOT = { has_any_opinion_modifier = opinion_feuding_family }
			}
			liege = {
				any_vassal = {
					is_patrician = yes
					is_adult = yes
					in_command = no
					prisoner = no
					NOT = { reverse_opinion = { who = ROOT value = 0 } }
					is_incapable = no
					NOT = { has_dynasty_flag = the_victims }
					NOT = { has_character_flag = the_grand_ball }
					NOT = { is_inaccessible_trigger = yes }
					NOT = { has_any_opinion_modifier = opinion_feuding_family }
				}
			}
		}
		NOT = { has_dynasty_flag = the_feuders }
	}
	
	mean_time_to_happen = {
		months = 320
	}
	
	immediate = {
		random_list = {
			10 = {
				modifier = {
					factor = 0
					liege = {
						OR = {
							is_adult = no
							in_command = yes
							prisoner = yes
							is_incapable = yes
							reverse_opinion = { who = ROOT value = 0 }
							has_dynasty_flag = the_victims
							has_character_flag = the_grand_ball
							is_inaccessible_trigger = yes
							has_any_opinion_modifier = opinion_feuding_family
						}
					}
				}
				liege = {
					save_event_target_as = feud_victim
				}
			}
			30 = {
				liege = {
					random_vassal = {
						limit = {
							is_patrician = yes
							is_adult = yes
							in_command = no
							prisoner = no
							NOT = { reverse_opinion = { who = ROOT value = 0 } }
							NOT = { has_dynasty_flag = the_victims }
							NOT = { is_inaccessible_trigger = yes }
							NOT = { has_any_opinion_modifier = opinion_feuding_family }
						}
						save_event_target_as = feud_victim
					}
				}
			}
		}
	}
	
	option = {
		name = EVTOPTA_REP_100
		
		event_target:feud_victim = { 
			narrative_event = { id = REP.101 }
			set_character_flag = the_grand_ball
		}
	}
}

# The Great Ball (Player)
narrative_event = {
	id = REP.101
	title = EVTNAME_REP_101
	desc = EVTDESC_REP_101
	picture = GFX_evt_courtiers_talking
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_REP_101
		FROM = { set_dynasty_flag = the_feuders }
		set_dynasty_flag = the_victims
		narrative_event = { id = REP.102 days = 15 tooltip = EVTTOOLTIP_REP_102 } 
	}
	option = {
		name = EVTOPTB_REP_101
		prestige = -60
		custom_tooltip = { text = no_ball_tooltip }
		clr_character_flag = the_grand_ball
	}
}

# Arriving at the Ball...
narrative_event = {
	id = REP.102
	title = EVTNAME_REP_102
	desc = EVTDESC_REP_102
	picture = GFX_evt_scandal
	
	hide_from = yes
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_REP_102
		FROMFROM = {
			set_character_flag = shamed_player_at_ball
		}
		set_character_flag = shamed_at_ball
		prestige = -100
		FROMFROM = { narrative_event = { id = REP.106 } }
		custom_tooltip = { text = feud_begins_tooltip }
	}
}

narrative_event = {
	id = REP.106
	title = EVTNAME_REP_106
	desc = EVTDESC_REP_106
	picture = GFX_evt_scandal
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_REP_106
		prestige = 100
	}
}

# The Even Greater Ball (AI)
character_event = {
	id = REP.103
	hide_window = yes
	
	is_patrician = yes
	has_character_flag = shamed_player_at_ball
	
	trigger = {
		has_dlc = "The Republic"
		liege = { is_merchant_republic = yes }
		OR = {
			liege = {
				has_character_flag = shamed_at_ball
				is_patrician = yes
				in_command = no
				prisoner = no
				is_incapable = no
				NOT = { trait = infirm }
				has_opinion_modifier = { who = ROOT modifier = opinion_feuding_family }
			}
			liege = {
				any_vassal = {
					has_character_flag = shamed_at_ball
					is_patrician = yes
					in_command = no
					prisoner = no
					is_incapable = no
					NOT = { trait = infirm }
					has_opinion_modifier = { who = ROOT modifier = opinion_feuding_family }
				}
			}
		}
	}
	
	mean_time_to_happen = {
		months = 80
	}
	
	immediate = {
		clr_character_flag = shamed_player_at_ball
		if = {
			limit = {
				liege = {
					has_character_flag = shamed_at_ball
					has_opinion_modifier = { who = ROOT modifier = opinion_feuding_family }
				}
			}
			liege = { 
				narrative_event = { id = REP.104 } 
			}
		}
		if = {
			limit = {
				liege = { 
					any_vassal = {
						is_patrician = yes
						has_character_flag = shamed_at_ball
						has_opinion_modifier = { who = ROOT modifier = opinion_feuding_family }
					}
				}
			}
			liege = {
				random_vassal = {
					limit = {
						is_patrician = yes
						has_character_flag = shamed_at_ball
						has_opinion_modifier = { who = ROOT modifier = opinion_feuding_family }
					}
					narrative_event = { id = REP.104 } 
				}
			}
		}
	}
}

# The Even Greater Ball (Player)
narrative_event = {
	id = REP.104
	title = EVTNAME_REP_104
	desc = EVTDESC_REP_104
	picture = GFX_evt_courtiers_talking
	
	hide_from = yes
	
	is_triggered_only = yes
	
	immediate = {
		clr_character_flag = shamed_at_ball
	}
	
	option = {
		name = EVTOPTA_REP_104
		wealth = -100
		FROM = {
			narrative_event = { id = REP.106 }
		}
		narrative_event = { id = REP.105 days = 14 tooltip = EVTTOOLTIP_REP_105 } 
	}
	option = {
		name = EVTOPTB_REP_104
		prestige = -20
		custom_tooltip = { text = no_own_ball_tooltip }
	}
}

narrative_event = {
	id = REP.107
	title = EVTNAME_REP_107
	desc = EVTDESC_REP_107
	picture = GFX_evt_courtiers_talking
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_REP_107
	}
}

# The Day of the Ball
narrative_event = {
	id = REP.105
	title = EVTNAME_REP_105
	desc = EVTDESC_REP_105
	picture = GFX_evt_family_feud_republic
	
	hide_from = yes
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_REP_105
		prestige = 150
		FROMFROM = { character_event = { id = REP.106 } }
	}
}

# The Day of the Ball (Victim)
narrative_event = {
	id = REP.108
	title = EVTNAME_REP_108
	desc = EVTDESC_REP_108
	picture = GFX_evt_family_feud_republic
	
	hide_from = yes
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_REP_108
		prestige = -100
	}
}

# AI gets Feuding opinion modifier (AI only)
character_event = {
	id = REP.109
	hide_window = yes
	
	is_patrician = yes
	
	trigger = {
		has_dlc = "The Republic"
		has_dynasty_flag = the_feuders
		liege = { is_merchant_republic = yes }
		OR = {
			liege = {
				has_dynasty_flag = the_victims
				NOT = {
					reverse_has_opinion_modifier = {
						who = ROOT
						modifier = opinion_feuding_family
					}
				}
			}
			liege = {
				any_vassal = {
					is_patrician = yes
					has_dynasty_flag = the_victims
					NOT = {
						reverse_has_opinion_modifier = {
							who = ROOT
							modifier = opinion_feuding_family
						}
					}
				}
			}
		}
	}
	
	mean_time_to_happen = {
		days = 1
	}
	
	immediate = {
		if = {
			limit = {
				liege = {
					has_dynasty_flag = the_victims
					NOT = {
						reverse_has_opinion_modifier = {
							who = ROOT
							modifier = opinion_feuding_family
						}
					}
				}
			}
			liege = { 
				reverse_opinion = {
					who = ROOT
					modifier = opinion_feuding_family
				}
				ROOT = {
					any_dynasty_member = {
						limit = {
							NOT = {
								has_opinion_modifier = {
									who = PREVPREV
									modifier = opinion_feuding_family_light
								}
							}
						}
						opinion = {
							who = PREVPREV
							modifier = opinion_feuding_family_light
						}
					}
				}
			}
		}
		if = {
			limit = {
				liege = { 
					any_vassal = {
						is_patrician = yes
						has_dynasty_flag = the_victims
						NOT = {
							reverse_has_opinion_modifier = {
								who = ROOT
								modifier = opinion_feuding_family
							}
						}
					}
				}
			}
			liege = {
				random_vassal = {
					limit = {
						is_patrician = yes
						has_dynasty_flag = the_victims
						NOT = {
							reverse_has_opinion_modifier = {
								who = ROOT
								modifier = opinion_feuding_family
							}
						}
					}
					reverse_opinion = {
						who = ROOT
						modifier = opinion_feuding_family
					}
					ROOT = {
						any_dynasty_member = {
							limit = {
								NOT = {
									has_opinion_modifier = {
										who = PREVPREV
										modifier = opinion_feuding_family_light
									}
								}
							}
							opinion = {
								who = PREVPREV
								modifier = opinion_feuding_family_light
							}
						}
					}
				}
			}
		}
	}
}

### The Flagship

# The New Flagship (AI)
character_event = {
	id = REP.150
	hide_window = yes

	is_patrician = yes
	
	trigger = {
		has_dlc = "The Republic"
		liege = { is_merchant_republic = yes }
		OR = {
			liege = {
				has_opinion_modifier = { who = ROOT modifier = opinion_feuding_family }
				NOT = { has_dynasty_flag = flagship_feud }
				is_patrician = yes
				is_adult = yes
				in_command = no
				prisoner = no
				job_spymaster = {
					NOT = { character = ROOT }
				}
				is_incapable = no
				NOT = {
					trait = infirm
				}
				NOT = { is_inaccessible_trigger = yes }
			}
			liege = {
				any_vassal = {
					is_patrician = yes
					has_opinion_modifier = { who = ROOT modifier = opinion_feuding_family }
					NOT = { has_dynasty_flag = flagship_feud }
					is_adult = yes
					in_command = no
					prisoner = no
					is_incapable = no
					NOT = {
						trait = infirm
					}
					NOT = { is_inaccessible_trigger = yes }
				}
			}
		}
	}
	
	mean_time_to_happen = {
		months = 520
	}
	
	immediate = {
		if = {
			limit = {
				liege = {
					has_opinion_modifier = { who = ROOT modifier = opinion_feuding_family }
					NOT = { has_dynasty_flag = flagship_feud }
					is_adult = yes
					in_command = no
					prisoner = no
					is_incapable = no
					NOT = {
						trait = infirm
					}
					NOT = { is_inaccessible_trigger = yes }
				}
			}
			liege = { 
				narrative_event = { id = REP.151 }
			}
		}
		if = {
			limit = {
				liege = { 
					any_vassal = {
						is_patrician = yes
						has_opinion_modifier = { who = ROOT modifier = opinion_feuding_family }
						NOT = { has_dynasty_flag = flagship_feud }
						is_adult = yes
						in_command = no
						prisoner = no
						is_incapable = no
						NOT = {
							trait = infirm
						}
						NOT = { is_inaccessible_trigger = yes }
					}
				}
			}
			liege = {
				random_vassal = {
					limit = {
						is_patrician = yes
						has_opinion_modifier = { who = ROOT modifier = opinion_feuding_family }
						is_adult = yes
						in_command = no
						prisoner = no
						is_incapable = no
						NOT = {
							trait = infirm
						}
						NOT = { is_inaccessible_trigger = yes }
					}
					narrative_event = { id = REP.151 }
				}
			}
		}
	}
}

# The New Flagship (Player)
narrative_event = {
	id = REP.151
	title = EVTNAME_REP_151
	desc = EVTDESC_REP_151
	picture = GFX_evt_busy_trading_dock_republic
	
	is_triggered_only = yes
	
	immediate = {
		set_dynasty_flag = flagship_feud
	}
	
	option = {
		name = EVTOPTA_REP_151
		hidden_tooltip = {
			random_list = {
				70 = {
					if = {
						limit = {
							liege = {
								has_landed_title = k_venice
								OR = {
									religion = catholic
									religion = fraticelli
								}
							}
							OR = {
								religion = catholic
								religion = fraticelli
							}
						}
						narrative_event = { id = REP.152 days = 46 }
					}
					if = {
						limit = {
							OR = {
								liege = { NOT = { has_landed_title = k_venice }}
								liege = {
									NOR = {
										religion = catholic
										religion = fraticelli
									}
								}
								NOR = {
									religion = catholic
									religion = fraticelli
								}
							}
						}
						narrative_event = { id = REP.153 days = 46 }
					}
				}
				30 = {
					narrative_event = { id = REP.155 days = 46 }
				}
			}
		}
		custom_tooltip = { text = flagship_plan_approved_tooltip }
	}
	option = {
		name = EVTOPTB_REP_151
		hidden_tooltip = {
			narrative_event = { id = REP.154 days = 46 }
		}
		custom_tooltip = { text = flagship_plan_refused_tooltip }
	}
}

# Marriage of the Sea (Venice Only)
narrative_event = {
	id = REP.152
	title = EVTNAME_REP_152
	desc = EVTDESC_REP_152
	picture = GFX_evt_merchant_ship_at_sea_republic
	
	hide_from = yes
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_REP_152
		prestige = 50
		FROMFROM = { narrative_event = { id = REP.156 } }
		religion_head = {
			opinion = {
				modifier = opinion_furious
				who = FROMFROM
				years = 5
			}
		}
		set_dynasty_flag = feud_phase_two
	}
}

narrative_event = {
	id = REP.156
	title = EVTNAME_REP_152
	desc = EVTDESC_REP_156
	picture = GFX_evt_merchant_ship_at_sea_republic
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_REP_156
		prestige = -100
		set_dynasty_flag = feud_phase_two
	}
}

# The Ship is Launched
narrative_event = {
	id = REP.153
	title = EVTNAME_REP_153
	desc = EVTDESC_REP_153
	picture = GFX_evt_merchant_ship_at_sea_republic
	
	hide_from = yes
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_REP_152
		prestige = 50
		FROMFROM = { narrative_event = { id = REP.157 } }
		set_dynasty_flag = feud_phase_two
	}
}

narrative_event = {
	id = REP.157
	title = EVTNAME_REP_157
	desc = EVTDESC_REP_157
	picture = GFX_evt_merchant_ship_at_sea_republic
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_REP_157
		prestige = -100
		set_dynasty_flag = feud_phase_two
	}
}

# The Lion of the Sea
narrative_event = {
	id = REP.154
	title = EVTNAME_REP_154
	desc = EVTDESC_REP_154
	picture = GFX_evt_merchant_ship_at_sea_republic
	
	hide_from = yes
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_REP_154
		prestige = -50
		FROMFROM = { narrative_event = { id = REP.158 } }
		set_dynasty_flag = feud_phase_two
	}
}

narrative_event = {
	id = REP.158
	title = EVTNAME_REP_154
	desc = EVTDESC_REP_158
	picture = GFX_evt_merchant_ship_at_sea_republic
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_REP_152
		prestige = 100
		set_dynasty_flag = feud_phase_two
	}
}

# You Are Cordially Invited...
narrative_event = {
	id = REP.155
	title = EVTNAME_REP_155
	desc = EVTDESC_REP_155
	picture = GFX_evt_family_feud_republic
	
	hide_from = yes
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_REP_155
		prestige = -50
		FROMFROM = { narrative_event = { id = REP.159 } }
		set_dynasty_flag = feud_phase_two
	}
}

narrative_event = {
	id = REP.159
	title = EVTNAME_REP_159
	desc = EVTDESC_REP_159
	picture = GFX_evt_merchant_ship_at_sea_republic
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_REP_159
		prestige = 100
		set_dynasty_flag = feud_phase_two
	}
}

### Romeo & Juliet

# A Nightly Visit... (Daughter) (AI)
character_event = {
	id = REP.160
	hide_window = yes
	
	min_age = 15
	ai = yes
	only_men = yes
	capable_only = yes
	prisoner = no
	has_dlc = "The Republic"
	is_married = no
	
	trigger = {
		in_command = no
		NOR = { 
			practical_age = 30 
			trait = homosexual
			trait = infirm
			trait = eunuch
		}
		is_incapable = no
		NOT = { is_inaccessible_trigger = yes }
		father = {
			liege = { is_merchant_republic = yes }
			is_patrician = yes
			prisoner = no
			in_command = no
			is_incapable = no
			NOT = { is_inaccessible_trigger = yes }
			has_any_opinion_modifier = opinion_feuding_family
			OR = {
				liege = {
					has_dynasty_flag = feud_phase_two
					is_patrician = yes
					in_command = no
					prisoner = no
					is_incapable = no
					NOT = { is_inaccessible_trigger = yes }
					has_opinion_modifier = { who = PREV modifier = opinion_feuding_family }
					any_child = {
						is_female = yes
						is_married = no
						age = 15
						NOT = { practical_age = 30 }
						prisoner = no
						is_incapable = no
						NOT = {
							trait = infirm
							trait = homosexual
						}
						NOT = { is_inaccessible_trigger = yes }
					}
				}
				liege = {
					any_vassal = {
						is_patrician = yes
						has_dynasty_flag = feud_phase_two
						prisoner = no
						in_command = no
						is_incapable = no
						NOT = { is_inaccessible_trigger = yes }
						has_opinion_modifier = { who = PREVPREV modifier = opinion_feuding_family }
						any_child = {
							is_female = yes
							is_married = no
							age = 15
							NOT = { practical_age = 30 }
							prisoner = no
							is_incapable = no
							NOT = {
								trait = infirm
								trait = homosexual
							}
							NOT = { is_inaccessible_trigger = yes }
						}
					}
				}
			}
		}
	}
	
	immediate = {
		father = {
			if = {
				limit = {
					liege = {
						has_dynasty_flag = feud_phase_two
						prisoner = no
						in_command = no
						is_incapable = no
						NOT = { is_inaccessible_trigger = yes }
						has_opinion_modifier = { who = PREV modifier = opinion_feuding_family }
					}
				}
				liege = { 
					narrative_event = { id = REP.161 }
				}
			}
			if = {
				limit = {
					liege = { 
						any_vassal = {
							is_patrician = yes
							has_dynasty_flag = feud_phase_two
							prisoner = no
							in_command = no
							is_incapable = no
							NOT = { is_inaccessible_trigger = yes }
							has_opinion_modifier = { who = PREVPREV modifier = opinion_feuding_family }
						}
					}
				}
				liege = {
					random_vassal = {
						limit = {
							is_patrician = yes
							has_dynasty_flag = feud_phase_two
							prisoner = no
							in_command = no
							is_incapable = no
							NOT = { is_inaccessible_trigger = yes }
							has_opinion_modifier = { who = PREVPREV modifier = opinion_feuding_family }
						}
						narrative_event = { id = REP.161 }
					}
				}
			}
		}
		save_event_target_as = romeo
		father = {
			save_event_target_as = rival_father
		}
	}
	
	mean_time_to_happen = {
		months = 100
	}
}

# A Nightly Visit... (Daughter)
narrative_event = {
	id = REP.161
	title = EVTNAME_REP_161
	desc = EVTDESC_REP_161
	picture = GFX_evt_family_feud_republic
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_REP_161
		hidden_tooltip = {
			event_target:romeo = {
				father = {
					narrative_event = { id = REP.170 }
				}
			}
		}
		random_child = {
			limit = {
				is_female = yes
				can_marry = event_target:romeo
				age = 15
				NOT = { practical_age = 30 }
				prisoner = no
				is_incapable = no
				NOT = {
					trait = infirm
					trait = homosexual
				}
			}
			add_lover = event_target:romeo
			save_event_target_as = julia
			custom_tooltip = { text = forbid_daughter_tooltip }
		}
	}
	option = {
		name = EVTOPTB_REP_161
		hidden_tooltip = {
			event_target:romeo = {
				father = {
					narrative_event = { id = REP.169 }
				}
			}
		}
		random_child = {
			limit = {
				is_female = yes
				can_marry = event_target:romeo
				age = 15
				NOT = { practical_age = 30 }
				prisoner = no
				is_incapable = no
				NOT = {
					trait = infirm
					trait = homosexual
				}
			}
			add_lover = event_target:romeo
			save_event_target_as = julia
			custom_tooltip = { text = permit_love_tooltip }
		}
	}
}

narrative_event = {
	id = REP.169
	title = EVTNAME_REP_161
	desc = EVTDESC_REP_163
	picture = GFX_evt_family_feud_republic
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_REP_163
		hidden_tooltip = {
			random_list = {
				80 = {
					FROM = { narrative_event = { id = REP.164 days = 46 } }
				}
				20 = {
				}
			}
		}
		custom_tooltip = { text = forbid_son_tooltip }
	}
	
	option = {
		name = EVTOPTB_REP_161
		hidden_tooltip = { FROM = { narrative_event = { id = REP.166 days = 46 } } }
		custom_tooltip = { text = permit_love_tooltip }
	}
}

narrative_event = {
	id = REP.170
	title = EVTNAME_REP_161
	desc = EVTDESC_REP_163
	picture = GFX_evt_family_feud_republic
	
	is_triggered_only = yes
	
	immediate = {
		hidden_tooltip = {
			random_list = {
				80 = {
					FROM = { narrative_event = { id = REP.164 days = 46 } }
				}
				20 = {
				}
			}
		}
	}
	
	option = {
		name = EVTOPTA_REP_163
		custom_tooltip = { text = forbid_son_tooltip }
	}
	
	option = {
		name = EVTOPTB_REP_161
		custom_tooltip = { text = permit_love_tooltip }
	}
}

# A Nightly Visit... (Son) (AI)
character_event = {
	id = REP.162
	hide_window = yes
	
	min_age = 15
	ai = yes
	only_women = yes
	capable_only = yes
	prisoner = no
	has_dlc = "The Republic"
	is_married = no
	
	trigger = {
		is_incapable = no
		NOT = { 
			practical_age = 30 
			trait = homosexual
		}
		NOT = { is_inaccessible_trigger = yes }
		father = {
			liege = { is_merchant_republic = yes }
			is_patrician = yes
			prisoner = no
			in_command = no
			is_incapable = no
			NOT = { is_inaccessible_trigger = yes }
			OR = {
				liege = {
					has_dynasty_flag = feud_phase_two
					prisoner = no
					in_command = no
					is_incapable = no
					NOT = { is_inaccessible_trigger = yes }
					has_opinion_modifier = { who = PREV modifier = opinion_feuding_family }
					any_child = {
						age = 15
						is_female = no
						is_incapable = no
						NOT = { 
							practical_age = 30 
							trait = homosexual
							trait = infirm
							trait = eunuch
						}
						NOT = { is_inaccessible_trigger = yes }
						prisoner = no
						is_married = no
						in_command = no
					}
				}
				liege = {
					any_vassal = {
						is_patrician = yes
						has_dynasty_flag = feud_phase_two
						prisoner = no
						in_command = no
						is_incapable = no
						NOT = { is_inaccessible_trigger = yes }
						has_opinion_modifier = { who = PREVPREV modifier = opinion_feuding_family }
						any_child = {
							age = 15
							is_female = no
							is_incapable = no
							NOT = { 
								practical_age = 30 
								trait = homosexual
								trait = infirm
								trait = eunuch
							}
							NOT = { is_inaccessible_trigger = yes }
							prisoner = no
							is_married = no
							in_command = no
						}
					}
				}
			}
		}
	}
	
	immediate = {
		father = {
			if = {
				limit = {
					liege = {
						has_dynasty_flag = feud_phase_two
						prisoner = no
						in_command = no
						is_incapable = no
						NOT = { is_inaccessible_trigger = yes }
						has_opinion_modifier = { who = PREV modifier = opinion_feuding_family }
					}
				}
				liege = { 
					narrative_event = { id = REP.163 }
				}
			}
			if = {
				limit = {
					liege = { 
						any_vassal = {
							is_patrician = yes
							has_dynasty_flag = feud_phase_two
							prisoner = no
							in_command = no
							is_incapable = no
							NOT = { is_inaccessible_trigger = yes }
							has_opinion_modifier = { who = PREVPREV modifier = opinion_feuding_family }
						}
					}
				}
				liege = {
					random_vassal = {
						limit = {
							is_patrician = yes
							has_dynasty_flag = feud_phase_two
							prisoner = no
							in_command = no
							is_incapable = no
							NOT = { is_inaccessible_trigger = yes }
							has_opinion_modifier = { who = PREVPREV modifier = opinion_feuding_family }
						}
						narrative_event = { id = REP.163 }
					}
				}
			}
		}
		save_event_target_as = julia
		father = {
			save_event_target_as = rival_father
		}
	}
	
	mean_time_to_happen = {
		months = 100
	}
}

# A Nightly Visit... (Son)
narrative_event = {
	id = REP.163
	title = EVTNAME_REP_161
	desc = EVTDESC_REP_163
	picture = GFX_evt_family_feud_republic
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_REP_163
		hidden_tooltip = {
			event_target:julia = {
				father = {
					narrative_event = { id = REP.172 }
				}
			}
		}
		random_child = {
			limit = {
				age = 15
				is_female = no
				NOT = { 
					practical_age = 30 
					trait = homosexual
					trait = infirm
					trait = eunuch
				}
				is_incapable = no
				can_marry = event_target:julia
				prisoner = no
				in_command = no
			}
			add_lover = event_target:julia
			save_event_target_as = romeo
			custom_tooltip = { text = forbid_son_tooltip }
		}
	}
	option = {
		name = EVTOPTB_REP_161
		hidden_tooltip = {
			event_target:julia = {
				father = {
					narrative_event = { id = REP.171 }
				}
			}
		}
		random_child = {
			limit = {
				age = 15
				is_female = no
				NOT = { 
					practical_age = 30 
					trait = homosexual
					trait = infirm
					trait = eunuch
				}
				is_incapable = no
				can_marry = event_target:julia
				prisoner = no
				in_command = no
			}
			add_lover = event_target:julia
			save_event_target_as = romeo
			custom_tooltip = { text = permit_love_tooltip }
		}
	}
}

narrative_event = {
	id = REP.171
	title = EVTNAME_REP_161
	desc = EVTDESC_REP_161
	picture = GFX_evt_family_feud_republic
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_REP_161
		hidden_tooltip = {
			random_list = {
				80 = {
					FROM = { narrative_event = { id = REP.165 days = 46 } }
				}
				20 = {
				}
			}
		}
		custom_tooltip = { text = forbid_daughter_tooltip }
	}
	
	option = {
		name = EVTOPTB_REP_161
		hidden_tooltip = { FROM = { narrative_event = { id = REP.166 days = 46 } } }
		custom_tooltip = { text = permit_love_tooltip }
	}
}

narrative_event = {
	id = REP.172
	title = EVTNAME_REP_161
	desc = EVTDESC_REP_161
	picture = GFX_evt_family_feud_republic
	
	is_triggered_only = yes
	
	immediate = {
		hidden_tooltip = {
			random_list = {
				80 = {
					FROM = { narrative_event = { id = REP.165 days = 46 } }
				}
				20 = {
				}
			}
		}
	}
	
	option = {
		name = EVTOPTA_REP_161
		custom_tooltip = { text = forbid_daughter_tooltip }
	}
	
	option = {
		name = EVTOPTB_REP_161
		custom_tooltip = { text = permit_love_tooltip }
	}
}

# Never Was a Story of More Woe... (Daughter)
narrative_event = {
	id = REP.164
	title = EVTNAME_REP_164
	desc = EVTDESC_REP_164
	picture = GFX_evt_family_feud_republic
	
	hide_from = yes
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_REP_164
		set_dynasty_flag = feud_peace_1
		event_target:romeo = {
			father = { narrative_event = { id = REP.172 } }
			death = { death_reason = death_suicide_poison }
		}
		event_target:julia = {
			death = { death_reason = death_suicide_poison }
		}
		custom_tooltip = { text = end_feud_tooltip }
	}
	option = {
		name = EVTOPTB_REP_164
		event_target:romeo = {
			father = { narrative_event = { id = REP.173 } }
			death = { death_reason = death_suicide_poison }
		}
		event_target:julia = {
			death = { death_reason = death_suicide_poison }
		}
		custom_tooltip = { text = continue_feud_tooltip }
	}
}

# Never Was a Story of More Woe... (Son)
narrative_event = {
	id = REP.165
	title = EVTNAME_REP_164
	desc = EVTDESC_REP_165
	picture = GFX_evt_family_feud_republic
	
	hide_from = yes
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_REP_164
		set_dynasty_flag = feud_peace_1
		event_target:julia = {
			father = { narrative_event = { id = REP.173 } }
			death = { death_reason = death_suicide_poison }
		}
		event_target:romeo = {
			death = { death_reason = death_suicide_poison }
		}
		custom_tooltip = { text = end_feud_tooltip }
		ai_chance = {
			factor = 1
		}
	}
	option = {
		name = EVTOPTB_REP_165
		event_target:julia = {
			father = { narrative_event = { id = REP.174 } }
			death = { death_reason = death_suicide_poison }
		}
		event_target:romeo = {
			death = { death_reason = death_suicide_poison }
		}
		custom_tooltip = { text = continue_feud_tooltip }
		ai_chance = {
			factor = 0
		}
	}
}

narrative_event = {
	id = REP.173
	title = EVTNAME_REP_164
	desc = EVTDESC_REP_173
	picture = GFX_evt_family_feud_republic
	
	hide_from = yes
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_REP_164
		hidden_tooltip = {
			FROM = { narrative_event = { id = REP.167 days = 14 } }
		}
		tooltip = {
			event_target:romeo = {
				death = { death_reason = death_suicide_poison }
			}
			event_target:julia = {
				death = { death_reason = death_suicide_poison }
			}
		}
		custom_tooltip = { text = end_feud_tooltip }
		set_dynasty_flag = feud_peace_2
		ai_chance = {
			factor = 1
		}
	}
	
	option = {
		name = EVTOPTB_REP_173
		tooltip = {
			event_target:romeo = {
				death = { death_reason = death_suicide_poison }
			}
			event_target:julia = {
				death = { death_reason = death_suicide_poison }
			}
		}
		custom_tooltip = { text = continue_feud_tooltip }
		FROM = {
			clr_dynasty_flag = feud_peace_1
			narrative_event = { id = REP.175 }
		}
		ai_chance = {
			factor = 0
		}
	}
}

narrative_event = {
	id = REP.174
	title = EVTNAME_REP_164
	desc = EVTDESC_REP_174
	picture = GFX_evt_family_feud_republic
	
	hide_from = yes
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_REP_174
		
		tooltip = {
			event_target:romeo = {
				death = { death_reason = death_suicide_poison }
			}
			event_target:julia = {
				death = { death_reason = death_suicide_poison }
			}
		}
	}
}

narrative_event = {
	id = REP.175
	title = EVTNAME_REP_175
	desc = EVTDESC_REP_175
	picture = GFX_evt_family_feud_republic
	
	hide_from = yes
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_REP_175
		custom_tooltip = { text = continue_feud_tooltip }
	}
}

# Wedding Bells
narrative_event = {
	id = REP.166
	title = EVTNAME_REP_166
	desc = EVTDESC_REP_166
	picture = GFX_evt_marriage
	
	hide_from = yes
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_REP_166
		event_target:romeo = {
			add_spouse = event_target:julia
		}
		clr_dynasty_flag = the_victims
		clr_dynasty_flag = the_feuders
		clr_dynasty_flag = flagship_feud
		clr_dynasty_flag = smugglers_feud
		clr_dynasty_flag = feud_phase_two
		event_target:romeo = {
			father = {
				clr_dynasty_flag = the_victims
				clr_dynasty_flag = the_feuders
				clr_dynasty_flag = flagship_feud
				clr_dynasty_flag = smugglers_feud
				clr_dynasty_flag = feud_phase_two
				prestige = 100
				any_dynasty_member = {
					remove_opinion = { who = ROOT modifier = opinion_feuding_family }
					remove_opinion = { who = ROOT modifier = opinion_feuding_family_light }
				}
			}
		}
		event_target:julia = {
			father = {
				clr_dynasty_flag = the_victims
				clr_dynasty_flag = the_feuders
				clr_dynasty_flag = flagship_feud
				clr_dynasty_flag = smugglers_feud
				clr_dynasty_flag = feud_phase_two
				prestige = 100
				any_dynasty_member = {
					remove_opinion = { who = ROOT modifier = opinion_feuding_family }
					remove_opinion = { who = ROOT modifier = opinion_feuding_family_light }
				}
			}
		}
		FROM = { narrative_event = { id = REP.176 } }
	}
}

narrative_event = {
	id = REP.176
	title = EVTNAME_REP_166
	desc = EVTDESC_REP_166
	picture = GFX_evt_marriage
	
	hide_from = yes
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_REP_166
		tooltip = {
			event_target:romeo = {
				add_spouse = event_target:julia
			}
		}
		clr_dynasty_flag = the_victims
		clr_dynasty_flag = the_feuders
		clr_dynasty_flag = flagship_feud
		clr_dynasty_flag = smugglers_feud
		clr_dynasty_flag = feud_phase_two
	}
}

# Two Funerals and a Truce (AI)
narrative_event = {
	id = REP.167
	title = EVTNAME_REP_168
	desc = EVTDESC_REP_168
	picture = GFX_evt_death
	
	hide_from = yes
	
	is_patrician = yes
	
	trigger = {
		has_dlc = "The Republic"
		has_dynasty_flag = feud_peace_2
		OR = {
			liege = {
				has_dynasty_flag = feud_peace_1
				has_opinion_modifier = { who = PREV modifier = opinion_feuding_family }
			}
			any_vassal = {
				is_patrician = yes
				has_dynasty_flag = feud_peace_1
				has_opinion_modifier = { who = PREV modifier = opinion_feuding_family }
			}
			liege = {
				any_vassal = {
					is_patrician = yes
					has_dynasty_flag = feud_peace_1
					has_opinion_modifier = { who = PREVPREV modifier = opinion_feuding_family }
				}
			}
		}
	}
	
	mean_time_to_happen = {
		days = 1
	}
	
	option = {
		name = EVTOPTA_REP_168
		clr_dynasty_flag = feud_peace_2
		if = {
			limit = {
				liege = {
					has_dynasty_flag = feud_peace_1
					has_opinion_modifier = { who = PREV modifier = opinion_feuding_family }
				}
			}
			liege = { 
				narrative_event = { id = REP.168 }
				clr_dynasty_flag = feud_peace_1
			}
		}
		else_if = {
			limit = {
				any_vassal = {
					is_patrician = yes
					has_dynasty_flag = feud_peace_1
					has_opinion_modifier = { who = PREV modifier = opinion_feuding_family }
				}
			}
			random_vassal = {
				limit = {
					is_patrician = yes
					has_dynasty_flag = feud_peace_1
					has_opinion_modifier = { who = PREV modifier = opinion_feuding_family }
				}
				narrative_event = { id = REP.168 }
				clr_dynasty_flag = feud_peace_1
			}
		}
		else_if = {
			limit = {
				liege = { 
					any_vassal = {
						is_patrician = yes
						has_dynasty_flag = feud_peace_1
						has_opinion_modifier = { who = PREVPREV modifier = opinion_feuding_family }
					}
				}
			}
			liege = {
				random_vassal = {
					limit = {
						is_patrician = yes
						has_dynasty_flag = feud_peace_1
						has_opinion_modifier = { who = PREVPREV modifier = opinion_feuding_family }
					}
					narrative_event = { id = REP.168 }
					clr_dynasty_flag = feud_peace_1
				}
			}
		}
	}	
}

# Two Funerals and a Truce (Player)
narrative_event = {
	id = REP.168
	title = EVTNAME_REP_168
	desc = EVTDESC_REP_168
	picture = GFX_evt_death
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_REP_168
		clr_dynasty_flag = the_victims
		clr_dynasty_flag = the_feuders
		clr_dynasty_flag = flagship_feud
		clr_dynasty_flag = smugglers_feud
		clr_dynasty_flag = feud_phase_two
		hidden_tooltip = {
			FROM = {
				clr_dynasty_flag = the_victims
				clr_dynasty_flag = the_feuders
				clr_dynasty_flag = flagship_feud
				clr_dynasty_flag = smugglers_feud
				clr_dynasty_flag = feud_phase_two
				remove_opinion = { who = ROOT modifier = opinion_feuding_family }
				any_dynasty_member = {
					remove_opinion = { who = FROM modifier = opinion_feuding_family_light }
				}
			}
		}
	}
}

### The Smugglers

# The Smugglers (AI Patrician)
character_event = {
	id = REP.180
	hide_window = yes
	
	min_age = 30
	is_patrician = yes
	capable_only = yes
	prisoner = no
	
	trigger = {
		has_dlc = "The Republic"
		liege = { is_merchant_republic = yes }
		wealth = 200
		OR = {
			liege = { 
				is_patrician = yes
				in_command = no
				prisoner = no
				is_incapable = no
				NOT = { has_dynasty_flag = smugglers_feud }
				has_opinion_modifier = { who = PREV modifier = opinion_feuding_family }
				any_child = {
					is_female = no
					is_alive = yes
					is_adult = yes
					NOT = { practical_age = 35 }
					in_command = no
					prisoner = no
					is_incapable = no
					NOR = { 
						trait = infirm
						trait = blinded
						trait = craven
					}
					NOT = { is_inaccessible_trigger = yes }
				}
			}
			liege = {
				any_vassal = {
					is_patrician = yes
					in_command = no
					prisoner = no
					is_incapable = no
					NOT = { has_dynasty_flag = smugglers_feud }
					has_opinion_modifier = { who = PREVPREV modifier = opinion_feuding_family }
					any_child = {
						is_female = no
						is_alive = yes
						is_adult = yes
						NOT = { practical_age = 35 }
						in_command = no
						prisoner = no
						is_incapable = no
						NOR = {
							trait = infirm
							trait = blinded
							trait = craven
						}
						NOT = { is_inaccessible_trigger = yes }
					}
				}
			}
		}
	}
	
	mean_time_to_happen = {
		months = 420
	}
	
	immediate = {
		if = {
			limit = {
				liege = {
					in_command = no
					prisoner = no
					is_incapable = no
					NOT = { has_dynasty_flag = smugglers_feud }
					has_opinion_modifier = { who = PREV modifier = opinion_feuding_family }
				}
			}
			liege = { 
				random_child = {
					limit = {
						is_female = no
						is_alive = yes
						is_adult = yes
						NOT = { practical_age = 35 }
						in_command = no
						prisoner = no
						is_incapable = no
						NOR = {
							trait = infirm
							trait = blinded
							trait = craven
						}
						NOT = { is_inaccessible_trigger = yes }
					}
					character_event = { id = REP.181 }
				}
			}
		}
		if = {
			limit = {
				liege = { 
					any_vassal = {
						is_patrician = yes
						in_command = no
						prisoner = no
						is_incapable = no
						NOT = { has_dynasty_flag = smugglers_feud }
						has_opinion_modifier = { who = PREVPREV modifier = opinion_feuding_family }
					}
				}
			}
			liege = {
				random_vassal = {
					limit = {
						is_patrician = yes
						in_command = no
						prisoner = no
						is_incapable = no
						NOT = { has_dynasty_flag = smugglers_feud }
						has_opinion_modifier = { who = PREVPREV modifier = opinion_feuding_family }
					}
					random_child = {
						limit = {
							is_female = no
							is_alive = yes
							is_adult = yes
							NOT = { practical_age = 35 }
							in_command = no
							prisoner = no
							is_incapable = no
							NOR = {
								trait = infirm
								trait = blinded
								trait = craven
							}
							NOT = { is_inaccessible_trigger = yes }
						}
						character_event = { id = REP.181 }
					}
				}
			}
		}
	}
}

# The Smugglers (AI Son)
character_event = {
	id = REP.181
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		father = {
			narrative_event = { id = REP.182 }
		}
	}
}

# The Smugglers
narrative_event = {
	id = REP.182
	title = EVTNAME_REP_182
	desc = EVTDESC_REP_182
	picture = GFX_evt_family_feud_republic
	
	is_triggered_only = yes
	
	immediate = {
		set_dynasty_flag = smugglers_feud
	}
	
	option = {
		name = EVTOPTA_REP_182
		
		custom_tooltip = {
			text = approve_plan_tooltip
			hidden_tooltip = {
				FROMFROM = {
					character_event = { id = REP.183 days = 26 }
				}
			}
		}
	}
	option = {
		name = EVTOPTB_REP_182
		custom_tooltip = { text = refuse_plan_tooltip }
	}
}

# Plan is approved (AI Patrician)
character_event = {
	id = REP.183
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		FROMFROM = {
			character_event = { id = REP.184 }
		}
	}
}

# Plan is approved (AI Son)
character_event = {
	id = REP.184
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		FROMFROM = {
			random_list = {
				60 = {
					narrative_event = { id = REP.185 }
				}
				40 = {
					narrative_event = { id = REP.186 }
				}
			}
		}
	}
}

# The Only Good Smuggler...
narrative_event = {
	id = REP.185
	title = EVTNAME_REP_185
	desc = EVTDESC_REP_185
	picture = GFX_evt_family_feud_republic
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_REP_185
		wealth = 200
		prestige = 100
		FROMFROM = {
			narrative_event = { id = REP.187 }
		}
		set_dynasty_flag = feud_phase_two
	}
}

narrative_event = {
	id = REP.187
	title = EVTNAME_REP_187
	desc = EVTDESC_REP_187
	picture = GFX_evt_family_feud_republic
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_REP_006
		wealth = -200
		prestige = -100
		set_dynasty_flag = feud_phase_two
	}
}

# The Ultimate Sacrifice
narrative_event = {
	id = REP.186
	title = EVTNAME_REP_186
	desc = EVTDESC_REP_186
	picture = GFX_evt_family_feud_republic
	
	is_triggered_only = yes
	
	immediate = {
		set_dynasty_flag = feud_phase_two
		FROMFROM = {
			set_dynasty_flag = feud_phase_two
		}
	}
	
	option = {
		name = EVTOPTA_REP_186
		trigger = {
			NOT = { wealth = 200 }
		}
		FROM = {
			death = {
				death_reason = death_murder_beheading
				killer = FROM
			}
		}
	}
	option = {
		name = EVTOPTB_REP_186
		trigger = {
			wealth = 200
		}
		wealth = -200
	}
	option = {
		name = EVTOPTC_REP_186
		FROM = {
			death = {
				death_reason = death_murder_beheading
				killer = FROM
			}
		}
	}
}

### The Battle

# The Right of Way (AI)
narrative_event = {
	id = REP.190
	title = EVTNAME_REP_191
	desc = EVTDESC_REP_190
	picture = GFX_evt_busy_trading_dock_republic
	
	min_age = 16
	is_patrician = yes
	capable_only = yes
	prisoner = no
	
	trigger = {
		has_dlc = "The Republic"
		in_command = no
		NOT = {
			trait = infirm
			trait = blinded
		}
		NOT = { is_inaccessible_trigger = yes }
		liege = { is_merchant_republic = yes }
		OR = {
			liege = {
				is_adult = yes
				in_command = no
				prisoner = no
				is_patrician = yes
				is_incapable = no
				NOT = {
					trait = infirm
					trait = blinded
				}
				NOT = { is_inaccessible_trigger = yes }
				has_dynasty_flag = feud_phase_two
				has_opinion_modifier = { who = PREV modifier = opinion_feuding_family }
			}
			liege = {
				any_vassal = {
					is_patrician = yes
					is_adult = yes
					in_command = no
					prisoner = no
					is_incapable = no
					NOT = {
						trait = infirm
						trait = blinded
					}
					NOT = { is_inaccessible_trigger = yes }
					has_dynasty_flag = feud_phase_two
					has_opinion_modifier = { who = PREV modifier = opinion_feuding_family }
				}
			}
		}
	}
	
	mean_time_to_happen = {
		months = 720
	}
	
	immediate = {
		if = {
			limit = {
				liege = {
					is_adult = yes
					in_command = no
					prisoner = no
					is_patrician = yes
					is_incapable = no
					NOT = {
						trait = infirm
						trait = blinded
					}
					has_opinion_modifier = { who = PREV modifier = opinion_feuding_family }
					has_dynasty_flag = feud_phase_two
					NOT = { is_inaccessible_trigger = yes }
				}
			}
			liege = { 
				save_event_target_as = rival_head
			}
		}
		if = {
			limit = {
				liege = { 
					any_vassal = {
						is_patrician = yes
						in_command = no
						prisoner = no
						is_incapable = no
						NOT = {
							trait = infirm
							trait = blinded
						}
						has_opinion_modifier = { who = PREVPREV modifier = opinion_feuding_family }
						has_dynasty_flag = feud_phase_two
						NOT = { is_inaccessible_trigger = yes }
					}
				}
			}
			liege = {
				random_vassal = {
					limit = {
						is_patrician = yes
						in_command = no
						prisoner = no
						is_incapable = no
						NOT = {
							trait = infirm
							trait = blinded
						}
						has_opinion_modifier = { who = PREVPREV modifier = opinion_feuding_family }
						has_dynasty_flag = feud_phase_two
						NOT = { is_inaccessible_trigger = yes }
					}
					save_event_target_as = rival_head
				}
			}
		}
	}
	
	option = {
		name = EVTOPTA_REP_190
		event_target:rival_head = { 
			narrative_event = { id = REP.191 }
		}
	}
}

# The Right of Way
narrative_event = {
	id = REP.191
	title = EVTNAME_REP_191
	desc = EVTDESC_REP_191
	picture = GFX_evt_busy_trading_dock_republic
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_REP_191
		custom_tooltip = { 
			text = battle_tooltip
			hidden_tooltip = {	
				narrative_event = { id = REP.192 days = 5 }
			}
		}
	}
	option = {
		name = EVTOPTB_REP_191
		custom_tooltip = { text = no_battle_tooltip }
		prestige = -100
		FROM = { narrative_event = { id = REP.201 } }
	}
}

narrative_event = {
	id = REP.201
	title = EVTNAME_REP_201
	desc = EVTDESC_REP_201
	picture = GFX_evt_busy_trading_dock_republic
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_REP_201
		prestige = 100
	}
}

# Battle is Joined!
narrative_event = {
	id = REP.192
	title = EVTNAME_REP_192
	desc = EVTDESC_REP_192
	picture = GFX_evt_kraken
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_REP_192
		custom_tooltip = { 
			text = flotsam_tooltip
			hidden_tooltip = {
				FROMFROM = {
					narrative_event = { id = REP.193 }
				}
			}
		}
	}
}

# Days of Toil and Hardship (AI)
narrative_event = {
	id = REP.193
	title = EVTNAME_REP_192
	desc = EVTDESC_REP_193
	picture = GFX_evt_trade_post_republic
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_REP_192
		random_list = {
			50 = {
				save_event_target_as = ship_hero
				FROM = { save_event_target_as = ship_prisoner }
			}
			50 = {
				FROM = { save_event_target_as = ship_hero }
				save_event_target_as = ship_prisoner
			}
		}
		event_target:ship_hero = {
			narrative_event = { id = REP.194 }
		}
	}
}

# Days of Toil and Hardship
narrative_event = {
	id = REP.194
	title = EVTNAME_REP_194
	desc = EVTDESC_REP_194
	picture = GFX_evt_trade_post_republic
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_REP_194
		tooltip = {
			event_target:ship_prisoner = {
				death = { death_reason = death_dungeon }
			}
		}
		event_target:ship_prisoner = { narrative_event = { id = REP.196 } }
		custom_tooltip = { text = flee_ship_tooltip }
	}
	option = {
		name = EVTOPTB_REP_194
		custom_tooltip = {
			text = rescue_rival_tooltip
			hidden_tooltip = {
				narrative_event = { id = REP.195 } 
			}
		}
	}
}

narrative_event = {
	id = REP.196
	title = EVTNAME_REP_194
	desc = EVTDESC_REP_196
	picture = GFX_evt_trade_post_republic
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_REP_196
		death = { death_reason = death_dungeon }
	}
}

# The Mutiny
narrative_event = {
	id = REP.195
	title = EVTNAME_REP_195
	desc = EVTDESC_REP_195
	picture = GFX_evt_merchant_ship_at_sea_republic
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_REP_195
		event_target:ship_prisoner = {
			narrative_event = { id = REP.197 }
		}
		custom_tooltip = { text = feud_over_tooltip }
		ai_chance = {
			factor = 1
		}
	}
	option = {
		name = EVTOPTB_REP_195
		event_target:ship_prisoner = {
			narrative_event = { id = REP.198 }
		}
		custom_tooltip = { text = feud_continues_tooltip }
		ai_chance = {
			factor = 0
		}
	}
}

narrative_event = {
	id = REP.197
	title = EVTNAME_REP_194
	desc = EVTDESC_REP_197
	picture = GFX_evt_merchant_ship_at_sea_republic
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_REP_197
		custom_tooltip = { text = feud_over_tooltip }
		clr_dynasty_flag = the_victims
		clr_dynasty_flag = the_feuders
		clr_dynasty_flag = flagship_feud
		clr_dynasty_flag = smugglers_feud
		clr_dynasty_flag = feud_phase_two
		remove_opinion = { who = ROOT modifier = opinion_feuding_family }
		any_dynasty_member = {
			remove_opinion = { who = FROM modifier = opinion_feuding_family_light }
		}
		FROM = {
			clr_dynasty_flag = the_victims
			clr_dynasty_flag = the_feuders
			clr_dynasty_flag = flagship_feud
			clr_dynasty_flag = smugglers_feud
			clr_dynasty_flag = feud_phase_two
			remove_opinion = { who = ROOT modifier = opinion_feuding_family }
			any_dynasty_member = {
				remove_opinion = { who = FROM modifier = opinion_feuding_family_light }
			}
			narrative_event = { id = REP.199 }
		}
		ai_chance = {
			factor = 1
		}
	}
	option = {
		name = EVTOPTB_REP_197
		custom_tooltip = { text = feud_continues_tooltip }
		FROM = { narrative_event = { id = REP.200 } }
		ai_chance = {
			factor = 0
		}
	}
}

narrative_event = {
	id = REP.198
	title = EVTNAME_REP_194
	desc = EVTDESC_REP_198
	picture = GFX_evt_merchant_ship_at_sea_republic
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_REP_198
		custom_tooltip = { text = feud_continues_tooltip }
	}
}

narrative_event = {
	id = REP.199
	title = EVTNAME_REP_199
	desc = EVTDESC_REP_199
	picture = GFX_evt_merchant_ship_at_sea_republic
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_REP_199
		custom_tooltip = { text = feud_over_tooltip }
		clr_dynasty_flag = the_victims
		clr_dynasty_flag = the_feuders
		clr_dynasty_flag = flagship_feud
		clr_dynasty_flag = smugglers_feud
		clr_dynasty_flag = feud_phase_two
		remove_opinion = { who = ROOT modifier = opinion_feuding_family }
		any_dynasty_member = {
			remove_opinion = { who = FROM modifier = opinion_feuding_family_light }
		}
		FROM = {
			clr_dynasty_flag = the_victims
			clr_dynasty_flag = the_feuders
			clr_dynasty_flag = flagship_feud
			clr_dynasty_flag = smugglers_feud
			clr_dynasty_flag = feud_phase_two
			remove_opinion = { who = ROOT modifier = opinion_feuding_family }
			any_dynasty_member = {
				remove_opinion = { who = FROM modifier = opinion_feuding_family_light }
			}
		}
	}
}

narrative_event = {
	id = REP.200
	title = EVTNAME_REP_200
	desc = EVTDESC_REP_200
	picture = GFX_evt_merchant_ship_at_sea_republic
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_REP_200
		custom_tooltip = { text = feud_continues_tooltip }
	}
}

### Player Dynasty Rules the Republic

# Player Dynasty Rules the Republic (AI)
character_event = {
	id = REP.202
	title = EVTNAME_REP_202
	desc = EVTDESC_REP_202
	picture = GFX_evt_doge_republic
	
	is_patrician = yes
	
	trigger = {
		has_dlc = "The Republic"
		liege = { is_merchant_republic = yes }
		liege = {
			is_patrician = yes
			is_adult = yes
			prisoner = no
			is_incapable = no
			has_opinion_modifier = { who = PREV modifier = opinion_feuding_family }
		}
	}
	
	mean_time_to_happen = {
		months = 320
	}
	
	option = {
		name = EVTOPTA_REP_202
		prestige = -100
		liege = {
			narrative_event = { id = REP.203 }
		}
	}
}

# Player Dynasty Rules the Republic
narrative_event = {
	id = REP.203
	title = EVTNAME_REP_201
	desc = EVTDESC_REP_203
	picture = GFX_evt_doge_republic
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_REP_203
		prestige = 50
	}
}

### Riots

# Riots (AI)
character_event = {
	id = REP.205
	title = EVTNAME_REP_206
	desc = EVTDESC_REP_206
	picture = GFX_evt_family_feud_republic
	
	is_patrician = yes
	
	trigger = {
		has_dlc = "The Republic"
		liege = { is_merchant_republic = yes }
		OR = {
			liege = {
				is_patrician = yes
				has_opinion_modifier = { who = PREV modifier = opinion_feuding_family }
			}
			liege = {
				any_vassal = {
					is_patrician = yes
					has_opinion_modifier = { who = PREVPREV modifier = opinion_feuding_family }
				}
			}
		}
	}
	
	mean_time_to_happen = {
		months = 420
	}
	
	immediate = {
		if = {
			limit = {
				liege = {
					has_opinion_modifier = { who = PREV modifier = opinion_feuding_family }
				}
			}
			liege = { 
				save_event_target_as = rival_head
			}
		}
		if = {
			limit = {
				liege = { 
					any_vassal = {
						is_patrician = yes
						has_opinion_modifier = { who = PREVPREV modifier = opinion_feuding_family }
					}
				}
			}
			liege = {
				random_vassal = {
					limit = {
						is_patrician = yes
						has_opinion_modifier = { who = PREVPREV modifier = opinion_feuding_family }
					}
					save_event_target_as = rival_head
				}
			}
		}
	}
	
	option = {
		name = EVTOPTA_REP_206
		prestige = -100
		event_target:rival_head = { 
			narrative_event = { id = REP.206 }
		}
	}
}

# Riots
narrative_event = {
	id = REP.206
	title = EVTNAME_REP_206
	desc = EVTDESC_REP_206
	picture = GFX_evt_family_feud_republic
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_REP_206
		prestige = -100
	}
}
