# -*- ck2.events -*-

namespace = emf_imperial

# file range: emf_imperial.1850-1899

#######################################
# IMPERIAL DECAY EVENTS
# Written by Rylock
#######################################

### MAINTENANCE EVENTS

# Main decay event upon an imperial title being inherited/usurped
character_event = {
	id = emf_imperial.1850
	
	hide_window = yes
	is_triggered_only = yes
	
	trigger = {
		FROM = {
			tier = EMPEROR
			is_primary_holder_title = yes
			temporary = no
			is_tribal = no
			is_nomadic = no
		}
		FROMFROM = { always = yes }
		NOT = { uses_decadence = yes }
		is_nomadic = no
#		is_ironman = no
		had_global_flag = { flag = EMF days = 1 }
	}
	
	immediate = {
		FROMFROM = { save_event_target_as = former_owner }
		character_event = { id = emf_imperial.1851 days = 1 }
		
		# Remove the decay modifier from the former owner, if alive
		FROMFROM = {
			if = {
				limit = {
					is_alive = yes
					lower_real_tier_than = EMPEROR
				}
				emf_remove_decay_mods_effect = yes
			}
		}
	}
}

# emf_imperial.1851 -- deferred calculation of decay rating change due to primary imperial title transfer
character_event = {
	id = emf_imperial.1851
	
	is_triggered_only = yes
	hide_window = yes
	
	trigger = {
		primary_title = { title = FROMFROM }
		NOT = { uses_decadence = yes }
#		is_ironman = no
		is_nomadic = no
	}
	
	immediate = {
		
		primary_title = {
			# Skip the increase if title was overthrown
			if = {
				limit = { has_title_flag = emf_decay_overthrow }
				clr_title_flag = emf_decay_overthrow
				set_variable = { which = "imperial_decay_change" value = -10 }
				ROOT = { character_event = { id = emf_imperial.1852 } }
				break = yes
			}
			# The base decay change is 1
			set_variable = { which = "imperial_decay_change" value = 1 }
			# Reset dynasty count if this is a new dynasty
			if = {
				limit = { NOT = { ROOT = { dynasty = event_target:former_owner } } }
				set_variable = { which = "imperial_dynasty_count" value = 0 }
			}
			# Increase dynasty count if this is an ongoing dynasty
			if = {
				limit = { ROOT = { dynasty = event_target:former_owner } }
				change_variable = { which = "imperial_dynasty_count" value = 1 }
			}
			# Decay value goes higher for long-running dynasties, curve is pseudo-logarithmic
			if = {
				limit = { check_variable = { which = "imperial_dynasty_count" value = 1 } }
				change_variable = { which = "imperial_decay_change" value = 1 }
			}
			if = {
				limit = { check_variable = { which = "imperial_dynasty_count" value = 2 } }
				change_variable = { which = "imperial_decay_change" value = 0.5 }
			}
			if = {
				limit = { check_variable = { which = "imperial_dynasty_count" value = 3 } }
				change_variable = { which = "imperial_decay_change" value = 0.5 }
			}
			if = {
				limit = { check_variable = { which = "imperial_dynasty_count" value = 4 } }
				change_variable = { which = "imperial_decay_change" value = 0.25 }
			}
			if = {
				limit = { check_variable = { which = "imperial_dynasty_count" value = 5 } }
				change_variable = { which = "imperial_decay_change" value = 0.25 }
			}
			if = {
				limit = { check_variable = { which = "imperial_dynasty_count" value = 6 } }
				change_variable = { which = "imperial_decay_change" value = 0.25 }
			}
			if = {
				limit = { check_variable = { which = "imperial_dynasty_count" value = 7 } }
				change_variable = { which = "imperial_decay_change" value = 0.25 }
			}
			if = {
				limit = { check_variable = { which = "imperial_dynasty_count" value = 8 } }
				change_variable = { which = "imperial_decay_change" value = 0.2 }
			}
			if = {
				limit = { check_variable = { which = "imperial_dynasty_count" value = 9 } }
				change_variable = { which = "imperial_decay_change" value = 0.2 }
			}
			if = {
				limit = { check_variable = { which = "imperial_dynasty_count" value = 10 } }
				change_variable = { which = "imperial_decay_change" value = 0.2 }
			}
			if = {
				limit = { check_variable = { which = "imperial_dynasty_count" value = 11 } }
				change_variable = { which = "imperial_decay_change" value = 0.2 }
			}
			if = {
				limit = { check_variable = { which = "imperial_dynasty_count" value = 12 } }
				change_variable = { which = "imperial_decay_change" value = 0.2 }
			}
			# Increase more if this is an usurpation
			if = {
				limit = {
					event_target:former_owner = {
						is_alive = yes
						has_claim = FROMFROM
					}
				}
				change_variable = { which = "imperial_decay_change" value = 2 }
			}
			# Imperial Administration gets an additional +1
			if = {
				limit = { has_law = administration_2 }
				change_variable = { which = "imperial_decay_change" value = 1 }
			}
			# Then determine how much CA should change it
			if = {
				limit = {
					NOR = {
						has_law = crown_authority_2
						has_law = crown_authority_3
						has_law = crown_authority_4
					}
				}
				change_variable = { which = "imperial_decay_change" value = 3 }
			}
			if = {
				limit = { has_law = crown_authority_2 }
				change_variable = { which = "imperial_decay_change" value = 2 }
			}
			if = {
				limit = { has_law = crown_authority_3 }
				change_variable = { which = "imperial_decay_change" value = 1 }
			}
			# Increase less if we have a horde culture
			if = {
				limit = { ROOT = { has_horde_culture = yes } }
				change_variable = { which = "imperial_decay_change" value = -2 }
			}
			# Adjust according to realm size and map
			if = {
				limit = { NOT = { has_global_flag = SWMH } }
				if = {
					limit = { NOT = { ROOT = { realm_size = 100 } } }
					change_variable = { which = "imperial_decay_change" value = -1 }
				}
				if = {
					limit = { NOT = { ROOT = { realm_size = 125 } } }
					change_variable = { which = "imperial_decay_change" value = -0.5 }
				}
				if = {
					limit = { NOT = { ROOT = { realm_size = 150 } } }
					change_variable = { which = "imperial_decay_change" value = -0.5 }
				}
				if = {
					limit = { ROOT = { realm_size = 175 } }
					change_variable = { which = "imperial_decay_change" value = 0.5 }
				}
				if = {
					limit = { ROOT = { realm_size = 200 } }
					change_variable = { which = "imperial_decay_change" value = 0.5 }
				}
				if = {
					limit = { ROOT = { realm_size = 225 } }
					change_variable = { which = "imperial_decay_change" value = 0.5 }
				}
				if = {
					limit = { ROOT = { realm_size = 250 } }
					change_variable = { which = "imperial_decay_change" value = 0.5 }
				}
				if = {
					limit = { ROOT = { realm_size = 275 } }
					change_variable = { which = "imperial_decay_change" value = 0.5 }
				}
				if = {
					limit = { ROOT = { realm_size = 300 } }
					change_variable = { which = "imperial_decay_change" value = 0.5 }
				}
				if = {
					limit = { ROOT = { realm_size = 325 } }
					change_variable = { which = "imperial_decay_change" value = 0.5 }
				}
				if = {
					limit = { ROOT = { realm_size = 350 } }
					change_variable = { which = "imperial_decay_change" value = 0.5 }
				}
				if = {
					limit = { ROOT = { realm_size = 375 } }
					change_variable = { which = "imperial_decay_change" value = 0.25 }
				}
				if = {
					limit = { ROOT = { realm_size = 400 } }
					change_variable = { which = "imperial_decay_change" value = 0.25 }
				}
				if = {
					limit = { ROOT = { realm_size = 425 } }
					change_variable = { which = "imperial_decay_change" value = 0.25 }
				}
				if = {
					limit = { ROOT = { realm_size = 450 } }
					change_variable = { which = "imperial_decay_change" value = 0.25 }
				}
				if = {
					limit = { ROOT = { realm_size = 475 } }
					change_variable = { which = "imperial_decay_change" value = 0.25 }
				}
				if = {
					limit = { ROOT = { realm_size = 500 } }
					change_variable = { which = "imperial_decay_change" value = 0.25 }
				}
				if = {
					limit = { ROOT = { realm_size = 525 } }
					change_variable = { which = "imperial_decay_change" value = 0.25 }
				}
				if = {
					limit = { ROOT = { realm_size = 550 } }
					change_variable = { which = "imperial_decay_change" value = 0.25 }
				}
				if = {
					limit = { ROOT = { realm_size = 575 } }
					change_variable = { which = "imperial_decay_change" value = 0.25 }
				}
				if = {
					limit = { ROOT = { realm_size = 600 } }
					change_variable = { which = "imperial_decay_change" value = 0.25 }
				}
				if = {
					limit = { ROOT = { realm_size = 625 } }
					change_variable = { which = "imperial_decay_change" value = 0.25 }
				}
				if = {
					limit = { ROOT = { realm_size = 650 } }
					change_variable = { which = "imperial_decay_change" value = 0.25 }
				}
			}
			# For SWMH, we use a realm size factor of 8/5 vs. vanilla
			if = {
				limit = { has_global_flag = SWMH }
				if = {
					limit = { NOT = { ROOT = { realm_size = 160 } } }
					change_variable = { which = "imperial_decay_change" value = -1 }
				}
				if = {
					limit = { NOT = { ROOT = { realm_size = 200 } } }
					change_variable = { which = "imperial_decay_change" value = -0.5 }
				}
				if = {
					limit = { NOT = { ROOT = { realm_size = 240 } } }
					change_variable = { which = "imperial_decay_change" value = -0.5 }
				}
				if = {
					limit = { ROOT = { realm_size = 280 } }
					change_variable = { which = "imperial_decay_change" value = 0.5 }
				}
				if = {
					limit = { ROOT = { realm_size = 320 } }
					change_variable = { which = "imperial_decay_change" value = 0.5 }
				}
				if = {
					limit = { ROOT = { realm_size = 360 } }
					change_variable = { which = "imperial_decay_change" value = 0.5 }
				}
				if = {
					limit = { ROOT = { realm_size = 400 } }
					change_variable = { which = "imperial_decay_change" value = 0.5 }
				}
				if = {
					limit = { ROOT = { realm_size = 440 } }
					change_variable = { which = "imperial_decay_change" value = 0.5 }
				}
				if = {
					limit = { ROOT = { realm_size = 480 } }
					change_variable = { which = "imperial_decay_change" value = 0.5 }
				}
				if = {
					limit = { ROOT = { realm_size = 520 } }
					change_variable = { which = "imperial_decay_change" value = 0.5 }
				}
				if = {
					limit = { ROOT = { realm_size = 560 } }
					change_variable = { which = "imperial_decay_change" value = 0.5 }
				}
				if = {
					limit = { ROOT = { realm_size = 600 } }
					change_variable = { which = "imperial_decay_change" value = 0.25 }
				}
				if = {
					limit = { ROOT = { realm_size = 640 } }
					change_variable = { which = "imperial_decay_change" value = 0.25 }
				}
				if = {
					limit = { ROOT = { realm_size = 680 } }
					change_variable = { which = "imperial_decay_change" value = 0.25 }
				}
				if = {
					limit = { ROOT = { realm_size = 720 } }
					change_variable = { which = "imperial_decay_change" value = 0.25 }
				}
				if = {
					limit = { ROOT = { realm_size = 760 } }
					change_variable = { which = "imperial_decay_change" value = 0.25 }
				}
				if = {
					limit = { ROOT = { realm_size = 800 } }
					change_variable = { which = "imperial_decay_change" value = 0.25 }
				}
				if = {
					limit = { ROOT = { realm_size = 840 } }
					change_variable = { which = "imperial_decay_change" value = 0.25 }
				}
				if = {
					limit = { ROOT = { realm_size = 880 } }
					change_variable = { which = "imperial_decay_change" value = 0.25 }
				}
				if = {
					limit = { ROOT = { realm_size = 920 } }
					change_variable = { which = "imperial_decay_change" value = 0.25 }
				}
				if = {
					limit = { ROOT = { realm_size = 960 } }
					change_variable = { which = "imperial_decay_change" value = 0.25 }
				}
				if = {
					limit = { ROOT = { realm_size = 1000 } }
					change_variable = { which = "imperial_decay_change" value = 0.25 }
				}
				if = {
					limit = { ROOT = { realm_size = 1040 } }
					change_variable = { which = "imperial_decay_change" value = 0.25 }
				}
			}
			# Wrap this up...
			# If AI, apply a handicap
			if = {
				limit = { ROOT = { ai = yes } }
				multiply_variable = { which = "imperial_decay_change" value = 0.75 }
			}
			# Round imperial_decay_change to nearest integer
			# Since we have a limited range of possible change that could've been induced in this event,
			# this is actually tractable, though still very annoying, in CK2script (oh my!).
			# Range from dynastic continuity: [0,4]
			# Range from usurpation [0,2]
			# Range from imperial admin [0,1]
			# Range from crown authority [0,3]
			# Range from horde culture [-2,0]
			# Range from realm size [-2,7]
			# Max. range: [-4,17] --> [1,17] after enforcing minimum gain rule
			if = {
				limit = { # Minimum gain rule
					NOT = { check_variable = { which = "imperial_decay_change" value = 1.5 } }
				}
				set_variable = { which = "imperial_decay_change" value = 1 }
			}
			if = {
				limit = {
					check_variable = { which = "imperial_decay_change" value = 1.5 }
					NOT = { check_variable = { which = "imperial_decay_change" value = 2.5 } }
				}
				set_variable = { which = "imperial_decay_change" value = 2 }
			}
			if = {
				limit = {
					check_variable = { which = "imperial_decay_change" value = 2.5 }
					NOT = { check_variable = { which = "imperial_decay_change" value = 3.5 } }
				}
				set_variable = { which = "imperial_decay_change" value = 3 }
			}
			if = {
				limit = {
					check_variable = { which = "imperial_decay_change" value = 3.5 }
					NOT = { check_variable = { which = "imperial_decay_change" value = 4.5 } }
				}
				set_variable = { which = "imperial_decay_change" value = 4 }
			}
			if = {
				limit = {
					check_variable = { which = "imperial_decay_change" value = 4.5 }
					NOT = { check_variable = { which = "imperial_decay_change" value = 5.5 } }
				}
				set_variable = { which = "imperial_decay_change" value = 5 }
			}
			if = {
				limit = {
					check_variable = { which = "imperial_decay_change" value = 5.5 }
					NOT = { check_variable = { which = "imperial_decay_change" value = 6.5 } }
				}
				set_variable = { which = "imperial_decay_change" value = 6 }
			}
			if = {
				limit = {
					check_variable = { which = "imperial_decay_change" value = 6.5 }
					NOT = { check_variable = { which = "imperial_decay_change" value = 7.5 } }
				}
				set_variable = { which = "imperial_decay_change" value = 7 }
			}
			if = {
				limit = {
					check_variable = { which = "imperial_decay_change" value = 7.5 }
					NOT = { check_variable = { which = "imperial_decay_change" value = 8.5 } }
				}
				set_variable = { which = "imperial_decay_change" value = 8 }
			}
			if = {
				limit = {
					check_variable = { which = "imperial_decay_change" value = 8.5 }
					NOT = { check_variable = { which = "imperial_decay_change" value = 9.5 } }
				}
				set_variable = { which = "imperial_decay_change" value = 9 }
			}
			if = {
				limit = {
					check_variable = { which = "imperial_decay_change" value = 9.5 }
					NOT = { check_variable = { which = "imperial_decay_change" value = 10.5 } }
				}
				set_variable = { which = "imperial_decay_change" value = 10 }
			}
			if = {
				limit = {
					check_variable = { which = "imperial_decay_change" value = 10.5 }
					NOT = { check_variable = { which = "imperial_decay_change" value = 11.5 } }
				}
				set_variable = { which = "imperial_decay_change" value = 11 }
			}
			if = {
				limit = {
					check_variable = { which = "imperial_decay_change" value = 11.5 }
					NOT = { check_variable = { which = "imperial_decay_change" value = 12.5 } }
				}
				set_variable = { which = "imperial_decay_change" value = 12 }
			}
			if = {
				limit = {
					check_variable = { which = "imperial_decay_change" value = 12.5 }
					NOT = { check_variable = { which = "imperial_decay_change" value = 13.5 } }
				}
				set_variable = { which = "imperial_decay_change" value = 13 }
			}
			if = {
				limit = {
					check_variable = { which = "imperial_decay_change" value = 13.5 }
					NOT = { check_variable = { which = "imperial_decay_change" value = 14.5 } }
				}
				set_variable = { which = "imperial_decay_change" value = 14 }
			}
			if = {
				limit = {
					check_variable = { which = "imperial_decay_change" value = 14.5 }
					NOT = { check_variable = { which = "imperial_decay_change" value = 15.5 } }
				}
				set_variable = { which = "imperial_decay_change" value = 15 }
			}
			if = {
				limit = {
					check_variable = { which = "imperial_decay_change" value = 15.5 }
					NOT = { check_variable = { which = "imperial_decay_change" value = 16.5 } }
				}
				set_variable = { which = "imperial_decay_change" value = 16 }
			}
			if = {
				limit = {
					check_variable = { which = "imperial_decay_change" value = 16.5 }
				}
				set_variable = { which = "imperial_decay_change" value = 17 }
			}
		}
		
		# Commit the change
		character_event = { id = emf_imperial.1852 }
	}
}

# emf_imperial.1852 -- Event for actually changing imperial decay rating by title variable `imperial_decay_change`
# All dynamic (i.e., everything but history effects) changes to imperial decay should use this event -- do not bypass it
character_event = {
	id = emf_imperial.1852
	
	hide_window = yes
	is_triggered_only = yes
	
	trigger = {
#		is_ironman = no
	}
	
	immediate = {
		primary_title = {
			# Clamp imperial_decay to the range [0,100] while changing it by imperial_decay_change
			change_variable = { which = "imperial_decay" which = "imperial_decay_change" }
			if = {
				limit = { NOT = { check_variable = { which = "imperial_decay" value = 0 } } }
				set_variable = { which = "imperial_decay" value = 0 }
			}
			if = {
				limit = { check_variable = { which = "imperial_decay" value = 100 } }
				set_variable = { which = "imperial_decay" value = 100 }
			}
		}
		
		# Remove old decay modifier
		emf_remove_decay_mods_effect = yes
		
		if = {
			limit = {
				OR = {
					uses_decadence = yes
					is_tribal = yes
					is_nomadic = yes
				}
			}
			break = yes
		}
		
		character_event = { id = emf_imperial.1880 } # Notify (also shows the amount by which ID changed, if any)
		
		if = {
			limit = {
				primary_title = {
					check_variable = { which = "imperial_decay" value = 10 }
					NOT = { check_variable = { which = "imperial_decay" value = 20 } }
				}
			}
			add_character_modifier = {
				name = imperial_decay_1
				duration = -1
			}
		} 
		if = {
			limit = {
				primary_title = {
					check_variable = { which = "imperial_decay" value = 20 }
					NOT = { check_variable = { which = "imperial_decay" value = 30 } }
				}
			}
			add_character_modifier = {
				name = imperial_decay_2
				duration = -1
			}
		}
		if = {
			limit = {
				primary_title = {
					check_variable = { which = "imperial_decay" value = 30 }
					NOT = { check_variable = { which = "imperial_decay" value = 40 } }
				}
			}
			add_character_modifier = {
				name = imperial_decay_3
				duration = -1
			}
		}   
		if = {
			limit = {
				primary_title = {
					check_variable = { which = "imperial_decay" value = 40 }
					NOT = { check_variable = { which = "imperial_decay" value = 50 } }
				}
			}
			add_character_modifier = {
				name = imperial_decay_4
				duration = -1
			}
		}  
		if = {
			limit = {
				primary_title = {
					check_variable = { which = "imperial_decay" value = 50 }
					NOT = { check_variable = { which = "imperial_decay" value = 60 } }
				}
			}
			add_character_modifier = {
				name = imperial_decay_5
				duration = -1
			}
		}   
		if = {
			limit = {
				primary_title = {
					check_variable = { which = "imperial_decay" value = 60 }
					NOT = { check_variable = { which = "imperial_decay" value = 70 } }
				}
			}
			add_character_modifier = {
				name = imperial_decay_6
				duration = -1
			}
		}    
		if = {
			limit = {
				primary_title = {
					check_variable = { which = "imperial_decay" value = 70 }
					NOT = { check_variable = { which = "imperial_decay" value = 80 } }
				}
			}
			add_character_modifier = {
				name = imperial_decay_7
				duration = -1
			}
		}     
		if = {
			limit = {
				primary_title = {
					check_variable = { which = "imperial_decay" value = 80 }
				}             
			}
			add_character_modifier = {
				name = imperial_decay_8
				duration = -1
			}
		}
	}
}

# emf_imperial.1853 -- Always explicitly initialize imperial_decay to 0 when an empire title is formed
#
# Triggered by on_new_holder; always do this so that the now always-available Lower Imperial Decay decision never, ever
# shows a blank value for Imperial Decay. [This also prevents old imperial_decay values from affecting newly-created
# titles.]
character_event = {
	id = emf_imperial.1853
	
	hide_window = yes
	is_triggered_only = yes
	
	only_independent = yes
	only_playable = yes
	
	trigger = {
		FROM = {
			tier = EMPEROR
			temporary = no
		}
		NOT = { FROMFROM = { always = yes } }
	}
	
	immediate = {
		FROM = { set_variable = { which = "imperial_decay" value = 0 } }
	}
}

# emf_imperial.1854 -- Always ensure existing empire titles w/ zero decay actually have imperial_decay=0 in RAM (on_startup)
character_event = {
	id = emf_imperial.1854
	
	hide_window = yes
	is_triggered_only = yes
	
	only_independent = yes
	only_playable = yes
	religion = hip_religion
	
	trigger = {
		has_landed_title = e_hip
	}
	
	immediate = {
		# Ensure every empire title has an explicitly-set imperial_decay value, even if 0 or never to be used
		# If we are reloading saves, 0-values for imperial_decay will be null (appear blank) and not be 0 until fixed
		any_landed_title = {
			limit = {
				has_holder = yes
				tier = EMPEROR
				temporary = no
				rebel = no
				NOT = { is_variable_equal = { which = "imperial_decay" value = 0 } }
			}
			set_variable = { which = "imperial_decay" value = 0 }
		}
	}
}

### RANDOM EVENTS

# Emperor/Regent is Just
character_event = {
	id = emf_imperial.1855
	picture = GFX_evt_throne_room
	
	desc = {
		text = EVTDESC_emf_imperial_1855A
		trigger = { ROOT = { has_regent = no } }
	}
	desc = {
		text = EVTDESC_emf_imperial_1855B
		trigger = { ROOT = { has_regent = yes } }
	}
	
	is_triggered_only = yes
	major = yes
	
	only_independent = yes
	only_playable = yes
	
	major_trigger = {
		OR = {
			character = ROOT
			same_realm = ROOT
		}
	}
	
	trigger = {
		emf_uses_imperial_decay_trigger = yes
		primary_title = { check_variable = { which = "imperial_decay" value = 1 } }
		OR = {
			AND = {
				has_regent = no
				trait = just
			}
			AND = {
				has_regent = yes
				NOT = { trait = arbitrary }
				regent = { trait = just }
			}
		}
		NOT = { has_character_modifier = decay_event_timer }
	}
	
	weight_multiplier = {
		days = 1
		modifier = {
			factor = 0.5
			NOT = { primary_title = { check_variable = { which = "imperial_decay" value = 10 } } }
		}
		modifier = {
			factor = 2.0
			primary_title = { check_variable = { which = "imperial_decay" value = 30 } }
		}
		modifier = {
			factor = 2.0
			primary_title = { check_variable = { which = "imperial_decay" value = 60 } }
		}
	}
	
	option = {
		name = OK
		ROOT = { custom_tooltip = { text = IMPERIAL_DECAY_MINUS_1 } }
		if = {
			limit = { character = ROOT }
			hidden_tooltip = {
				emf_imperial_decay_minus_1_effect = yes
				add_character_modifier = {
					name = decay_event_timer
					hidden = yes
					duration = 1825
				}
			}
		}
	}
}

# Emperor/Regent is Arbitrary
character_event = {
	id = emf_imperial.1856
	picture = GFX_evt_throne_room
	
	desc = {
		text = EVTDESC_emf_imperial_1856A
		trigger = { ROOT = { has_regent = no } }
	}
	desc = {
		text = EVTDESC_emf_imperial_1856B
		trigger = { ROOT = { has_regent = yes } }
	}
	
	is_triggered_only = yes
	major = yes
	
	only_independent = yes
	only_playable = yes
	
	major_trigger = {
		OR = {
			character = ROOT
			same_realm = ROOT
		}
	}
	
	trigger = {
		emf_uses_imperial_decay_trigger = yes
		primary_title = { NOT = { check_variable = { which = "imperial_decay" value = 100 } } }
		OR = {
			AND = {
				has_regent = no
				trait = arbitrary
			}
			AND = {
				has_regent = yes
				NOT = { trait = just }
				regent = { trait = arbitrary }
			}
		}
		NOT = { has_character_modifier = decay_event_timer }
	}
	
	weight_multiplier = {
		days = 1
		modifier = {
			factor = 2.0
			has_regent = yes
		}
		modifier = {
			factor = 2.0
			NOT = { primary_title = { check_variable = { which = "imperial_decay" value = 10 } } }
		}
		modifier = {
			factor = 0.75
			primary_title = { check_variable = { which = "imperial_decay" value = 30 } }
		}
		modifier = {
			factor = 0.75
			primary_title = { check_variable = { which = "imperial_decay" value = 60 } }
		}
		modifier = {
			factor = 0.5
			primary_title = { check_variable = { which = "imperial_decay" value = 90 } }
		}
	}
	
	option = {
		name = OK
		ROOT = { custom_tooltip = { text = IMPERIAL_DECAY_PLUS_1 } }
		if = {
			limit = { character = ROOT }
			hidden_tooltip = {
				emf_imperial_decay_plus_1_effect = yes
				add_character_modifier = {
					name = decay_event_timer
					hidden = yes
					duration = 1825
				}
			}
		}
	}
}

# Emperor/Regent is Diligent
character_event = {
	id = emf_imperial.1857
	picture = GFX_evt_throne_room
	
	desc = {
		text = EVTDESC_emf_imperial_1857A
		trigger = { ROOT = { has_regent = no } }
	}
	desc = {
		text = EVTDESC_emf_imperial_1857B
		trigger = { ROOT = { has_regent = yes } }
	}
	
	is_triggered_only = yes
	major = yes
	
	only_independent = yes
	only_playable = yes
	
	major_trigger = {
		OR = {
			character = ROOT
			same_realm = ROOT
		}
	}
	
	trigger = {
		emf_uses_imperial_decay_trigger = yes
		primary_title = { check_variable = { which = "imperial_decay" value = 1 } }
		OR = {
			AND = {
				has_regent = no
				trait = diligent
			}
			AND = {
				has_regent = yes
				NOT = { trait = slothful }
				regent = { trait = diligent }
			}
		}
		NOT = { has_character_modifier = decay_event_timer }
	}
	
	weight_multiplier = {
		days = 1
		modifier = {
			factor = 0.5
			NOT = { primary_title = { check_variable = { which = "imperial_decay" value = 10 } } }
		}
		modifier = {
			factor = 2.0
			primary_title = { check_variable = { which = "imperial_decay" value = 30 } }
		}
		modifier = {
			factor = 2.0
			primary_title = { check_variable = { which = "imperial_decay" value = 60 } }
		}
	}
	
	option = {
		name = OK
		ROOT = { custom_tooltip = { text = IMPERIAL_DECAY_MINUS_1 } }
		if = {
			limit = { character = ROOT }
			hidden_tooltip = {
				emf_imperial_decay_minus_1_effect = yes
				add_character_modifier = {
					name = decay_event_timer
					hidden = yes
					duration = 1825
				}
			}
		}
	}
}

# Emperor/Regent is Slothful
character_event = {
	id = emf_imperial.1858
	picture = GFX_evt_throne_room
	
	desc = {
		text = EVTDESC_emf_imperial_1858A
		trigger = { ROOT = { has_regent = no } }
	}
	desc = {
		text = EVTDESC_emf_imperial_1858B
		trigger = { ROOT = { has_regent = yes } }
	}
	
	is_triggered_only = yes
	major = yes
	
	only_independent = yes
	only_playable = yes
	
	major_trigger = {
		OR = {
			character = ROOT
			same_realm = ROOT
		}
	}
	
	trigger = {
		emf_uses_imperial_decay_trigger = yes
		primary_title = { NOT = { check_variable = { which = "imperial_decay" value = 100 } } }
		OR = {
			AND = {
				has_regent = no
				trait = slothful
			}
			AND = {
				has_regent = yes
				NOT = { trait = diligent }
				regent = { trait = slothful }
			}
		}
		NOT = { has_character_modifier = decay_event_timer }
	}
	
	weight_multiplier = {
		days = 1
		modifier = {
			factor = 2.0
			has_regent = yes
		}
		modifier = {
			factor = 2.0
			NOT = { primary_title = { check_variable = { which = "imperial_decay" value = 10 } } }
		}
		modifier = {
			factor = 0.75
			primary_title = { check_variable = { which = "imperial_decay" value = 30 } }
		}
		modifier = {
			factor = 0.75
			primary_title = { check_variable = { which = "imperial_decay" value = 60 } }
		}
		modifier = {
			factor = 0.5
			primary_title = { check_variable = { which = "imperial_decay" value = 90 } }
		}
	}
	
	option = {
		name = OK
		ROOT = { custom_tooltip = { text = IMPERIAL_DECAY_PLUS_1 } }
		if = {
			limit = { character = ROOT }
			hidden_tooltip = {
				emf_imperial_decay_plus_1_effect = yes
				add_character_modifier = {
					name = decay_event_timer
					hidden = yes
					duration = 1825
				}
			}
		}
	}
}

# Emperor/Regent is Hedonist
character_event = {
	id = emf_imperial.1859
	picture = GFX_evt_brothel
	
	desc = {
		text = EVTDESC_emf_imperial_1859A
		trigger = { ROOT = { has_regent = no } }
	}
	desc = {
		text = EVTDESC_emf_imperial_1859B
		trigger = { ROOT = { has_regent = yes } }
	}
	
	is_triggered_only = yes
	major = yes
	
	only_independent = yes
	only_playable = yes
	
	major_trigger = {
		OR = {
			character = ROOT
			same_realm = ROOT
		}
	}
	
	trigger = {
		emf_uses_imperial_decay_trigger = yes
		primary_title = { NOT = { check_variable = { which = "imperial_decay" value = 100 } } }
		OR = {
			AND = {
				has_regent = no
				trait = hedonist
			}
			AND = {
				has_regent = yes
				regent = { trait = hedonist }
			}
		}
		NOT = { has_character_modifier = decay_event_timer }
	}
	
	weight_multiplier = {
		days = 1
		modifier = {
			factor = 2.0
			has_regent = yes
		}
		modifier = {
			factor = 2.0
			NOT = { primary_title = { check_variable = { which = "imperial_decay" value = 10 } } }
		}
		modifier = {
			factor = 0.75
			primary_title = { check_variable = { which = "imperial_decay" value = 30 } }
		}
		modifier = {
			factor = 0.75
			primary_title = { check_variable = { which = "imperial_decay" value = 60 } }
		}
		modifier = {
			factor = 0.5
			primary_title = { check_variable = { which = "imperial_decay" value = 90 } }
		}
	}
	
	option = {
		name = OK
		ROOT = { custom_tooltip = { text = IMPERIAL_DECAY_PLUS_1 } }
		if = {
			limit = { character = ROOT }
			hidden_tooltip = {
				emf_imperial_decay_plus_1_effect = yes
				add_character_modifier = {
					name = decay_event_timer
					hidden = yes
					duration = 1825
				}
			}
		}
	}
}

# Emperor/Regent is Cruel/Impaler
character_event = {
	id = emf_imperial.1860
	picture = GFX_evt_brothel
	
	desc = {
		text = EVTDESC_emf_imperial_1860A
		trigger = { ROOT = { has_regent = no } }
	}
	desc = {
		text = EVTDESC_emf_imperial_1860B
		trigger = { ROOT = { has_regent = yes } }
	}
	
	is_triggered_only = yes
	major = yes
	
	only_independent = yes
	only_playable = yes
	
	major_trigger = {
		OR = {
			character = ROOT
			same_realm = ROOT
		}
	}
	
	trigger = {
		emf_uses_imperial_decay_trigger = yes
		primary_title = { NOT = { check_variable = { which = "imperial_decay" value = 100 } } }
		OR = {
			AND = {
				has_regent = no
				OR = {
					trait = cruel
					trait = impaler
				}
			}
			AND = {
				has_regent = yes
				NOT = { trait = kind }
				regent = {
					OR = {
						trait = cruel
						trait = impaler
					}
				}
			}
		}
		NOT = { has_character_modifier = decay_event_timer }
	}
	
	weight_multiplier = {
		days = 1
		modifier = {
			factor = 2.0
			has_regent = yes
		}
		modifier = {
			factor = 2.0
			NOT = { primary_title = { check_variable = { which = "imperial_decay" value = 10 } } }
		}
		modifier = {
			factor = 0.75
			primary_title = { check_variable = { which = "imperial_decay" value = 30 } }
		}
		modifier = {
			factor = 0.75
			primary_title = { check_variable = { which = "imperial_decay" value = 60 } }
		}
		modifier = {
			factor = 0.5
			primary_title = { check_variable = { which = "imperial_decay" value = 90 } }
		}
	}
	
	option = {
		name = OK
		ROOT = { custom_tooltip = { text = IMPERIAL_DECAY_PLUS_1 } }
		if = {
			limit = { character = ROOT }
			hidden_tooltip = {
				emf_imperial_decay_plus_1_effect = yes
				add_character_modifier = {
					name = decay_event_timer
					hidden = yes
					duration = 1825
				}
			}
		}
	}
}

# Emperor/Regent is Quick/Genius
character_event = {
	id = emf_imperial.1861
	picture = GFX_evt_throne_room
	
	desc = {
		text = EVTDESC_emf_imperial_1861A
		trigger = { ROOT = { has_regent = no } }
	}
	desc = {
		text = EVTDESC_emf_imperial_1861B
		trigger = { ROOT = { has_regent = yes } }
	}
	
	is_triggered_only = yes
	major = yes
	
	only_independent = yes
	only_playable = yes
	
	major_trigger = {
		OR = {
			character = ROOT
			same_realm = ROOT
		}
	}
	
	trigger = {
		emf_uses_imperial_decay_trigger = yes
		primary_title = { check_variable = { which = "imperial_decay" value = 1 } }
		OR = {
			AND = {
				has_regent = no
				is_smart_trigger = yes
			}
			AND = {
				has_regent = yes
				regent = {
					is_smart_trigger = yes
				}
			}
		}
		NOT = { has_character_modifier = decay_event_timer }
	}
	
	weight_multiplier = {
		days = 1
		modifier = {
			factor = 2.0
			has_regent = no
			trait = genius
		}
		modifier = {
			factor = 2.0
			has_regent = yes
			regent = { trait = genius }
		}
		modifier = {
			factor = 0.5
			NOT = { primary_title = { check_variable = { which = "imperial_decay" value = 10 } } }
		}
		modifier = {
			factor = 2.0
			primary_title = { check_variable = { which = "imperial_decay" value = 30 } }
		}
		modifier = {
			factor = 2.0
			primary_title = { check_variable = { which = "imperial_decay" value = 60 } }
		}
	}
	
	option = {
		name = OK
		ROOT = { custom_tooltip = { text = IMPERIAL_DECAY_MINUS_1 } }
		if = {
			limit = { character = ROOT }
			hidden_tooltip = {
				emf_imperial_decay_minus_1_effect = yes
				add_character_modifier = {
					name = decay_event_timer
					hidden = yes
					duration = 1825
				}
			}
		}
	}
}

# Emperor/Regent is Inbred/Imbecile/Slow
character_event = {
	id = emf_imperial.1862
	picture = GFX_evt_throne_room
	
	desc = {
		text = EVTDESC_emf_imperial_1862A
		trigger = { ROOT = { has_regent = no } }
	}
	desc = {
		text = EVTDESC_emf_imperial_1862B
		trigger = { ROOT = { has_regent = yes } }
	}
	
	is_triggered_only = yes
	major = yes
	
	only_independent = yes
	only_playable = yes
	
	major_trigger = {
		OR = {
			character = ROOT
			same_realm = ROOT
		}
	}
	
	trigger = {
		emf_uses_imperial_decay_trigger = yes
		primary_title = { NOT = { check_variable = { which = "imperial_decay" value = 100 } } }
		OR = {
			AND = {
				has_regent = no
				OR = {
					is_dumb_trigger = yes
					trait = inbred
				}
			}
			AND = {
				has_regent = yes
				regent = {
					OR = {
						is_dumb_trigger = yes
						trait = inbred
					}
				}
			}
		}
		NOT = { has_character_modifier = decay_event_timer }
	}
	
	weight_multiplier = {
		days = 1
		modifier = {
			factor = 2.0
			has_regent = no
			trait = imbecile
		}
		modifier = {
			factor = 2.0
			has_regent = yes
			regent = { trait = imbecile }
		}
		modifier = {
			factor = 1.5
			has_regent = no
			trait = inbred
		}
		modifier = {
			factor = 1.5
			has_regent = yes
			regent = { trait = inbred }
		}
		modifier = {
			factor = 2.0
			has_regent = yes
		}
		modifier = {
			factor = 2.0
			NOT = { primary_title = { check_variable = { which = "imperial_decay" value = 10 } } }
		}
		modifier = {
			factor = 0.75
			primary_title = { check_variable = { which = "imperial_decay" value = 30 } }
		}
		modifier = {
			factor = 0.75
			primary_title = { check_variable = { which = "imperial_decay" value = 60 } }
		}
		modifier = {
			factor = 0.5
			primary_title = { check_variable = { which = "imperial_decay" value = 90 } }
		}
	}
	
	option = {
		name = OK
		ROOT = { custom_tooltip = { text = IMPERIAL_DECAY_PLUS_1 } }
		if = {
			limit = { character = ROOT }
			hidden_tooltip = {
				emf_imperial_decay_plus_1_effect = yes
				add_character_modifier = {
					name = decay_event_timer
					hidden = yes
					duration = 1825
				}
			}
		}
	}
}

# Emperor is Incapable
character_event = {
	id = emf_imperial.1863
	picture = GFX_evt_throne_room
	desc = EVTDESC_emf_imperial_1863
	
	is_triggered_only = yes
	major = yes
	
	only_independent = yes
	only_playable = yes
	
	major_trigger = {
		OR = {
			character = ROOT
			same_realm = ROOT
		}
	}
	
	trigger = {
		emf_uses_imperial_decay_trigger = yes
		primary_title = { NOT = { check_variable = { which = "imperial_decay" value = 100 } } }
		trait = incapable
		NOT = { has_character_modifier = decay_event_timer }
	}
	
	weight_multiplier = {
		days = 1
		modifier = {
			factor = 2.0
			NOT = { primary_title = { check_variable = { which = "imperial_decay" value = 10 } } }
		}
		modifier = {
			factor = 0.75
			primary_title = { check_variable = { which = "imperial_decay" value = 30 } }
		}
		modifier = {
			factor = 0.75
			primary_title = { check_variable = { which = "imperial_decay" value = 60 } }
		}
		modifier = {
			factor = 0.5
			primary_title = { check_variable = { which = "imperial_decay" value = 90 } }
		}
	}
	
	option = {
		name = OK
		ROOT = { custom_tooltip = { text = IMPERIAL_DECAY_PLUS_1 } }
		if = {
			limit = { character = ROOT }
			hidden_tooltip = {
				emf_imperial_decay_plus_1_effect = yes
				add_character_modifier = {
					name = decay_event_timer
					hidden = yes
					duration = 1825
				}
			}
		}
	}
}

# Emperor/Regent is Drunkard
character_event = {
	id = emf_imperial.1864
	picture = GFX_evt_dancing
	
	desc = {
		text = EVTDESC_emf_imperial_1864A
		trigger = { ROOT = { has_regent = no } }
	}
	desc = {
		text = EVTDESC_emf_imperial_1864B
		trigger = { ROOT = { has_regent = yes } }
	}
	
	is_triggered_only = yes
	major = yes
	
	only_independent = yes
	only_playable = yes
	
	major_trigger = {
		OR = {
			character = ROOT
			same_realm = ROOT
		}
	}
	
	trigger = {
		emf_uses_imperial_decay_trigger = yes
		primary_title = { NOT = { check_variable = { which = "imperial_decay" value = 100 } } }
		OR = {
			AND = {
				has_regent = no
				trait = drunkard
			}
			AND = {
				has_regent = yes
				regent = { trait = drunkard }
			}
		}
		NOT = { has_character_modifier = decay_event_timer }
	}
	
	weight_multiplier = {
		days = 1
		modifier = {
			factor = 2.0
			has_regent = yes
		}
		modifier = {
			factor = 2.0
			NOT = { primary_title = { check_variable = { which = "imperial_decay" value = 10 } } }
		}
		modifier = {
			factor = 0.75
			primary_title = { check_variable = { which = "imperial_decay" value = 30 } }
		}
		modifier = {
			factor = 0.75
			primary_title = { check_variable = { which = "imperial_decay" value = 60 } }
		}
		modifier = {
			factor = 0.5
			primary_title = { check_variable = { which = "imperial_decay" value = 90 } }
		}
	}
	
	option = {
		name = OK
		ROOT = { custom_tooltip = { text = IMPERIAL_DECAY_PLUS_1 } }
		if = {
			limit = { character = ROOT }
			hidden_tooltip = {
				emf_imperial_decay_plus_1_effect = yes
				add_character_modifier = {
					name = decay_event_timer
					hidden = yes
					duration = 1825
				}
			}
		}
	}
}

# Emperor/Regent is Lunatic
character_event = {
	id = emf_imperial.1865
	picture = GFX_evt_lunatic
	
	desc = {
		text = EVTDESC_emf_imperial_1865A
		trigger = { ROOT = { has_regent = no } }
	}
	desc = {
		text = EVTDESC_emf_imperial_1865B
		trigger = { ROOT = { has_regent = yes } }
	}
	
	is_triggered_only = yes
	major = yes
	
	only_independent = yes
	only_playable = yes
	
	major_trigger = {
		OR = {
			character = ROOT
			same_realm = ROOT
		}
	}
	
	trigger = {
		emf_uses_imperial_decay_trigger = yes
		primary_title = { NOT = { check_variable = { which = "imperial_decay" value = 100 } } }
		OR = {
			AND = {
				has_regent = no
				trait = lunatic
			}
			AND = {
				has_regent = yes
				regent = { trait = lunatic }
			}
		}
		NOT = { has_character_modifier = decay_event_timer }
	}
	
	weight_multiplier = {
		days = 1
		modifier = {
			factor = 2.0
			has_regent = yes
		}
		modifier = {
			factor = 2.0
			NOT = { primary_title = { check_variable = { which = "imperial_decay" value = 10 } } }
		}
		modifier = {
			factor = 0.75
			primary_title = { check_variable = { which = "imperial_decay" value = 30 } }
		}
		modifier = {
			factor = 0.75
			primary_title = { check_variable = { which = "imperial_decay" value = 60 } }
		}
		modifier = {
			factor = 0.5
			primary_title = { check_variable = { which = "imperial_decay" value = 90 } }
		}
	}
	
	option = {
		name = OK
		ROOT = { custom_tooltip = { text = IMPERIAL_DECAY_PLUS_1 } }
		if = {
			limit = { character = ROOT }
			hidden_tooltip = {
				emf_imperial_decay_plus_1_effect = yes
				add_character_modifier = {
					name = decay_event_timer
					hidden = yes
					duration = 1825
				}
			}
		}
	}
}

# Emperor/Regent is Possessed
character_event = {
	id = emf_imperial.1866
	picture = GFX_evt_lunatic
	
	desc = {
		text = EVTDESC_emf_imperial_1866A
		trigger = { ROOT = { has_regent = no } }
	}
	desc = {
		text = EVTDESC_emf_imperial_1866B
		trigger = { ROOT = { has_regent = yes } }
	}
	
	is_triggered_only = yes
	major = yes
	
	only_independent = yes
	only_playable = yes
	
	major_trigger = {
		OR = {
			character = ROOT
			same_realm = ROOT
		}
	}
	
	trigger = {
		emf_uses_imperial_decay_trigger = yes
		primary_title = { NOT = { check_variable = { which = "imperial_decay" value = 100 } } }
		OR = {
			AND = {
				has_regent = no
				trait = possessed
			}
			AND = {
				has_regent = yes
				regent = { trait = possessed }
			}
		}
		NOT = { has_character_modifier = decay_event_timer }
	}
	
	weight_multiplier = {
		days = 1
		modifier = {
			factor = 1.5
			has_regent = no
			has_character_modifier = voice_of_jesus
		}
		modifier = {
			factor = 1.5
			has_regent = yes
			regent = { has_character_modifier = voice_of_jesus }
		}
		modifier = {
			factor = 2.0
			has_regent = no
			has_character_modifier = voice_of_satan
		}
		modifier = {
			factor = 2.0
			has_regent = yes
			regent = { has_character_modifier = voice_of_satan }
		}
		modifier = {
			factor = 2.0
			has_regent = yes
		}
		modifier = {
			factor = 2.0
			NOT = { primary_title = { check_variable = { which = "imperial_decay" value = 10 } } }
		}
		modifier = {
			factor = 0.75
			primary_title = { check_variable = { which = "imperial_decay" value = 30 } }
		}
		modifier = {
			factor = 0.75
			primary_title = { check_variable = { which = "imperial_decay" value = 60 } }
		}
		modifier = {
			factor = 0.5
			primary_title = { check_variable = { which = "imperial_decay" value = 90 } }
		}
	}
	
	option = {
		name = OK
		ROOT = { custom_tooltip = { text = IMPERIAL_DECAY_PLUS_1 } }
		if = {
			limit = { character = ROOT }
			hidden_tooltip = {
				emf_imperial_decay_plus_1_effect = yes
				add_character_modifier = {
					name = decay_event_timer
					hidden = yes
					duration = 1825
				}
			}
		}
	}
}

# Emperor/Regent is Depressed
character_event = {
	id = emf_imperial.1867
	picture = GFX_evt_bad_news
	
	desc = {
		text = EVTDESC_emf_imperial_1867A
		trigger = { ROOT = { has_regent = no } }
	}
	desc = {
		text = EVTDESC_emf_imperial_1867B
		trigger = { ROOT = { has_regent = yes } }
	}
	
	is_triggered_only = yes
	major = yes
	
	only_independent = yes
	only_playable = yes
	
	major_trigger = {
		OR = {
			character = ROOT
			same_realm = ROOT
		}
	}
	
	trigger = {
		emf_uses_imperial_decay_trigger = yes
		primary_title = { NOT = { check_variable = { which = "imperial_decay" value = 100 } } }
		OR = {
			AND = {
				has_regent = no
				trait = depressed
			}
			AND = {
				has_regent = yes
				regent = { trait = depressed }
			}
		}
		NOT = { has_character_modifier = decay_event_timer }
	}
	
	weight_multiplier = {
		days = 1
		modifier = {
			factor = 2.0
			has_regent = yes
		}
		modifier = {
			factor = 2.0
			NOT = { primary_title = { check_variable = { which = "imperial_decay" value = 10 } } }
		}
		modifier = {
			factor = 0.75
			primary_title = { check_variable = { which = "imperial_decay" value = 30 } }
		}
		modifier = {
			factor = 0.75
			primary_title = { check_variable = { which = "imperial_decay" value = 60 } }
		}
		modifier = {
			factor = 0.5
			primary_title = { check_variable = { which = "imperial_decay" value = 90 } }
		}
	}
	
	option = {
		name = OK
		ROOT = { custom_tooltip = { text = IMPERIAL_DECAY_PLUS_1 } }
		if = {
			limit = { character = ROOT }
			hidden_tooltip = {
				emf_imperial_decay_plus_1_effect = yes
				add_character_modifier = {
					name = decay_event_timer
					hidden = yes
					duration = 1825
				}
			}
		}
	}
}

# Emperor is a prisoner
character_event = {
	id = emf_imperial.1868
	picture = GFX_evt_into_the_dungeon
	desc = EVTDESC_emf_imperial_1868
	
	is_triggered_only = yes
	major = yes
	
	only_independent = yes
	only_playable = yes
	
	major_trigger = {
		OR = {
			character = ROOT
			same_realm = ROOT
		}
	}
	
	trigger = {
		emf_uses_imperial_decay_trigger = yes
		primary_title = { NOT = { check_variable = { which = "imperial_decay" value = 100 } } }
		prisoner = yes
		NOT = { has_character_modifier = decay_event_timer }
	}
	
	weight_multiplier = {
		days = 1
		modifier = {
			factor = 2.0
			NOT = { primary_title = { check_variable = { which = "imperial_decay" value = 10 } } }
		}
		modifier = {
			factor = 0.75
			primary_title = { check_variable = { which = "imperial_decay" value = 30 } }
		}
		modifier = {
			factor = 0.75
			primary_title = { check_variable = { which = "imperial_decay" value = 60 } }
		}
		modifier = {
			factor = 0.5
			primary_title = { check_variable = { which = "imperial_decay" value = 90 } }
		}
	}
	
	option = {
		name = OK
		ROOT = { custom_tooltip = { text = IMPERIAL_DECAY_PLUS_1 } }
		if = {
			limit = { character = ROOT }
			hidden_tooltip = {
				emf_imperial_decay_plus_1_effect = yes
				add_character_modifier = {
					name = decay_event_timer
					hidden = yes
					duration = 1825
				}
			}
		}
	}
}

# Emperor has a capable Steward
character_event = {
	id = emf_imperial.1869
	desc = EVTDESC_emf_imperial_1869
	picture = GFX_evt_throne_room
	
	is_triggered_only = yes
	major = yes
	
	only_independent = yes
	only_playable = yes
	
	major_trigger = {
		OR = {
			character = ROOT
			same_realm = ROOT
		}
	}
	
	trigger = {
		emf_uses_imperial_decay_trigger = yes
		primary_title = { check_variable = { which = "imperial_decay" value = 1 } }
		job_treasurer = { stewardship = 15 }
		realm_stewardship = 30
		NOT = { has_character_modifier = decay_event_timer }
	}
	
	weight_multiplier = {
		days = 1
		modifier = {
			factor = 1.5
			job_treasurer = { stewardship = 20 }
		}
		modifier = {
			factor = 1.5
			job_treasurer = { stewardship = 25 }
		}
		modifier = {
			factor = 0.5
			NOT = { primary_title = { check_variable = { which = "imperial_decay" value = 10 } } }
		}
		modifier = {
			factor = 2.0
			primary_title = { check_variable = { which = "imperial_decay" value = 30 } }
		}
		modifier = {
			factor = 2.0
			primary_title = { check_variable = { which = "imperial_decay" value = 60 } }
		}
	}
	
	option = {
		name = OK
		ROOT = { custom_tooltip = { text = IMPERIAL_DECAY_MINUS_1 } }
		if = {
			limit = { character = ROOT }
			hidden_tooltip = {
				emf_imperial_decay_minus_1_effect = yes
				add_character_modifier = {
					name = decay_event_timer
					hidden = yes
					duration = 1825
				}
			}
		}
	}
}

# Emperor has a lousy Steward
character_event = {
	id = emf_imperial.1870
	desc = EVTDESC_emf_imperial_1870
	picture = GFX_evt_throne_room
	
	is_triggered_only = yes
	major = yes
	
	only_independent = yes
	only_playable = yes
	
	major_trigger = {
		OR = {
			character = ROOT
			same_realm = ROOT
		}
	}
	
	trigger = {
		emf_uses_imperial_decay_trigger = yes
		primary_title = { NOT = { check_variable = { which = "imperial_decay" value = 100 } } }
		any_courtier = { has_job_title = job_treasurer }
		job_treasurer = { NOT = { stewardship = 10 } }
		NOT = { has_character_modifier = decay_event_timer }
	}
	
	weight_multiplier = {
		days = 1
		modifier = {
			factor = 1.5
			job_treasurer = { NOT = { stewardship = 8 } }
		}
		modifier = {
			factor = 1.5
			job_treasurer = { NOT = { stewardship = 5 } }
		}
		modifier = {
			factor = 2.0
			NOT = { primary_title = { check_variable = { which = "imperial_decay" value = 10 } } }
		}
		modifier = {
			factor = 0.75
			primary_title = { check_variable = { which = "imperial_decay" value = 30 } }
		}
		modifier = {
			factor = 0.75
			primary_title = { check_variable = { which = "imperial_decay" value = 60 } }
		}
		modifier = {
			factor = 0.5
			primary_title = { check_variable = { which = "imperial_decay" value = 90 } }
		}
	}
	
	option = {
		name = OK
		ROOT = { custom_tooltip = { text = IMPERIAL_DECAY_PLUS_1 } }
		if = {
			limit = { character = ROOT }
			hidden_tooltip = {
				emf_imperial_decay_plus_1_effect = yes
				add_character_modifier = {
					name = decay_event_timer
					hidden = yes
					duration = 1825
				}
			}
		}
	}
}

### BYZANTINE STARTUP EVENTS

# Bounce event (fired from emf_startup.2)
character_event = {
	id = emf_imperial.1875
	
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		e_byzantium = {
			holder_scope = {
				narrative_event = { id = emf_imperial.1876 }
				narrative_event = { id = emf_imperial.1877 }
				narrative_event = { id = emf_imperial.1878 }
				narrative_event = { id = emf_imperial.1879 }
			}
		}
	}
}

# Byzantine Empire is flourishing
narrative_event = {
	id = emf_imperial.1876
	title = EVTNAME_emf_imperial_1876
	desc = EVTDESC_emf_imperial_1876
	picture = GFX_evt_byzantine_throne
	
	is_triggered_only = yes
	hide_from = yes
	
	has_global_flag = byz_empire_flourishes
	
	trigger = {
		has_landed_title = e_byzantium
	}
	
	option = {
		name = EVTOPTA_emf_imperial_1876
		clr_global_flag = byz_empire_flourishes
		if = {
			limit = { emf_was_strong_basileus = yes }
			add_trait = strong_basileus
		}
		# Change the decadence modifier
		hidden_tooltip = { character_event = { id = emf_imperial.1852 } }
	}
}

# Byzantine Empire is cracking
narrative_event = {
	id = emf_imperial.1877
	title = EVTNAME_emf_imperial_1877
	desc = EVTDESC_emf_imperial_1877
	picture = GFX_evt_byzantine_throne
	
	is_triggered_only = yes
	hide_from = yes
	
	has_global_flag = byz_empire_cracking
	
	trigger = {
		has_landed_title = e_byzantium
	}
	
	option = {
		name = EVTOPTA_emf_imperial_1876
		clr_global_flag = byz_empire_cracking
		if = {
			limit = { emf_was_strong_basileus = yes }
			add_trait = strong_basileus
		}
		if = {
			limit = {
#				is_ironman = no
				trait = strong_basileus
			}
			hidden_tooltip = {
				e_byzantium = { set_variable = { which = "imperial_decay_change" value = -10 } }
			}
		}
		# Change the decadence modifier
		hidden_tooltip = { character_event = { id = emf_imperial.1852 } }
	}
}

# Byzantine Empire is falling
narrative_event = {
	id = emf_imperial.1878
	title = EVTNAME_emf_imperial_1878
	desc = EVTDESC_emf_imperial_1878
	picture = GFX_evt_byzantine_throne
	
	is_triggered_only = yes
	hide_from = yes
	
	has_global_flag = byz_empire_falling
	
	trigger = {
		has_landed_title = e_byzantium
	}
	
	option = {
		name = EVTOPTA_emf_imperial_1876
		clr_global_flag = byz_empire_falling
		if = {
			limit = { emf_was_strong_basileus = yes }
			add_trait = strong_basileus
		}
		if = {
			limit = {
#				is_ironman = no
				trait = strong_basileus
			}
			hidden_tooltip = {
				e_byzantium = { set_variable = { which = "imperial_decay_change" value = -10 } }
			}
		}
		# Change the decadence modifier
		hidden_tooltip = { character_event = { id = emf_imperial.1852 } }
	}
}

# Byzantine Empire is shattered
narrative_event = {
	id = emf_imperial.1879
	title = EVTNAME_emf_imperial_1879
	desc = EVTDESC_emf_imperial_1879
	picture = GFX_evt_byzantine_throne
	
	is_triggered_only = yes
	hide_from = yes
	
	has_global_flag = byz_empire_shattered
	
	trigger = {
		has_landed_title = e_byzantium
	}
	
	option = {
		name = EVTOPTA_emf_imperial_1876
		clr_global_flag = byz_empire_shattered
		if = {
			limit = { emf_was_strong_basileus = yes }
			add_trait = strong_basileus
		}
		if = {
			limit = {
#				is_ironman = no
				trait = strong_basileus
			}
			hidden_tooltip = {
				e_byzantium = { set_variable = { which = "imperial_decay_change" value = -10 } }
			}
		}
		# Change the decadence modifier
		hidden_tooltip = { character_event = { id = emf_imperial.1852 } }
	}
}

###########################

# emf_imperial.1880 -- Notification of imperial decay change for ROOT, FROM must also be ROOT
# Note that this is only for players and that all decay changes should be routed through emf_imperial.1852
character_event = {
	id = emf_imperial.1880
	picture = GFX_evt_council
	
	is_triggered_only = yes
	notification = yes
	
	trigger = { ai = no }
	
	desc = {
		text = emf_imperial.1880.desc_decrease
		trigger = {
			primary_title = {
				NOT = { check_variable = { which = "imperial_decay_change" value = 0 } }
			}
		}
	}
	desc = {
		text = emf_imperial.1880.desc_increase
		trigger = {
			primary_title = {
				check_variable = { which = "imperial_decay_change" value = 0 }
				NOT = { is_variable_equal = { which = "imperial_decay_change" value = 0 } }
			}
		}
	}
	desc = { # Fallback case should there actually have been no change
		text = emf_imperial.1880.desc_same
		trigger = {
			primary_title = {
				is_variable_equal = { which = "imperial_decay_change" value = 0 }
			}
		}
	}
	
	option = { name = OK }
}

# emf_imperial.1885 -- Acquisition of a secondary empire title (not for nomads)
character_event = {
	id = emf_imperial.1885
	
	is_triggered_only = yes
	hide_window = yes
	
	only_independent = yes
	only_playable = yes
	
	trigger = {
		is_nomadic = no
		FROM = {
			tier = EMPEROR
			is_primary_holder_title = no
			temporary = no
		}
		any_demesne_title = {
			tier = EMPEROR
			temporary = no
			NOT = { title = FROM }
		}
	}
	
	immediate = {
		primary_title = {
			if = {
				limit = {
					tier = EMPEROR
					temporary = no
					NOT = { title = FROM }
				}
				save_event_target_as = emf_current_title
				break = yes
			}
		}
		random_demesne_title = {
			limit = {
				tier = EMPEROR
				temporary = no
				NOT = { title = FROM }
			}
			save_event_target_as = emf_current_title
			break = yes
		}
	}
	
	option = {
		name = OK
		log = "INFO: emf_imperial.1885: [Root.GetTitledFirstName] of [Root.PrimaryTitle.GetBaseName] ([Root.GetID]/[Root.PrimaryTitle.GetID]) acquired secondary empire title [From.GetBaseName] ([From.GetID]) -- will have to choose between it and [emf_current_title.GetBaseName] ([emf_current_title.GetID])"
		character_event = { id = emf_imperial.1886 days = 1 } # Force them to choose
	}
}


character_event = {
	id = emf_imperial.1886
	desc = emf_imperial.1886.desc
	picture = GFX_evt_coronation
	
	is_triggered_only = yes
	
	trigger = {
		has_landed_title = event_target:emf_current_title
		has_landed_title = FROMFROM
	}
	
	option = {
		name = emf_imperial.1886.opt.keep_current
		ai_chance = {
			factor = 10
			modifier = {
				factor = 0
				NOR = {
					event_target:emf_current_title = { is_de_jure_title = yes }
					FROMFROM = { is_de_jure_title = no }
				}
			}
		}
		hidden_tooltip = {
			if = {
				limit = { FROMFROM = { is_primary_holder_title = yes } }
				event_target:emf_current_title = { make_primary_title = yes }
			}
			# TODO in 2.6: check the de_facto_liege_title of vassals before using set_defacto_liege,
			# as this seems to boot the entire council and all minor titles. Only vassals whose liege
			# is the empire which we're to destroy need this effect.
			any_vassal = { set_defacto_liege = ROOT }
		}
		FROMFROM = {
			if = {
				limit = { is_landless_type_title = no }
				emf_destroy_title_effect = yes
			}
			if = {
				limit = { is_landless_type_title = yes }
				emf_destroy_title_unsafe_effect = yes
			}
		}
	}
	
	option = {
		name = emf_imperial.1886.opt.assume_new
		ai_chance = {
			factor = 10
			modifier = {
				factor = 0
				OR = {
					event_target:emf_current_title = { is_de_jure_title = yes }
					FROMFROM = { is_de_jure_title = no }
				}
			}
		}
		hidden_tooltip = {
			FROMFROM = { make_primary_title = yes }
			# TODO in 2.6: check the de_facto_liege_title of vassals before using set_defacto_liege,
			# as this seems to boot the entire council and all minor titles. Only vassals whose liege
			# is the empire which we're to destroy need this effect.
			any_vassal = { set_defacto_liege = ROOT }
			# When assuming new title, ensure that the new title's ID rating is at least as high
			# as any held empire titles
			any_demesne_title = {
				limit = {
					tier = EMPEROR
					NOT = { title = FROMFROM }
					check_variable = { which = "imperial_decay" which = FROMFROM }
				}
				ROOT = { set_character_flag = decay_change_tmp }
				set_variable = { which = "imperial_decay_change" which = "imperial_decay" }
				FROMFROM = {
					set_variable = { which = "imperial_decay_change" which = PREV }
					subtract_variable = { which = "imperial_decay_change" which = "imperial_decay" }
				}
				set_variable = { which = "imperial_decay_change" value = 0 }
			}
			if = {
				limit = { has_character_flag = decay_change_tmp }
				clr_character_flag = decay_change_tmp
				character_event = { id = emf_imperial.1852 } # Update modifiers & notify
			}
		}
		event_target:emf_current_title = {
			if = {
				limit = { is_landless_type_title = no }
				emf_destroy_title_effect = yes
			}
			if = {
				limit = { is_landless_type_title = yes }
				emf_destroy_title_unsafe_effect = yes
			}
		}
	}
}
