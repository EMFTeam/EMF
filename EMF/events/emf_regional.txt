# -*- ck2.events -*-

namespace = emf_regional

### EMF Regional Events Module
### AKA: Doing silly stuff with narrative events because recursion is broken

## Seasonal Events
## 0-99 reserved

# Don't forget, we'll probably want some weather/other modifier graphics!

# Seasons:
# Spring = March, April, May
# Summer = June, July, August
# Autumn = September, October, November
# Winter = December, January, February

# Terrain:
# Vanilla: steppe, jungle, forest, hills, plains, farmlands, mountain, desert, arctic
# SWMH: marsh, coastal_desert, woods

# Effects:
# Possible effects: Effective fort readiness on coastal provinces, trade value, tax modifiers, possibly movement speed (though the new local_speed_modifier), levy_sizes, attrition (supply_limit and max_attrition), and in particularly nasty cases increased revolt risk

# Rain: Bad for ripening or harvest, but good for growing (Heavy Rain is enough)
# Heavy Rain: Very bad for ripening or ready crops (Heavy Snow in Winter)
# Storms: Damage crops, bad for livestock (Blizzards in Winter)
# Cloudy: Poor effect on ripening crops (doesn't apply in Winter)
# Bright: Good for ripening crops (doesn't apply in Winter)
# Drought: Bad for everything
# Heat Wave: ? (Mild Winter in Winter)
# Unusually Cold: ? (Harsh Winter in Winter)

# Desert is going to need to get its own version of many of these modifiers for proper localization descriptions
# Jungle might need some as well

# AI seasonal pulse event
narrative_event = {
	id = emf_regional.0
	title = OK
	desc = OK
	picture = GFX_evt_cathedral
	is_triggered_only = yes
	major = yes
	
	major_trigger = {
		is_playable = yes
		ai = yes
	}
	
	option = { # Nothing happens
		ai_chance = {
			factor = 96
			modifier = {
				factor = 0.958
				num_of_count_titles = 2
			}
			modifier = {
				factor = 0.957
				num_of_count_titles = 3
			}
			modifier = {
				factor = 0.955
				num_of_count_titles = 4
			}
			modifier = {
				factor = 0.952
				num_of_count_titles = 5
			}
			modifier = {
				factor = 0.95
				num_of_count_titles = 6
			}
			modifier = {
				factor = 0.947
				num_of_count_titles = 7
			}
			modifier = {
				factor = 0.944
				num_of_count_titles = 8
			}
			modifier = {
				factor = 0.941
				num_of_count_titles = 9
			}
			modifier = {
				factor = 0.938
				num_of_count_titles = 10
			}
		}
		name = OK
	}
	option = { # Seasonal weather event
		ai_chance = {
			factor = 3
			modifier = {
				factor = 2
				num_of_count_titles = 2
			}
			modifier = {
				factor = 1.5
				num_of_count_titles = 3
			}
			modifier = {
				factor = 1.333
				num_of_count_titles = 4
			}
			modifier = {
				factor = 1.25
				num_of_count_titles = 5
			}
			modifier = {
				factor = 1.2
				num_of_count_titles = 6
			}
			modifier = {
				factor = 1.167
				num_of_count_titles = 7
			}
			modifier = {
				factor = 1.143
				num_of_count_titles = 8
			}
			modifier = {
				factor = 1.125
				num_of_count_titles = 9
			}
			modifier = {
				factor = 1.111
				num_of_count_titles = 10
			}
		}
		name = OK

		random_demesne_title = {
			limit = { tier = COUNT }
			location = {
				# EMF Seasonal Events
				set_province_flag = emf_seasonal_event
				owner = { character_event = { id = emf_regional.3 } }
			}
		}
	}
	option = { # Other seasonal event
		ai_chance = {
			factor = 1
			modifier = {
				factor = 2
				num_of_count_titles = 2
			}
			modifier = {
				factor = 1.5
				num_of_count_titles = 3
			}
			modifier = {
				factor = 1.333
				num_of_count_titles = 4
			}
			modifier = {
				factor = 1.25
				num_of_count_titles = 5
			}
			modifier = {
				factor = 1.2
				num_of_count_titles = 6
			}
			modifier = {
				factor = 1.167
				num_of_count_titles = 7
			}
			modifier = {
				factor = 1.143
				num_of_count_titles = 8
			}
			modifier = {
				factor = 1.125
				num_of_count_titles = 9
			}
			modifier = {
				factor = 1.111
				num_of_count_titles = 10
			}
		}
		name = OK

#		random_demesne_title = {
#			limit = { tier = COUNT }
#			location = {
				# EMF Seasonal Events
				# set_province_flag = emf_seasonal_event
				# owner = { character_event = { id = emf_regional.4 } }
#			}
#		}
	}
}

# Player seasonal pulse event
character_event = {
	id = emf_regional.1
	hide_window = yes
	is_triggered_only = yes
	
	option = { # Nothing happens
		ai_chance = {
			factor = 96
			modifier = {
				factor = 0.958
				num_of_count_titles = 2
			}
			modifier = {
				factor = 0.957
				num_of_count_titles = 3
			}
			modifier = {
				factor = 0.955
				num_of_count_titles = 4
			}
			modifier = {
				factor = 0.952
				num_of_count_titles = 5
			}
			modifier = {
				factor = 0.95
				num_of_count_titles = 6
			}
			modifier = {
				factor = 0.947
				num_of_count_titles = 7
			}
			modifier = {
				factor = 0.944
				num_of_count_titles = 8
			}
			modifier = {
				factor = 0.941
				num_of_count_titles = 9
			}
			modifier = {
				factor = 0.938
				num_of_count_titles = 10
			}
		}
		name = OK
	}
	option = { # Seasonal weather event
		ai_chance = {
			factor = 3
			modifier = {
				factor = 2
				num_of_count_titles = 2
			}
			modifier = {
				factor = 1.5
				num_of_count_titles = 3
			}
			modifier = {
				factor = 1.333
				num_of_count_titles = 4
			}
			modifier = {
				factor = 1.25
				num_of_count_titles = 5
			}
			modifier = {
				factor = 1.2
				num_of_count_titles = 6
			}
			modifier = {
				factor = 1.167
				num_of_count_titles = 7
			}
			modifier = {
				factor = 1.143
				num_of_count_titles = 8
			}
			modifier = {
				factor = 1.125
				num_of_count_titles = 9
			}
			modifier = {
				factor = 1.111
				num_of_count_titles = 10
			}
		}
		name = OK

		random_demesne_title = {
			limit = { tier = COUNT }
			location = {
				# EMF Seasonal Events
				set_province_flag = emf_seasonal_event
				owner = { character_event = { id = emf_regional.3 } }
			}
		}
	}
	option = { # Other seasonal event
		ai_chance = {
			factor = 1
			modifier = {
				factor = 2
				num_of_count_titles = 2
			}
			modifier = {
				factor = 1.5
				num_of_count_titles = 3
			}
			modifier = {
				factor = 1.333
				num_of_count_titles = 4
			}
			modifier = {
				factor = 1.25
				num_of_count_titles = 5
			}
			modifier = {
				factor = 1.2
				num_of_count_titles = 6
			}
			modifier = {
				factor = 1.167
				num_of_count_titles = 7
			}
			modifier = {
				factor = 1.143
				num_of_count_titles = 8
			}
			modifier = {
				factor = 1.125
				num_of_count_titles = 9
			}
			modifier = {
				factor = 1.111
				num_of_count_titles = 10
			}
		}
		name = OK

#		random_demesne_title = {
#			limit = { tier = COUNT }
#			location = {
				# EMF Seasonal Events
				# set_province_flag = emf_seasonal_event
				# owner = { character_event = { id = emf_regional.4 } }
#			}
#		}
	}
}

# Hand out seasonal weather events
character_event = {
	id = emf_regional.3
	hide_window = yes
	is_triggered_only = yes
	
	# Shared
	option = { # Heavy Rain
		name = OK
		ai_chance = {
			factor = 1
			modifier = { # Not in Winter
				factor = 0
				OR = {
					month = 11 # At least December
					AND = {
						month = 0
						NOT = { month = 2 } # Before March
					}
				}
			}
		}
		random_demesne_title = {
			limit = {
				tier = COUNT
				location = { has_province_flag = emf_seasonal_event }
			}
			location = {
				clr_province_flag = emf_seasonal_event
				# Heavy Rain is good during spring
				if = {
					limit = {
						NOT = { terrain = desert }
						NOT = { borders_major_river = yes }
						NOT = { port = yes }
						month = 2 # At least March
						NOT = { month = 5 } # Before June
					}
					add_province_modifier = {
						name = emf_mod_heavy_rain_good
						duration = 80
					}
				}
				# Heavy Rain is bad during other seasons
				if = {
					limit = {
						NOT = { terrain = desert }
						NOT = { borders_major_river = yes }
						NOT = { port = yes }
						month = 5 # At least June
						NOT = { month = 11 } # Before December
					}
					add_province_modifier = {
						name = emf_mod_heavy_rain_bad
						duration = 80
					}
				}
				# River Flooding
				if = {
					limit = { borders_major_river = yes }
					add_province_modifier = {
						name = emf_mod_river_flooding
						duration = 80
					}
				}
				# Coastal Flooding
				if = {
					limit = { port = yes }
					add_province_modifier = {
						name = emf_mod_coastal_flooding
						duration = 80
					}
				}
				# Deserts get their own Rain
				if = {
					limit = { terrain = desert }
					add_province_modifier = {
						name = emf_mod_desert_rain
						duration = 80
					}
				}
				any_neighbor_province = {
					limit = {
						# General
						NOT = { has_province_modifier = emf_mod_heavy_rain_good }
						NOT = { has_province_modifier = emf_mod_heavy_rain_bad }
						NOT = { has_province_modifier = emf_mod_storms }
						NOT = { has_province_modifier = emf_mod_drought }
						# Special
						NOT = { has_province_modifier = emf_mod_river_flooding }
						NOT = { has_province_modifier = emf_mod_coastal_flooding }
						NOT = { has_province_modifier = emf_mod_sandstorms }
						NOT = { has_province_modifier = emf_mod_desert_rain }
						NOT = { has_province_modifier = emf_mod_desert_storms }
						# Winter
						NOT = { has_province_modifier = emf_mod_heavy_snow }
						NOT = { has_province_modifier = emf_mod_blizzards }
						NOT = { has_province_modifier = emf_mod_mild_winter }
						NOT = { has_province_modifier = emf_mod_harsh_winter }
						# Spring
						NOT = { has_province_modifier = emf_mod_pleasant_spring }
						NOT = { has_province_modifier = emf_mod_long_winter }
						# Summer
						NOT = { has_province_modifier = emf_mod_heat_wave }
						NOT = { has_province_modifier = emf_mod_mild_summer }
						NOT = { has_province_modifier = emf_mod_cloudy }
						NOT = { has_province_modifier = emf_mod_bright }
						# Autumn
						NOT = { has_province_modifier = emf_mod_warm_autumn }
						NOT = { has_province_modifier = emf_mod_early_winter }
					}
					# Heavy Rain is good during spring
					if = {
						limit = {
							NOT = { terrain = desert }
							NOT = { borders_major_river = yes }
							NOT = { port = yes }
							month = 2 # At least March
							NOT = { month = 5 } # Before June
						}
						add_province_modifier = {
							name = emf_mod_heavy_rain_good
							duration = 80
						}
					}
					# Heavy Rain is bad during other seasons
					if = {
						limit = {
							NOT = { terrain = desert }
							NOT = { borders_major_river = yes }
							NOT = { port = yes }
							month = 5 # At least June
							NOT = { month = 11 } # Before December
						}
						add_province_modifier = {
							name = emf_mod_heavy_rain_bad
							duration = 80
						}
					}
					# River Flooding
					if = {
						limit = { borders_major_river = yes }
						add_province_modifier = {
							name = emf_mod_river_flooding
							duration = 80
						}
					}
					# Coastal Flooding
					if = {
						limit = { port = yes }
						add_province_modifier = {
							name = emf_mod_coastal_flooding
							duration = 80
						}
					}
					# Deserts get their own Rain
					if = {
						limit = { terrain = desert }
						add_province_modifier = {
							name = emf_mod_desert_rain
							duration = 80
						}
					}
				}
			}
		}
	}
	option = { # Storms
		name = OK
		ai_chance = {
			factor = 1
			modifier = { # Not in Winter
				factor = 0
				OR = {
					month = 11 # At least December
					AND = {
						month = 0
						NOT = { month = 2 } # Before March
					}
				}
			}
		}
		random_demesne_title = {
			limit = {
				tier = COUNT
				location = { has_province_flag = emf_seasonal_event }
			}
			location = {
				clr_province_flag = emf_seasonal_event
				# Most provinces get Storms
				if = {
					limit = {
						NOT = { terrain = desert }
						NOT = { borders_major_river = yes }
						NOT = { port = yes }
					}
					add_province_modifier = {
						name = emf_mod_storms
						duration = 80
					}
				}
				# River Flooding
				if = {
					limit = { borders_major_river = yes }
					add_province_modifier = {
						name = emf_mod_river_flooding
						duration = 80
					}
				}
				# Coastal Flooding
				if = {
					limit = { port = yes }
					add_province_modifier = {
						name = emf_mod_coastal_flooding
						duration = 80
					}
				}
				# Deserts get Sandstorms unless they're coastal or border a major river
				if = {
					limit = {
						terrain = desert
						NOT = { borders_major_river = yes }
						NOT = { port = yes }
					}
					add_province_modifier = {
						name = emf_mod_sandstorms
						duration = 80
					}
				}
				any_neighbor_province = {
					limit = {
						# General
						NOT = { has_province_modifier = emf_mod_heavy_rain_good }
						NOT = { has_province_modifier = emf_mod_heavy_rain_bad }
						NOT = { has_province_modifier = emf_mod_storms }
						NOT = { has_province_modifier = emf_mod_drought }
						# Special
						NOT = { has_province_modifier = emf_mod_river_flooding }
						NOT = { has_province_modifier = emf_mod_coastal_flooding }
						NOT = { has_province_modifier = emf_mod_sandstorms }
						NOT = { has_province_modifier = emf_mod_desert_rain }
						NOT = { has_province_modifier = emf_mod_desert_storms }
						# Winter
						NOT = { has_province_modifier = emf_mod_heavy_snow }
						NOT = { has_province_modifier = emf_mod_blizzards }
						NOT = { has_province_modifier = emf_mod_mild_winter }
						NOT = { has_province_modifier = emf_mod_harsh_winter }
						# Spring
						NOT = { has_province_modifier = emf_mod_pleasant_spring }
						NOT = { has_province_modifier = emf_mod_long_winter }
						# Summer
						NOT = { has_province_modifier = emf_mod_heat_wave }
						NOT = { has_province_modifier = emf_mod_mild_summer }
						NOT = { has_province_modifier = emf_mod_cloudy }
						NOT = { has_province_modifier = emf_mod_bright }
						# Autumn
						NOT = { has_province_modifier = emf_mod_warm_autumn }
						NOT = { has_province_modifier = emf_mod_early_winter }
					}
					# Most provinces get Storms
					if = {
						limit = {
							NOT = { terrain = desert }
							NOT = { borders_major_river = yes }
							NOT = { port = yes }
						}
						add_province_modifier = {
							name = emf_mod_storms
							duration = 80
						}
					}
					# River Flooding
					if = {
						limit = { borders_major_river = yes }
						add_province_modifier = {
							name = emf_mod_river_flooding
							duration = 80
						}
					}
					# Coastal Flooding
					if = {
						limit = { port = yes }
						add_province_modifier = {
							name = emf_mod_coastal_flooding
							duration = 80
						}
					}
					# Deserts get Sandstorms unless they're coastal or border a major river
					if = {
						limit = {
							terrain = desert
							NOT = { borders_major_river = yes }
							NOT = { port = yes }
						}
						add_province_modifier = {
							name = emf_mod_sandstorms
							duration = 80
						}
					}
				}
			}
		}
	}
	option = { # Drought
		name = OK
		ai_chance = {
			factor = 1
		}
		random_demesne_title = {
			limit = {
				tier = COUNT
				location = { has_province_flag = emf_seasonal_event }
			}
			location = {
				clr_province_flag = emf_seasonal_event
				# Most provinces get Drought
				if = {
					limit = {
						NOT = { terrain = desert }
					}
					add_province_modifier = {
						name = emf_mod_drought
						duration = 80
					}
				}
				any_neighbor_province = {
					limit = {
						# General
						NOT = { has_province_modifier = emf_mod_heavy_rain_good }
						NOT = { has_province_modifier = emf_mod_heavy_rain_bad }
						NOT = { has_province_modifier = emf_mod_storms }
						NOT = { has_province_modifier = emf_mod_drought }
						# Special
						NOT = { has_province_modifier = emf_mod_river_flooding }
						NOT = { has_province_modifier = emf_mod_coastal_flooding }
						NOT = { has_province_modifier = emf_mod_sandstorms }
						NOT = { has_province_modifier = emf_mod_desert_rain }
						NOT = { has_province_modifier = emf_mod_desert_storms }
						# Winter
						NOT = { has_province_modifier = emf_mod_heavy_snow }
						NOT = { has_province_modifier = emf_mod_blizzards }
						NOT = { has_province_modifier = emf_mod_mild_winter }
						NOT = { has_province_modifier = emf_mod_harsh_winter }
						# Spring
						NOT = { has_province_modifier = emf_mod_pleasant_spring }
						NOT = { has_province_modifier = emf_mod_long_winter }
						# Summer
						NOT = { has_province_modifier = emf_mod_heat_wave }
						NOT = { has_province_modifier = emf_mod_mild_summer }
						NOT = { has_province_modifier = emf_mod_cloudy }
						NOT = { has_province_modifier = emf_mod_bright }
						# Autumn
						NOT = { has_province_modifier = emf_mod_warm_autumn }
						NOT = { has_province_modifier = emf_mod_early_winter }
					}
					# Most provinces get Drought
					if = {
						limit = {
							NOT = { terrain = desert }
						}
						add_province_modifier = {
							name = emf_mod_drought
							duration = 80
						}
					}
				}
			}
		}
	}
	
	# Winter
	option = { # Heavy Snow
		trigger = {
			OR = {
				month = 11 # At least December
				AND = {
					month = 0
					NOT = { month = 2 } # Before March
				}
			}
		}
		name = OK
		ai_chance = {
			factor = 1
		}
		
		random_demesne_title = {
			limit = {
				tier = COUNT
				location = { has_province_flag = emf_seasonal_event }
			}
			location = {
				clr_province_flag = emf_seasonal_event
				# Most provinces get Heavy Snow
				if = {
					limit = {
						NOT = { terrain = jungle }
						NOT = { terrain = desert }
					}
					add_province_modifier = {
						name = emf_mod_heavy_snow
						duration = 80
					}
				}
				# Jungle gets Heavy Rains
				if = {
					limit = { terrain = jungle }
					add_province_modifier = {
						name = emf_mod_heavy_rain_bad
						duration = 80
					}
				}
				# Desert gets Desert Rain
				if = {
					limit = { terrain = desert }
					add_province_modifier = {
						name = emf_mod_desert_rain
						duration = 80
					}
				}
				any_neighbor_province = {
					limit = {
						# General
						NOT = { has_province_modifier = emf_mod_heavy_rain_good }
						NOT = { has_province_modifier = emf_mod_heavy_rain_bad }
						NOT = { has_province_modifier = emf_mod_storms }
						NOT = { has_province_modifier = emf_mod_drought }
						# Special
						NOT = { has_province_modifier = emf_mod_river_flooding }
						NOT = { has_province_modifier = emf_mod_coastal_flooding }
						NOT = { has_province_modifier = emf_mod_sandstorms }
						NOT = { has_province_modifier = emf_mod_desert_rain }
						NOT = { has_province_modifier = emf_mod_desert_storms }
						# Winter
						NOT = { has_province_modifier = emf_mod_heavy_snow }
						NOT = { has_province_modifier = emf_mod_blizzards }
						NOT = { has_province_modifier = emf_mod_mild_winter }
						NOT = { has_province_modifier = emf_mod_harsh_winter }
						# Spring
						NOT = { has_province_modifier = emf_mod_pleasant_spring }
						NOT = { has_province_modifier = emf_mod_long_winter }
						# Summer
						NOT = { has_province_modifier = emf_mod_heat_wave }
						NOT = { has_province_modifier = emf_mod_mild_summer }
						NOT = { has_province_modifier = emf_mod_cloudy }
						NOT = { has_province_modifier = emf_mod_bright }
						# Autumn
						NOT = { has_province_modifier = emf_mod_warm_autumn }
						NOT = { has_province_modifier = emf_mod_early_winter }
					}
					# Most provinces get Heavy Snow
					if = {
						limit = {
							NOT = { terrain = jungle }
							NOT = { terrain = desert }
						}
						add_province_modifier = {
							name = emf_mod_heavy_snow
							duration = 80
						}
					}
					# Jungle gets Heavy Rains
					if = {
						limit = { terrain = jungle }
						add_province_modifier = {
							name = emf_mod_heavy_rain_bad
							duration = 80
						}
					}
					# Desert gets Desert Rain
					if = {
						limit = { terrain = desert }
						add_province_modifier = {
							name = emf_mod_desert_rain
							duration = 80
						}
					}
				}
			}
		}
	}
	option = { # Blizzards
		trigger = {
			OR = {
				month = 11 # At least December
				AND = {
					month = 0
					NOT = { month = 2 } # Before March
				}
			}
		}
		name = OK
		ai_chance = {
			factor = 1
		}
		
		random_demesne_title = {
			limit = {
				tier = COUNT
				location = { has_province_flag = emf_seasonal_event }
			}
			location = {
				clr_province_flag = emf_seasonal_event
				# Most provinces get Blizzards
				if = {
					limit = {
						NOT = { terrain = jungle }
						NOT = { terrain = desert }
					}
					add_province_modifier = {
						name = emf_mod_blizzards
						duration = 80
					}
				}
				# Jungle gets Storms
				if = {
					limit = { terrain = jungle }
					add_province_modifier = {
						name = emf_mod_storms
						duration = 80
					}
				}
				# Desert gets Desert Storms
				if = {
					limit = { terrain = desert }
					add_province_modifier = {
						name = emf_mod_desert_storms
						duration = 80
					}
				}
				any_neighbor_province = {
					limit = {
						# General
						NOT = { has_province_modifier = emf_mod_heavy_rain_good }
						NOT = { has_province_modifier = emf_mod_heavy_rain_bad }
						NOT = { has_province_modifier = emf_mod_storms }
						NOT = { has_province_modifier = emf_mod_drought }
						# Special
						NOT = { has_province_modifier = emf_mod_river_flooding }
						NOT = { has_province_modifier = emf_mod_coastal_flooding }
						NOT = { has_province_modifier = emf_mod_sandstorms }
						NOT = { has_province_modifier = emf_mod_desert_rain }
						NOT = { has_province_modifier = emf_mod_desert_storms }
						# Winter
						NOT = { has_province_modifier = emf_mod_heavy_snow }
						NOT = { has_province_modifier = emf_mod_blizzards }
						NOT = { has_province_modifier = emf_mod_mild_winter }
						NOT = { has_province_modifier = emf_mod_harsh_winter }
						# Spring
						NOT = { has_province_modifier = emf_mod_pleasant_spring }
						NOT = { has_province_modifier = emf_mod_long_winter }
						# Summer
						NOT = { has_province_modifier = emf_mod_heat_wave }
						NOT = { has_province_modifier = emf_mod_mild_summer }
						NOT = { has_province_modifier = emf_mod_cloudy }
						NOT = { has_province_modifier = emf_mod_bright }
						# Autumn
						NOT = { has_province_modifier = emf_mod_warm_autumn }
						NOT = { has_province_modifier = emf_mod_early_winter }
					}
					# Most provinces get Blizzards
					if = {
						limit = {
							NOT = { terrain = jungle }
							NOT = { terrain = desert }
						}
						add_province_modifier = {
							name = emf_mod_blizzards
							duration = 80
						}
					}
					# Jungle get Storms
					if = {
						limit = { terrain = jungle }
						add_province_modifier = {
							name = emf_mod_storms
							duration = 80
						}
					}
					# Desert gets Desert Storms
					if = {
						limit = { terrain = desert }
						add_province_modifier = {
							name = emf_mod_desert_storms
							duration = 80
						}
					}
				}
			}
		}
	}
	option = { # Mild Winter (warm)
		trigger = {
			OR = {
				month = 11 # At least December
				AND = {
					month = 0
					NOT = { month = 2 } # Before March
				}
			}
		}
		name = OK
		ai_chance = {
			factor = 1
		}
		
		random_demesne_title = {
			limit = {
				tier = COUNT
				location = { has_province_flag = emf_seasonal_event }
			}
			location = {
				clr_province_flag = emf_seasonal_event
				# All provinces get Mild Winter
				add_province_modifier = {
					name = emf_mod_mild_winter
					duration = 80
				}
				any_neighbor_province = {
					limit = {
						# General
						NOT = { has_province_modifier = emf_mod_heavy_rain_good }
						NOT = { has_province_modifier = emf_mod_heavy_rain_bad }
						NOT = { has_province_modifier = emf_mod_storms }
						NOT = { has_province_modifier = emf_mod_drought }
						# Special
						NOT = { has_province_modifier = emf_mod_river_flooding }
						NOT = { has_province_modifier = emf_mod_coastal_flooding }
						NOT = { has_province_modifier = emf_mod_sandstorms }
						NOT = { has_province_modifier = emf_mod_desert_rain }
						NOT = { has_province_modifier = emf_mod_desert_storms }
						# Winter
						NOT = { has_province_modifier = emf_mod_heavy_snow }
						NOT = { has_province_modifier = emf_mod_blizzards }
						NOT = { has_province_modifier = emf_mod_mild_winter }
						NOT = { has_province_modifier = emf_mod_harsh_winter }
						# Spring
						NOT = { has_province_modifier = emf_mod_pleasant_spring }
						NOT = { has_province_modifier = emf_mod_long_winter }
						# Summer
						NOT = { has_province_modifier = emf_mod_heat_wave }
						NOT = { has_province_modifier = emf_mod_mild_summer }
						NOT = { has_province_modifier = emf_mod_cloudy }
						NOT = { has_province_modifier = emf_mod_bright }
						# Autumn
						NOT = { has_province_modifier = emf_mod_warm_autumn }
						NOT = { has_province_modifier = emf_mod_early_winter }
					}
					# All provinces get Mild Winter
					add_province_modifier = {
						name = emf_mod_mild_winter
						duration = 80
					}
				}
			}
		}
	}
	option = { # Harsh Winter (cold)
		trigger = {
			OR = {
				month = 11 # At least December
				AND = {
					month = 0
					NOT = { month = 2 } # Before March
				}
			}
		}
		name = OK
		ai_chance = {
			factor = 1
		}
		
		random_demesne_title = {
			limit = {
				tier = COUNT
				location = { has_province_flag = emf_seasonal_event }
			}
			location = {
				clr_province_flag = emf_seasonal_event
				# All provinces get Harsh Winter
				add_province_modifier = {
					name = emf_mod_harsh_winter
					duration = 80
				}
				any_neighbor_province = {
					limit = {
						# General
						NOT = { has_province_modifier = emf_mod_heavy_rain_good }
						NOT = { has_province_modifier = emf_mod_heavy_rain_bad }
						NOT = { has_province_modifier = emf_mod_storms }
						NOT = { has_province_modifier = emf_mod_drought }
						# Special
						NOT = { has_province_modifier = emf_mod_river_flooding }
						NOT = { has_province_modifier = emf_mod_coastal_flooding }
						NOT = { has_province_modifier = emf_mod_sandstorms }
						NOT = { has_province_modifier = emf_mod_desert_rain }
						NOT = { has_province_modifier = emf_mod_desert_storms }
						# Winter
						NOT = { has_province_modifier = emf_mod_heavy_snow }
						NOT = { has_province_modifier = emf_mod_blizzards }
						NOT = { has_province_modifier = emf_mod_mild_winter }
						NOT = { has_province_modifier = emf_mod_harsh_winter }
						# Spring
						NOT = { has_province_modifier = emf_mod_pleasant_spring }
						NOT = { has_province_modifier = emf_mod_long_winter }
						# Summer
						NOT = { has_province_modifier = emf_mod_heat_wave }
						NOT = { has_province_modifier = emf_mod_mild_summer }
						NOT = { has_province_modifier = emf_mod_cloudy }
						NOT = { has_province_modifier = emf_mod_bright }
						# Autumn
						NOT = { has_province_modifier = emf_mod_warm_autumn }
						NOT = { has_province_modifier = emf_mod_early_winter }
					}
					# All provinces get Harsh Winter
					add_province_modifier = {
						name = emf_mod_harsh_winter
						duration = 80
					}
				}
			}
		}
	}
	
	# Spring
	option = { # Pleasant Spring (warm)
		trigger = {
			month = 2 # At least March
			NOT = { month = 5 } # Before June
		}
		name = OK
		ai_chance = {
			factor = 1
		}
		
		random_demesne_title = {
			limit = {
				tier = COUNT
				location = { has_province_flag = emf_seasonal_event }
			}
			location = {
				clr_province_flag = emf_seasonal_event
				# All provinces get Pleasant Spring
				add_province_modifier = {
					name = emf_mod_pleasant_spring
					duration = 80
				}
				any_neighbor_province = {
					limit = {
						# General
						NOT = { has_province_modifier = emf_mod_heavy_rain_good }
						NOT = { has_province_modifier = emf_mod_heavy_rain_bad }
						NOT = { has_province_modifier = emf_mod_storms }
						NOT = { has_province_modifier = emf_mod_drought }
						# Special
						NOT = { has_province_modifier = emf_mod_river_flooding }
						NOT = { has_province_modifier = emf_mod_coastal_flooding }
						NOT = { has_province_modifier = emf_mod_sandstorms }
						NOT = { has_province_modifier = emf_mod_desert_rain }
						NOT = { has_province_modifier = emf_mod_desert_storms }
						# Winter
						NOT = { has_province_modifier = emf_mod_heavy_snow }
						NOT = { has_province_modifier = emf_mod_blizzards }
						NOT = { has_province_modifier = emf_mod_mild_winter }
						NOT = { has_province_modifier = emf_mod_harsh_winter }
						# Spring
						NOT = { has_province_modifier = emf_mod_pleasant_spring }
						NOT = { has_province_modifier = emf_mod_long_winter }
						# Summer
						NOT = { has_province_modifier = emf_mod_heat_wave }
						NOT = { has_province_modifier = emf_mod_mild_summer }
						NOT = { has_province_modifier = emf_mod_cloudy }
						NOT = { has_province_modifier = emf_mod_bright }
						# Autumn
						NOT = { has_province_modifier = emf_mod_warm_autumn }
						NOT = { has_province_modifier = emf_mod_early_winter }
					}
					# All provinces get Pleasant Spring
					add_province_modifier = {
						name = emf_mod_pleasant_spring
						duration = 80
					}
				}
			}
		}
	}
	option = { # Long Winter (cold)
		trigger = {
			month = 2 # At least March
			NOT = { month = 5 } # Before June
		}
		name = OK
		ai_chance = {
			factor = 1
		}
		
		random_demesne_title = {
			limit = {
				tier = COUNT
				location = { has_province_flag = emf_seasonal_event }
			}
			location = {
				clr_province_flag = emf_seasonal_event
				# All provinces get Long Winter
				add_province_modifier = {
					name = emf_mod_long_winter
					duration = 80
				}
				any_neighbor_province = {
					limit = {
						# General
						NOT = { has_province_modifier = emf_mod_heavy_rain_good }
						NOT = { has_province_modifier = emf_mod_heavy_rain_bad }
						NOT = { has_province_modifier = emf_mod_storms }
						NOT = { has_province_modifier = emf_mod_drought }
						# Special
						NOT = { has_province_modifier = emf_mod_river_flooding }
						NOT = { has_province_modifier = emf_mod_coastal_flooding }
						NOT = { has_province_modifier = emf_mod_sandstorms }
						NOT = { has_province_modifier = emf_mod_desert_rain }
						NOT = { has_province_modifier = emf_mod_desert_storms }
						# Winter
						NOT = { has_province_modifier = emf_mod_heavy_snow }
						NOT = { has_province_modifier = emf_mod_blizzards }
						NOT = { has_province_modifier = emf_mod_mild_winter }
						NOT = { has_province_modifier = emf_mod_harsh_winter }
						# Spring
						NOT = { has_province_modifier = emf_mod_pleasant_spring }
						NOT = { has_province_modifier = emf_mod_long_winter }
						# Summer
						NOT = { has_province_modifier = emf_mod_heat_wave }
						NOT = { has_province_modifier = emf_mod_mild_summer }
						NOT = { has_province_modifier = emf_mod_cloudy }
						NOT = { has_province_modifier = emf_mod_bright }
						# Autumn
						NOT = { has_province_modifier = emf_mod_warm_autumn }
						NOT = { has_province_modifier = emf_mod_early_winter }
					}
					# All provinces get Long Winter
					add_province_modifier = {
						name = emf_mod_long_winter
						duration = 80
					}
				}
			}
		}
	}
	
	# Summer
	option = { # Heat Wave (warm)
		trigger = {
			month = 5 # At least June
			NOT = { month = 8 } # Before September
		}
		name = OK
		ai_chance = {
			factor = 1
		}
		
		random_demesne_title = {
			limit = {
				tier = COUNT
				location = { has_province_flag = emf_seasonal_event }
			}
			location = {
				clr_province_flag = emf_seasonal_event
				# All provinces get Heat Wave
				add_province_modifier = {
					name = emf_mod_heat_wave
					duration = 80
				}
				any_neighbor_province = {
					limit = {
						# General
						NOT = { has_province_modifier = emf_mod_heavy_rain_good }
						NOT = { has_province_modifier = emf_mod_heavy_rain_bad }
						NOT = { has_province_modifier = emf_mod_storms }
						NOT = { has_province_modifier = emf_mod_drought }
						# Special
						NOT = { has_province_modifier = emf_mod_river_flooding }
						NOT = { has_province_modifier = emf_mod_coastal_flooding }
						NOT = { has_province_modifier = emf_mod_sandstorms }
						NOT = { has_province_modifier = emf_mod_desert_rain }
						NOT = { has_province_modifier = emf_mod_desert_storms }
						# Winter
						NOT = { has_province_modifier = emf_mod_heavy_snow }
						NOT = { has_province_modifier = emf_mod_blizzards }
						NOT = { has_province_modifier = emf_mod_mild_winter }
						NOT = { has_province_modifier = emf_mod_harsh_winter }
						# Spring
						NOT = { has_province_modifier = emf_mod_pleasant_spring }
						NOT = { has_province_modifier = emf_mod_long_winter }
						# Summer
						NOT = { has_province_modifier = emf_mod_heat_wave }
						NOT = { has_province_modifier = emf_mod_mild_summer }
						NOT = { has_province_modifier = emf_mod_cloudy }
						NOT = { has_province_modifier = emf_mod_bright }
						# Autumn
						NOT = { has_province_modifier = emf_mod_warm_autumn }
						NOT = { has_province_modifier = emf_mod_early_winter }
					}
					# All provinces get Heat Wave
					add_province_modifier = {
						name = emf_mod_heat_wave
						duration = 80
					}
				}
			}
		}
	}
	option = { # Mild Summer (cold)
		trigger = {
			month = 5 # At least June
			NOT = { month = 8 } # Before September
		}
		name = OK
		ai_chance = {
			factor = 1
		}
		
		random_demesne_title = {
			limit = {
				tier = COUNT
				location = { has_province_flag = emf_seasonal_event }
			}
			location = {
				clr_province_flag = emf_seasonal_event
				# All provinces get Mild Summer
				add_province_modifier = {
					name = emf_mod_mild_summer
					duration = 80
				}
				any_neighbor_province = {
					limit = {
						# General
						NOT = { has_province_modifier = emf_mod_heavy_rain_good }
						NOT = { has_province_modifier = emf_mod_heavy_rain_bad }
						NOT = { has_province_modifier = emf_mod_storms }
						NOT = { has_province_modifier = emf_mod_drought }
						# Special
						NOT = { has_province_modifier = emf_mod_river_flooding }
						NOT = { has_province_modifier = emf_mod_coastal_flooding }
						NOT = { has_province_modifier = emf_mod_sandstorms }
						NOT = { has_province_modifier = emf_mod_desert_rain }
						NOT = { has_province_modifier = emf_mod_desert_storms }
						# Winter
						NOT = { has_province_modifier = emf_mod_heavy_snow }
						NOT = { has_province_modifier = emf_mod_blizzards }
						NOT = { has_province_modifier = emf_mod_mild_winter }
						NOT = { has_province_modifier = emf_mod_harsh_winter }
						# Spring
						NOT = { has_province_modifier = emf_mod_pleasant_spring }
						NOT = { has_province_modifier = emf_mod_long_winter }
						# Summer
						NOT = { has_province_modifier = emf_mod_heat_wave }
						NOT = { has_province_modifier = emf_mod_mild_summer }
						NOT = { has_province_modifier = emf_mod_cloudy }
						NOT = { has_province_modifier = emf_mod_bright }
						# Autumn
						NOT = { has_province_modifier = emf_mod_warm_autumn }
						NOT = { has_province_modifier = emf_mod_early_winter }
					}
					# All provinces get Mild Summer
					add_province_modifier = {
						name = emf_mod_mild_summer
						duration = 80
					}
				}
			}
		}
	}
	option = { # Cloudy
		trigger = {
			month = 5 # At least June
			NOT = { month = 8 } # Before September
		}
		name = OK
		ai_chance = {
			factor = 1
		}
		
		random_demesne_title = {
			limit = {
				tier = COUNT
				location = { has_province_flag = emf_seasonal_event }
			}
			location = {
				clr_province_flag = emf_seasonal_event
				# All provinces get Cloudy
				add_province_modifier = {
					name = emf_mod_cloudy
					duration = 80
				}
				any_neighbor_province = {
					limit = {
						# General
						NOT = { has_province_modifier = emf_mod_heavy_rain_good }
						NOT = { has_province_modifier = emf_mod_heavy_rain_bad }
						NOT = { has_province_modifier = emf_mod_storms }
						NOT = { has_province_modifier = emf_mod_drought }
						# Special
						NOT = { has_province_modifier = emf_mod_river_flooding }
						NOT = { has_province_modifier = emf_mod_coastal_flooding }
						NOT = { has_province_modifier = emf_mod_sandstorms }
						NOT = { has_province_modifier = emf_mod_desert_rain }
						NOT = { has_province_modifier = emf_mod_desert_storms }
						# Winter
						NOT = { has_province_modifier = emf_mod_heavy_snow }
						NOT = { has_province_modifier = emf_mod_blizzards }
						NOT = { has_province_modifier = emf_mod_mild_winter }
						NOT = { has_province_modifier = emf_mod_harsh_winter }
						# Spring
						NOT = { has_province_modifier = emf_mod_pleasant_spring }
						NOT = { has_province_modifier = emf_mod_long_winter }
						# Summer
						NOT = { has_province_modifier = emf_mod_heat_wave }
						NOT = { has_province_modifier = emf_mod_mild_summer }
						NOT = { has_province_modifier = emf_mod_cloudy }
						NOT = { has_province_modifier = emf_mod_bright }
						# Autumn
						NOT = { has_province_modifier = emf_mod_warm_autumn }
						NOT = { has_province_modifier = emf_mod_early_winter }
					}
					# All provinces get Cloudy
					add_province_modifier = {
						name = emf_mod_cloudy
						duration = 80
					}
				}
			}
		}
	}
	option = { # Bright
		trigger = {
			month = 5 # At least June
			NOT = { month = 8 } # Before September
		}
		name = OK
		ai_chance = {
			factor = 1
		}
		
		random_demesne_title = {
			limit = {
				tier = COUNT
				location = { has_province_flag = emf_seasonal_event }
			}
			location = {
				clr_province_flag = emf_seasonal_event
				# All provinces get Bright
				add_province_modifier = {
					name = emf_mod_bright
					duration = 80
				}
				any_neighbor_province = {
					limit = {
						# General
						NOT = { has_province_modifier = emf_mod_heavy_rain_good }
						NOT = { has_province_modifier = emf_mod_heavy_rain_bad }
						NOT = { has_province_modifier = emf_mod_storms }
						NOT = { has_province_modifier = emf_mod_drought }
						# Special
						NOT = { has_province_modifier = emf_mod_river_flooding }
						NOT = { has_province_modifier = emf_mod_coastal_flooding }
						NOT = { has_province_modifier = emf_mod_sandstorms }
						NOT = { has_province_modifier = emf_mod_desert_rain }
						NOT = { has_province_modifier = emf_mod_desert_storms }
						# Winter
						NOT = { has_province_modifier = emf_mod_heavy_snow }
						NOT = { has_province_modifier = emf_mod_blizzards }
						NOT = { has_province_modifier = emf_mod_mild_winter }
						NOT = { has_province_modifier = emf_mod_harsh_winter }
						# Spring
						NOT = { has_province_modifier = emf_mod_pleasant_spring }
						NOT = { has_province_modifier = emf_mod_long_winter }
						# Summer
						NOT = { has_province_modifier = emf_mod_heat_wave }
						NOT = { has_province_modifier = emf_mod_mild_summer }
						NOT = { has_province_modifier = emf_mod_cloudy }
						NOT = { has_province_modifier = emf_mod_bright }
						# Autumn
						NOT = { has_province_modifier = emf_mod_warm_autumn }
						NOT = { has_province_modifier = emf_mod_early_winter }
					}
					# All provinces get Bright
					add_province_modifier = {
						name = emf_mod_bright
						duration = 80
					}
				}
			}
		}
	}
	
	# Autumn
	option = { # Warm Autumn (warm)
		trigger = {
			month = 8 # At least September
			NOT = { month = 11 } # Before December
		}
		name = OK
		ai_chance = {
			factor = 1
		}
		
		random_demesne_title = {
			limit = {
				tier = COUNT
				location = { has_province_flag = emf_seasonal_event }
			}
			location = {
				clr_province_flag = emf_seasonal_event
				# All provinces get Warm Autumn
				add_province_modifier = {
					name = emf_mod_warm_autumn
					duration = 80
				}
				any_neighbor_province = {
					limit = {
						# General
						NOT = { has_province_modifier = emf_mod_heavy_rain_good }
						NOT = { has_province_modifier = emf_mod_heavy_rain_bad }
						NOT = { has_province_modifier = emf_mod_storms }
						NOT = { has_province_modifier = emf_mod_drought }
						# Special
						NOT = { has_province_modifier = emf_mod_river_flooding }
						NOT = { has_province_modifier = emf_mod_coastal_flooding }
						NOT = { has_province_modifier = emf_mod_sandstorms }
						NOT = { has_province_modifier = emf_mod_desert_rain }
						NOT = { has_province_modifier = emf_mod_desert_storms }
						# Winter
						NOT = { has_province_modifier = emf_mod_heavy_snow }
						NOT = { has_province_modifier = emf_mod_blizzards }
						NOT = { has_province_modifier = emf_mod_mild_winter }
						NOT = { has_province_modifier = emf_mod_harsh_winter }
						# Spring
						NOT = { has_province_modifier = emf_mod_pleasant_spring }
						NOT = { has_province_modifier = emf_mod_long_winter }
						# Summer
						NOT = { has_province_modifier = emf_mod_heat_wave }
						NOT = { has_province_modifier = emf_mod_mild_summer }
						NOT = { has_province_modifier = emf_mod_cloudy }
						NOT = { has_province_modifier = emf_mod_bright }
						# Autumn
						NOT = { has_province_modifier = emf_mod_warm_autumn }
						NOT = { has_province_modifier = emf_mod_early_winter }
					}
					# All provinces get Warm Autumn
					add_province_modifier = {
						name = emf_mod_warm_autumn
						duration = 80
					}
				}
			}
		}
	}
	option = { # Early Winter (cold)
		trigger = {
			month = 8 # At least September
			NOT = { month = 11 } # Before December
		}
		name = OK
		ai_chance = {
			factor = 1
		}
		
		random_demesne_title = {
			limit = {
				tier = COUNT
				location = { has_province_flag = emf_seasonal_event }
			}
			location = {
				clr_province_flag = emf_seasonal_event
				# All provinces get Early Winter
				add_province_modifier = {
					name = emf_mod_early_winter
					duration = 80
				}
				any_neighbor_province = {
					limit = {
						# General
						NOT = { has_province_modifier = emf_mod_heavy_rain_good }
						NOT = { has_province_modifier = emf_mod_heavy_rain_bad }
						NOT = { has_province_modifier = emf_mod_storms }
						NOT = { has_province_modifier = emf_mod_drought }
						# Special
						NOT = { has_province_modifier = emf_mod_river_flooding }
						NOT = { has_province_modifier = emf_mod_coastal_flooding }
						NOT = { has_province_modifier = emf_mod_sandstorms }
						NOT = { has_province_modifier = emf_mod_desert_rain }
						NOT = { has_province_modifier = emf_mod_desert_storms }
						# Winter
						NOT = { has_province_modifier = emf_mod_heavy_snow }
						NOT = { has_province_modifier = emf_mod_blizzards }
						NOT = { has_province_modifier = emf_mod_mild_winter }
						NOT = { has_province_modifier = emf_mod_harsh_winter }
						# Spring
						NOT = { has_province_modifier = emf_mod_pleasant_spring }
						NOT = { has_province_modifier = emf_mod_long_winter }
						# Summer
						NOT = { has_province_modifier = emf_mod_heat_wave }
						NOT = { has_province_modifier = emf_mod_mild_summer }
						NOT = { has_province_modifier = emf_mod_cloudy }
						NOT = { has_province_modifier = emf_mod_bright }
						# Autumn
						NOT = { has_province_modifier = emf_mod_warm_autumn }
						NOT = { has_province_modifier = emf_mod_early_winter }
					}
					# All provinces get Early Winter
					add_province_modifier = {
						name = emf_mod_early_winter
						duration = 80
					}
				}
			}
		}
	}
}

# Hand out other seasonal events
# This is where wolves and rats and stuff go
# None of these events spread
character_event = {
	id = emf_regional.4
	hide_window = yes
	is_triggered_only = yes
	
	# Shared
	option = { # Rats
		name = OK
		ai_chance = {
			factor = 1
		}
#		random_demesne_title = {
#			limit = {
#				tier = COUNT
#				location = { has_province_flag = emf_seasonal_event }
#			}
#			location = {
#				clr_province_flag = emf_seasonal_event
#				# Rats in the food supply
#				add_province_modifier = {
#					name = emf_mod_rats
#					duration = 80
#				}
#			}
#		}
	}
	option = { # Wolves
		name = OK
		ai_chance = {
			factor = 1
		}
#		random_demesne_title = {
#			limit = {
#				tier = COUNT
#				location = { has_province_flag = emf_seasonal_event }
#			}
#			location = {
#				clr_province_flag = emf_seasonal_event
#				# Rats in the food supply
#				add_province_modifier = {
#					name = emf_mod_wolves
#					duration = 80
#				}
#			}
#		}
	}
	# Locusts or other insect plagues?
	# Landslides?
	# Avalanches?
	# Minor Earthquakes?
	# Other?
}
