# -*- ck2.events -*-

###########################################
#                                         #
# M&M Secret religious cults              #
#                                         #
# ID MNM.3000-MNM.3999		              #
#                                         #
###########################################

#IDs:
#3100-3199 David
#3200-3399 Milla
#3400-3599 Mathilda
#3600-3799 Drikus
#3800-3948 Joel
#3949-3997 Jakob

#Useful triggers
#is_secret_religious_society_member_trigger
#is_christian_secret_religious_society_member_trigger
#is_muslim_secret_religious_society_member_trigger
#is_indian_secret_religious_society_member_trigger
#is_openly_of_prevs_secret_religion_trigger
#has_sympathy_for_true_religion_of_prev_trigger
#true_religion_X_trigger
#true_religion_group_X_trigger
#is_in_prevs_interesting_society_trigger
#shares_prevs_secret_religion_trigger

#Useful effects 
#add_trait_for_prevs_secret_religion_society_effect 
#add_prevs_secret_religion_trait_effect 
#add_sympathy_for_prevs_true_religion_effect


namespace = MNM


#JOINING

#Sat in house of worship, approached by someone sat next to me
character_event = {
    id = MNM.3420
    desc = EVTDESC_MNM_3420
    picture = GFX_evt_bishop
    border = GFX_event_normal_frame_religion

    is_triggered_only = yes 

    hide_from = yes
    
    immediate = {
    	#The inductor
    	if = {
    		limit = { NOT = { event_target:secret_religion_recruiter = { always = yes } } }
    		random_society_member = { #backup
    			limit = { 
    				is_in_prevs_interesting_society_trigger = yes 
    				ai = yes
    			}
    			save_event_target_as = secret_religion_recruiter 
    		}
    		random_society_member = { #diplo range
    			limit = { 
    				is_in_prevs_interesting_society_trigger = yes 
    				is_within_diplo_range = ROOT
    				ai = yes
    			}
    			save_event_target_as = secret_religion_recruiter 
    		}
    		random_society_member = { #same realm
    			limit = { 
    				is_in_prevs_interesting_society_trigger = yes 
    				same_realm = ROOT
    				ai = yes
    			}
    			save_event_target_as = secret_religion_recruiter 
    		}
            liege = { #a courtier of my liege's
                any_courtier = {
                    limit = { 
                        is_in_prevs_interesting_society_trigger = yes 
                        ai = yes
                    }
                    save_event_target_as = secret_religion_recruiter 
                }
            }
    		any_courtier = { #a courtier
    			limit = { 
    				is_in_prevs_interesting_society_trigger = yes 
    				ai = yes
    			}
    			save_event_target_as = secret_religion_recruiter 
    		}
    	}
    	save_event_target_as = secret_religion_recruitee
    	#For loc 
    	random_realm_character = {
    		limit = { is_female = no }
    		save_event_target_as = spiritual_gender
    	}
    	random_courtier_or_vassal = {
    		limit = { is_priest = yes }
    		save_event_target_as = spiritual_gender
    	}
    }

    #Follow them
    option = { 
        name = EVTOPTA_MNM_3420
        custom_tooltip = { text = EVTOPTA_MNM_3420_TT }

        hidden_effect = { event_target:secret_religion_recruiter = { character_event = { id = MNM.3425 days = 3 } } }

        ai_chance = {
        	factor = 100
        	modifier = {
        		factor = 10
        		trait = brave 
        	}
        	modifier = {
        		factor = 5
        		trait = just 
        	}
        	modifier = {
        		factor = 5
        		trait = trusting 
        	}
        }
    }

    #Remain seated
    option = {
        name = EVTOPTB_MNM_3420
        custom_tooltip = { text = EVTOPTB_MNM_3420_TT }

        hidden_effect = { event_target:secret_religion_recruiter = { character_event = { id = MNM.3423 days = 1 } } } #notification of failure
        #set_interested_society = none

        ai_chance = {
        	factor = 10
        	modifier = {
        		trait = craven
        		factor = 15
        	}
        	modifier = {
        		trait = paranoid
        		factor = 5
        	}
        	modifier = {
        		trait = arbitrary
        		factor = 5
        	}
        	modifier = {
        		trait = content
        		factor = 5
        	}		
        }
    }
}

#Ping event
character_event = {
    id = MNM.3425
    hide_window = yes

    is_triggered_only = yes
    
    option = { 
        event_target:secret_religion_recruitee = { character_event = { id = MNM.3421 } }
    }
}

#Came with them, they offered me to join
character_event = {
    id = MNM.3421
    picture = GFX_evt_shady_meeting
    border = GFX_event_normal_frame_religion

    desc = {
    	trigger = { event_target:secret_religion_recruiter = { ROOT = { character_knows_prev_trigger = yes } } }
    	text = EVTDESC_MNM_3421_A
    }
     desc = {
    	trigger = { event_target:secret_religion_recruiter = { ROOT = { character_knows_prev_trigger = no } } }
    	text = EVTDESC_MNM_3421_B
    }

    is_triggered_only = yes

    immediate = {
    	event_target:secret_religion_recruiter = { save_event_target_as = secret_religion_recruiter }
    }

    #Yes
    option = { 
        name = EVTOPTA_MNM_3421
        custom_tooltip = { text = EVTOPTA_MNM_3421_TT }
        hidden_effect = { event_target:secret_religion_recruiter = { character_event = { id = MNM.3422 days = 1 } } }
        ai_chance = { 
            factor = 80 
            modifier = { is_in_society = yes factor = 0 } #Cannot join a new society when they're already in a society
        }
    }

    #No
    option = {
        name = EVTOPTB_MNM_3421
        custom_tooltip = { text = EVTOPTB_MNM_3421_TT }

        hidden_effect = { event_target:secret_religion_recruiter = { character_event = { id = MNM.3423 days = 1 } } } #notification of failure
        #set_interested_society = none

        ai_chance = { factor = 20 }
    }
}

#The interested party accepted
character_event = {
    id = MNM.3422
    desc = EVTDESC_MNM_3422
    picture = GFX_evt_shady_meeting
    border = GFX_event_normal_frame_religion

    is_triggered_only = yes
    
	immediate = {
		society = { save_event_target_as = recruiter_society }
	}
	
    option = { 
        name = EVTOPTA_MNM_3422
        
        tooltip = { event_target:secret_religion_recruitee = { join_society = event_target:recruiter_society } }

        hidden_effect = { event_target:secret_religion_recruitee = { character_event = { id = MNM.3424 days = 2 } } }
    }
}

#The interested party rejected
character_event = {
    id = MNM.3423
    desc = EVTDESC_MNM_3423
    picture = GFX_evt_uncomfortable
    border = GFX_event_normal_frame_religion

    is_triggered_only = yes
    
    option = { 
        name = EVTOPTA_MNM_3423
    }
}

#Confirmation for joiner on joining
character_event = {
    id = MNM.3424
    desc = EVTDESC_MNM_3424
    picture = GFX_evt_religious_exultation
    border = GFX_event_normal_frame_religion

    is_triggered_only = yes
    
    option = { 
        name = EVTOPTA_MNM_3424

        join_society = event_target:recruiter_society
    }
}

#MISSIONS

#Mission tombola
character_event = {
    id = MNM.3000
    hide_window = yes

    is_triggered_only = yes
    
    trigger = {
    	society_member_of = secret_religious_cult
		is_society_grandmaster = no
		has_any_quest = no
		NOT = { is_inaccessible_trigger = yes }
		NOT = { has_character_modifier = quest_cooldown_timer }
    }

    immediate = {
    	random_society_member = {
			limit = {
				is_society_grandmaster = yes
				same_society_as = ROOT
			}
			save_event_target_as = society_leader
		}

		random_list = {
			10 = { #Induct a ruler
				modifier = {
					factor = 0
					ai = yes
				}
				modifier = {
					factor = 0
					society_rank < 2
				}
				modifier = {
					factor = 0
					NOT = {
						top_liege = { 
							any_realm_lord = { 
								ok_sr_induction_mission_target_trigger = yes
							} 
						}
					}
				}
				event_target:society_leader	= { character_event = { id = MNM.3400 } }
			}
			10 = { #Make ruler sympathetic
				modifier = {
					factor = 0
					ai = yes
				}
				modifier = {
					factor = 0
					NOT = {
						top_liege = { 
							any_realm_lord = { 
								ok_sr_sympathy_mission_target_trigger = yes
							} 
						}
					}
				}
                trigger = {
                    society_rank > 1
                }
				event_target:society_leader	= { character_event = { id = MNM.3402 } }
			}
			10 = { # Prepare Grounds
				modifier = {
					factor = 0
					society_rank < 3
				}
				modifier = {
					factor = 0
					NOT = {
						any_demesne_province = {
                            emf_sr_has_not_religion_or_community_of_ROOT_sr = yes
                        }
					}
				}
				event_target:society_leader = { character_event = { id = MNM.3900 } }
			}
            10 = { #Blend In
                trigger  = {
					any_courtier = {
						religion = ROOT
						shares_prevs_secret_religion_trigger = no
						NOT = { same_society_as = ROOT }   
						is_adult = yes
					}
                }
				modifier = {
					factor = 1.5
					check_variable = { which = visibility_value value = 10 }
				}
				modifier = {
					factor = 2
					check_variable = { which = visibility_value value = 20 }
				}
                event_target:society_leader = { character_event = { id = MNM.3397 } }
            }
            10 = { #Conduct Secret Ceremony
                event_target:society_leader = { character_event = { id = MNM.3233 } }
            }
			120 = { # AI bypasses missions at times
				modifier = {
					factor = 0
					ai = no
				}
				random_list = {
					70 = {
						modifier = {
							factor = 0.9
							society_influence >= 30
						}
						modifier = {
							factor = 0.9
							society_influence >= 40
						}
						modifier = {
							factor = 0.8
							society_influence >= 50
						}
						modifier = {
							factor = 0.7
							society_influence >= 70
						}
						modifier = {
							factor = 0.6
							society_influence >= 80
						}
						modifier = {
							factor = 0.5
							society_influence >= 90
						}
						add_mission_succeed_influence_effect = yes
						if = { # AI Members of Secret Religious Cults level up more often
							limit = {
								society_rank < 3
								society_can_rank_up = yes
							}
							random_list = {
								50 = {}
								50 = {
									society_rank_up = 1
								}
							}
						}
					}
					30 = {
						add_mission_fail_influence_effect = yes
					}
				}
			}
		}
    }
}


#Mission ping to leader
character_event = {
    id = MNM.3397
    hide_window = yes

    is_triggered_only = yes

    immediate = { FROM = { society_quest_event = { id = MNM.3398 days = 7 random = 7 } } }
}


#QUEST: Blending In
society_quest_event = {
    id = MNM.3398
    border = GFX_event_letter_frame_religion

    desc = {
        trigger = { society_member_of = secret_religious_cult }
        text = EVTDESC_3398_BLEND_IN
    }

    is_triggered_only = yes

    option = {
        name = ACCEPT

        set_quest = quest_secret_religions_societies_blend_in
    }

    option = {
        name = DECLINE
        custom_tooltip = { text = decline_quest_tooltip }

        add_character_modifier = {
            name = quest_cooldown_timer
            hidden = yes
            days = 1000
        }

        ai_chance = { factor = 0 }
    }
}

#Blending In-mission start
character_event = {
    id = MNM.3399
    picture = GFX_evt_dark_prayer
    desc = EVTDESC_3399
    border = GFX_event_normal_frame_religion

    is_triggered_only = yes

    option = {
        name = {
            trigger = {
                society_member_of = secret_religious_cult
            }
            text = EVTOPTA_MNM_3399
        }

        hidden_effect = {
            set_variable = { which = blending_in_points value = 0 }
            set_character_flag = blending_in_timer
            character_event = { id = MNM.3200 days = 40 random = 30 } #Sends the tombola
        }
    }
}

# Mission: Blend in - outcome evaluator for blending in
character_event = {
    id = MNM.3200
    hide_window = yes

    is_triggered_only = yes

    trigger = { has_quest = quest_secret_religions_societies_blend_in }

    immediate = {
        if = {
            limit = { 
                has_character_modifier = attempting_to_blend_in
            }
            if = {
                limit = { 
                    NOR = {
                        check_variable = { which = blending_in_points value = 4 } 
                        NOT = { check_variable = { which = blending_in_points value = -2 } }
                    }
                }

                random_list = { # Next opportunity...
                    10 = { # Convince a particular character (that doesn't exactly love you)
                        modifier = {
                            factor = 0
                            NOT = {
                                any_courtier = {
                                    host = { character = ROOT }
                                    religion = ROOT
                                    is_adult = yes
                                    prisoner = no
                                    NOT = {
                                        same_society_as = ROOT
                                    }
                                    opinion = { who = ROOT value = -50 }
                                    NOT = { opinion = { who = ROOT value = 10 } }
                                }
                            }
                        }
                        modifier = {
                            factor = 0
                            has_character_flag = attempting_to_convince_stubborn_courtier
                        }
                        random_courtier = {
                            limit = {
                                host = { character = ROOT }
                                religion = ROOT
                                is_adult = yes
                                prisoner = no
                                NOT = {
                                    same_society_as = ROOT
                                }
                                opinion = { who = ROOT value = -50 }
                                NOT = { opinion = { who = ROOT value = 10 } }
                            }
                            save_event_target_as = stubborn_courtier
                        }
                        random_courtier = {
                            limit = {
                                host = { character = ROOT }
                                religion = ROOT
                                is_adult = yes
                                prisoner = no
                                NOT = {
                                    same_society_as = ROOT
                                }
                                opinion = { who = ROOT value = -50 }
                                NOT = { opinion = { who = ROOT value = 10 } }
                                has_pious_trait_trigger = yes
                            }
                            save_event_target_as = stubborn_courtier
                        }
                        set_character_flag = attempting_to_convince_stubborn_courtier
                        event_target:stubborn_courtier = { character_event = { id = MNM.3201 } }
                    }

                    10 = { # Convince a particular character (that does care about you)
                        modifier = {
                            factor = 0
                            NOT = {
                                any_courtier = {
                                    host = { character = ROOT }
                                    religion = ROOT
                                    is_adult = yes
                                    prisoner = no
                                    NOT = {
                                        same_society_as = ROOT
                                    }
                                    opinion = { who = ROOT value = 50 }
                                }
                            }
                        }
                        modifier = {
                            factor = 0
                            has_character_flag = attempting_to_convince_concerned_friend
                        }
                        random_courtier = {
                            limit = {
                                host = { character = ROOT }
                                religion = ROOT
                                is_adult = yes
                                prisoner = no
                                NOT = {
                                    same_society_as = ROOT
                                }
                                opinion = { who = ROOT value = 50 }
                            }
                            save_event_target_as = concerned_friend
                        }
                        random_courtier = {
                            limit = {
                                host = { character = ROOT }
                                religion = ROOT
                                is_adult = yes
                                prisoner = no
                                OR = {
                                    is_friend = ROOT
                                    is_lover = ROOT
                                }
                                NOT = { same_society_as = ROOT }
                                is_friend = ROOT
                                opinion = { who = ROOT value = 100 }
                            }
                            save_event_target_as = concerned_friend
                        }
                        set_character_flag = attempting_to_convince_concerned_friend
                        event_target:concerned_friend = { character_event = { id = MNM.3208 } }
                    }
                    30 = { # struggle with trait
                        modifier = { 
                            factor = 0 
                            AND = {
                                trait = paranoid
                                trait = gregarious
                                trait = deceitful
                            }
                        }
                        modifier = {
                            factor = 0
                            NOT = {
                                any_courtier = {
                                    religion = ROOT
                                    shares_prevs_secret_religion_trigger = no
                                    NOT = { same_society_as = ROOT }   
                                    is_adult = yes
                                    opinion = { who = ROOT value = 0 }
                                }
                            }
                        }
                        modifier = {
                            factor = 0
                            has_character_flag = blend_in_struggled_with_trait
                        }

                        random_courtier = {
                            limit = {
                                religion = ROOT
                                shares_prevs_secret_religion_trigger = no
                                NOT = { same_society_as = ROOT }
                                is_adult = yes
                                opinion = { who = ROOT value = 0 }
                            }
                            save_event_target_as = trusted_friend
                        }
                        random_courtier = {
                            limit = {
                                religion = ROOT
                                shares_prevs_secret_religion_trigger = no
                                NOT = { same_society_as = ROOT }
                                is_adult = yes
                                opinion = { who = ROOT value = 25 }
                            }
                            save_event_target_as = trusted_friend
                        }
                        random_courtier = {
                            limit = {
                                religion = ROOT
                                shares_prevs_secret_religion_trigger = no
                                NOT = { same_society_as = ROOT }
                                is_adult = yes
                                opinion = { who = ROOT value = 45 }
                            }
                            save_event_target_as = trusted_friend
                        }
                        random_courtier = {
                            limit = {
                                religion = ROOT
                                shares_prevs_secret_religion_trigger = no
                                NOT = { same_society_as = ROOT }
                                is_adult = yes
                                opinion = { who = ROOT value = 75 }
                            }
                            save_event_target_as = trusted_friend
                        }
                        random_spouse = {
                            limit = {
                                religion = ROOT
                                shares_prevs_secret_religion_trigger = no
                                NOT = { same_society_as = ROOT }
                                is_adult = yes
                                opinion = { who = ROOT value = 45 }
                            }
                            save_event_target_as = trusted_friend
                        }
                        random_lover = {
                            limit = {
                                religion = ROOT
                                shares_prevs_secret_religion_trigger = no
                                NOT = { same_society_as = ROOT }
                                opinion = { who = ROOT value = 20 }
                                is_adult = yes
                            }
                            save_event_target_as = trusted_friend
                        }
                        random_friend = {
                            limit = {
                                religion = ROOT
                                shares_prevs_secret_religion_trigger = no
                                NOT = { same_society_as = ROOT }
                                is_adult = yes
                            }
                            save_event_target_as = trusted_friend
                        }


                        set_character_flag = blend_in_struggled_with_trait
                        random_list = {
                            10 = {
                                modifier = { factor = 0 trait = paranoid }
                                set_character_flag = blend_in_trusting
                            }
                            10 = { 
                                modifier = { factor = 0 trait = gregarious }
                                set_character_flag = blend_in_shy
                            }
                            10 = { 
                                modifier = { factor = 0 trait = deceitful }
                                set_character_flag = blend_in_honest
                            }
                        }

                        character_event = { id = MNM.3220 } 
                    }
                    10 = { # Attend [Root.HouseOfWorship]
                        
                        modifier = {
                            factor = 0
                            has_character_flag = blend_in_attended_house_of_worship
                        }
                        set_character_flag = blend_in_attended_house_of_worship
                        character_event = { id = MNM.3225 }
                    }
                    5 = { #General progress
                        modifier = {
                            intrigue = 15
                            factor = 1.2
                        }
                        modifier = {
                            trait = deceitful
                            factor = 1.2
                        }
                        modifier = {
                            is_learned_trigger = yes
                            factor = 1.1
                        }
                        modifier = {
                            is_dumb_trigger = yes
                            factor = 0.1
                        }
                        modifier = {
                            is_smart_trigger = yes
                            factor = 1.2
                        }
                        set_character_flag = blend_in_general_progress
                        character_event = { id = MNM.3230 }
                    }

                    10 = { #If all missions have been done already....
                        modifier = {
                            factor = 0 #Don't reset if the following is true
                            OR = {
                                #Don't reset if one of these flags are missing
                                OR = {
                                    NOT = { has_character_flag = attempting_to_convince_stubborn_courtier }
                                    NOT = { has_character_flag = attempting_to_convince_concerned_friend }
                                    NOT = { has_character_flag = blend_in_attended_house_of_worship }
                                    NOT = { has_character_flag = blend_in_general_progress }
                                }
                                #We have the other flags, but need this special one and can get it
                                AND = {
                                    NOT = { has_character_flag = blend_in_struggled_with_trait }
                                    NAND = {
                                        trait = paranoid
                                        trait = gregarious
                                        trait = deceitful
                                    }
                                    any_courtier = {
                                        religion = ROOT
                                        shares_prevs_secret_religion_trigger = no
                                        NOT = { same_society_as = ROOT }   
                                        is_adult = yes
                                        opinion = { who = ROOT value = 0 }
                                    }
                                }

                                #We have the other flags, but need this special one and can get it
                                AND = {
                                    NOT = { has_character_flag = attempting_to_convince_stubborn_courtier } #other
                                    any_courtier = {
                                        host = { character = ROOT }
                                        religion = ROOT
                                        is_adult = yes
                                        prisoner = no
                                        NOT = {
                                            same_society_as = ROOT
                                        }
                                        opinion = { who = ROOT value = -50 }
                                        NOT = { opinion = { who = ROOT value = 10 } }
                                    }
                                }

                                #We have the other flags, but need this special one and can get it
                                AND = {
                                    NOT = { has_character_flag = attempting_to_convince_concerned_friend } #other
                                    NOT = {
                                        any_courtier = {
                                            host = { character = ROOT }
                                            religion = ROOT
                                            is_adult = yes
                                            prisoner = no
                                            NOT = {
                                                same_society_as = ROOT
                                            }
                                            opinion = { who = ROOT value = 50 }
                                        }
                                    }
                                }
                            }
                        }

                        clr_character_flag = attempting_to_convince_stubborn_courtier
                        clr_character_flag = attempting_to_convince_concerned_friend
                        clr_character_flag = blend_in_struggled_with_trait
                        clr_character_flag = blend_in_attended_house_of_worship
                        clr_character_flag = blend_in_general_progress
                    }
                }
                character_event = { id = MNM.3200 days = 40 random = 30 } #Sends the tombola again
            }
            if = {
                limit = { 
                    OR = {
                        check_variable = { which = blending_in_points value = 4 } 
                        NOT = { check_variable = { which = blending_in_points value = -2 } }
                    }
                } 

                random_society_member = {
                    limit = {
                        is_society_grandmaster = yes
                        same_society_as = ROOT
                    }
                    character_event = { id = MNM.3250 } #Mission success/fail
                }
            }
        }
    }
}

## Opportunity 01 - The Stubborn Courtier
character_event = { # PING for stubborn courtier
    id = MNM.3201
    hide_window = yes
    is_triggered_only = yes
    immediate = { FROM = { character_event = { id = MNM.3202 } } }
}

character_event = { # Your stubborn courtier confronts you about your faith
    id = MNM.3202
    desc = EVTDESC_MNM_3202
    picture = GFX_evt_shady_meeting
    border = GFX_event_normal_frame_diplomacy

    is_triggered_only = yes

    #Quote their Holy Book at them - smaller chance to succeed, bigger pay-off, small penalty
    option = {
        name = EVTOPTA_MNM_3202

        random_list = {
            50 = {
                modifier = {
                    factor = 1.5
                    is_smart_trigger = yes
                }
                modifier = {
                    factor = 1.5
                    event_target:stubborn_courtier = {
                        OR = {
                            trait = trusting
                            NOT = { trait = zealous }
                        }
                    }
                }
                modifier = {
                    factor = 1.1
                    learning = 15
                }
                modifier = {
                    factor = 1.1
                    learning = 15
                }
                custom_tooltip = { text = EVTOPTA_MNM_3202_TOOLTIP_SUCCESS }
                event_target:stubborn_courtier = { 
                    set_character_flag = quoted_scripture_correctly
                    hidden_tooltip = { character_event = { id = MNM.3203 days = 2 } }
                }
            }
            50 = {
                modifier = {
                    factor = 1.5
                    event_target:stubborn_courtier = { is_dumb_trigger = yes }
                }
                modifier = {
                    factor = 1.5
                    event_target:stubborn_courtier = { trait = cynical }
                }
                custom_tooltip = { text = EVTOPTA_MNM_3202_TOOLTIP_FAILURE }
                event_target:stubborn_courtier = { 
                    set_character_flag = quoted_scripture_poorly
                    hidden_tooltip = { character_event = { id = MNM.3203 days = 2 } }
                }
            }
        }
    }

    #Intimidate them - bigger chance to succeed, smaller pay-off, big penalty
    option = {
        name = EVTOPTB_MNM_3202

        random_list = {
            65 = {
                modifier = {
                    is_benevolent_trigger = yes
                    factor = 1.5
                }
                modifier = {
                    has_pleasant_personality_trigger = yes
                    factor = 1.5
                }
                custom_tooltip = { text = EVTOPTB_MNM_3202_TOOLTIP_SUCCESS }
                event_target:stubborn_courtier = { 
                    set_character_flag = successful_intimidation
                    hidden_tooltip = { character_event = { id = MNM.3203 days = 2 } }
                }
            }
            35 = {
                modifier = {
                    is_evil_trigger = yes
                    factor = 1.5
                }
                modifier = {
                    has_unpleasant_personality_trigger = yes
                    factor = 1.5
                }
                custom_tooltip = { text = EVTOPTB_MNM_3202_TOOLTIP_FAILURE }
                event_target:stubborn_courtier = { 
                    set_character_flag = failed_intimidation
                    hidden_tooltip = { character_event = { id = MNM.3203 days = 2 } }
                }
            }
        }
    }

    #Bribe
    option = {
        name = EVTOPTC_MNM_3202
        custom_tooltip = { text = EVTOPTC_MNM_3202_TOOLTIP }
        hidden_effect = { change_variable = { which = blending_in_points value = -1 } }

        wealth = -20

        random_list = {
            80 = { # They will not mention this again
                modifier = {
                    factor = 1.5
                    trait = greedy
                }
                reverse_opinion = {
                    who = event_target:stubborn_courtier
                    modifier = opinion_grateful
                    years = 5
                }
            }
            20 = { # They are insulted
                modifier = {
                    factor = 1.5
                    trait = honest
                }
                modifier = {
                    factor = 1.5
                    is_pious_trigger = yes
                }
                reverse_opinion = {
                    who = event_target:stubborn_courtier
                    modifier = insulted
                    years = 5
                }
            }
        }
    }
}

#Stubborn courtier ping event
character_event = {
    id = MNM.3203
    hide_window = yes
    is_triggered_only = yes
    immediate = { 
        trigger_switch = {
            on_trigger = has_character_flag 
            quoted_scripture_correctly   = { FROM = { long_character_event = { id = MNM.3204 } } clr_character_flag = quoted_scripture_correctly }
            quoted_scripture_poorly      = { FROM = { long_character_event = { id = MNM.3205 } } clr_character_flag = quoted_scripture_poorly }
            successful_intimidation      = { FROM = { long_character_event = { id = MNM.3206 } } clr_character_flag = successful_intimidation }
            failed_intimidation          = { FROM = { long_character_event = { id = MNM.3207 } } clr_character_flag = failed_intimidation }
        }
    }
}

# You quoted scripture correctly
long_character_event = {
    id = MNM.3204
    desc = EVTDESC_MNM_3204
    picture = "GFX_evt_secret_ceremony"
    border = GFX_event_long_frame_diplomacy

    is_triggered_only = yes

    option = {
        name = EVTOPTA_MNM_3204
        custom_tooltip = { text = EVTOPTA_MNM_3204_TOOLTIP_SUCCESS }
        hidden_effect = { change_variable = { which = blending_in_points value = 2 } }

        event_target:stubborn_courtier = {
            add_trait_silently_humble_effect = yes
            remove_trait_proud_effect = yes
        }
        
        reverse_opinion = {
            who = event_target:stubborn_courtier
            modifier = opinion_impressed
            years = 10
        }
    }
}

# You quoted scripture poorly
long_character_event = {
    id = MNM.3205
    desc = EVTDESC_MNM_3205
    picture = "GFX_evt_secret_ceremony"
    border = GFX_event_long_frame_diplomacy

    is_triggered_only = yes

    option = {
        name = EVTOPTA_MNM_3205
        custom_tooltip = { text = EVTOPTA_MNM_3205_TOOLTIP_FAILURE }
        hidden_effect = { change_variable = { which = blending_in_points value = -1 } }

        event_target:stubborn_courtier = {
            if = {
                limit = { NOT = { trait = zealous } }
                random = {
                    chance = 15
                    add_trait_zealous_effect = yes
                }
            }
        }
    }
}   

# Successful intimidation of stubborn courtier
long_character_event = {
    id = MNM.3206
    desc = EVTDESC_MNM_3206
    picture = "GFX_evt_secret_ceremony"
   border = GFX_event_long_frame_diplomacy

    is_triggered_only = yes

    option = {
        name = EVTOPTA_MNM_3206
        custom_tooltip = { text = EVTOPTC_MNM_3206_TOOLTIP_SUCCESS }
        hidden_effect = { change_variable = { which = blending_in_points value = 1 } }
    }
}

# Failed intimidation of stubborn courtier
long_character_event = {
    id = MNM.3207
    desc = EVTDESC_MNM_3207
    picture = GFX_evt_secret_ceremony
    border = GFX_event_long_frame_diplomacy

    is_triggered_only = yes

    option = {
        name = EVTOPTA_MNM_3207
        custom_tooltip = { text = EVTOPTC_MNM_3207_TOOLTIP_FAILURE }
        hidden_effect = { change_variable = { which = blending_in_points value = -2 } }

        add_character_modifier = {
            name = embarrassed_believer
            years = 3
        }
        reverse_opinion = {
            who = event_target:stubborn_courtier
            modifier = opinion_unimpressed
            years = 5
        }
    }
}

## Opportunity 02 - The Concerned Friend
character_event = { # PING for concerned friend
    id = MNM.3208
    hide_window = yes
    is_triggered_only = yes
    immediate = { FROM = { character_event = { id = MNM.3209 } } }
}

character_event = { # Your concerned friend needs reassurance of your devoutness
    id = MNM.3209
    desc = EVTDESC_MNM_3209
    picture = "GFX_evt_uncomfortable"
    border = GFX_event_normal_frame_diplomacy

    is_triggered_only = yes

    #Tell them of bad dreams - smaller chance to succeed, bigger pay-off, small penalty
    option = {
        name = EVTOPTA_MNM_3209

        random_list = {
            50 = {
                modifier = {
                    factor = 1.5
                    is_smart_trigger = yes
                }
                modifier = {
                    factor = 1.5
                    event_target:concerned_friend = {
                        OR = {
                            trait = trusting
                            NOT = { trait = zealous }
                        }
                    }
                }
                modifier = {
                    factor = 1.1
                    learning = 15
                }
                modifier = {
                    factor = 1.1
                    learning = 15
                }
                custom_tooltip = { text = EVTOPTA_MNM_3209_TOOLTIP_SUCCESS }
                event_target:concerned_friend = {
                    set_character_flag = quoted_scripture_correctly
                    hidden_tooltip = { character_event = { id = MNM.3210 days = 2 } }
                }
            }
            50 = {
                modifier = {
                    factor = 1.5
                    event_target:concerned_friend = { is_dumb_trigger = yes }
                }
                modifier = {
                    factor = 1.5
                    event_target:concerned_friend = { trait = cynical }
                }
                custom_tooltip = { text = EVTOPTA_MNM_3209_TOOLTIP_FAILURE }
                event_target:concerned_friend = { 
                    set_character_flag = quoted_scripture_poorly
                    hidden_tooltip = { character_event = { id = MNM.3210 days = 2 } }
                }
            }
        }
    }

    #Say all is well - bigger chance to succeed, smaller pay-off, big penalty
    option = {
        name = EVTOPTB_MNM_3209

        random_list = {
            65 = {
                modifier = {
                    is_benevolent_trigger = yes
                    factor = 1.5
                }
                modifier = {
                    has_pleasant_personality_trigger = yes
                    factor = 1.5
                }
                custom_tooltip = { text = EVTOPTB_MNM_3209_TOOLTIP_SUCCESS }
                event_target:concerned_friend = { 
                    set_character_flag = successful_intimidation
                    hidden_tooltip = { character_event = { id = MNM.3210 days = 2 } }
                }
            }
            35 = {
                modifier = {
                    is_evil_trigger = yes
                    factor = 1.5
                }
                modifier = {
                    has_unpleasant_personality_trigger = yes
                    factor = 1.5
                }
                custom_tooltip = { text = EVTOPTB_MNM_3209_TOOLTIP_FAILURE }
                event_target:concerned_friend = { 
                    set_character_flag = failed_intimidation
                    hidden_tooltip = { character_event = { id = MNM.3210 days = 2 } }
                }
            }
        }
    }

    #Distract them
    option = {
        name = EVTOPTC_MNM_3209
        custom_tooltip = { text = EVTOPTC_MNM_3209_TOOLTIP }
        hidden_effect = { change_variable = { which = blending_in_points value = -1 } }

        random_list = {
            50 = { # They are happily distracted
                modifier = {
                    factor = 1.5
                    event_target:concerned_friend = { trait = trusting }
                }
                modifier = {
                    factor = 1.5
                    event_target:concerned_friend = { trait = arbitrary }
                }
                reverse_opinion = {
                    who = event_target:concerned_friend
                    modifier = opinion_approves
                    years = 5
                }
            }
            50 = { # They are confused
                modifier = {
                    factor = 1.5
                    event_target:concerned_friend = { trait = cynical }
                }
                modifier = {
                    factor = 1.5
                    event_target:concerned_friend = { is_lover = ROOT }
                }
                modifier = {
                    factor = 1.5
                    event_target:concerned_friend = { is_friend = ROOT }
                }
                reverse_opinion = {
                    who = event_target:concerned_friend
                    modifier = opinion_confused
                    years = 5
                }
            }
        }
    }
}

#concerned friend ping event
character_event = {
    id = MNM.3210
    hide_window = yes
    is_triggered_only = yes
    immediate = { 
        trigger_switch = {
            on_trigger = has_character_flag 
            quoted_scripture_correctly   = { FROM = { character_event = { id = MNM.3211 } } clr_character_flag = quoted_scripture_correctly }
            quoted_scripture_poorly      = { FROM = { character_event = { id = MNM.3212 } } clr_character_flag = quoted_scripture_poorly }
            successful_intimidation      = { FROM = { character_event = { id = MNM.3213 } } clr_character_flag = successful_intimidation }
            failed_intimidation          = { FROM = { character_event = { id = MNM.3214 } } clr_character_flag = failed_intimidation }
        }
    }
}

# You convinced them you have bad dreams
character_event = {
    id = MNM.3211
    desc = EVTDESC_MNM_3211
    picture = "GFX_evt_dark_prayer"
    border = GFX_event_normal_frame_diplomacy

    is_triggered_only = yes

    option = {
        name = EVTOPTA_MNM_3211 #They are a good friend
        custom_tooltip = { text = EVTOPTA_MNM_3211_TOOLTIP_SUCCESS }
        hidden_effect = { change_variable = { which = blending_in_points value = 2 } }

        if = {
            limit = {
                event_target:concerned_friend = {
                    NOT = { is_friend = ROOT }
                }
            }
            add_friend = event_target:concerned_friend
        }
        reverse_opinion = {
            who = event_target:concerned_friend
            modifier = opinion_approves
            years = 5
        }
    }
}

# You spill your guts?
character_event = {
    id = MNM.3212
    desc = EVTDESC_MNM_3212
    picture = "GFX_evt_uncomfortable"
    border = GFX_event_normal_frame_diplomacy

    is_triggered_only = yes

    option = {
        name = EVTOPTA_MNM_3212
        custom_tooltip = { text = EVTOPTA_MNM_3212_TOOLTIP_FAILURE }
        hidden_effect = { change_variable = { which = blending_in_points value = -1 } }

        reverse_opinion = {
            who = event_target:concerned_friend
            modifier = opinion_worried
            years = 5
        }
    }
}   

# Successfully dismissed concerned friend
character_event = {
    id = MNM.3213
    desc = EVTDESC_MNM_3213
    picture = "GFX_evt_state_diplomacy"
    border = GFX_event_normal_frame_diplomacy

    is_triggered_only = yes

    option = {
        name = EVTOPTA_MNM_3213
        custom_tooltip = { text = EVTOPTA_MNM_3213_TOOLTIP_SUCCESS }
        hidden_effect = { change_variable = { which = blending_in_points value = 1 } }
    }
}

# Failed dismissing concerned friend
character_event = {
    id = MNM.3214
    desc = EVTDESC_MNM_3214
    picture = GFX_evt_uncomfortable
    border = GFX_event_normal_frame_diplomacy

    is_triggered_only = yes

    option = {
        name = EVTOPTA_MNM_3214
        custom_tooltip = { text = EVTOPTA_MNM_3214_TOOLTIP_FAILURE }
        hidden_effect = { change_variable = { which = blending_in_points value = -2 } }

        random = {
            chance = 20 
            add_trait_paranoid_effect = yes
        }

        reverse_opinion = {
            who = event_target:concerned_friend
            modifier = opinion_disappointed
            years = 5
        }
    }
}

## Opportunity 3
#Blend In: Dealing with trait
character_event = {
    id = MNM.3220
    picture = "GFX_evt_uncomfortable"
    border = GFX_event_normal_frame_religion

    hide_from = yes

    desc = {
        trigger = { has_character_flag = blend_in_trusting }
        text = EVTDESC_3220_TRUSTING
    }
    desc = {
        trigger = { has_character_flag = blend_in_shy }
        text = EVTDESC_3220_SHY
    }
    desc = {
        trigger = { has_character_flag = blend_in_honest }
        text = EVTDESC_3220_HONEST
    }

    is_triggered_only = yes

    immediate = {

    }

    #Indulge (trusting or honest)
    option = {
        name = {
            trigger = { has_character_flag = blend_in_trusting }
            text = EVTOPTA_3220_TRUSTING
        }
        name = {
            trigger = { has_character_flag = blend_in_honest }
            text = EVTOPTA_3220_HONEST
        }

        random_list = {
            65 = { 
                custom_tooltip = { 
                    text = EVTOPTB_MNM_3209_TOOLTIP_SUCCESS
                    character_event = { id = MNM.3221 days = 3 }
                }
            }
            35 = {
                custom_tooltip = { 
                    text = EVTOPTA_MNM_3209_TOOLTIP_FAILURE
                    character_event = { id = MNM.3222 days = 3 }
                }
            }
        }
        #To show portrait in option
        if = { limit = { has_character_flag = blend_in_trusting }
            event_target:trusted_friend = { set_character_flag = tooltip_flag_1 }
        }
        if = { limit = { has_character_flag = blend_in_honest } 
            event_target:trusted_friend = { set_character_flag = tooltip_flag_1 }
        }
        trigger = {
            OR = {
                has_character_flag = blend_in_trusting
                has_character_flag = blend_in_honest
            }
        }
    }

    #Indulge (shy)
    option = {
        name = EVTOPTA_3220_SHY

        random_list = {
            65 = { 
                custom_tooltip = { 
                    text = EVTOPTB_MNM_3209_TOOLTIP_SUCCESS
                    character_event = { id = MNM.3221 days = 3 }
                }
            }
            35 = {
                custom_tooltip = { 
                    text = EVTOPTA_MNM_3209_TOOLTIP_FAILURE
                    character_event = { id = MNM.3222 days = 3 }
                }
            }
        }
        trigger = { has_character_flag = blend_in_shy }
    }


    #Fight it (trusting or honest)
    option = {
        name = {
            trigger = { has_character_flag = blend_in_trusting }
            text = EVTOPTB_3220_TRUSTING
        }
        name = {
            trigger = { has_character_flag = blend_in_honest }
            text = EVTOPTB_3220_HONEST
        }

        random_list = {
            40 = { 
                custom_tooltip = { 
                    text = EVTOPTA_MNM_3209_TOOLTIP_SUCCESS
                    character_event = { id = MNM.3223 days = 14 }
                }
            }
            60 = {
                custom_tooltip = { 
                    text = EVTOPTB_MNM_3209_TOOLTIP_FAILURE
                    character_event = { id = MNM.3224 days = 14 }
                }
            }
        }
        #To show portrait in option
        if = { limit = { has_character_flag = blend_in_trusting }
            event_target:trusted_friend = { set_character_flag = tooltip_flag_1 }
        }
        if = { limit = { has_character_flag = blend_in_honest }
            event_target:trusted_friend = { set_character_flag = tooltip_flag_1 }
        }

        trigger = {
            OR = {
                has_character_flag = blend_in_trusting
                has_character_flag = blend_in_honest
            }
        }
    }
    
    #Fight it (shy)
    option = {
        name = EVTOPTB_3220_SHY

        random_list = {
            40 = { 
                custom_tooltip = { 
                    text = EVTOPTA_MNM_3209_TOOLTIP_SUCCESS
                    character_event = { id = MNM.3223 days = 14 }
                }
            }
            60 = {
                custom_tooltip = { 
                    text = EVTOPTB_MNM_3209_TOOLTIP_FAILURE
                    character_event = { id = MNM.3224 days = 14 }
                }
            }
        }

        trigger = {
            has_character_flag = blend_in_shy
        }
    }

    after = {
        if = { limit = { event_target:trusted_friend = { has_character_flag = tooltip_flag_1 } } 
            event_target:trusted_friend = { clr_character_flag = tooltip_flag_1 }
        }
    }
}

#Trait outcome - small success
character_event = {
    id = MNM.3221
    picture = "GFX_evt_state_diplomacy"
    border = GFX_event_normal_frame_religion

    desc = {
        trigger = { has_character_flag = blend_in_trusting }
        text = EVTDESC_3221_TRUSTING
    }
    desc = {
        trigger = { has_character_flag = blend_in_shy }
        text = EVTDESC_3221_SHY
    }
    desc = {
        trigger = { has_character_flag = blend_in_honest }
        text = EVTDESC_3221_HONEST
    }

    is_triggered_only = yes
    hide_from = yes

    option = {
        name = {
            trigger = { has_character_flag = blend_in_trusting }
            text = EVTOPTA_3221_TRUSTING
        }
        name = {
            trigger = { has_character_flag = blend_in_shy }
            text = EVTOPTA_3221_SHY
        }
        name = {
            trigger = { has_character_flag = blend_in_honest }
            text = EVTOPTA_3221_HONEST
        }

        custom_tooltip = { 
            text = EVTOPTA_3221_TOOLTIP 
        }

        hidden_effect = { change_variable = { which = blending_in_points value = 1 } }

        hidden_effect = {
            clr_character_flag = blend_in_trusting
            clr_character_flag = blend_in_shy
            clr_character_flag = blend_in_honest
        }
    }
}

# Trait outcome - small failure
character_event = {
    id = MNM.3222
    picture = "GFX_evt_secret_ceremony"
    border = GFX_event_normal_frame_religion

    desc = {
        trigger = { has_character_flag = blend_in_trusting }
        text = EVTDESC_3222_TRUSTING
    }
    desc = {
        trigger = { has_character_flag = blend_in_shy }
        text = EVTDESC_3222_SHY
    }
    desc = {
        trigger = { has_character_flag = blend_in_honest }
        text = EVTDESC_3222_HONEST
    }

    is_triggered_only = yes
    hide_from = yes

    immediate = {

    }

    option = {
        name = {
            trigger = { has_character_flag = blend_in_trusting }
            text = EVTOPTA_3222_TRUSTING
        }
        name = {
            trigger = { has_character_flag = blend_in_shy }
            text = EVTOPTA_3222_SHY
        }
        name = {
            trigger = { has_character_flag = blend_in_honest }
            text = EVTOPTA_3222_HONEST
        }

        custom_tooltip = { 
            text = EVTOPTA_3222_TOOLTIP 
        }

        hidden_effect = { change_variable = { which = blending_in_points value = -1 } }

        hidden_effect = {
            clr_character_flag = blend_in_trusting
            clr_character_flag = blend_in_shy
            clr_character_flag = blend_in_honest
        }
    }
}

# Trait outcome big success
character_event = {
    id = MNM.3223
    picture = "GFX_evt_state_diplomacy"
    border = GFX_event_normal_frame_religion

    desc = {
        trigger = { has_character_flag = blend_in_trusting }
        text = EVTDESC_3223_TRUSTING
    }
    desc = {
        trigger = { has_character_flag = blend_in_shy }
        text = EVTDESC_3223_SHY
    }
    desc = {
        trigger = { has_character_flag = blend_in_honest }
        text = EVTDESC_3223_HONEST
    }

    is_triggered_only = yes
    #hide_from = yes

    option = {
        name = {
            trigger = { has_character_flag = blend_in_trusting }
            text = EVTOPTA_3223_TRUSTING
        }
        name = {
            trigger = { has_character_flag = blend_in_shy }
            text = EVTOPTA_3223_SHY
        }
        name = {
            trigger = { has_character_flag = blend_in_honest }
            text = EVTOPTA_3223_HONEST
        }

        custom_tooltip = { 
            text = EVTOPTA_3223_TOOLTIP 
        }

        hidden_effect = { change_variable = { which = blending_in_points value = 2 } }
        
        if = {
            limit = { has_character_flag = blend_in_trusting }
            if = {
                limit = { trait = trusting }
                random = {
                    chance = 50
                    remove_trait_trusting_effect = yes
                }
            }
        }

        if = {
            limit = { has_character_flag = blend_in_shy }
            if = {
                limit = { NOT = { trait = shy } }
                random = {
                    chance = 50
                    add_trait_gregarious_effect = yes
                }
            }
            if = {
                limit = { trait = shy }
                random = {
                    chance = 50
                    remove_trait_shy_effect = yes
                }
            }
        }
        if = {
            limit = { has_character_flag = blend_in_honest }

            if = {
                limit = { NOT = { trait = honest } }
                random = {
                    chance = 50
                    add_trait_deceitful_effect = yes
                }
            }
            if = {
                limit = { trait = honest }
                random = {
                    chance = 50
                    remove_trait_honest_effect = yes
                }
            }
        }
        add_character_modifier = {
            name = great_believer
            years = 3
        }

        hidden_effect = {
            clr_character_flag = blend_in_trusting
            clr_character_flag = blend_in_shy
            clr_character_flag = blend_in_honest
        }
    }
}

# Trait outcome - big failure
character_event = {
    id = MNM.3224
    picture = "GFX_evt_secret_ceremony"
    border = GFX_event_normal_frame_religion

    desc = {
        trigger = { has_character_flag = blend_in_trusting }
        text = EVTDESC_3224_TRUSTING
        picture = GFX_evt_brothel
    }
    desc = {
        trigger = { has_character_flag = blend_in_shy }
        text = EVTDESC_3224_SHY
    }
    desc = {
        trigger = { has_character_flag = blend_in_honest }
        text = EVTDESC_3224_HONEST
    }

    is_triggered_only = yes
    #hide_from = yes

    option = {
        name = {
            trigger = { has_character_flag = blend_in_trusting }
            text = EVTOPTA_3224_TRUSTING
        }
        name = {
            trigger = { has_character_flag = blend_in_shy }
            text = EVTOPTA_3224_SHY
        }
        name = {
            trigger = { has_character_flag = blend_in_honest }
            text = EVTOPTA_3224_HONEST
        }

        custom_tooltip = { 
            text = EVTOPTA_3224_TOOLTIP
        }

        hidden_effect = { change_variable = { which = blending_in_points value = -5 } }
        
        if = {
            limit = { has_character_flag = blend_in_trusting }
            if = {
                limit = { NOT = { trait = trusting } }
                random = {
                    chance = 30
                    add_trait_trusting_effect = yes
                }
            }
        }

        if = {
            limit = { has_character_flag = blend_in_shy }
            if = {
                limit = { NOT = { trait = shy } }
                random = {
                    chance = 30
                    add_trait_shy_effect = yes
                }
            }
        }

        if = {
            limit = { has_character_flag = blend_in_honest }
            if = {
                limit = { NOT = { trait = honest } }
                random = {
                    chance = 30
                    add_trait_honest_effect = yes
                }
            }
        }

        add_character_modifier = {
            name = awkward_believer
            years = 3
        }

        hidden_effect = {
            clr_character_flag = blend_in_trusting
            clr_character_flag = blend_in_shy
            clr_character_flag = blend_in_honest
        }
    }
}

# Religion specific visiting of house of worship
character_event = {
    id = MNM.3225
    picture = "GFX_evt_secret_ceremony"
    border = GFX_event_normal_frame_religion
    is_triggered_only = yes

    hide_from = yes
    
    # EMF-SR NOTE: these desc triggers, while they do use some code-generated scripted triggers, may need manual adjustment
    # or changes to the code-generator (src/sr_codegen.py) in the future, because they're relatively arbitrary.
    
     desc = {
        trigger = {
            emf_sr_event_desc_christian_group_1 = yes
        }
        text = EVTDESC_MNM_3225_A
    }
    desc = {
        trigger = {
            emf_sr_event_desc_christian_group_2 = yes
        }
        text = EVTDESC_MNM_3225_A
    }
    desc = {
        trigger = { religion_group = jewish_group }
        text = EVTDESC_MNM_3225_A
    }
    desc = {
        trigger = {
            emf_sr_event_desc_muslim_group_1 = yes
        }
        text = EVTDESC_MNM_3225_D
    }
    desc = {
        trigger = { religion_group = zoroastrian_group }
        text = EVTDESC_MNM_3225_E
    }
    desc = {
        trigger = {
            emf_sr_event_desc_muslim_group_2 = yes
        }
        text = EVTDESC_MNM_3225_D
    }
    desc = {
        trigger = { religion = hindu }
        text = EVTDESC_MNM_3225_G
    }
    desc = {
        trigger = { religion = buddhist }
        text = EVTDESC_MNM_3225_H
    }
    desc = {
        trigger = { religion = jain }
        text = EVTDESC_MNM_3225_G
    }
    desc = {
        trigger = {
            OR = {
                religion = norse_pagan_reformed
                religion = norse_pagan
            }
        }
        text = EVTDESC_MNM_3225_J
    }
    desc = {
        trigger = {
            OR = {
                religion = baltic_pagan_reformed
                religion = baltic_pagan
            }
        }
        text = EVTDESC_MNM_3225_J
    }
    desc = {
        trigger = {
            OR = {
                religion = finnish_pagan_reformed
                religion = finnish_pagan
            }
        }
        text = EVTDESC_MNM_3225_J
    }
    desc = {
        trigger = {
            OR = {
                religion = slavic_pagan_reformed
                religion = slavic_pagan
            }
        }
        text = EVTDESC_MNM_3225_J
    }
    desc = {
        trigger = {
            OR = {
                religion = tengri_pagan_reformed
                religion = tengri_pagan
            }
        }
        text = EVTDESC_MNM_3225_N
    }
    desc = {
        trigger = {
            emf_sr_event_desc_african_pagan_group = yes
        }
        text = EVTDESC_MNM_3225_O
    }
    desc = {
        trigger = {
            OR = {
                religion = zun_pagan_reformed
                religion = zun_pagan
            }
        }
        text = EVTDESC_MNM_3225_P
    }
    desc = {
        trigger = {
            OR = {
                religion = hellenic_pagan
                religion = pagan
            }
        }
        text = EVTDESC_MNM_3225_P
    }

    hide_from = yes

    option = {      
        name = EVTOPTB_MNM_3225
        random_list = {
            50 = { #good outcome (big)
                modifier = {
                    factor = 0
                    trait = imbecile
                }
                modifier = {
                    factor = 1.1
                    diplomacy = 15
                }
                modifier = {
                    factor = 1.1
                    diplomacy = 16
                }
                modifier = {
                    factor = 1.1
                    diplomacy = 17
                }
                modifier = {
                    factor = 1.1
                    diplomacy = 18
                }
                modifier = {
                    factor = 1.1
                    diplomacy = 19
                }
                modifier = {
                    factor = 1.1
                    diplomacy = 20
                }
                modifier = {
                    factor = 1.1
                    diplomacy = 21
                }
                modifier = {
                    factor = 1.1
                    diplomacy = 22
                }
                modifier = {
                    factor = 1.1
                    trait = deceitful
                }
                modifier = {
                    factor = 1.1
                    trait = gregarious
                }
                modifier = {
                    factor = 1.1
                    trait = zealous
                }
                modifier = {
                    factor = 1.1
                    trait = cynical
                }
                custom_tooltip = {
                    text = EVTOPTA_MNM_3209_TOOLTIP_SUCCESS
                    long_character_event = { id = MNM.3228 } 
                }
            }
            50 = { #bad outcome (big)
                modifier = {
                    factor = 0
                    trait = genius
                }
                modifier = {
                    factor = 1.1
                    NOT = { diplomacy = 10 }
                }
                modifier = {
                    factor = 1.1
                    NOT = { diplomacy = 9 }
                }
                modifier = {
                    factor = 1.1
                    NOT = { diplomacy = 8 }
                }
                modifier = {
                    factor = 1.1
                    NOT = { diplomacy = 7 }
                }
                modifier = {
                    factor = 1.1
                    NOT = { diplomacy = 6 }
                }
                modifier = {
                    factor = 1.1
                    NOT = { diplomacy = 5 }
                }
                modifier = {
                    factor = 1.2
                    NOT = { diplomacy = 4 }
                }
                modifier = {
                    factor = 1.3
                    NOT = { diplomacy = 3 }
                }
                modifier = {
                    factor = 1.4
                    NOT = { diplomacy = 2 }
                }
                modifier = {
                    factor = 1.5
                    NOT = { diplomacy = 1 }
                }
                modifier = {
                    factor = 1.1
                    trait = shy
                }
                modifier = {
                    factor = 1.1
                    trait = content
                }
                custom_tooltip = {
                    text = EVTOPTB_MNM_3209_TOOLTIP_FAILURE
                    long_character_event = { id = MNM.3229 } 
                }
            }
        }
    }
    option = {      
        name = EVTOPTA_MNM_3225

        #add negative effect, trait or loss of something

        random_list = {
            70 = { #good outcome (small)
                modifier = {
                    factor = 0
                    trait = imbecile
                }
                modifier = {
                    factor = 1.1
                    diplomacy = 15
                }
                modifier = {
                    factor = 1.1
                    diplomacy = 16
                }
                modifier = {
                    factor = 1.1
                    diplomacy = 17
                }
                modifier = {
                    factor = 1.1
                    diplomacy = 18
                }
                modifier = {
                    factor = 1.1
                    diplomacy = 19
                }
                modifier = {
                    factor = 1.1
                    diplomacy = 20
                }
                modifier = {
                    factor = 1.1
                    diplomacy = 21
                }
                modifier = {
                    factor = 1.1
                    diplomacy = 22
                }
                modifier = {
                    factor = 1.1
                    trait = deceitful
                }
                modifier = {
                    factor = 1.1
                    trait = gregarious
                }
                modifier = {
                    factor = 1.1
                    trait = zealous
                }
                modifier = {
                    factor = 1.1
                    trait = cynical
                }
                custom_tooltip = {
                    text = EVTOPTB_MNM_3209_TOOLTIP_SUCCESS
                    long_character_event = { id = MNM.3226 }
                }
            }
            30 = { #bad outcome (small)
                modifier = {
                    factor = 0
                    trait = genius
                }
                modifier = {
                    factor = 1.1
                    NOT = { diplomacy = 10 }
                }
                modifier = {
                    factor = 1.1
                    NOT = { diplomacy = 9 }
                }
                modifier = {
                    factor = 1.1
                    NOT = { diplomacy = 8 }
                }
                modifier = {
                    factor = 1.1
                    NOT = { diplomacy = 7 }
                }
                modifier = {
                    factor = 1.1
                    NOT = { diplomacy = 6 }
                }
                modifier = {
                    factor = 1.1
                    NOT = { diplomacy = 5 }
                }
                modifier = {
                    factor = 1.2
                    NOT = { diplomacy = 4 }
                }
                modifier = {
                    factor = 1.3
                    NOT = { diplomacy = 3 }
                }
                modifier = {
                    factor = 1.4
                    NOT = { diplomacy = 2 }
                }
                modifier = {
                    factor = 1.5
                    NOT = { diplomacy = 1 }
                }
                modifier = {
                    factor = 1.1
                    trait = shy
                }
                modifier = {
                    factor = 1.1
                    trait = content
                }
                custom_tooltip = {
                    text = EVTOPTA_MNM_3209_TOOLTIP_FAILURE
                    long_character_event = { id = MNM.3227 } 
                }
            }
        }
    }
}

long_character_event = { #Outcome 1 (small gain)
    id = MNM.3226
    picture = "GFX_evt_secret_ceremony"
    border = GFX_event_long_frame_religion
    is_triggered_only = yes

    desc = {
        trigger = {
            emf_sr_event_desc_christian_group_1 = yes
        }
        text = EVTDESC_MNM_3226_A
    }
    desc = {
        trigger = {
            emf_sr_event_desc_christian_group_2 = yes
        }
        text = EVTDESC_MNM_3226_A
    }
    desc = {
        trigger = { religion_group = jewish_group }
        text = EVTDESC_MNM_3226_A
    }
    desc = {
        trigger = {
            emf_sr_event_desc_muslim_group_1 = yes
        }
        text = EVTDESC_MNM_3226_D
    }
    desc = {
        trigger = { religion_group = zoroastrian_group }
        text = EVTDESC_MNM_3226_E
    }
    desc = {
        trigger = {
            emf_sr_event_desc_muslim_group_2 = yes
        }
        text = EVTDESC_MNM_3226_F
    }
    desc = {
        trigger = { religion = hindu }
        text = EVTDESC_MNM_3226_G
    }
    desc = {
        trigger = { religion = buddhist }
        text = EVTDESC_MNM_3226_H
    }
    desc = {
        trigger = { religion = jain }
        text = EVTDESC_MNM_3226_G
    }
    desc = {
        trigger = {
            OR = {
                religion = norse_pagan_reformed
                religion = norse_pagan
            }
        }
        text = EVTDESC_MNM_3226_J
    }
    desc = {
        trigger = {
            OR = {
                religion = baltic_pagan_reformed
                religion = baltic_pagan
            }
        }
        text = EVTDESC_MNM_3226_G
    }
    desc = {
        trigger = {
            OR = {
                religion = finnish_pagan_reformed
                religion = finnish_pagan
            }
        }
        text = EVTDESC_MNM_3226_G
    }
    desc = {
        trigger = {
            OR = {
                religion = slavic_pagan_reformed
                religion = slavic_pagan
            }
        }
        text = EVTDESC_MNM_3226_G
    }
    desc = {
        trigger = {
            OR = {
                religion = tengri_pagan_reformed
                religion = tengri_pagan
            }
        }
        text = EVTDESC_MNM_3226_N
    }
    desc = {
        trigger = {
            emf_sr_event_desc_african_pagan_group = yes
        }
        text = EVTDESC_MNM_3226_O
    }
    desc = {
        trigger = {
            OR = {
                religion = zun_pagan_reformed
                religion = zun_pagan
            }
        }
        text = EVTDESC_MNM_3226_P
    }
    desc = {
        trigger = {
            OR = {
                religion = hellenic_pagan
                religion = pagan
            }
        }
        text = EVTDESC_MNM_3226_A
    }

    hide_from = yes

    option = {      
        name = EVTOPTA_MNM_3226
        custom_tooltip = { text = EVTOPTA_3221_TOOLTIP }
        hidden_effect = { change_variable = { which = blending_in_points value = 1 } }
    }
}

long_character_event = { #Outcome 2 (small loss)
    id = MNM.3227
    picture = "GFX_evt_uncomfortable"
    border = GFX_event_long_frame_religion
    is_triggered_only = yes

   desc = {
        trigger = {
            emf_sr_event_desc_christian_group_1 = yes
        }
        text = EVTDESC_MNM_3227_A
    }
    desc = {
        trigger = {
            emf_sr_event_desc_christian_group_2 = yes
        }
        text = EVTDESC_MNM_3227_A
    }
    desc = {
        trigger = { religion_group = jewish_group }
        text = EVTDESC_MNM_3227_A
    }
    desc = {
        trigger = {
            emf_sr_event_desc_muslim_group_1 = yes
        }
        text = EVTDESC_MNM_3227_D
    }
    desc = {
        trigger = { religion_group = zoroastrian_group }
        text = EVTDESC_MNM_3227_E
    }
    desc = {
        trigger = {
            emf_sr_event_desc_muslim_group_2 = yes
        }
        text = EVTDESC_MNM_3227_F
    }
    desc = {
        trigger = { religion = hindu }
        text = EVTDESC_MNM_3227_G
    }
    desc = {
        trigger = { religion = buddhist }
        text = EVTDESC_MNM_3227_G
    }
    desc = {
        trigger = { religion = jain }
        text = EVTDESC_MNM_3227_G
    }
    desc = {
        trigger = {
            OR = {
                religion = norse_pagan_reformed
                religion = norse_pagan
            }
        }
        text = EVTDESC_MNM_3227_J
    }
    desc = {
        trigger = {
            OR = {
                religion = baltic_pagan_reformed
                religion = baltic_pagan
            }
        }
        text = EVTDESC_MNM_3227_J
    }
    desc = {
        trigger = {
            OR = {
                religion = finnish_pagan_reformed
                religion = finnish_pagan
            }
        }
        text = EVTDESC_MNM_3227_J
    }
    desc = {
        trigger = {
            OR = {
                religion = slavic_pagan_reformed
                religion = slavic_pagan
            }
        }
        text = EVTDESC_MNM_3227_J
    }
    desc = {
        trigger = {
            OR = {
                religion = tengri_pagan_reformed
                religion = tengri_pagan
            }
        }
        text = EVTDESC_MNM_3227_N
    }
    desc = {
        trigger = {
            emf_sr_event_desc_african_pagan_group = yes
        }
        text = EVTDESC_MNM_3227_O
    }
    desc = {
        trigger = {
            OR = {
                religion = zun_pagan_reformed
                religion = zun_pagan
            }
        }
        text = EVTDESC_MNM_3227_P
    }
    desc = {
        trigger = {
            OR = {
                religion = hellenic_pagan
                religion = pagan
            }
        }
        text = EVTDESC_MNM_3227_P
    }


    hide_from = yes

    option = {
        name = EVTOPTA_MNM_3227
        custom_tooltip = { text = EVTOPTA_3222_TOOLTIP }
        hidden_effect = { change_variable = { which = blending_in_points value = -1 } }
    }
}


long_character_event = { #Outcome 3 (big gain)
    id = MNM.3228
    picture = "GFX_evt_secret_ceremony"
    border = GFX_event_long_frame_religion
    is_triggered_only = yes

    desc = {
        trigger = {
            emf_sr_event_desc_christian_group_1 = yes
        }
        text = EVTDESC_MNM_3228_A
    }
    desc = {
        trigger = {
            emf_sr_event_desc_christian_group_2 = yes
        }
        text = EVTDESC_MNM_3228_A
    }
    desc = {
        trigger = { religion_group = jewish_group }
        text = EVTDESC_MNM_3228_A
    }
    desc = {
        trigger = {
            emf_sr_event_desc_muslim_group_1 = yes
        }
        text = EVTDESC_MNM_3228_A
    }
    desc = {
        trigger = { religion_group = zoroastrian_group }
        text = EVTDESC_MNM_3228_A
    }
    desc = {
        trigger = {
            emf_sr_event_desc_muslim_group_2 = yes
        }
        text = EVTDESC_MNM_3228_A
    }
    desc = {
        trigger = { religion = hindu }
        text = EVTDESC_MNM_3228_G
    }
    desc = {
        trigger = { religion = buddhist }
        text = EVTDESC_MNM_3228_H
    }
    desc = {
        trigger = { religion = jain }
        text = EVTDESC_MNM_3228_H
    }
    desc = {
        trigger = {
            OR = {
                religion = norse_pagan_reformed
                religion = norse_pagan
            }
        }
        text = EVTDESC_MNM_3228_H
    }
    desc = {
        trigger = {
            OR = {
                religion = baltic_pagan_reformed
                religion = baltic_pagan
            }
        }
        text = EVTDESC_MNM_3228_H
    }
    desc = {
        trigger = {
            OR = {
                religion = finnish_pagan_reformed
                religion = finnish_pagan
            }
        }
        text = EVTDESC_MNM_3228_H
    }
    desc = {
        trigger = {
            OR = {
                religion = slavic_pagan_reformed
                religion = slavic_pagan
            }
        }
        text = EVTDESC_MNM_3228_H
    }
    desc = {
        trigger = {
            OR = {
                religion = tengri_pagan_reformed
                religion = tengri_pagan
            }
        }
        text = EVTDESC_MNM_3228_H
    }
    desc = {
        trigger = {
            emf_sr_event_desc_african_pagan_group = yes
        }
        text = EVTDESC_MNM_3228_O
    }
    desc = {
        trigger = {
            OR = {
                religion = zun_pagan_reformed
                religion = zun_pagan
            }
        }
        text = EVTDESC_MNM_3228_O
    }
    desc = {
        trigger = {
            OR = {
                religion = hellenic_pagan
                religion = pagan
            }
        }
        text = EVTDESC_MNM_3228_O
    }


    hide_from = yes

    option = {      
        name = EVTOPTA_MNM_3228
        custom_tooltip = { text = EVTOPTA_3223_TOOLTIP }
        hidden_effect = { change_variable = { which = blending_in_points value = 2 } }
    }
}

long_character_event = { #Outcome 4 (big loss)
    id = MNM.3229
    picture = "GFX_evt_uncomfortable"
    border = GFX_event_long_frame_religion
    is_triggered_only = yes

    desc = {
        trigger = {
            emf_sr_event_desc_christian_group_1 = yes
        }
        text = EVTDESC_MNM_3229_A
    }
    desc = {
        trigger = {
            emf_sr_event_desc_christian_group_2 = yes
        }
        text = EVTDESC_MNM_3229_A
    }
    desc = {
        trigger = { religion_group = jewish_group }
        text = EVTDESC_MNM_3229_C
    }
    desc = {
        trigger = {
            emf_sr_event_desc_muslim_group_1 = yes
        }
        text = EVTDESC_MNM_3229_D
    }
    desc = {
        trigger = { religion_group = zoroastrian_group }
        text = EVTDESC_MNM_3229_D
    }
    desc = {
        trigger = {
            emf_sr_event_desc_muslim_group_2 = yes
        }
        text = EVTDESC_MNM_3229_D
    }
    desc = {
        trigger = { religion = hindu }
        text = EVTDESC_MNM_3229_G
    }
    desc = {
        trigger = { religion = buddhist }
        text = EVTDESC_MNM_3229_G
    }
    desc = {
        trigger = { religion = jain }
        text = EVTDESC_MNM_3229_G
    }
    desc = {
        trigger = {
            OR = {
                religion = norse_pagan_reformed
                religion = norse_pagan
            }
        }
        text = EVTDESC_MNM_3229_G
    }
    desc = {
        trigger = {
            OR = {
                religion = baltic_pagan_reformed
                religion = baltic_pagan
            }
        }
        text = EVTDESC_MNM_3229_G
    }
    desc = {
        trigger = {
            OR = {
                religion = finnish_pagan_reformed
                religion = finnish_pagan
            }
        }
        text = EVTDESC_MNM_3229_G
    }
    desc = {
        trigger = {
            OR = {
                religion = slavic_pagan_reformed
                religion = slavic_pagan
            }
        }
        text = EVTDESC_MNM_3229_G
    }
    desc = {
        trigger = {
            OR = {
                religion = tengri_pagan_reformed
                religion = tengri_pagan
            }
        }
        text = EVTDESC_MNM_3229_G
    }
    desc = {
        trigger = {
            emf_sr_event_desc_african_pagan_group = yes
        }
        text = EVTDESC_MNM_3229_G
    }
    desc = {
        trigger = {
            OR = {
                religion = zun_pagan_reformed
                religion = zun_pagan
            }
        }
        text = EVTDESC_MNM_3229_G
    }
    desc = {
        trigger = {
            OR = {
                religion = hellenic_pagan
                religion = pagan
            }
        }
        text = EVTDESC_MNM_3229_G
    }


    hide_from = yes

    option = {      
        name = EVTOPTA_MNM_3229
        custom_tooltip = { text = EVTOPTA_3224_TOOLTIP }
        hidden_effect = { change_variable = { which = blending_in_points value = -2 } }
    }
}


character_event = { #Generic progress (small)
    id = MNM.3230
    picture = "GFX_evt_dark_prayer"
    border = GFX_event_normal_frame_religion
    is_triggered_only = yes

    desc = {
        trigger = { has_character_flag = desc_flag_A }
        text = EVTDESC_MNM_3230_A
    }
    desc = {
        trigger = { has_character_flag = desc_flag_B }
        text = EVTDESC_MNM_3230_B
    }
    desc = {
        trigger = { has_character_flag = desc_flag_C }
        text = EVTDESC_MNM_3230_C
    }
    desc = {
        trigger = { has_character_flag = desc_flag_D }
        text = EVTDESC_MNM_3230_D
    }
    desc = {
        trigger = { has_character_flag = desc_flag_E }
        text = EVTDESC_MNM_3230_E
    }
    desc = {
        trigger = { has_character_flag = desc_flag_F }
        text = EVTDESC_MNM_3230_F
    }

    immediate = {
        random_list = {
            10 = {
                modifier = {
                    factor = 0
                    has_character_flag = desc_flag_A
                }
                modifier = {
                    factor = 0
                    NOT = {
                        any_courtier = {
                            has_job_title = job_spiritual
                        }
                    }
                }
                set_character_flag = desc_flag_A
            }
            10 = {
                modifier = {
                    factor = 0
                    has_character_flag = desc_flag_B
                }
                modifier = {
                    factor = 0
                    NOT = {
                        any_courtier = {
                            has_job_title = job_spiritual
                        }
                    }
                }
                set_character_flag = desc_flag_B
            }
            10 = {
                modifier = {
                    factor = 0
                    has_character_flag = desc_flag_C
                }
                set_character_flag = desc_flag_C
            }
            10 = {
                modifier = {
                    factor = 0
                    has_character_flag = desc_flag_D
                }
                set_character_flag = desc_flag_D
            }
            10 = {
                modifier = {
                    factor = 0
                    has_character_flag = desc_flag_E
                }
                set_character_flag = desc_flag_E
            }
            10 = {
                modifier = {
                    factor = 0
                    has_character_flag = desc_flag_F
                }
                set_character_flag = desc_flag_F
            }
        }
    }

    hide_from = yes

    option = {      
        name = {
            trigger = { has_character_flag = desc_flag_C }
            text = EVTOPTA_MNM_3230_C
        }
        name = {
            trigger = { has_character_flag = desc_flag_D }
            text = EVTOPTA_MNM_3230_D
        }
        name = {
            trigger = { has_character_flag = desc_flag_E }
            text = EVTOPTA_MNM_3230_E
        }
        name = {
            trigger = { has_character_flag = desc_flag_F }
            text = EVTOPTA_MNM_3230_F
        }
        
        trigger = {
            NOR = {
                has_character_flag = desc_flag_A
                has_character_flag = desc_flag_B
            }
        }
    }

    option = { #gives opinion boost with court chaplain (desc A + B only)
        name = {
            trigger = { has_character_flag = desc_flag_A }
            text = EVTOPTA_MNM_3230_A
        }

        name = {
            trigger = { has_character_flag = desc_flag_B }
            text = EVTOPTA_MNM_3230_B
        }

        if = {
            limit = {
                OR = {
                    has_character_flag = desc_flag_B
                    has_character_flag = desc_flag_A
                }
            }
            random_courtier = {
                limit = { has_job_title = job_spiritual }
                save_event_target_as = court_spiritual
            }

            reverse_opinion =  {
                who = event_target:court_spiritual
                modifier = opinion_approves
                years = 5
            }
        }

        trigger = {
            OR = {
                has_character_flag = desc_flag_B
                has_character_flag = desc_flag_A
            }
        }
    }

    after = {
        custom_tooltip = { text = EVTOPTA_3221_TOOLTIP }
        hidden_effect = { change_variable = { which = blending_in_points value = 1 } }
        clr_character_flag = desc_flag_A
        clr_character_flag = desc_flag_B
        clr_character_flag = desc_flag_C
        clr_character_flag = desc_flag_D
        clr_character_flag = desc_flag_E
        clr_character_flag = desc_flag_F
    }
}

#Fail/success evaluation for Blend In-mission
character_event = {
    id = MNM.3250
    hide_window = yes

    is_triggered_only = yes

    immediate = {
        if = {
            limit = { FROM = { check_variable = { which = blending_in_points value = 4 } } }
            FROM = { letter_event = { id = MNM.3251 } } # successful mission
        }
        if = {
            limit = { FROM = { NOT = { check_variable = { which = blending_in_points value = -2 } } } }
            FROM = { letter_event = { id = MNM.3252 } } # mission failed
        }
        clr_character_flag = attempting_to_convince_stubborn_courtier
        clr_character_flag = attempting_to_convince_concerned_friend
        clr_character_flag = blend_in_struggled_with_trait
    }
}

#Blend In-mission success
letter_event = {
    id = MNM.3251
    border = GFX_event_letter_frame_religion
    desc = EVTDESC_MNM_3251

    is_triggered_only = yes

    option = {
        name = EVTOPTA_MNM_3251

        if = {
            limit = { has_quest = quest_secret_religions_societies_blend_in }
            clr_quest = quest_secret_religions_societies_blend_in
            sound_effect = secret_cults_blend_in
            remove_character_modifier = attempting_to_blend_in
            clr_character_flag = blending_in_timer
        }
        add_society_currency_medium_effect = yes
		decrease_visibility_effect = yes
    }
}

#Blend In-mission failure
letter_event = {
    id = MNM.3252
    border = GFX_event_letter_frame_religion
    desc = EVTDESC_MNM_3252

    is_triggered_only = yes

    option = {
        name = EVTOPTA_MNM_3252

        if = {
            limit = { has_quest = quest_secret_religions_societies_blend_in }
            clr_quest = { id = quest_secret_religions_societies_blend_in failure = yes }
            remove_character_modifier = attempting_to_blend_in
            clr_character_flag = blending_in_timer
        }
    }
}

###Mission ping to leader (Secret Ceremony)###
character_event = {
    id = MNM.3233
    hide_window = yes

    is_triggered_only = yes

    immediate = { FROM = { society_quest_event = { id = MNM.3234 days = 7 random = 7 } } }
}

#QUEST: Conduct Secret Ceremony
society_quest_event = {
    id = MNM.3234
    border = GFX_event_letter_frame_religion

    desc = {
        trigger = { society_member_of = secret_religious_cult }
        text = EVTDESC_3398_CONDUCT_SECRET_CEREMONY
    }

    is_triggered_only = yes

    option = {
        name = ACCEPT
        set_quest = quest_secret_religions_conduct_secret_ceremony
    }

    option = {
        name = DECLINE
        custom_tooltip = { text = decline_quest_tooltip }

        add_character_modifier = {
            name = quest_cooldown_timer
            hidden = yes
            days = 1000
        }

        ai_chance = { factor = 0 }
    }
}

### MISSION: Conduct Secret Ceremony to your Secret God(s)
# -- Hidden Start --
character_event = {
    id = MNM.3235
    hide_window = yes
    
    is_triggered_only = yes
       
    immediate = {
        # First look for someone at court
        society = {
            random_society_member = {
                limit = {
                    ai = yes
                    is_incapable = no
                    prisoner = no
                    in_command = no
                    is_inaccessible_trigger = no
                    NOT = { character = ROOT }
                    host = { character = ROOT }
                }
                character_event = { id = MNM.3236 }
                break = yes
            }
            
            # Then look for someone in the same realm
            random_society_member = {
                limit = {
                    ai = yes
                    is_incapable = no
                    prisoner = no
                    in_command = no
                    is_inaccessible_trigger = no
                    NOT = { character = ROOT }
                    same_realm = yes
                }
                character_event = { id = MNM.3236 }
                break = yes
            }
            
            # Then look abroad...
            random_society_member = {
                limit = {
                    ai = yes
                    is_incapable = no
                    prisoner = no
                    in_command = no
                    is_inaccessible_trigger = no
                    NOT = { character = ROOT }
                    is_within_diplo_range = ROOT
                }
                character_event = { id = MNM.3236 }
                break = yes
            }
        }
    }
}

# Ping for other member
character_event = {
    id = MNM.3236
    hide_window = yes
    
    is_triggered_only = yes
    
    immediate = {
        save_event_target_as = fellow_member

        set_quest_target = {
            id = quest_secret_religions_conduct_secret_ceremony
            holder = FROM
        }

        FROM = { character_event = { id = MNM.3237 } }
    }
}

# Conduct secret ceremony - Fellow member approaches you
character_event = {
    id = MNM.3237
    picture = GFX_evt_dark_prayer
    border = GFX_event_normal_frame_diplomacy
    
    desc = {
        text = EVTDESC_MNM_3237
        trigger = {
            FROM = {
                NOT = { host = { character = ROOT } }
            }
        }
    }
    desc = {
        text = EVTDESC_MNM_3237_COURT
        trigger = {
            FROM = {
                host = { character = ROOT }
            }
        }
    }

    is_triggered_only = yes

    option = {
        name = EVTOPTA_MNM_3237 # Can't wait
        custom_tooltip = {
            text = EVTOPTA_MNM_3237_TT
        }
        hidden_effect = { FROM = { character_event = { id = MNM.3238 days = 15 random = 10 } } }
    }

    option = {
        name = EVTOPTB_MNM_3237 # I changed my mind
        ai_chance = { factor = 0 }
        
        detract_society_currency_minor_effect = yes
        reverse_opinion = { who = FROM modifier = opinion_unimpressed years = 5 }
    }
}

# PING/GATING for other char
character_event = {
    id = MNM.3238
    hide_window = yes
    
    trigger = { FROM = { has_quest = quest_secret_religions_conduct_secret_ceremony } }

    is_triggered_only = yes

    trigger = {
        is_alive = yes
    }
    
    immediate = {
        FROM = { character_event = { id = MNM.3239 } }
    }
}

# The Secret Ceremony - Result
character_event = {
    id = MNM.3239
    picture = "GFX_evt_secret_ceremony"
    border = GFX_event_normal_frame_diplomacy
    
    trigger = { has_quest = quest_secret_religions_conduct_secret_ceremony }

    is_triggered_only = yes
    
    immediate = {
        random_list = {
            5 = { # Random courtier accidentally discovers you and fellow member kills them (by accident?)
                modifier = {
                    factor = 0
                    # zero chance of happening if there is no potential threath within your court...
                    NOT = {
                        any_courtier = {
                            NOR = {
                                character = ROOT
                                character = FROM
                                is_married = ROOT
                                is_close_relative = ROOT
                            }
                            is_adult = yes
                            prisoner = no
                            is_ruler = no
                            shares_prevs_secret_religion_trigger = no
                            NOT = { same_society_as = ROOT }    
                        }
                    }
                }
                hidden_effect = {
                    random_courtier = { #find a potential threath, who stumbles in on your ceremony...
                        limit = {
                            NOR = {
                                character = ROOT
                                character = FROM
                                is_married = ROOT
                                is_close_relative = ROOT
                            }
                            is_adult = yes
                            prisoner = no
                            is_ruler = no
                            shares_prevs_secret_religion_trigger = no
                            NOT = { same_society_as = ROOT }
                        }
                        save_event_target_as = unfortunate_interrupter
                        death = { death_reason = death_murder_unknown killer = ROOT }
                    }
                }
                set_character_flag = feel_different_negative
                set_character_flag = secret_ceremony_tragic_failure
            }
            10 = { # You feel stressed out by the ordeal...
                set_character_flag = feel_different_negative
                set_character_flag = secret_ceremony_small_failure
            }

            10 = { # You are satisfied, you guess...
                set_character_flag = secret_ceremony_neutral_outcome
            }

            30 = { # The ceremony leaves you at peace...
                random = {
                    chance = 25
                    set_character_flag = feel_different_positive
                }
                if = {
                    limit = { 
                        FROM = { root_attraction_trigger = yes }
                        NOT = { is_lover = FROM }
                    }
                    random = {
                        chance = 50
                        set_character_flag = secret_ceremony_romance
                    }
                }
                if = {
                    limit = {
                        NOT = { is_friend = FROM }
                        FROM = { root_attraction_trigger = no }
                    }
                    random = {
                        chance = 50
                        set_character_flag = secret_ceremony_friendship
                    }
                }
                set_character_flag = secret_ceremony_small_success
            }

            30 = { #The ceremony reinvigorates you completely...!
                if = {
                    limit = { 
                        FROM = { root_attraction_trigger = yes }
                        NOT = { is_lover = FROM }
                    }
                    random = {
                        chance = 50
                        set_character_flag = secret_ceremony_romance
                    }
                }
                if = {
                    limit = {
                        NOT = { is_friend = FROM }
                        FROM = { root_attraction_trigger = no }
                    }
                    random = {
                        chance = 50
                        set_character_flag = secret_ceremony_friendship
                    }
                }
                set_character_flag = feel_different_positive
                set_character_flag = secret_ceremony_big_success
            }
        }

        if = { # if you just gained this flag, you gain a random trait! (unless you already have all the traits)
            limit = { has_character_flag = feel_different_positive }
            random_list = {
                10 = {
                    modifier = {
                        factor = 0
                        trait = gregarious
                    }
                    modifier = {
                        factor = 2
                        has_education_diplomacy_trigger = yes
                    }
                    set_character_flag = gregarious_flag
                }
                10 = {
                    modifier = {
                        factor = 0
                        trait = brave
                    }
                    modifier = {
                        factor = 2
                        has_education_martial_trigger = yes
                    }
                    set_character_flag = brave_flag
                }
                10 = {
                    modifier = {
                        factor = 0
                        trait = diligent
                    }
                    modifier = {
                        factor = 2
                        has_education_stewardship_trigger = yes
                    }
                    set_character_flag = diligent_flag
                }
                10 = {
                    modifier = {
                        factor = 0
                        trait = patient
                    }
                    modifier = {
                        factor = 2
                        has_education_intrigue_trigger = yes
                    }
                    set_character_flag = patient_flag
                }
                10 = {
                    modifier = {
                        factor = 0
                        NOT = {
                            trait = gregarious
                            trait = brave
                            trait = diligent
                            trait = patient
                        }
                    }
                    clr_character_flag = feel_different_positive
                }
            }
        }
    }
    
    desc = { 
        text = EVTDESC_MNM_3239_TRAGIC_FAIL
        picture = GFX_evt_secluded_in_prayer
        trigger = { has_character_flag = secret_ceremony_tragic_failure }
    }
    desc = { 
        text = EVTDESC_MNM_3239_SMALL_FAIL
        picture = GFX_evt_secluded_in_prayer
        trigger = { has_character_flag = secret_ceremony_small_failure }
    }
    desc = { 
        text = EVTDESC_MNM_3239_NEUTRAL_OUTCOME
        picture = GFX_evt_secluded_in_prayer
        trigger = { has_character_flag = secret_ceremony_neutral_outcome }
    }
    desc = { 
        text = EVTDESC_MNM_3239_SMALL_SUCCESS
        picture = GFX_evt_secluded_in_prayer
        trigger = {
            has_character_flag = secret_ceremony_small_success
            NOT = { has_character_flag = secret_ceremony_romance }
            NOT = { has_character_flag = secret_ceremony_friendship }
        }
    }
    desc = { 
        text = EVTDESC_MNM_3239_SMALL_SUCCESS_N_FRIENDSHIP
        picture = GFX_evt_secluded_in_prayer
        trigger = {
            has_character_flag = secret_ceremony_small_success
            has_character_flag = secret_ceremony_friendship
        }
    }
    desc = { 
        text = EVTDESC_MNM_3239_SMALL_SUCCESS_N_ROMANCE
        picture = GFX_evt_secluded_in_prayer
        trigger = {
            has_character_flag = secret_ceremony_small_success
            has_character_flag = secret_ceremony_romance
            NOT = { is_rival = FROM }
        }
    }
    desc = { 
        text = EVTDESC_MNM_3239_SMALL_SUCCESS_N_RIVAL_ROMANCE
        picture = GFX_evt_secluded_in_prayer
        trigger = {
            has_character_flag = secret_ceremony_small_success
            has_character_flag = secret_ceremony_romance
            is_rival = FROM
        }
    }
    desc = {
        text = EVTDESC_MNM_3239_BIG_SUCCESS
        picture = GFX_evt_secluded_in_prayer
        trigger = {
            has_character_flag = secret_ceremony_big_success
            NOT = { has_character_flag = secret_ceremony_romance }
            NOT = { has_character_flag = secret_ceremony_friendship }
        }
    }
    desc = { 
        text = EVTDESC_MNM_3239_BIG_SUCCESS_N_FRIENDSHIP
        picture = GFX_evt_secluded_in_prayer
        trigger = {
            has_character_flag = secret_ceremony_big_success
            has_character_flag = secret_ceremony_friendship
        }
    }
    desc = { 
        text = EVTDESC_MNM_3239_BIG_SUCCESS_N_ROMANCE
        picture = GFX_evt_secluded_in_prayer
        trigger = {
            has_character_flag = secret_ceremony_big_success
            has_character_flag = secret_ceremony_romance
            NOT = { is_rival = FROM }
        }
    }
    desc = { 
        text = EVTDESC_MNM_3239_BIG_SUCCESS_N_RIVAL_ROMANCE
        picture = GFX_evt_secluded_in_prayer
        trigger = {
            has_character_flag = secret_ceremony_big_success
            has_character_flag = secret_ceremony_romance
            is_rival = FROM
        }
    }

    option = {
        name = {
            text = EVTOPTA_MNM_3239_TRAGIC_FAIL
            trigger = { has_character_flag = secret_ceremony_tragic_failure }
        }
        name = {
            text = EVTOPTA_MNM_3239_SMALL_FAIL
            trigger = { has_character_flag = secret_ceremony_small_failure }
        }
        name = {
            text = EVTOPTA_MNM_3239_NEUTRAL_OUTCOME
            trigger = { has_character_flag = secret_ceremony_neutral_outcome }
        }
        name = {
            text = EVTOPTA_MNM_3239_SMALL_SUCCESS
            trigger = { has_character_flag = secret_ceremony_small_success }
        }
        name = {
            text = EVTOPTA_MNM_3239_BIG_SUCCESS
            trigger = { has_character_flag = secret_ceremony_big_success }
        }

        if = { limit = { has_character_flag = secret_ceremony_tragic_failure } 
            custom_tooltip = { text = EVTOPTA_MNM_3239_TRAGIC_FAIL_TT }
        }
        if = { limit = { has_character_flag = secret_ceremony_small_failure } 
            custom_tooltip = { text = EVTOPTA_MNM_3239_SMALL_FAIL_TT }
        }
        if = { limit = { has_character_flag = secret_ceremony_neutral_outcome } 
            custom_tooltip = { text = EVTOPTA_MNM_3239_NEUTRAL_OUTCOME_TT }
        }
        if = {
            limit = {
                has_character_flag = secret_ceremony_small_success
                NOT = { has_character_flag = secret_ceremony_romance }
            } 
            custom_tooltip = { text = EVTOPTA_MNM_3239_SMALL_SUCCESS_TT_1 }
        }
        if = {
            limit = {
                has_character_flag = secret_ceremony_small_success
                has_character_flag = secret_ceremony_romance
            }
            custom_tooltip = { text = EVTOPTA_MNM_3239_SMALL_SUCCESS_TT_2 }
        }
        if = {
            limit = {
                has_character_flag = secret_ceremony_big_success
                NOT = { has_character_flag = secret_ceremony_romance }
            }
            custom_tooltip = { text = EVTOPTA_MNM_3239_BIG_SUCCESS_TT_1 }
        }
        if = {
            limit = {
                has_character_flag = secret_ceremony_big_success
                has_character_flag = secret_ceremony_romance
            }
            custom_tooltip = { text = EVTOPTA_MNM_3239_BIG_SUCCESS_TT_2 }
        }
        
        if = { # the ceremony sparked something between the two of you
            limit = { has_character_flag = secret_ceremony_romance }
            if = {
                limit = {
                    has_opinion_modifier = { who = FROM modifier = opinion_budding_romance }
                    reverse_has_opinion_modifier = { who = FROM modifier = opinion_budding_romance }
                }
                add_lover = FROM 
            }
            if = {
                limit = { is_rival = FROM }
                remove_rival = FROM
            }
            if = {
                limit = {
                    NOT = { has_opinion_modifier = { who = FROM modifier = opinion_budding_romance } }
                    NOT = { reverse_has_opinion_modifier = { who = FROM modifier = opinion_budding_romance } }
                }
                reverse_opinion =  {
                    who = FROM
                    modifier = opinion_budding_romance
                    years = 10
                }
                opinion =  {
                    who = FROM
                    modifier = opinion_budding_romance
                    years = 10
                }
            }
        }

        if = { # the ceremony brought you closer together
            limit = { has_character_flag = secret_ceremony_friendship }
            if = {
                limit = { NOT = { is_rival = FROM } }
                add_friend = FROM
            }
            
            if = {
                limit = { is_rival = FROM }
                remove_rival = FROM
                reverse_opinion =  {
                    who = FROM
                    modifier = opinion_budding_friendship
                    years = 10
                }
                opinion =  {
                    who = FROM
                    modifier = opinion_budding_friendship
                    years = 10
                }
            }
        }    
        
        trigger_switch = { # Which trait to handle
            on_trigger = has_character_flag
            gregarious_flag = {
                add_trait_gregarious_effect = yes
                remove_trait_shy_effect = yes
                clr_character_flag = gregarious_flag
            }
            brave_flag = {
                add_trait_brave_effect = yes
                remove_trait_craven_effect = yes   
                clr_character_flag = brave_flag
            }
            diligent_flag = {
                add_trait_diligent_effect = yes
                remove_trait_slothful_effect = yes
                clr_character_flag = diligent_flag
            }
            patient_flag = {
                add_trait_patient_effect = yes
                remove_trait_wroth_effect = yes
                clr_character_flag = patient_flag
            }
        }
        
        if = {
            limit = { has_character_flag = feel_different_negative }
            random = {
                chance = 20
                add_trait = stressed
            }
        }

        if = { limit = { has_character_flag = secret_ceremony_small_failure }
            add_society_currency_minor_effect = yes
        }
        trigger_switch = {
            on_trigger = has_character_flag
            secret_ceremony_neutral_outcome = { add_society_currency_minor_effect = yes }
            secret_ceremony_small_success = { add_society_currency_medium_effect = yes }
            secret_ceremony_big_success = { add_society_currency_medium_effect = yes }
        }

        if = { limit = { NOT = { has_character_flag = secret_ceremony_tragic_failure } } #unless you tragically failed, you succeed
            clr_quest = quest_secret_religions_conduct_secret_ceremony
        }
        
        if = {
            limit = { has_character_flag = secret_ceremony_tragic_failure }
            event_target:unfortunate_interrupter = {
                death = { death_reason = death_murder_unknown killer = ROOT }
                show_portrait = yes
            }
            clr_quest = { id = quest_secret_religions_conduct_secret_ceremony failure = yes }
        }
        
        clr_character_flag = secret_ceremony_tragic_failure
        clr_character_flag = secret_ceremony_small_failure
        clr_character_flag = secret_ceremony_neutral_outcome
        clr_character_flag = secret_ceremony_small_success
        clr_character_flag = secret_ceremony_big_success
        clr_character_flag = secret_ceremony_friendship
        clr_character_flag = secret_ceremony_romance
        clr_character_flag = feel_different_positive
        clr_character_flag = feel_different_negative
        clr_character_flag = conduct_secret_ceremony_timer
    }
}

#------------------ Secret ceremony end--------------------


#MISSION: Induct a ruler
character_event = {
	id = MNM.3400
	hide_window = yes

	is_triggered_only = yes

	immediate = { FROM = { society_quest_event = { id = MNM.3401 days = 7 random = 7 } } }
}

society_quest_event = {
	id = MNM.3401
	desc = EVTDESC_MNM_3401
	quest_target = event_target:induction_target

	is_triggered_only = yes

	immediate = {
		top_liege = {
			random_realm_lord = { #Backup
				limit = { ok_sr_induction_mission_target_trigger = yes }
				save_event_target_as = induction_target
			}

			random_realm_lord = { #Baron-count for low levels
				limit = { 
					lower_tier_than = DUKE 
					ok_sr_induction_mission_target_trigger = yes
				}
			    save_event_target_as = induction_target
	        }
		}
		if = {
			limit = { society_rank >= 3 }
			top_liege = { 
				if = { #Top liege only if all other duke+ rulers are taken
					limit = { ok_sr_induction_mission_target_trigger = yes }
					save_event_target_as = induction_target
				}
			}
			random_realm_lord = { #For high level ppl, duke+ ruler
				limit = { 
					higher_tier_than = BARON 
					ok_sr_induction_mission_target_trigger = yes
				}
			save_event_target_as = induction_target
		  }
	   }
	}

	option = { #accept
		name = ACCEPT
		event_target:induction_target = {
			set_character_flag = appear_in_option
			clr_character_flag = appear_in_option
		}
			event_target:induction_target = {
				set_quest_target = {
				id = quest_secret_religious_societies_induct_ruler
					holder = ROOT
				}
			}
			
		}	
	option = { #nah thx
		name = DECLINE
		custom_tooltip = { text = decline_quest_tooltip }

		hidden_effect = {
			add_character_modifier = {
				name = quest_cooldown_timer
				hidden = yes
				days = 1000
			}
		}
		ai_chance = { factor = 0 }
	}
}


#MISSION: evoke a ruler's sympathy
character_event = {
	id = MNM.3402
	hide_window = yes

	is_triggered_only = yes

	immediate = { FROM = { society_quest_event = { id = MNM.3403 days = 7 random = 7 } } }
}

society_quest_event = {
	id = MNM.3403
	desc = EVTDESC_MNM_3403
	quest_target = event_target:sympathy_target

	is_triggered_only = yes

	immediate = {
		top_liege = {
			random_realm_lord = { #Backup
				limit = { 
                    ok_sr_sympathy_mission_target_trigger = yes 
                    is_adult = yes
                }
				save_event_target_as = sympathy_target
			}

			random_realm_lord = { #Baron-count for low levels
				limit = { 
                    is_adult = yes
					lower_tier_than = DUKE 
					ok_sr_sympathy_mission_target_trigger = yes
				}
				save_event_target_as = sympathy_target
			}
		}
		if = {
			limit = { society_rank >= 3 }
			top_liege = { 
				if = { #Top liege only if all other duke+ rulers are taken
					limit = { 
                        ok_sr_sympathy_mission_target_trigger = yes 
                        is_adult = yes
                    }
					save_event_target_as = sympathy_target
				}
				random_realm_lord = { #For high level ppl, duke+ ruler
					limit = { 
						is_adult = yes
						higher_tier_than = BARON 
						ok_sr_sympathy_mission_target_trigger = yes
					}
					save_event_target_as = sympathy_target
				}
			}
		}
	}

	option = { #accept
		name = ACCEPT
		
		event_target:sympathy_target = {
				set_quest_target = {
				id = quest_secret_religious_societies_sympathy_ruler
					holder = ROOT
				}
			}
		}	

	option = { #nah thx
		name = DECLINE
		custom_tooltip = { text = decline_quest_tooltip }

		hidden_effect = {
			add_character_modifier = {
				name = quest_cooldown_timer
				hidden = yes
				days = 1000
			}
		}
		ai_chance = { factor = 0 }
	}
}


#POWERS
#Power: Attempt to give character sympathy
character_event = {
    id = MNM.3404
    desc = EVTDESC_MNM_3404
    picture = GFX_evt_feast
    border = GFX_event_normal_frame_religion

    is_triggered_only = yes
    

    #How to make your argument?

    #Friends & family
    option = { 
        name = EVTOPTA_MNM_3404
        custom_tooltip = { text = EVTOPTA_MNM_3404_TT }
        set_character_flag = sympathy_argument_friends_family

    }

    #Home & business
    option = {
        name = EVTOPTB_MNM_3404
        custom_tooltip = { text = EVTOPTB_MNM_3404_TT }
        set_character_flag = sympathy_argument_trauma
    }
    
    #Logical option
    option = {
        name = EVTOPTC_MNM_3404
        custom_tooltip = { text = EVTOPTC_MNM_3404_TT }
        set_character_flag = sympathy_argument_profit
    }
    
    #Stress your own opinion
    option = {
        name = EVTOPTD_MNM_3404
        custom_tooltip = { text = EVTOPTD_MNM_3404_TT }
        set_character_flag = sympathy_argument_personal
    }

    after = {
    	hidden_effect = { FROM = { character_event = { id = MNM.3405 days = 5 } } }
    }
}

#Person is approached with touching story, develop sympathy or not?
character_event = {
    id = MNM.3405
    picture = GFX_evt_feast
    border = GFX_event_normal_frame_diplomacy

    desc = {
    	trigger = { FROM = { has_character_flag = sympathy_argument_friends_family } }
    	text = EVTDESC_MNM_3405_A
    }
    desc = {
    	trigger = { FROM = { has_character_flag = sympathy_argument_trauma } }
    	text = EVTDESC_MNM_3405_B
    }
    desc = {
    	trigger = { FROM = { has_character_flag = sympathy_argument_profit } }
    	text = EVTDESC_MNM_3405_C
    }
    desc = {
    	trigger = { FROM = { has_character_flag = sympathy_argument_personal } }
    	text = EVTDESC_MNM_3405_D
    }

    is_triggered_only = yes
    
    #Yes I agree
    option = { 
        name = EVTOPTA_MNM_3405

        if = {
        	limit = { trait = zealous }
        	remove_trait = zealous
        }

        FROM = {
        	ROOT = {
        		add_sympathy_for_prevs_true_religion_effect = yes
        	}
        }

        reverse_opinion =  {
        	who = FROM
        	modifier = opinion_open_minded
        	years = 10
        }

        hidden_effect = {
        	FROM = { character_event =  { id = MNM.3406 days = 1 } }
        }

        ai_chance = {
        	factor = 60
        	modifier = { trait = kind factor = 3 }
        	modifier = { trait = just factor = 2 }
        	modifier = { trait = trusting factor = 2 }
        	modifier = { trait = patient factor = 1.5 }
        	modifier = { trait = charitable factor = 1.5 }
        	modifier = { controls_religion = yes factor = 0 }
        	modifier = { FROM = { diplomacy = 12 } factor = 1.4 }
        	modifier = { FROM = { diplomacy = 14 } factor = 1.3 }
        	modifier = { FROM = { diplomacy = 16 } factor = 1.2 }
        	modifier = { FROM = { ai = yes } factor = 2 } #The AI makes an uniformed choice, so they need this boost

        	modifier = {
        		factor = 3
        		FROM = { has_character_flag = sympathy_argument_friends_family }
        		OR = {
        			trait = gregarious
        			trait = socializer
        			trait = kind
        			num_of_friends = 1
        			num_of_lovers = 1
        			any_child = { reverse_opinion = { who = ROOT value = 35 } }
        			has_education_diplomacy_trigger = yes
        		}
        	}

        	modifier = {
        		factor = 3
        		FROM = { has_character_flag = sympathy_argument_trauma }
        		OR = {
        			trait = craven
        			trait = kind
        			trait = scarred
        			is_weak_trigger = yes
        			character_disease_trigger = yes
        			has_injury_trigger = yes
        			has_disability_trigger = yes
        			has_mental_disorder_trigger = yes
        			has_negative_congenital_trigger = yes
        		}
        	}

        	modifier = {
        		factor = 3
        		FROM = { has_character_flag = sympathy_argument_profit }
        		OR = {
        			trait = greedy
        			trait = ambitious
        			trait = cynical
        			trait = administrator
        			trait = diligent
        			is_smart_trigger = yes
        			has_education_stewardship_trigger = yes
        		}
        	}

        	modifier = {
        		factor = 3
        		FROM = { has_character_flag = sympathy_argument_personal }
        		opinion = { WHO = FROM value = 15 }
        		OR = {
        			is_friend = FROM
        			is_lover = FROM
        			opinion = { WHO = FROM value = 50 }
        			liege = { character = FROM }
        			top_liege = { character = FROM }
        			is_close_relative = FROM
        			FROM = { diplomacy = 15 }
        		}
        	}
        }
    }

    #No I don't care
    option = {
        name = EVTOPTB_MNM_3405

        reverse_opinion =  {
        	who = FROM
        	modifier = opinion_narrow_minded
        	years = 10
        }

        hidden_effect = {
        	FROM = { character_event =  { id = MNM.3407 days = 1 } }
        }

        ai_chance = {
        	factor = 40
        	modifier = { trait = zealous factor = 5 }
        	modifier = { trait = cruel factor = 3 }
        	modifier = { trait = arbitrary factor = 3 }
        	modifier = { is_priest = yes factor = 2 }
        	modifier = { NOT = { FROM = { diplomacy = 8 } } factor = 2 }
        	modifier = { tier = BARON factor = 1.2 }
        	modifier = { tier = DUKE factor = 1.4 }
        	modifier = { tier = KING factor = 1.7 }
        	modifier = { tier = EMPEROR factor = 2 }
        }
    }

    after = {
    	hidden_effect = {
    		FROM = {
    			clr_character_flag = sympathy_argument_friends_family
    			clr_character_flag = sympathy_argument_trauma
    			clr_character_flag = sympathy_argument_profit
    			clr_character_flag = sympathy_argument_personal
    		}
    	}
    }
}

#They gained sympathy
character_event = {
    id = MNM.3406
    desc = EVTDESC_MNM_3406
    picture = GFX_evt_uncomfortable
    border = GFX_event_normal_frame_religion

    is_triggered_only = yes
    
    option = { 
        name = EVTOPTA_MNM_3406

        tooltip = {
        	FROM = { add_sympathy_for_prevs_true_religion_effect = yes }
        }
        if = {
        	limit = { 
        		has_quest = quest_secret_religious_societies_sympathy_ruler 
        		FROM = { is_quest_target_of = ROOT }
        	}
        	clr_quest = quest_secret_religious_societies_sympathy_ruler
        	add_society_currency_medium_effect = yes
        }
    }
}

#They did not gain sympathy
character_event = {
    id = MNM.3407
    desc = EVTDESC_MNM_3407
    picture = GFX_evt_courtiers_talking
    border = GFX_event_normal_frame_religion

    is_triggered_only = yes
    
    option = { 
        name = EVTOPTA_MNM_3407

        if = {
        	limit = { 
        		has_quest = quest_secret_religious_societies_sympathy_ruler 
        		FROM = { is_quest_target_of = ROOT }
            }
        	clr_quest = { id = quest_secret_religious_societies_sympathy_ruler failure = yes }
        }
       	if = {
        	limit = { 
        		has_quest = quest_secret_religious_societies_induct_ruler 
        		FROM = { is_quest_target_of = ROOT }
        	}
        	clr_quest = { id = quest_secret_religious_societies_induct_ruler failure = yes }
        }
    }
}


#POWER: Induct character to secret faith
character_event = {
    id = MNM.3408
    desc = EVTDESC_MNM_3408
    picture = GFX_evt_library
    border = GFX_event_normal_frame_religion

    is_triggered_only = yes

    immediate = {
    	save_event_target_as = secret_religion_inductor
    	FROM = { save_event_target_as = secret_religion_inductee }
    }
    
    #A passage about great warriors of the faith
    option = { 
        name = EVTOPTA_MNM_3408
        custom_tooltip = { text = EVTOPTA_MNM_3408_TT }
        set_character_flag = induction_argument_war
    }

    #A passage about community  
    option = {
        name = EVTOPTB_MNM_3408
        custom_tooltip = { text = EVTOPTB_MNM_3408_TT }
         set_character_flag = induction_argument_community
    }
    
    #An interesting passage on matters of ethics and philosophy
    option = {
        name = EVTOPTC_MNM_3408
        custom_tooltip = { text = EVTOPTC_MNM_3408_TT }
         set_character_flag = induction_argument_theology
    }
    
    #A passage about a succesful and fair ruler
    option = {
        name = EVTOPTD_MNM_3408
        custom_tooltip = { text = EVTOPTD_MNM_3408_TT }
        set_character_flag = induction_argument_stewardship
    }

    after = {
    	hidden_effect = { event_target:secret_religion_inductee = { character_event = { id = MNM.3409 days = 3 } } }
    }
}

#Finds a holy book
character_event = {
    id = MNM.3409
    picture = GFX_evt_library
    desc = EVTDESC_MNM_3409
    border = GFX_event_normal_frame_religion

    hide_from = yes

    is_triggered_only = yes
  
    #Read it
    option = { 
        name = EVTOPTA_MNM_3409
        custom_tooltip = { text = EVTOPTA_MNM_3409_TT }

        hidden_effect = { character_event = { id = MNM.3410 days = 12 } }
        ai_chance = { factor = 10 }
    }

    #Hide it
    option = {
        name = EVTOPTC_MNM_3409
        custom_tooltip = { text = EVTOPTC_MNM_3409_TT }

        hidden_effect = { event_target:secret_religion_inductor = { character_event = { id = MNM.3413 days = 3 } } } #fail event

        random = {
        	chance = 10
        	add_trait_paranoid_effect = yes
        }

        ai_chance = { factor = 0 }
    }
}

#Reading the holy book
character_event = {
    id = MNM.3410
    picture = GFX_evt_secluded_in_prayer
    border = GFX_event_normal_frame_religion

    desc = {
    	trigger = { event_target:secret_religion_inductor = { has_character_flag = induction_argument_war } }
    	text = EVTDESC_MNM_3410_A
    }
    desc = {
    	trigger = { event_target:secret_religion_inductor = { has_character_flag = induction_argument_community } }
    	text = EVTDESC_MNM_3410_B
    }
    desc = {
    	trigger = { event_target:secret_religion_inductor = { has_character_flag = induction_argument_theology } }
    	text = EVTDESC_MNM_3410_C
    }
    desc = {
    	trigger = { event_target:secret_religion_inductor = { has_character_flag = induction_argument_stewardship } }
    	text = EVTDESC_MNM_3410_D
    }

    hide_from = yes

    is_triggered_only = yes

    #It speaks the truth
    option = { 
        name = EVTOPTA_MNM_3410
        #custom_tooltip = { text = EVTOPTA_MNM_3410_TT }

        hidden_effect = {
	        clear_secret_religion = yes
	    }
	    #Add new secret religion
		set_secret_religion = event_target:secret_religion_inductor
       	event_target:secret_religion_inductor = {
       		#And update the inductor
       		hidden_effect = { character_event = { id = MNM.3411 days = 3 } }
       	}

       	ai_chance = {
        	factor = 60
        	modifier = { trait = trusting factor = 2 }
        	modifier = { controls_religion = yes factor = 0 }
        	modifier = { FROM = { diplomacy = 12 } factor = 1.4 }
        	modifier = { FROM = { diplomacy = 14 } factor = 1.4 }
        	modifier = { FROM = { diplomacy = 16 } factor = 1.3 }
            modifier = { FROM = { diplomacy = 18 } factor = 1.3 }
            modifier = { FROM = { diplomacy = 20 } factor = 1.2 }
            modifier = { FROM = { diplomacy = 22 } factor = 1.2 }
        	modifier = { FROM = { ai = yes } factor = 1.5 } #The AI makes an uniformed choice, so they need this boost

        	modifier = {
        		factor = 3
        		FROM = { has_character_flag = induction_argument_war }
        		OR = {
        			trait = brave
        			has_education_martial_trigger = yes
					has_lifestyle_martial_trigger = yes
					has_job_title = job_marshal
        		}
        	}

        	modifier = {
        		factor = 3
        		FROM = { has_character_flag = induction_argument_community }
        		OR = {
        			trait = gregarious
        			num_of_friends = 1
        			num_of_lovers = 1
        			any_child = { reverse_opinion = { who = ROOT value = 35 } }
        			has_education_diplomacy_trigger = yes
        			has_lifestyle_diplomacy_trigger = yes
        		}
        	}

        	modifier = {
        		factor = 3
        		FROM = { has_character_flag = induction_argument_theology }
        		OR = {
        			trait = erudite
        			has_education_learning_trigger = yes
        			has_lifestyle_learning_trigger = yes
        		}
        	}

        	modifier = {
        		factor = 3
        		FROM = { has_character_flag = induction_argument_stewardship }
        		OR = {
        			trait = ambitious
        			trait = just
        			has_lifestyle_stewardship_trigger = yes
        			has_education_stewardship_trigger = yes
        		}
        	}
        }
    }

    #Reaffirmed my belief
    option = {
        name = EVTOPTB_MNM_3410

        piety = 100

       	hidden_effect = { event_target:secret_religion_inductor = { character_event = { id = MNM.3413 days = 3 } } } #fail event

        ai_chance = {
        	factor = 40
        	modifier = { is_priest = yes factor = 2 }
        	modifier = { trait = paranoid factor = 2 }
			modifier = { trait = zealous factor = 6 }
        	modifier = { NOT = { FROM = { diplomacy = 8 } } factor = 2 }
        	modifier = { tier = BARON factor = 2 }
			modifier = { tier = COUNT factor = 3 }
        	modifier = { tier = DUKE factor = 4 }
        	modifier = { tier = KING is_nomadic = no factor = 16 }
        	modifier = { tier = EMPEROR is_nomadic = no factor = 32 }
        }
    }

    after = {
    	hidden_effect = {
    		event_target:secret_religion_inductor = {
    			clr_character_flag = induction_argument_war
    			clr_character_flag = induction_argument_community
    			clr_character_flag = induction_argument_theology
    			clr_character_flag = induction_argument_stewardship
    		}
    	}
    }
}

#The inductee did accept my secret religion
character_event = {
    id = MNM.3411
    desc = EVTDESC_MNM_3411
    picture = GFX_evt_secluded_in_prayer
    border = GFX_event_normal_frame_religion

    trigger = { society_member_of = secret_religious_cult }

    is_triggered_only = yes

    #Attempt to recruit them
    option = { 
        name = EVTOPTA_MNM_3411
        custom_tooltip = { text = EVTOPTA_MNM_3411_TT }

        #Recruitment
        hidden_effect = {
        	save_event_target_as = secret_religion_recruiter
        	event_target:secret_religion_inductee = { 
        		character_event = { id = MNM.3420 days = 14 }
        		add_character_modifier = {
					name = secret_religions_recruitment_timer
					years = 5
					hidden = yes
				}
        	}
        }        

        ai_chance = {
        	factor = 5
        	modifier = { event_target:secret_religion_inductee = { is_ruler = yes } factor = 20 }
        	modifier = { event_target:secret_religion_inductee = { diplomacy = 12 } factor = 5 }
        	modifier = { event_target:secret_religion_inductee = { diplomacy = 15 } factor = 4 }
            modifier = {
                factor = 0 # don't recruit characters interested in something else
                event_target:secret_religion_inductee = { ai = no }
                event_target:secret_religion_inductee = { NOT = { interested_in_society = secret_religious_cult } }
                event_target:secret_religion_inductee = { is_interested_in_any_society = yes }
            }
        }
    }

    #Good
    option = { 
        name = EVTOPTB_MNM_3411

        ai_chance = { factor = 10 }
    }

    after = {
    	event_target:secret_religion_inductee = {
    		tooltip = { set_secret_religion = event_target:secret_religion_inductor }
    		if = {
    			limit = { 
	        		ROOT = { has_quest = quest_secret_religious_societies_induct_ruler }
	        		is_quest_target_of = ROOT
	        	}
	        	ROOT = { 
                    clr_quest = quest_secret_religious_societies_induct_ruler 
                    add_society_currency_major_effect = yes
                }
    		}
    	}
    }
}


#Fail: Inductee hid/didn't read book
character_event = {
    id = MNM.3413
    desc = EVTDESC_MNM_3413
    picture = GFX_evt_uncomfortable
    border = GFX_event_normal_frame_religion

    trigger = { society_member_of = secret_religious_cult }

    is_triggered_only = yes

    option = { 
        name = EVTOPTA_MNM_3412

        if = {
        	limit = { 
        		has_quest = quest_secret_religious_societies_induct_ruler 
        		FROM = { is_quest_target_of = ROOT }
        	}
        	clr_quest = { id = quest_secret_religious_societies_induct_ruler failure = yes }
        }
    }
}

# openly_adopt_faith - Convert cultists
character_event = {
	id = MNM.3800
	desc = EVTDESC_MNM_3800
    picture = GFX_evt_society_joining
    border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	immediate = {
		set_character_flag = currently_part_of_secret_religion_uncovering
	}
	
	option = {
		name = EVTOPTA_MNM_3800
        if = { # Caliphates and Fylkirates are forfeit
            limit = {
                OR = {
                    religion_group = muslim
                    religion = norse_pagan_reformed
                }
                any_demesne_title = {
                    controls_religion = yes
                }
            }
            any_demesne_title = {
                limit = {
                    controls_religion = yes
                }
                emf_destroy_title_unsafe_effect = yes
            }
        }
        if = { # Papacies are given to a random new character
            limit = {
                NOR = {
                    religion_group = muslim
                    religion = norse_pagan_reformed
                }
                any_demesne_title = {
                    controls_religion = yes
                }
            }
            hidden_tooltip = {
                liege = {
                    save_event_target_as = liege_target
                }
                create_character = {
                    age = 38
                    dynasty = random
                    religion = ROOT
                    culture = ROOT
                    random_traits = yes
                }
                new_character = {
                    save_event_target_as = new_holder
                }
            }
            any_demesne_title = {
                limit = {
                    controls_religion = yes
                }
                grant_title = event_target:new_holder
                holder_scope = {
                    any_vassal = {
                        set_defacto_liege = event_target:liege_target
                    }
                }
            }
            hidden_tooltip = {
                set_defacto_liege = event_target:liege_target
            }
        }
        if = { # Holy Orders/Static Mercs are given to a random new character
            limit = {
                any_demesne_title = {
                    OR = {
                        holy_order = yes
                        mercenary = yes
                    }
                }
            }
            hidden_tooltip = {
                liege = {
                    save_event_target_as = liege_target
                }
                create_character = {
                    age = 38
                    dynasty = random
                    religion = ROOT
                    culture = ROOT
                    random_traits = yes
                }
                new_character = {
                    save_event_target_as = new_holder
                }
            }
            any_demesne_title = {
                limit = {
                    OR = {
                        holy_order = yes
                        mercenary = yes
                    }
                }
                grant_title = event_target:new_holder
                holder_scope = {
                    any_vassal = {
                        set_defacto_liege = event_target:liege_target
                    }
                }
            }
            hidden_tooltip = {
                set_defacto_liege = event_target:liege_target
            }
        }
		flip_to_secret_religion_effect = yes
		leave_society = yes
        if = {
            limit = { ai = yes }
            set_character_flag = ai_flag_refuse_conversion
        }
	}
}

# openly_adopt_faith - Allow sympathisers the chance to flip
character_event = {
	id = MNM.3810
	desc = EVTDESC_MNM_3810
    picture = GFX_evt_society_joining
    border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	trigger = {
		OR = {
			ai = yes
			is_nomadic = yes
			NOR = {
				AND = {
					FROM = { 
                        emf_sr_does_cult_need_SoI = yes
					}
					NOT = { has_dlc = "The Sword of Islam" }
				}
				AND = {
					FROM = { 
                        emf_sr_does_cult_need_SoA = yes
					}
					NOT = { has_dlc = "Sons of Abraham" }
				}
				AND = {
					FROM = { 
                        emf_sr_does_cult_need_TOG = yes
					}
					NOT = { has_dlc = "The Old Gods" }
				}
				AND = {
					FROM = { 
                        emf_sr_does_cult_need_RoI = yes
					}
					NOT = { has_dlc = "Rajas of India" }
				}
			}
		}
	}
	
	immediate = {
		FROM = {
            emf_sr_set_adopt_faith_flag_of_my_cult_on_ROOT = yes
        }
	}
	
	option = {
		name = EVTOPTA_MNM_3810 
		ai_chance = {
			factor = 20
			modifier = {
				factor = 1.3
				FROM = {
					diplomacy = 7
				}
			}
			modifier = {
				factor = 1.3
				FROM = {
					diplomacy = 10
				}
			}
			modifier = {
				factor = 1.3
				FROM = {
					diplomacy = 13
				}
			}
			modifier = {
				factor = 1.25
				FROM = {
					diplomacy = 15
				}
			}
			modifier = {
				factor = 1.25
				FROM = {
					diplomacy = 17
				}
			}
			modifier = {
				factor = 1.2
				FROM = {
					diplomacy = 19
				}
			}
			modifier = {
				factor = 1.2
				FROM = {
					diplomacy = 21
				}
			}
			modifier = {
				factor = 1.2
				FROM = {
					diplomacy = 23
				}
			}
			modifier = {
				factor = 1.2
				FROM = {
					diplomacy = 25
				}
			}
		}
        if = { # Caliphates and Fylkirates are forfeit
            limit = {
                OR = {
                    religion_group = muslim
                    religion = norse_pagan_reformed
                }
                any_demesne_title = {
                    controls_religion = yes
                }
            }
            any_demesne_title = {
                limit = {
                    controls_religion = yes
                }
                emf_destroy_title_unsafe_effect = yes
            }
        }
        if = { # Papacies are given to a random new character
            limit = {
                NOR = {
                    religion_group = muslim
                    religion = norse_pagan_reformed
                }
                any_demesne_title = {
                    controls_religion = yes
                }
            }
            hidden_tooltip = {
                liege = {
                    save_event_target_as = liege_target
                }
                create_character = {
                    age = 38
                    dynasty = random
                    religion = ROOT
                    culture = ROOT
                    random_traits = yes
                }
                new_character = {
                    save_event_target_as = new_holder
                }
            }
            any_demesne_title = {
                limit = {
                    controls_religion = yes
                }
                grant_title = event_target:new_holder
                holder_scope = {
                    any_vassal = {
                        set_defacto_liege = event_target:liege_target
                    }
                }
            }
            hidden_tooltip = {
                set_defacto_liege = event_target:liege_target
            }
        }
        if = { # Holy Orders/Static Mercs are given to a random new character
            limit = {
                any_demesne_title = {
                    OR = {
                        holy_order = yes
                        mercenary = yes
                    }
                }
            }
            hidden_tooltip = {
                liege = {
                    save_event_target_as = liege_target
                }
                create_character = {
                    age = 38
                    dynasty = random
                    religion = ROOT
                    culture = ROOT
                    random_traits = yes
                }
                new_character = {
                    save_event_target_as = new_holder
                }
            }
            any_demesne_title = {
                limit = {
                    OR = {
                        holy_order = yes
                        mercenary = yes
                    }
                }
                grant_title = event_target:new_holder
                holder_scope = {
                    any_vassal = {
                        set_defacto_liege = event_target:liege_target
                    }
                }
            }
            hidden_tooltip = {
                set_defacto_liege = event_target:liege_target
            }
        }
		emf_sr_adopt_faith_from_flag = yes
		clear_secret_religion = yes
        if = {
            limit = { ai = yes }
            set_character_flag = ai_flag_refuse_conversion
        }
	}
	
	option = {
		name = EVTOPTB_MNM_3810
		ai_chance = {
			factor = 80
			modifier = {
				factor = 0.05
				FROM = {
					ROOT = {
						has_prevs_secret_religion_truly_trigger = yes
					}
				}
			}
		}
	}
	
	after = {
		set_character_flag = currently_part_of_secret_religion_uncovering
		
		emf_sr_clr_adopt_faith_flag = yes
	}
}

character_event = { # Openly Adopt Faith event (for the character who actually fires all of it)
    id = MNM.3811
    desc = EVTDESC_MNM_3811
    picture = GFX_evt_dark_prayer
    border = GFX_event_normal_frame_religion
    is_triggered_only = yes
    
    option = {      
        name = EVTOPTA_MNM_3811
        custom_tooltip = { text = EVTOPTA_MNM_3811_TT }
		add_character_modifier = {
			modifier = devout_leader
			duration = -1
		}
        if = {
            limit = { ai = yes }
            set_character_flag = ai_flag_refuse_conversion
        }
    }
}


# openly_adopt_faith - Flip provinces with local cult modifier
character_event = {
	id = MNM.3820
	desc = EVTDESC_MNM_3820
    picture = GFX_evt_society_joining
    border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	immediate = {
		FROM = {
            emf_sr_set_prov_flip_char_flag_of_my_cult_on_ROOT = yes
		}
	}
	
	option = {
		name = EVTOPTA_MNM_3820
        
		emf_sr_flip_secret_community_provinces_by_prov_flip_char_flag = yes
	}
}

# openly_adopt_faith - Inform lieges unless they're part of the cult flipping
character_event = {
	id = MNM.3830
	desc = EVTDESC_MNM_3830
    picture = GFX_evt_society_joining
    border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	trigger = {
		NOT = { has_character_flag = currently_part_of_secret_religion_uncovering }
	}
	
	option = {
		name = EVTOPTA_MNM_3830
	}
}

###INTERACTIONS###

#Interaction: I am so stressed
character_event = {
    id = MNM.3500
    hide_window = yes
    is_triggered_only = yes

    min_age = 16
    only_playable = yes
    only_capable = yes
    prisoner = no
   
    trigger = {
        OR = {
            trait = stressed
            trait = depressed
        }
        society_member_of = secret_religious_cult

        society = {
            any_society_member = {
                ai = yes
                block_general_event_trigger = no
                opinion = { who = ROOT value = 20 }
                reverse_opinion = { who = ROOT value = 20 }
                NOT = { has_opinion_modifier = { who = ROOT modifier = opinion_distressing_encounter } }
                NOT = { is_lover = ROOT }
                OR = {
                    is_friend = ROOT 
                    AND = {
                        root_attraction_trigger = yes
                        NOT = { is_close_relative = ROOT }
                    }
                }
            }
        }
    }

    immediate = {
        society = {
            random_society_member = {
                limit = {
                    ai = yes
                    block_general_event_trigger = no
                    opinion = { who = ROOT value = 20 }
                    reverse_opinion = { who = ROOT value = 20 }
                    NOT = { has_opinion_modifier = { who = ROOT modifier = opinion_distressing_encounter } }
                    NOT = { is_lover = ROOT }
                    OR = {
                        is_friend = ROOT 
                        AND = {
                            root_attraction_trigger = yes
                            NOT = { is_close_relative = ROOT }
                        }
                    }
                    is_within_diplo_range = ROOT
                }
                save_event_target_as = supportive_sr_member
            }
            random_society_member = {
                limit = {
                    ai = yes
                    block_general_event_trigger = no
                    opinion = { who = ROOT value = 20 }
                    reverse_opinion = { who = ROOT value = 20 }
                    NOT = { has_opinion_modifier = { who = ROOT modifier = opinion_distressing_encounter } }
                    NOT = { is_lover = ROOT }
                    OR = {
                        is_friend = ROOT 
                        AND = {
                            root_attraction_trigger = yes
                            NOT = { is_close_relative = ROOT }
                        }
                    }
                    same_realm = ROOT
                }
                save_event_target_as = supportive_sr_member
            }
            random_society_member = {
                limit = {
                    ai = yes
                    block_general_event_trigger = no
                    opinion = { who = ROOT value = 20 }
                    reverse_opinion = { who = ROOT value = 20 }
                    NOT = { has_opinion_modifier = { who = ROOT modifier = opinion_distressing_encounter } }
                    NOT = { is_lover = ROOT }
                    OR = {
                        is_friend = ROOT 
                        AND = {
                            root_attraction_trigger = yes
                            NOT = { is_close_relative = ROOT }
                        }
                    }
                    at_location = ROOT
                }
                save_event_target_as = supportive_sr_member
            }
        }
        event_target:supportive_sr_member = { character_event = { id = MNM.3501 } }
    }
}


character_event = {
    id = MNM.3501
    hide_window = yes
    is_triggered_only = yes
    immediate = { FROM = { character_event = { id = MNM.3502 } } }
}   

#I am stessed, do I find support?
character_event = {
    id = MNM.3502
    desc = EVTDESC_MNM_3502
    picture = GFX_evt_secret_ceremony
    border = GFX_event_normal_frame_diplomacy

    trigger = { society_member_of = secret_religious_cult }

    is_triggered_only = yes

    #Friend
    option = { 
        trigger = { NOT = { is_friend = FROM } }
        name = EVTOPTA_MNM_3502
        add_friend = FROM

        ai_chance = { factor = 100 }
    }

    #Lover?
    option = {
        trigger = {
            FROM = { root_attraction_trigger = yes }
            NOT = { is_close_relative = FROM }
        }
        name = EVTOPTB_MNM_3502
        custom_tooltip = { text = EVTOPTB_MNM_3502_TT }

        hidden_effect = { FROM = { character_event = { id = MNM.6906 days = 3 } } }

        ai_chance = {
            factor = 10
            modifier = {
                factor = 10
                OR = {
                    trait = lustful
                    trait = seducer
                    trait = seductress
                    trait = gregarious
                    trait = socializer
                }
            }
            modifier = {
                factor = 5
                FROM = { has_attractive_trait_trigger = yes }
            }
        }
    }
    
    #Not lover
    option = {
        trigger = {
            FROM = { root_attraction_trigger = yes }
            NOT = { is_close_relative = FROM }
            is_friend = FROM
        }

        name = EVTOPTA_MNM_3502
        custom_tooltip = { text = EVTOPTC_MNM_3502_TT }

        ai_chance = { factor = 100 }
    }
    
    after = {
        if = {
            limit = { trait = stressed }
            remove_trait = stressed
        }
        if = {
            limit = { trait = depressed }
            remove_trait = depressed
        }
        if = {
            limit = { FROM = { trait = stressed } }
            remove_trait = stressed
        }
        if = {
            limit = { FROM = { trait = depressed } }
            remove_trait = depressed
        }
    }
}

#Interaction: Get help from another member with problematic trait
character_event = {
    id =  MNM.3505
    hide_window = yes

    is_triggered_only = yes

    min_age = 16
    only_playable = yes
    only_capable = yes
    prisoner = no

    trigger = {
        society_member_of = secret_religious_cult
        check_variable = { which = visibility_value value = 1 }
        block_general_event_trigger = no
        OR = {
            trait = honest
            trait = slothful
            trait = wroth
            trait = trusting
            NOT = { intrigue = 8 }
        }
    }

    immediate = {
        clr_character_flag = sr_too_honest
        clr_character_flag = sr_too_wroth
        clr_character_flag = sr_too_slothful
        clr_character_flag = sr_too_trusting
        clr_character_flag = sr_too_indiscreet

        random_list = {
            20 = { #Root is too honest
                modifier = {
                    factor = 0
                    NAND = {
                        trait = honest
                        society = {
                            any_society_member = {
                                block_general_event_trigger = no 
                                NOT = { trait = honest }  
                            }
                        }
                    }
                }
                set_character_flag = sr_too_honest

                society = {
                    random_society_member = {
                        limit = {
                            block_general_event_trigger = no 
                            NOT = { trait = honest }  
                        }
                        character_event = { id = MNM.3506 days = 3 }
                    }
                }
            }
            20 = { #Root is too slothful
                modifier = {
                    factor = 0
                    NAND = {
                        trait = slothful
                        society = {
                            any_society_member = {
                                block_general_event_trigger = no 
                                NOT = { trait = slothful }  
                            }
                        }
                    }
                }
                set_character_flag = sr_too_slothful

                society = {
                    random_society_member = {
                        limit = {
                            block_general_event_trigger = no 
                            NOT = { trait = slothful }  
                        }
                        character_event = { id = MNM.3506 days = 3 }
                    }
                }
            }
            20 = { #Root is too wroth
                modifier = {
                    factor = 0
                    NAND = {
                        trait = wroth
                        society = {
                            any_society_member = {
                                block_general_event_trigger = no 
                                NOT = { trait = wroth }  
                            }
                        }
                    }
                }
                set_character_flag = sr_too_wroth

                society = {
                    random_society_member = {
                        limit = {
                            block_general_event_trigger = no 
                            NOT = { trait = wroth }  
                        }
                        character_event = { id = MNM.3506 days = 3 }
                    }
                }
            }
            20 = { #Root is too trusting
                modifier = {
                    factor = 0
                    NAND = {
                        trait = trusting
                        society = {
                            any_society_member = {
                                block_general_event_trigger = no 
                                NOT = { trait = trusting }  
                            }
                        }
                    }
                }
                set_character_flag = sr_too_trusting

                society = {
                    random_society_member = {
                        limit = {
                            block_general_event_trigger = no 
                            NOT = { trait = trusting }  
                        }
                        character_event = { id = MNM.3506 days = 3 }
                    }
                }
            }
            20 = { #Root is too indiscreet
                modifier = {
                    factor = 0
                    NAND = {
                        intrigue = 8
                        society = {
                            any_society_member = {
                                block_general_event_trigger = no 
                                intrigue = 12
                            }
                        }
                    }
                }
                set_character_flag = sr_too_indiscreet

                society = {
                    random_society_member = {
                        limit = {
                            block_general_event_trigger = no 
                            intrigue = 12  
                        }
                        character_event = { id = MNM.3506 days = 3 }
                    }
                }
            }
        }
    }
}

#This person is too suspicious, what do?
character_event = {
    id = MNM.3506
    picture = GFX_evt_catching_heretic
    border = GFX_event_normal_frame_diplomacy

    trigger = { society_member_of = secret_religious_cult }

    desc = {
        trigger = { FROM = { has_character_flag = sr_too_honest } }
        text = EVTDESC_MNM_3506_A
    }
    desc = {
        trigger = { FROM = { has_character_flag = sr_too_wroth } }
        text = EVTDESC_MNM_3506_B
    }
    desc = {
        trigger = { FROM = { has_character_flag = sr_too_slothful } }
        text = EVTDESC_MNM_3506_C
    }
    desc = {
        trigger = { FROM = { has_character_flag = sr_too_trusting } }
        text = EVTDESC_MNM_3506_D
    }
    desc = {
        trigger = { FROM = { has_character_flag = sr_too_indiscreet } }
        text = EVTDESC_MNM_3506_E
    }

    is_triggered_only = yes

    immediate = {
        clr_character_flag = free_help
        clr_character_flag = help_for_cost      
    }

    #Offer help freely
    option = { 
        name = EVTOPTA_MNM_3506
        custom_tooltip = { text = EVTOPTA_MNM_3506_TT }

        hidden_effect = {
            set_character_flag = free_help
            FROM = { character_event = { id = MNM.3507 } }
        }

        ai_chance = { 
            factor = 1 
            modifier = {
                factor = 3
                OR = {
                    trait = content
                    is_benevolent_trigger = yes
                    opinion = { who = FROM value = 50 }
                }
            }
        }
    }

    #Offer help for a cost
    option = {
        trigger = { FROM = { has_society_currency_minor_trigger = yes } }
        name = EVTOPTB_MNM_3506
        custom_tooltip = { text = EVTOPTB_MNM_3506_TT }

        hidden_effect = {
            set_character_flag = help_for_cost
            FROM = { character_event = { id = MNM.3507 } }
        }

        ai_chance = { 
            factor = 1 
            modifier = {
                factor = 3
                OR = {
                    trait = ambitious
                    trait = greedy
                    is_evil_trigger = yes
                    intrigue = 15
                }
            }
        }
    }

    #Do not help
    option = {
        name = EVTOPTC_MNM_3506
        custom_tooltip = { text = EVTOPTC_MNM_3506_TT }         

        ai_chance = { factor = 0 }

        hidden_effect = {
           FROM = {
                clr_character_flag = sr_too_honest
                clr_character_flag = sr_too_wroth
                clr_character_flag = sr_too_slothful
                clr_character_flag = sr_too_trusting
                clr_character_flag = sr_too_indiscreet
            } 
        }
    }
}

#I am offered help to hide my true religion
character_event = {     
    id = MNM.3507
    picture = GFX_evt_shady_meeting
    border = GFX_event_normal_frame_diplomacy

    is_triggered_only = yes

    trigger = { society_member_of = secret_religious_cult }

    desc = {
        trigger = { has_character_flag = sr_too_honest }
        text = EVTDESC_MNM_3507_A
    }
    desc = {
        trigger = { has_character_flag = sr_too_wroth }
        text = EVTDESC_MNM_3507_B
    }
    desc = {
        trigger = { has_character_flag = sr_too_slothful }
        text = EVTDESC_MNM_3507_C
    }
    desc = {
        trigger = { has_character_flag = sr_too_trusting }
        text = EVTDESC_MNM_3507_D
    }
    desc = {
        trigger = { has_character_flag = sr_too_indiscreet }
        text = EVTDESC_MNM_3507_E
    }

    option = { 
        trigger = { FROM = { has_character_flag = free_help } }
        name = EVTOPTA_MNM_3507
        custom_tooltip = { text = EVTOPTA_MNM_3507_TT }

        random_list = {
            50 = {
                modifier = { FROM = { intrigue = 12 } factor = 1.2 }
                modifier = { FROM = { intrigue = 14 } factor = 1.2 }
                modifier = { FROM = { intrigue = 16 } factor = 1.2 }
                modifier = { FROM = { intrigue = 18 } factor = 1.2 }
                modifier = { FROM = { intrigue = 20 } factor = 1.2 }

                custom_tooltip = { text = EVTOPT_MNM_3507_SUCCESS_TT }
                hidden_effect = { FROM = { character_event = { id = MNM.3508 days = 21 } } }

                tooltip = {
                    trigger_switch = {
                        on_trigger = has_character_flag 
                        sr_too_honest       = { remove_trait = honest }
                        sr_too_wroth        = { remove_trait = wroth }
                        sr_too_slothful     = { remove_trait = slothful }
                        sr_too_trusting     = { remove_trait = trusting }
                        sr_too_indiscreet   = { change_intrigue = 2 }
                    }
                }
            }
            50 = {
                custom_tooltip = { text = EVTOPT_MNM_3507_FAIL_TT }
                hidden_effect = { FROM = { character_event = { id = MNM.3509 days = 21 } } }
            }
        }

        reverse_opinion = {
            who = FROM
            modifier = opinion_took_my_advice
            years = 5
        }

        ai_chance = {
            factor = 10
            modifier = { FROM = { intrigue = 12 } factor = 1.2 }
            modifier = { FROM = { intrigue = 14 } factor = 1.2 }
            modifier = { FROM = { intrigue = 16 } factor = 1.2 }
            modifier = { FROM = { intrigue = 18 } factor = 1.2 }
            modifier = { FROM = { intrigue = 20 } factor = 1.2 }
        }
    }

    option = {
        trigger = { FROM = { has_character_flag = help_for_cost } }
        name = EVTOPTB_MNM_3507
        custom_tooltip = { text = EVTOPTB_MNM_3507_TT }

        detract_society_currency_minor_effect = yes

        random_list = {
            50 = {
                modifier = { FROM = { intrigue = 12 } factor = 1.2 }
                modifier = { FROM = { intrigue = 14 } factor = 1.2 }
                modifier = { FROM = { intrigue = 16 } factor = 1.2 }
                modifier = { FROM = { intrigue = 18 } factor = 1.2 }
                modifier = { FROM = { intrigue = 20 } factor = 1.2 }

                custom_tooltip = { text = EVTOPT_MNM_3507_SUCCESS_TT }
                hidden_effect = { FROM = { character_event = { id = MNM.3508 days = 21 } } }

                tooltip = {
                    trigger_switch = {
                        on_trigger = has_character_flag 
                        sr_too_honest       = { remove_trait = honest }
                        sr_too_wroth        = { remove_trait = wroth }
                        sr_too_slothful     = { remove_trait = slothful }
                        sr_too_trusting     = { remove_trait = trusting }
                        sr_too_indiscreet   = { change_intrigue = 2 }
                    }
                }
            }
            50 = {
                custom_tooltip = { text = EVTOPT_MNM_3507_FAIL_TT }
                hidden_effect = { FROM = { character_event = { id = MNM.3509 days = 21 } } }
            }
        }

        reverse_opinion = {
            who = FROM
            modifier = opinion_took_my_advice
            years = 5
        }

        ai_chance = {
            factor = 10
            modifier = { FROM = { intrigue = 12 } factor = 1.2 }
            modifier = { FROM = { intrigue = 14 } factor = 1.2 }
            modifier = { FROM = { intrigue = 16 } factor = 1.2 }
            modifier = { FROM = { intrigue = 18 } factor = 1.2 }
            modifier = { FROM = { intrigue = 20 } factor = 1.2 }
        }
    }
    
    option = {
        name = EVTOPTC_MNM_3507

        hidden_effect = { FROM = { character_event = { id = MNM.3510 days = 7 } } }

        reverse_opinion = {
            who = FROM
            modifier = opinion_did_not_take_my_advice
            years = 5
        }

        ai_chance = {
            factor = 5
        }
    }
}

#Successful help - giver
character_event = {
    id = MNM.3508
    desc = EVTDESC_MNM_3508
    picture = GFX_evt_shady_meeting
    border = GFX_event_normal_frame_diplomacy

    trigger = { society_member_of = secret_religious_cult }

    is_triggered_only = yes

    option = { 
        name = EXCELLENT
        custom_tooltip = { text = EVTOPTA_MNM_3508_TT }

        if = {
            limit = { has_character_flag = help_for_cost }
            add_society_currency_medium_effect = yes
        }

        tooltip = {
            FROM  = {
                trigger_switch = {
                    on_trigger = has_character_flag 
                    sr_too_honest       = { remove_trait = honest }
                    sr_too_wroth        = { remove_trait = wroth }
                    sr_too_slothful     = { remove_trait = slothful }
                    sr_too_trusting     = { remove_trait = trusting }
                    sr_too_indiscreet   = { change_intrigue = 2 }
                }
            }
        }

        hidden_effect = {
            clr_character_flag = free_help
            clr_character_flag = help_for_cost
            FROM  = { character_event = { id = MNM.3511 } }
        }
    }
}

#Unsuccessful help - giver
character_event = {
    id = MNM.3509
    desc = EVTDESC_MNM_3509
    picture = GFX_evt_uncomfortable
    border = GFX_event_normal_frame_diplomacy

    trigger = { society_member_of = secret_religious_cult }

    is_triggered_only = yes
    
    option = { 
        name = EVTOPTA_MNM_3509

        if = {
            limit = { has_character_flag = help_for_cost }
            add_society_currency_medium_effect = yes
        }

        hidden_effect = {
            clr_character_flag = free_help
            clr_character_flag = help_for_cost
            FROM  = { character_event = { id = MNM.3512 } }
        }
    }
}

#They didn't want my help 
character_event = {
    id = MNM.3510
    desc = EVTDESC_MNM_3510
    picture = GFX_evt_uncomfortable
    border = GFX_event_normal_frame_diplomacy

    trigger = { society_member_of = secret_religious_cult }

    is_triggered_only = yes
    
    option = { 
        name = EVTOPTA_MNM_3509

        opinion = {
            who = FROM
            modifier = opinion_did_not_take_my_advice
            years = 5
        }

        hidden_effect = { 
            clr_character_flag = free_help
            clr_character_flag = help_for_cost
            FROM = {
                clr_character_flag = sr_too_honest
                clr_character_flag = sr_too_wroth
                clr_character_flag = sr_too_slothful
                clr_character_flag = sr_too_trusting
                clr_character_flag = sr_too_indiscreet
            }
        }
    }
}

#Successful help - receiver
character_event = {
    id = MNM.3511
    desc = EVTDESC_MNM_3511
    picture = GFX_evt_secret_ceremony
    border = GFX_event_normal_frame_diplomacy

    trigger = { society_member_of = secret_religious_cult }

    is_triggered_only = yes

    option = { 
        name = EVTOPTA_MNM_3511
        custom_tooltip = { text = EVTOPTA_MNM_3511_TT }

        trigger_switch = {
            on_trigger = has_character_flag 
            sr_too_honest       = { remove_trait = honest }
            sr_too_wroth        = { remove_trait = wroth }
            sr_too_slothful     = { remove_trait = slothful }
            sr_too_trusting     = { remove_trait = trusting }
            sr_too_indiscreet   = { change_intrigue = 2 }
        }

        hidden_effect = {
            decrease_visibility_effect = yes
            clr_character_flag = sr_too_honest
            clr_character_flag = sr_too_wroth
            clr_character_flag = sr_too_slothful
            clr_character_flag = sr_too_trusting
            clr_character_flag = sr_too_indiscreet
        }
    }
}


#Unsuccessful help - receiver
character_event = {
    id = MNM.3512
    desc = EVTDESC_MNM_3512
    picture = GFX_evt_uncomfortable
    border = GFX_event_normal_frame_diplomacy

    trigger = { society_member_of = secret_religious_cult }

    is_triggered_only = yes
    
    option = { 
        name = EVTOPTA_MNM_3512

        hidden_effect = {
            clr_character_flag = sr_too_honest
            clr_character_flag = sr_too_wroth
            clr_character_flag = sr_too_slothful
            clr_character_flag = sr_too_trusting
            clr_character_flag = sr_too_indiscreet
        }
    }
}



###MISC###

#Misc: convert child to secret religion
#Ping event from child
character_event = {
	id = MNM.3429
	hide_window = yes
	
	is_triggered_only = yes

	trigger = {
		OR = {
			AND = {
				educator = { 
					has_secret_religion_trait_trigger = yes 
					NOT = { society_member_of = secret_religious_cult }
					any_ward = { character = PREV }
				}
			}
			guardian = { 
				has_secret_religion_trait_trigger = yes 
				NOT = { society_member_of = secret_religious_cult }
			}
			mother = { 
				has_secret_religion_trait_trigger = yes 
				NOT = { society_member_of = secret_religious_cult }
			}
			father = { 
				has_secret_religion_trait_trigger = yes 
				NOT = { society_member_of = secret_religious_cult }
			}
		}
	}

	immediate = {
		educator = {
			if = {
				limit = { has_secret_religion_trait_trigger = yes }
				save_event_target_as = secret_religion_influencer
				break = yes
			}
		}

		guardian = {
			if = {
				limit = { has_secret_religion_trait_trigger = yes }
				save_event_target_as = secret_religion_influencer
				break = yes
			}
		}

		mother = {
			if = {
				limit = { 
					has_secret_religion_trait_trigger = yes 
					is_playable = yes
					is_liege_of = ROOT
				}
				save_event_target_as = secret_religion_influencer
				break = yes
			}
		}

		father = {
			if = {
				limit = { 
					has_secret_religion_trait_trigger = yes 
					is_playable = yes
					is_liege_of = ROOT
				}
				save_event_target_as = secret_religion_influencer
				break = yes
			}
		}

		mother = {
			if = {
				limit = { 
					has_secret_religion_trait_trigger = yes 
					is_liege_of = ROOT
				}
				save_event_target_as = secret_religion_influencer
				break = yes
			}
		}

		father = {
			if = {
				limit = { 
					has_secret_religion_trait_trigger = yes 
					is_liege_of = ROOT
				}
				save_event_target_as = secret_religion_influencer
				break = yes
			}
		}
	}
	
	option = {
		event_target:secret_religion_influencer = { character_event = { id = MNM.3430 days = 3 random = 9 } } #todo days
	}
}

#Should I read my holy scripture to child?
character_event = {
    id = MNM.3430
    desc = EVTDESC_MNM_3430
    picture = GFX_evt_secluded_in_prayer
    border = GFX_event_normal_frame_religion

    is_triggered_only = yes
    
    trigger = {
    	has_secret_religion_trait_trigger = yes
    	FROM = { 
    		has_secret_religion_trait_trigger = no 
    		has_prevs_secret_religion_truly_trigger = no
    	}
    }

    immediate = {
    
    }

    #Yes
    option = { 
        name = EVTOPTA_MNM_3430
        custom_tooltip = { text = EVTOPTA_MNM_3430_TT }

        hidden_effect = {
        	save_event_target_as = secret_religion_inductor
        	FROM = {
        		character_event = { id = MNM.3431 days = 1 }
        	}
        }
        ai_chance = { 
        	factor = 100 
        	modifier = { trait = brave factor = 3 }
        }
    }

    #No
    option = {
        name = EVTOPTB_MNM_3430
        custom_tooltip = { text = EVTOPTB_MNM_3430_TT }

        ai_chance = { 
        	factor = 20 
        	modifier = { trait = craven factor = 5 }
        	modifier = { trait = paranoid factor = 5 }
        	modifier = { trait = arbitrary factor = 5 }
        }
    }
}

#Child gets holy scripture read to them, do they like it?
character_event = { 
    id = MNM.3431
    picture = GFX_evt_secluded_in_prayer
    border = GFX_event_normal_frame_religion

    desc = {
    	trigger = { FROM = { shares_true_religion_group_with_prev_trigger = no } }
    	text = EVTDESC_MNM_3431_A
    }
    desc = {
    	trigger = { FROM = { shares_true_religion_group_with_prev_trigger = yes } }
    	text = EVTDESC_MNM_3431_B
    }

    is_triggered_only = yes
 
 	#tell me more
   	option = {
        name = EVTOPTC_MNM_3431

        FROM = { ROOT = { add_prevs_secret_religion_trait_effect = yes } }

        hidden_effect = { FROM = { character_event = { id = MNM.3432 days = 14 } } }

        ai_chance = {
        	factor = 20
        	modifier = { mother = { character = FROM } factor = 1.6 }
			modifier = { father = { character = FROM } factor = 1.6 }
			modifier = { opinion = { who = FROM value = 30 } factor = 1.5 }
			modifier = { opinion = { who = FROM value = 50 } factor = 1.5 }
			modifier = { opinion = { who = FROM value = 70 } factor = 1.6 }
			modifier = { OR = { trait = trusting trait = affectionate } factor = 2 }
			modifier = { OR = { trait = craven trait = timid } factor = 1.5 }
			modifier = { FROM = { diplomacy = 10 } factor = 1.2 }
			modifier = { FROM = { diplomacy = 12 } factor = 1.2 }
			modifier = { FROM = { diplomacy = 14 } factor = 1.2 }
			modifier = { FROM = { diplomacy = 16 } factor = 1.2 }
			modifier = { FROM = { diplomacy = 18 } factor = 1.2 }
        }
    }

    #interesting
    option = { 
    	trigger = { #Can get sympathy
    		FROM = { ROOT = { has_sympathy_for_true_religion_of_prev_trigger = no } }
    		FROM = { shares_true_religion_group_with_prev_trigger = no }
    	}
        name = EVTOPTA_MNM_3431
        
        FROM = { ROOT = { add_sympathy_for_prevs_true_religion_effect = yes } }
        
        hidden_effect = { FROM = { character_event = { id = MNM.3433 days = 14 } } }

        ai_chance = {
        	factor = 40
        	modifier = { mother = { character = FROM } factor = 1.4 }
			modifier = { father = { character = FROM } factor = 1.4 }
			modifier = { opinion = { who = FROM value = 30 } factor = 1.2 }
			modifier = { opinion = { who = FROM value = 50 } factor = 1.2 }
			modifier = { opinion = { who = FROM value = 70 } factor = 1.2 }
			modifier = { OR = { trait = trusting trait = affectionate } factor = 2 }
			modifier = { OR = { trait = craven trait = timid } factor = 1.5 }
			modifier = { FROM = { diplomacy = 10 } factor = 1.1 }
			modifier = { FROM = { diplomacy = 12 } factor = 1.1 }
			modifier = { FROM = { diplomacy = 14 } factor = 1.1 }
			modifier = { FROM = { diplomacy = 16 } factor = 1.1 }
			modifier = { FROM = { diplomacy = 18 } factor = 1.1 }
        }
    }

    #this is stupid!
    option = {
        name = EVTOPTB_MNM_3431

        hidden_effect = { FROM = { character_event = { id = MNM.3434 days = 14 } } }

        ai_chance = {
        	factor = 40
        	modifier = { NOT = { opinion = { who = FROM value = 0 } } factor = 1.5 }
			modifier = { NOT = { opinion = { who = FROM value = -20 } } factor = 1.5 }
			modifier = { NOT = { opinion = { who = FROM value = -40 } } factor = 1.5 }
			modifier = { OR = { trait = zealous trait = idolizer } factor = 5 }
			modifier = { OR = { trait = willful trait = stubborn } factor = 1.5 }
			modifier = { OR = { trait = cynical trait = curious } factor = 1.5 }
			modifier = { FROM = { NOT = { diplomacy = 8 } } factor = 1.5 }
			modifier = { FROM = { NOT = { diplomacy = 6 } } factor = 1.5 }
        }
    }
}

#They seemed to like the holy scripture!
character_event = {
    id = MNM.3432
    desc = EVTDESC_MNM_3432
    picture = GFX_evt_child_reading
    border = GFX_event_normal_frame_religion

    is_triggered_only = yes

    option = { 
        name = EVTOPTA_MNM_3432
        tooltip = { FROM = { add_prevs_secret_religion_trait_effect = yes } }
    }
}

#They were intrigued by the holy scripture
character_event = {
    id = MNM.3433
    desc = EVTDESC_MNM_3433
    picture = GFX_evt_child_reading
    border = GFX_event_normal_frame_religion

    is_triggered_only = yes

    option = { 
        name = EVTOPTA_MNM_3433
        tooltip = { FROM = { add_sympathy_for_prevs_true_religion_effect = yes } }
    }
}

#They weren't impressed...
character_event = {
    id = MNM.3434
    desc = EVTDESC_MNM_3434
    picture = GFX_evt_child_play
    border = GFX_event_normal_frame_religion

    is_triggered_only = yes

    #Try anyway
    option = { 
    	trigger = {
    		OR = {
    			trait = patient
    			NOT = { has_character_modifier = out_of_patience }
    		}
    	}

        name = EVTOPTA_MNM_3434

        tooltip = {
	        random_list = {
	        	60 = { #Success
	        		modifier = { mother = { character = ROOT } factor = 1.6 }
					modifier = { father = { character = ROOT } factor = 1.6 }
					modifier = { opinion = { who = ROOT value = 30 } factor = 1.5 }
					modifier = { opinion = { who = ROOT value = 50 } factor = 1.5 }
					modifier = { opinion = { who = ROOT value = 70 } factor = 1.6 }
					modifier = { OR = { trait = trusting trait = affectionate } factor = 2 }
					modifier = { OR = { trait = craven trait = timid } factor = 1.5 }
					modifier = { ROOT = { diplomacy = 10 } factor = 1.2 }
					modifier = { ROOT = { diplomacy = 12 } factor = 1.2 }
					modifier = { ROOT = { diplomacy = 14 } factor = 1.2 }
					modifier = { ROOT = { diplomacy = 16 } factor = 1.2 }
					modifier = { ROOT = { diplomacy = 18 } factor = 1.2 }

					FROM = { add_prevs_secret_religion_trait_effect = yes }		
	        	}
	        	40 = { #Fail
	        		modifier = { NOT = { opinion = { who = ROOT value = 0 } } factor = 1.5 }
					modifier = { NOT = { opinion = { who = ROOT value = -20 } } factor = 1.5 }
					modifier = { NOT = { opinion = { who = ROOT value = -40 } } factor = 1.5 }
					modifier = { OR = { trait = zealous trait = idolizer } factor = 5 }
					modifier = { OR = { trait = willful trait = stubborn } factor = 1.5 }
					modifier = { OR = { trait = cynical trait = curious } factor = 1.5 }
					modifier = { ROOT = { NOT = { diplomacy = 8 } } factor = 1.5 }
					modifier = { ROOT = { NOT = { diplomacy = 6 } } factor = 1.5 }

					FROM = {
						if = {
							limit = {
								NOT = { trait = zealous }
								NOT = { has_dlc = Zeus }
							}
							add_trait = zealous
						}
						if = {
							limit = {
								NOT = { trait = idolizer }
								has_dlc = Zeus
							}
							add_trait = idolizer
						}
						add_rival = ROOT
					}
	        	}
	        }
        }

        if = {
        	limit = { NOT = { trait = patient } }
	        add_character_modifier = {
	        	name = out_of_patience 
	        	years = 3
	        }
        }

        hidden_effect = {
        	FROM = { character_event = { id = MNM.3435 days = 1 } }
        }

        ai_chance = { 
        	factor = 20
        	modifier = { any_child = { character = ROOT } factor = 5 }
        	modifier = { current_heir = { character = ROOT } factor = 5 }
        }
    }

    #Let it be
    option = {
    	name = EVTOPTB_MNM_3434

        ai_chance = { 
        	factor = 80
        }
    }
}

#They're trying to force the scripture on me again
character_event = {
    id = MNM.3435
    desc = EVTDESC_MNM_3435
    picture = GFX_evt_child_reading
    border = GFX_event_normal_frame_religion

    is_triggered_only = yes
    
    option = { 
        name = EVTOPTA_MNM_3435

        FROM = { ROOT = { add_prevs_secret_religion_trait_effect = yes } }

        hidden_effect = { FROM = { character_event = { id = MNM.3436 days = 14 } } }

        ai_chance = {
        	factor = 60
        	modifier = { mother = { character = FROM } factor = 1.6 }
			modifier = { father = { character = FROM } factor = 1.6 }
			modifier = { opinion = { who = FROM value = 30 } factor = 1.5 }
			modifier = { opinion = { who = FROM value = 50 } factor = 1.5 }
			modifier = { opinion = { who = FROM value = 70 } factor = 1.6 }
			modifier = { OR = { trait = trusting trait = affectionate } factor = 2 }
			modifier = { OR = { trait = craven trait = timid } factor = 1.5 }
			modifier = { FROM = { diplomacy = 10 } factor = 1.2 }
			modifier = { FROM = { diplomacy = 12 } factor = 1.2 }
			modifier = { FROM = { diplomacy = 14 } factor = 1.2 }
			modifier = { FROM = { diplomacy = 16 } factor = 1.2 }
			modifier = { FROM = { diplomacy = 18 } factor = 1.2 }
        }
    }

    option = {
        name = EVTOPTB_MNM_3435

        if = {
			limit = {
				NOT = { trait = zealous }
				NOT = { has_dlc = Zeus }
			}
			add_trait = zealous
		}
		if = {
			limit = {
				NOT = { trait = idolizer }
				has_dlc = Zeus
			}
			add_trait = idolizer
		}

		add_rival = FROM

		hidden_effect = { FROM = { character_event = { id = MNM.3437 days = 14 } } }

        ai_chance = {
        	factor = 60
        	modifier = { mother = { character = FROM } factor = 1.6 }
			modifier = { father = { character = FROM } factor = 1.6 }
			modifier = { opinion = { who = FROM value = 30 } factor = 1.5 }
			modifier = { opinion = { who = FROM value = 50 } factor = 1.5 }
			modifier = { opinion = { who = FROM value = 70 } factor = 1.6 }
			modifier = { OR = { trait = trusting trait = affectionate } factor = 2 }
			modifier = { OR = { trait = craven trait = timid } factor = 1.5 }
			modifier = { FROM = { diplomacy = 10 } factor = 1.2 }
			modifier = { FROM = { diplomacy = 12 } factor = 1.2 }
			modifier = { FROM = { diplomacy = 14 } factor = 1.2 }
			modifier = { FROM = { diplomacy = 16 } factor = 1.2 }
			modifier = { FROM = { diplomacy = 18 } factor = 1.2 }
        }
    }
}

#It worked out, in the end!
character_event = {
    id = MNM.3436
    desc = EVTDESC_MNM_3436
    picture = GFX_evt_child_reading
    border = GFX_event_normal_frame_religion

    is_triggered_only = yes

    option = { 
        name = EVTOPTA_MNM_3436
        tooltip = { FROM = { add_prevs_secret_religion_trait_effect = yes } }
    }
}

#I failed and now they are zealous
character_event = {
    id = MNM.3437
    desc = EVTDESC_MNM_3437
    picture = GFX_evt_child_sword
    border = GFX_event_normal_frame_religion

    is_triggered_only = yes

    option = { 
        name = EVTOPTA_MNM_3412
        tooltip = {
        	FROM  =	{
        		if = {
					limit = {
						NOT = { trait = zealous }
						NOT = { has_dlc = Zeus }
					}
					add_trait = zealous
				}
				if = {
					limit = {
						NOT = { trait = idolizer }
						has_dlc = Zeus
					}
					add_trait = idolizer
				}

				add_rival = ROOT
        	}
        }
    }
}

#Parent/educator/guardian ping event for the decision
character_event = {
	id = MNM.3438
	hide_window = yes
	is_triggered_only = yes
	immediate = { FROM = { character_event = { id = MNM.3431 } } }
}

# personally_openly_adopt_faith - inform liege
character_event = {
	id = MNM.3840
	desc = EVTDESC_MNM_3840
	picture = GFX_evt_secret_ceremony
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_MNM_3840
	}
}

# prepare_grounds - safety flag clear
character_event = {
	id = MNM.3849
	hide_window = yes
	is_triggered_only = yes
	immediate = { clr_character_flag = preparing_grounds_in_@FROM }
}

# prepare_grounds - Start progress
character_event = {
	id = MNM.3850
	desc = EVTDESC_MNM_3850
	picture = GFX_evt_secret_ceremony
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_MNM_3850
		custom_tooltip = {
			text = EVTTOOLTIP_MNM_3850
			hidden_effect = {
				random_list = {
					20 = {
						modifier = {
							factor = 0.1
							event_target:target_province = {
								holder_scope = {
									NOT = {
										character = ROOT
									}
								}
							}
						}
						modifier = {
							factor = 1.1
							diplomacy = 12
						}
						modifier = {
							factor = 1.1
							diplomacy = 14
						}
						modifier = {
							factor = 1.1
							diplomacy = 16
						}
						modifier = {
							factor = 1.1
							diplomacy = 18
						}
						modifier = {
							factor = 1.1
							diplomacy = 20
						}
						
						if = {
							limit = {
								event_target:target_province = {
									holder_scope = {
										NOT = {
											character = ROOT
										}
									}
								}
							}
							character_event = { id = MNM.3860 days = 500 random = 50 }
						}
						if = {
							limit = {
								event_target:target_province = {
									holder_scope = {
										character = ROOT
									}
								}
							}
							character_event = { id = MNM.3860 days = 300 random = 50 }
						}
					}
					50 = {
						modifier = {
							factor = 0.2
							event_target:target_province = {
								holder_scope = {
									NOT = {
										character = ROOT
									}
								}
							}
						}
						modifier = {
							factor = 1.1
							diplomacy = 12
						}
						modifier = {
							factor = 1.1
							diplomacy = 14
						}
						modifier = {
							factor = 1.1
							diplomacy = 16
						}
						modifier = {
							factor = 1.1
							diplomacy = 18
						}
						modifier = {
							factor = 1.1
							diplomacy = 20
						}
						
						if = {
							limit = {
								event_target:target_province = {
									holder_scope = {
										NOT = {
											character = ROOT
										}
									}
								}
							}
							character_event = { id = MNM.3870 days = 500 random = 50 }
						}
						if = {
							limit = {
								event_target:target_province = {
									holder_scope = {
										character = ROOT
									}
								}
							}
							character_event = { id = MNM.3870 days = 300 random = 50 }
						}
					}
					30 = {
						if = {
							limit = {
								event_target:target_province = {
									holder_scope = {
										NOT = {
											character = ROOT
										}
									}
								}
							}
							character_event = { id = MNM.3880 days = 500 random = 50 }
						}
						if = {
							limit = {
								event_target:target_province = {
									holder_scope = {
										character = ROOT
									}
								}
							}
							character_event = { id = MNM.3880 days = 300 random = 50 }
						}
					}
				}
			}
		}
		character_event = { id = MNM.3859 days = 30 }
	}
}

character_event = {
	id = MNM.3858
	desc = EVTDESC_MNM_3858
	picture = GFX_evt_secret_ceremony
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_MNM_3858
		if = {
			limit = {
				has_quest = quest_secret_religions_societies_prepare_grounds
				event_target:target_province = {
					is_quest_target_of = ROOT
				}
			}
			clr_quest = { id = quest_secret_religions_societies_prepare_grounds failure = yes }
		}
		clear_delayed_event = { id = MNM.3849 }
		clear_delayed_event = { id = MNM.3859 }
		clr_character_flag = preparing_grounds_in_@event_target:target_province
	}
}

character_event = {
	id = MNM.3859
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		if = {
			limit = {
				#OR = {
				#	NOT = {
				#		society = {
				#			event_target:original_society = {
				#				society_type = PREV
				#			}
				#		}
				#	}
					event_target:target_province = {
						county = {
							holder_scope = {
								NOT = { 
									same_realm = ROOT
								}
							}
						}
					}
				#}
			}
			clear_delayed_event = { id = MNM.3860 }
			clear_delayed_event = { id = MNM.3870 }
			clear_delayed_event = { id = MNM.3880 }
			clear_delayed_event = { id = MNM.3890 }
			character_event = { id = MNM.3858 }
			break = yes
		}
		repeat_event = { id = MNM.3859 days = 30 }
	}
}

character_event = {
	id = MNM.3860
	desc = EVTDESC_MNM_3860
	picture = GFX_evt_secret_ceremony
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_MNM_3860
		hidden_effect = {
			character_event = { id = MNM.3890 days = 150 random = 50 }
		}
	}
}

character_event = {
	id = MNM.3870
	desc = EVTDESC_MNM_3870
	picture = GFX_evt_secret_ceremony
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_MNM_3870
		hidden_effect = {
			character_event = { id = MNM.3890 days = 350 random = 50 }
		}
	}
}

character_event = {
	id = MNM.3880
	desc = EVTDESC_MNM_3880
	picture = GFX_evt_secret_ceremony
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_MNM_3880
		scaled_wealth = {
			value = -0.3
			min = -50
			max = -250
		}
		hidden_effect = {
			character_event = { id = MNM.3890 days = 450 random = 50 }
		}
	}
	
	option = {
		name = EVTOPTB_MNM_3880
		if = {
			limit = {
				has_quest = quest_secret_religions_societies_prepare_grounds
				event_target:target_province = {
					is_quest_target_of = ROOT
				}
			}
			clr_quest = { id = quest_secret_religions_societies_prepare_grounds failure = yes }
		}
		hidden_effect = {
			clear_delayed_event = { id = MNM.3859 }
			clear_delayed_event = { id = MNM.3849 }
			clr_character_flag = preparing_grounds_in_@event_target:target_province
		}
	}
}

character_event = {
	id = MNM.3890
	desc = EVTDESC_MNM_3890
	picture = GFX_evt_secret_ceremony
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_MNM_3890
		emf_sr_add_secret_community_to_target_province = yes
		if = {
			limit = {
				has_quest = quest_secret_religions_societies_prepare_grounds
				event_target:target_province = {
					is_quest_target_of = ROOT
				}
			}
			clr_quest = quest_secret_religions_societies_prepare_grounds
			
			add_society_currency_minor_effect = yes
		}
		clear_delayed_event = { id = MNM.3849 }
		clr_character_flag = preparing_grounds_in_@event_target:target_province
		
		hidden_effect = {
			clear_delayed_event = { id = MNM.3859 }
		}
	}
}

character_event = {
	id = MNM.3900
	hide_window = yes

	is_triggered_only = yes

	immediate = { FROM = { society_quest_event = { id = MNM.3901 days = 7 random = 7 } } }
}

society_quest_event = {
	id = MNM.3901
    border = GFX_event_letter_frame_religion

    desc = EVTDESC_MNM_3901

    is_triggered_only = yes
	
	immediate = {
		random_demesne_province = {
			limit = {
                emf_sr_has_not_religion_or_community_of_ROOT_sr = yes
            }
			save_event_target_as = target_province
		}
	}

    option = {
        name = ACCEPT
		event_target:target_province = {
			set_quest_target = {
				id = quest_secret_religions_societies_prepare_grounds
				holder = ROOT
			}
		}
    }

    option = {
        name = DECLINE
        custom_tooltip = { text = decline_quest_tooltip }

        add_character_modifier = {
            name = quest_cooldown_timer
            hidden = yes
            days = 1000
        }

        ai_chance = { factor = 0 }
    }
}


#Character gets option to secretly keep old religion
character_event = {
    id = MNM.3949
    desc = EVTDESC_MNM_3949
    picture = GFX_evt_uncomfortable
    border = GFX_event_normal_frame_religion

    is_triggered_only = yes

    hide_from = yes
    
    trigger = {
        has_secret_religion_trait_trigger = no
        has_any_char_old_religion = yes
    }

    immediate = {
        event_target_old_religion_from_flag_effect = yes
        FROM = { FROMFROM = { save_event_target_as = demander } }
    }

    option = {
        name = EVTOPTA_MNM_3949
        ai_chance = {
            factor = 50
            modifier = {
                trait = zealous 
                factor = 1.5
            }
            modifier = {
                trait = brave 
                factor = 1.5
            }
            modifier = {
                factor = 500
                emf_sr_old_religion_is_liege_sr = yes
            }
        }
		add_secret_religion_trait_trigger_is_religion_or_old_religion_flag_clear_flag_after_effect_is_run_this_name_is_a_tribute_to_m_effect = yes
        custom_tooltip = { text = EVTOPTA_MNM_3949_TT }
    }

    option = {
        name = EVTOPTB_MNM_3949
        ai_chance = {
            factor = 50
            modifier = {
                factor = 0.3
                trait = craven 
            }
        }
        custom_tooltip = { text = EVTOPTB_MNM_3949_TT }
    }    
}

# Secret religion - Member thinks it's too stressful to keep practising their secret religion.
character_event = {
	id = MNM.3920
	desc = EVTDESC_MNM_3920
	picture = "GFX_evt_uncomfortable"
    border = GFX_event_normal_frame_religion

    is_triggered_only = yes
	
	only_playable = yes
	is_in_society = yes
	
	trigger = {
		society_member_of = secret_religious_cult
		block_general_event_trigger = no
		
		society = {
			any_society_member = {
				ai = yes
				NOT = { character = ROOT }
				NOT = { is_society_grandmaster = yes }
				
				is_within_diplo_range = ROOT
			}
		}
	}
	
	weight_multiplier = {
		factor = 1
		modifier = {
			factor = 0.05
			ai = yes
		}
		modifier = {
			factor = 2
			society = {
				any_society_member = {
					OR = {
						trait = paranoid
						trait = stressed
					}
				}
			}
		}
		modifier = {
			factor = 2
			society = {
				any_society_member = {
					count = 5
					OR = {
						trait = paranoid
						trait = stressed
					}
				}
			}
		}
		modifier = {
			factor = 2
			society = {
				any_society_member = {
					count = 10
					OR = {
						trait = paranoid
						trait = stressed
					}
				}
			}
		}
	}
	
	immediate = {
		# Find a suitable person
		society = {
			random_society_member = {
				limit = {
					ai = yes
					NOT = { character = ROOT }
					NOT = { is_society_grandmaster = yes }
					same_realm = ROOT
					OR = {
						trait = paranoid
						trait = stressed
					}
					
					is_within_diplo_range = ROOT
				}
				save_event_target_as = worried_secret_member
			}
			if = {
				limit = {
					NOT = { event_target:worried_secret_member = { always = yes } }
				}
				random_society_member = {
					limit = {
						ai = yes
						NOT = { character = ROOT }
						NOT = { is_society_grandmaster = yes }
						same_realm = ROOT
						
						is_within_diplo_range = ROOT
					}
					save_event_target_as = worried_secret_member
				}
			}
			if = {
				limit = {
					NOT = { event_target:worried_secret_member = { always = yes } }
				}
				random_society_member = {
					limit = {
						ai = yes
						NOT = { character = ROOT }
						NOT = { is_society_grandmaster = yes }
						OR = {
							trait = paranoid
							trait = stressed
						}
						
						is_within_diplo_range = ROOT
					}
					save_event_target_as = worried_secret_member
				}
			}
			if = {
				limit = {
					NOT = { event_target:worried_secret_member = { always = yes } }
				}
				random_society_member = {
					limit = {
						ai = yes
						NOT = { character = ROOT }
						NOT = { is_society_grandmaster = yes }
						
						is_within_diplo_range = ROOT
					}
					save_event_target_as = worried_secret_member
				}
			}
		}
	}
	
	option = { # Try to convince by talking about solidarity
		name = EVTOPTA_MNM_3920
		hidden_effect = {
			random_list = {
				40 = { # Success
					modifier = {
						factor = 1.3
						diplomacy = 9
					}
					modifier = {
						factor = 1.3
						diplomacy = 11
					}
					modifier = {
						factor = 1.3
						diplomacy = 13
					}
					modifier = {
						factor = 1.3
						diplomacy = 15
					}
					modifier = {
						factor = 1.3
						diplomacy = 17
					}
					modifier = {
						factor = 1.3
						diplomacy = 19
					}
					modifier = {
						factor = 2
						FROM = { trait = charitable }
					}
					modifier = {
						factor = 2
						FROM = { trait = kind }
					}
					modifier = {
						factor = 2
						FROM = { trait = honest }
					}
					modifier = {
						factor = 0.5
						FROM = { trait = craven }
					}
					modifier = {
						factor = 0.5
						FROM = { trait = cynical }
					}
					
					set_character_flag = solidarity_success
				}
				20 = { # Failure
					modifier = { # ai can't deem what would be a good choice
						factor = 0.5
						ai = yes
					}
					set_character_flag = solidarity_failure
				}
			}
			character_event = { id = MNM.3921 days = 14 }
		}
	}
	
	option = { # Try to convince by talking about devotion
		name = EVTOPTB_MNM_3920
		hidden_effect = {
			random_list = {
				40 = { # Success
					modifier = {
						factor = 1.3
						diplomacy = 9
					}
					modifier = {
						factor = 1.3
						diplomacy = 11
					}
					modifier = {
						factor = 1.3
						diplomacy = 13
					}
					modifier = {
						factor = 1.3
						diplomacy = 15
					}
					modifier = {
						factor = 1.3
						diplomacy = 17
					}
					modifier = {
						factor = 1.3
						diplomacy = 19
					}
					modifier = {
						factor = 2
						FROM = { trait = patient }
					}
					modifier = {
						factor = 2
						FROM = { trait = diligent }
					}
					modifier = {
						factor = 2
						FROM = { trait = brave }
					}
					modifier = {
						factor = 0.5
						FROM = { trait = paranoid }
					}
					modifier = {
						factor = 0.5
						FROM = { trait = arbitrary }
					}
					
					set_character_flag = devotion_success
				}
				20 = { # Failure
					modifier = { # ai can't deem what would be a good choice
						factor = 0.5
						ai = yes
					}
					set_character_flag = devotion_failure
				}
			}
			character_event = { id = MNM.3921 days = 14 }
		}
	}
	
	option = { # Use smooth talking to calm her
		name = EVTOPTC_MNM_3920
		trigger = {
			trait = gregarious
		}
		tooltip_info = gregarious
		
		hidden_effect = {
			set_character_flag = gregarious_success
			character_event = { id = MNM.3921 days = 14 }
		}
	}
	
	option = { # She is free to leave if she feels that way
		name = EVTOPTD_MNM_3920
		event_target:worried_secret_member = {
			leave_society = yes
			clear_secret_religion = yes
		}
	}
}

character_event = {
    id = MNM.3921
    picture = "GFX_evt_uncomfortable"
    border = GFX_event_normal_frame_religion
    is_triggered_only = yes

    trigger = { society_member_of = secret_religious_cult }
    
    desc = {
        text = EVTDESC_MNM_3921_A
        trigger = { has_character_flag = solidarity_success }
    }
    desc = {
        text = EVTDESC_MNM_3921_B
        trigger = { has_character_flag = solidarity_failure }
    }
    desc = {
        text = EVTDESC_MNM_3921_C
        trigger = { has_character_flag = devotion_success }
    }
    desc = {
        text = EVTDESC_MNM_3921_D
        trigger = { has_character_flag = devotion_failure }
    }
    desc = {
        text = EVTDESC_MNM_3921_E
        trigger = { has_character_flag = gregarious_success }
    }
	
	option = {
		name = EVTOPTA_MNM_3921
		trigger = {
			OR = {
				has_character_flag = solidarity_success
				has_character_flag = devotion_success
				has_character_flag = gregarious_success
			}
		}
		if = {
			limit = {
				has_character_flag = gregarious_success
				FROM = {
					trait = paranoid
				}
			}
			FROM = {
				remove_trait = paranoid
			}
		}
		if = {
			limit = {
				has_character_flag = gregarious_success
				FROM = {
					trait = stressed
				}
			}
			FROM = {
				remove_trait = stressed
			}
		}
	}
	
	option = {
		name = EVTOPTB_MNM_3921
		trigger = {
			NOR = {
				has_character_flag = solidarity_success
				has_character_flag = devotion_success
				has_character_flag = gregarious_success
			}
		}
		event_target:worried_secret_member = {
			leave_society = yes
			clear_secret_religion = yes
		}
	}
}

### Secret religions - commission painting
character_event = {
	id = MNM.3910
	desc = EVTDESC_MNM_3910
	picture = GFX_evt_dharmic_pilgrims
    border = GFX_event_normal_frame_religion

    is_triggered_only = yes
	
	only_playable = yes
	
	trigger = {
		NOT = { has_character_flag = commissioned_painting }
		block_general_event_trigger = no
		OR = {
			is_in_society = no
			NOT = { society_member_of = secret_religious_cult }
			society = {
				any_society_member = {
					NOT = { character = ROOT }
					same_realm = ROOT
				}
			}
		}
	}
	
	weight_multiplier = {
		factor = 1
		modifier = {
			factor = 0.05
			NOT = { society_member_of = secret_religious_cult }
		}
	}
	
	immediate = {
		set_character_flag = commissioned_painting
	}
	
	option = {
		name = EVTOPTA_MNM_3910
		
		scaled_wealth = {
			value = -0.3
			min = -25
			max = -125
		}
		hidden_effect = {
			character_event = { id = MNM.3911 days = 60 random = 20 }
		}
	}
	
	option = {
		name = EVTOPTB_MNM_3910
	}
}

# Add hidden religious symbols to the painting?
character_event = {
	id = MNM.3911
	desc = EVTDESC_MNM_3911
	picture = GFX_evt_dharmic_pilgrims
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = { # Ask artist to add symbols
		name = EVTOPTA_MNM_3911
		trigger = {
			society_member_of = secret_religious_cult
		}
		
		scaled_wealth = {
			value = -0.05
			min = -5
			max = -30
		}
		if = {
			limit = { random = 50 }
			custom_tooltip = {
				text = EVTTOOLTIPA_MNM_3911_FEMALE
				random_list = {
					95 = {
						hidden_effect = {
							character_event = { id = MNM.3912 days = 25 random = 5 }
						}
					}
					5 = {
						add_character_modifier = {
							modifier = unfaithful_rumors
							years = 3
						}
						scaled_wealth = {
							value = -0.05
							min = -5
							max = -30
						}
					}
				}
			}
		}
		if = {
			limit = { NOT = { random = 50 } }
			custom_tooltip = {
				text = EVTTOOLTIPA_MNM_3911_MALE
				random_list = {
					95 = {
						hidden_effect = {
							character_event = { id = MNM.3912 days = 25 random = 5 }
						}
					}
					5 = {
						add_character_modifier = {
							modifier = unfaithful_rumors
							years = 3
						}
						scaled_wealth = {
							value = -0.05
							min = -5
							max = -30
						}
					}
				}
			}
		}
	}
	
	option = { # Add symbols yourself
		name = EVTOPTB_MNM_3911
		trigger = {
			society_member_of = secret_religious_cult
		}
		
		custom_tooltip = {
			text = EVTTOOLTIPB_MNM_3911
			hidden_effect = {
				random_list = {
					60 = { # Success
						character_event = { id = MNM.3912 days = 35 random = 10 }
					}
					40 = { # Avant Garde
						character_event = { id = MNM.3914 days = 35 random = 10 }
					}
				}
			}
		}
	}
	
	option = { # Keep as is
		name = EVTOPTC_MNM_3911
		add_artifact = magnificent_painting
	}
}

character_event = {
	id = MNM.3912
	desc = EVTDESC_MNM_3912
	picture = GFX_evt_ritual_scroll
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	immediate = {
		society = {
			random_society_member = {
				limit = {
					NOT = { character = ROOT }
					same_realm = ROOT
					OR = {
						AND = {
							society_rank > 1
							ROOT = { society_rank == 1 }
						}
						AND = {
							society_rank > 2
							ROOT = { society_rank == 2 }
						}
						AND = {
							society_rank > 3
							ROOT = { society_rank == 3 }
						}
					}
				}
				save_event_target_as = society_art_observer
			}
			if = {
				limit = {
					NOT = { event_target:society_art_observer = { always = yes } }
				}
				random_society_member = {
					limit = {
						NOT = { character = ROOT }
						same_realm = ROOT
					}
					save_event_target_as = society_art_observer
				}
			}
		}
	}
	
	option = {
		name = EVTOPTA_3912
		add_artifact = magnificent_painting
		add_society_currency_minor_effect = yes
		
		event_target:society_art_observer = {
			opinion = {
				who = ROOT
				modifier = opinion_budding_friendship
				years = 10
			}
			reverse_opinion = {
				who = ROOT
				modifier = opinion_budding_friendship
				years = 10
			}
		}
	}
}

character_event = {
	id = MNM.3914
	desc = EVTDESC_MNM_3914
	picture = GFX_evt_ritual_scroll
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_3914
		add_artifact = avant_garde_painting
	}
	
	option = {
		name = EVTOPTB_3914
		prestige = -100
	}
}

### Fellow society member asks you to go for a round of drinks
character_event = {
	id = MNM.3930
	desc = EVTDESC_MNM_3930
	picture = GFX_evt_brothel
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes

	is_in_society = yes
	
	trigger = {
		block_general_event_trigger = no
		society_member_of = secret_religious_cult
		
		society = {
			any_society_member = {
				NOT = { character = ROOT }
				ai = yes
			}
		}
	}
	
	immediate = {
		society = {
			
			random_society_member = {
				limit = {
					NOT = { character = ROOT }
					ai = yes
					same_realm = ROOT
				}
				save_event_target_as = society_character
			}
			if = {
				limit = { NOT = { event_target:society_character = { always = yes } } }				
				random_society_member = {
					limit = {
						NOT = {	character = ROOT }
						ai = yes
					}
					save_event_target_as = society_character
				}
			}
		}
	}
	
	option = { # Of course
		name = EVTOPTA_3930
		custom_tooltip = {
			text = EVTTOOLTIP_MNM_3930
			hidden_effect = {
				event_target:society_character = {
					character_event = { id = MNM.3931 }
				}
			}
		}
	}
	
	option = { # I don't have time for that
		name = EVTOPTB_3930
	}
}

character_event = {
	id = MNM.3931
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		FROM = {
			character_event = { id = MNM.3932 days = 21 random = 7 }
		}
	}
}

# Argument with local
character_event = {
	id = MNM.3932
	desc = EVTDESC_MNM_3932
	picture = GFX_evt_brothel
	border = GFX_event_normal_frame_religion
	is_triggered_only = yes
    
    trigger = { society_member_of = secret_religious_cult }

	
	option = { # diplomatically calm the situation
		name = EVTOPTA_MNM_3932
		custom_tooltip = {
			text = EVTTOOLTIPA_MNM_3932
			hidden_effect = {
				character_event = { id = MNM.3933 days = 7 }
			}
		}
	}
	
	option = { # fight the local
		name = EVTOPTB_MNM_3932
		custom_tooltip = {
			text = EVTTOOLTIPB_MNM_3932
			hidden_effect = {
				character_event = { id = MNM.3934 days = 7 }
			}
		}
	}
}

character_event = {
	id = MNM.3933
	desc = {
		text = EVTDESC_MNM_3933_SUCCESS
		trigger = {
			has_character_flag = sr_bar_fight_success
		}
	}
	desc = {
		text = EVTDESC_MNM_3933_FAILURE
		trigger = {
			NOT = { has_character_flag = sr_bar_fight_success }
		}
	}
	picture = GFX_evt_brothel
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	immediate = {
		random_list = { # Diplomacy check
			30 = { # success
				modifier = {
					factor = 1.3
					diplomacy = 7
				}
				modifier = {
					factor = 1.3
					diplomacy = 9
				}
				modifier = {
					factor = 1.3
					diplomacy = 11
				}
				modifier = {
					factor = 1.3
					diplomacy = 13
				}
			
			
				set_character_flag = sr_bar_fight_success
			}
			70 = { # failure
			}
		}
	}
	
	option = {
		name = EVTOPTA_MNM_3933
		trigger = {
			has_character_flag = sr_bar_fight_success
		}
		
		add_character_modifier = {
			modifier = mediator
			years = 2
		}
	}
	
	option = {
		name = EVTOPTB_MNM_3933
		trigger = {
			NOT = { has_character_flag = sr_bar_fight_success }
		}
		
		if = {
			limit = {
				OR = {
					trait = wounded
					trait = maimed
				}
			}
			prestige = -50
		}
		if = {
			limit = {
				NOR = {
					trait = wounded
					trait = maimed
				}
			}
			add_trait = wounded
		}
		event_target:society_character = {
			if = {
				limit = {
					OR = {
						trait = wounded
						trait = maimed
					}
				}
				prestige = -50
			}
			if = {
				limit = {
					NOR = {
						trait = wounded
						trait = maimed
					}
				}
				add_trait = wounded
			}
		}
		add_character_modifier = {
			modifier = bruised_knuckles
			months = 6
		}
	}
	
	after = {
		clr_character_flag = sr_bar_fight_success
		event_target:society_character = {
			opinion = {
				who = ROOT
				modifier = opinion_happy
				years = 5
			}
			hidden_effect = {
				reverse_opinion = {
					who = ROOT
					modifier = opinion_happy
					years = 5
				}
			}
		}
	}
}

character_event = {
	id = MNM.3934
	desc = {
		text = EVTDESC_MNM_3934_SUCCESS
		trigger = {
			has_character_flag = sr_bar_fight_success
		}
	}
	desc = {
		text = EVTDESC_MNM_3934_FAILURE
		trigger = {
			NOT = { has_character_flag = sr_bar_fight_success }
		}
	}
	picture = GFX_evt_brothel
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	immediate = {
		random_list = { # Martial check
			30 = { # success
				modifier = {
					factor = 1.3
					martial = 7
				}
				modifier = {
					factor = 1.3
					martial = 9
				}
				modifier = {
					factor = 1.3
					martial = 11
				}
				modifier = {
					factor = 1.3
					martial = 13
				}
			
				set_character_flag = sr_bar_fight_success
			}
			70 = { # failure
			}
		}
	}
	
	option = {
		name = EVTOPTA_MNM_3934
		trigger = {
			has_character_flag = sr_bar_fight_success
		}
		
		change_society_currency = 30
		increase_visibility_effect = yes
	}
	
	option = {
		name = EVTOPTB_MNM_3934
		trigger = {
			NOT = { has_character_flag = sr_bar_fight_success }
		}
		
		increase_visibility_effect = yes
		if = {
			limit = {
				OR = {
					trait = wounded
					trait = maimed
				}
			}
			prestige = -50
		}
		if = {
			limit = {
				NOR = {
					trait = wounded
					trait = maimed
				}
			}
			add_trait = wounded
		}
		event_target:society_character = {
			if = {
				limit = {
					OR = {
						trait = wounded
						trait = maimed
					}
				}
				prestige = -50
			}
			if = {
				limit = {
					NOR = {
						trait = wounded
						trait = maimed
					}
				}
				add_trait = wounded
			}
		}
	}
	
	after = {
		add_character_modifier = {
			modifier = bruised_knuckles
			months = 6
		}
		event_target:society_character = {
			opinion = {
				who = ROOT
				modifier = opinion_happy
				years = 5
			}
			hidden_effect = {
				reverse_opinion = {
					who = ROOT
					modifier = opinion_happy
					years = 5
				}
			}
		}
		clr_character_flag = sr_bar_fight_success
	}
}

# Feedback event for found_religious_cult decision
character_event = {
	id = MNM.3950
	desc = EVTDESC_MNM_3950
	picture = GFX_evt_secret_ceremony
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_MNM_3950
	}
}

# Feedback event for falsely_confess_faith decision
character_event = {
	id = MNM.3951
	desc = EVTDESC_MNM_3951
	picture = GFX_evt_secluded_in_prayer
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_MNM_3951
	}
}

# rare ai only - secretly convert from spouse/friend/province's religion
character_event = {
	id = MNM.3948
	hide_window = yes
	
	is_triggered_only = yes
	
	ai = yes
	only_playable = yes
	
	trigger = {
		has_secret_religion = no
		any_spouse = {
			same_true_religion_as_root_trigger = no
		}
		any_consort = {
			same_true_religion_as_root_trigger = no
		}
		any_demesne_province = {
			NOT = { religion = { target_type = true target = ROOT} }
		}
		any_friend = {
			same_true_religion_as_root_trigger = no
		}
	}
	
	weight_multiplier = {
		days = 1
	}
	
	immediate = {
		random_spouse = {
			limit = {
				same_true_religion_as_root_trigger = no
			}
			ROOT = { 
				set_secret_religion = { target_type = true target = PREV }
				any_spouse = {
					limit = {
						ai = yes
						has_secret_religion = no
						NOT = { character = PREVPREV }
					}
					set_secret_religion = { target_type = true target = PREVPREV }
				}
				any_child = {
					limit = {
						ai = yes
						has_secret_religion = no
						NOT = { character = PREVPREV }
					}
					set_secret_religion = { target_type = true target = PREVPREV }
				}
			}
			break = yes
		}
		random_consort = {
			limit = {
				same_true_religion_as_root_trigger = no
			}
			ROOT = { 
				set_secret_religion = { target_type = true target = PREV }
				any_spouse = {
					limit = {
						ai = yes
						has_secret_religion = no
						NOT = { character = PREVPREV }
					}
					set_secret_religion = { target_type = true target = PREVPREV }
				}
				any_child = {
					limit = {
						ai = yes
						has_secret_religion = no
						NOT = { character = PREVPREV }
					}
					set_secret_religion = { target_type = true target = PREVPREV }
				}
			}
			break = yes
		}
		random_demesne_province = {
			limit = {
				NOT = { religion = { target_type = true target = ROOT} }
			}
			ROOT = { set_secret_religion = { target_type = public target = PREV } }
			ROOT = {
				any_spouse = {
					limit = {
						ai = yes
						has_secret_religion = no
					}
					set_secret_religion = { target_type = true target = ROOT }
				}
				any_child = {
					limit = {
						ai = yes
						has_secret_religion = no
					}
					set_secret_religion = { target_type = true target = ROOT }
				}
			}
			break = yes
		}
		random_friend = {
			limit = {
				same_true_religion_as_root_trigger = no
			}
			ROOT = { 
				set_secret_religion = { target_type = true target = PREV }
				any_spouse = {
					limit = {
						ai = yes
						has_secret_religion = no
						NOT = { character = PREVPREV }
					}
					set_secret_religion = { target_type = true target = PREVPREV }
				}
				any_child = {
					limit = {
						ai = yes
						has_secret_religion = no
						NOT = { character = PREVPREV }
					}
					set_secret_religion = { target_type = true target = PREVPREV }
				}
			}
			break = yes
		}
	}
}
