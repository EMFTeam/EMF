namespace = emf_heresy

#reserved: emf_heresy.2000 to emf_heresy.2099

#######################################
# CHRISTIAN HERESY EVENTS
# Adapted from Heretic Pride by Rylock
#######################################

### NEW CARDINAL EVENTS

# Character has become a religious elector
character_event = {
	id = emf_heresy.155
	picture = GFX_evt_bishop
	border = GFX_event_normal_frame_religion
	
	desc = {
		text = EVTDESC_emf_heresy_155_manichean
		trigger = { religion = manichean }
	}
	desc = {
		text = EVTDESC_emf_heresy_155_cathar
		trigger = { religion = cathar }
	}
	desc = {
		text = EVTDESC_emf_heresy_155_bogomilist
		trigger = { religion = bogomilist }
	}
	
	is_triggered_only = yes
	
	option = {
		name = EXCELLENT
		hidden_tooltip = {
			if = {
				limit = {
					independent = no
					any_liege = {
						ai = no
						religion = ROOT
					}
				}
				any_liege = { character_event = { id = emf_heresy.156 } }
			}
			any_playable_ruler = {
				limit = {
					ai = no
					religion = ROOT
					NOT = { is_vassal_or_below = ROOT }
				}
				character_event = { id = emf_heresy.157 }
			}
		}
	}
}

# Inform liege
character_event = {
	id = emf_heresy.156
	picture = GFX_evt_bishop

	desc = {
		text = EVTDESC_emf_heresy_156_manichean
		trigger = { religion = manichean }
	}
	desc = {
		text = EVTDESC_emf_heresy_156_cathar
		trigger = { religion = cathar }
	}
	desc = {
		text = EVTDESC_emf_heresy_156_bogomilist
		trigger = { religion = bogomilist }
	}
	
	is_triggered_only = yes
	notification = yes

	option = {
		name = OK
	}
}

# Inform everyone else
character_event = {
	id = emf_heresy.157
	picture = GFX_evt_bishop

	desc = {
		text = EVTDESC_emf_heresy_157_manichean
		trigger = { religion = manichean }
	}
	desc = {
		text = EVTDESC_emf_heresy_157_cathar
		trigger = { religion = cathar }
	}
	desc = {
		text = EVTDESC_emf_heresy_157_bogomilist
		trigger = { religion = bogomilist }
	}
	
	is_triggered_only = yes
	notification = yes

	option = {
		name = OK
	}
}

### CATHAR EVENTS

# Cathar child gains chaste
character_event = {
	id = emf_heresy.2000
	desc = EVTDESC_emf_heresy_2000
	picture = GFX_evt_child_talking
	
	is_triggered_only = yes
	
	min_age = 6
	max_age = 16
	religion = cathar

	trigger = {
		educator = { always = yes }
		NOT = { personality_traits = 5 }
		NOT = { trait = lustful }
		NOT = { trait = chaste }
	}
	
	weight_multiplier = {
		days = 1
		modifier = {
			factor = 0.1
			educator = { trait = lustful }
		}
		modifier = {
			factor = 2.0
			educator = { trait = chaste }
		}
	}
	
	option = {
		name = EVTOPTA_emf_heresy_2000
		add_trait = chaste
	}
}

# Cathar male child becomes homosexual
character_event = {
	id = emf_heresy.2001
	desc = EVTDESC_emf_heresy_2001
	picture = GFX_evt_brothel
	
	min_age = 13
	max_age = 16
	only_men = yes
	religion = cathar
	
	trigger = {
		is_married = no
		NOR = {
			trait = homosexual
			trait = celibate
		}
	}

	mean_time_to_happen = {
		months = 960
		modifier = {
			factor = 0.75
			trait = zealous
		}
		modifier = {
			factor = 1.5
			trait = chaste
		}
		modifier = {
			factor = 0.5
			trait = trusting
			any_courtier = {
				age = 13
				NOT = { age = 18 }
				is_female = no
				trait = homosexual
				reverse_opinion = { who = ROOT value = 0 }
			}
		}
	}
	
	option = {
		name = EVTOPTA_emf_heresy_2001
		add_trait = homosexual
	}
}

# Cathar female child becomes homosexual
character_event = {
	id = emf_heresy.2002
	desc = EVTDESC_emf_heresy_2002
	picture = GFX_evt_garden
	
	min_age = 12
	max_age = 16
	only_women = yes
	religion = cathar
	
	trigger = {
		is_married = no
		NOR = {
			trait = homosexual
			trait = celibate
		}		
	}

	mean_time_to_happen = {
		months = 960
		modifier = {
			factor = 0.75
			trait = zealous
		}
		modifier = {
			factor = 1.5
			trait = chaste
		}
		modifier = {
			factor = 0.5
			trait = trusting
			any_courtier = {
				age = 13
				NOT = { age = 18 }
				is_female = yes
				trait = homosexual
				reverse_opinion = { who = ROOT value = 0 }
			}
		}
	}
	
	option = {
		name = EVTOPTA_emf_heresy_2001
		add_trait = homosexual
	}
}

# Adult Cathar becomes celibate
character_event = {
	id = emf_heresy.2003
	desc = EVTDESC_emf_heresy_2003
	picture = GFX_evt_brothel
	
	min_age = 25
	religion = cathar
	
	is_triggered_only = yes
	
	trigger = {
		religion = cathar
		trait = zealous
		NOR = {
			trait = celibate
			trait = hedonist
		}
	}
	
	weight_multiplier = {
		days = 1
		modifier = {
			factor = 2
			trait = chaste
		}
		modifier = {
			factor = 0.5
			trait = lustful
		}
	}
	
	option = {
		name = EVTOPTA_emf_heresy_2003
		add_trait = celibate
	}
}

# Cathar/Bogomilist ruler adopts a child (fired from decision)
character_event = {
	id = emf_heresy.2006
	desc = EVTDESC_emf_heresy_2006
	picture = GFX_evt_child_talking
	
	is_triggered_only = yes
	
	immediate = {
		if = {
			limit = { capital_scope = { religion = ROOT } }
			capital_scope = { save_event_target_as = adopted_province }
			break = yes
		}
		random_realm_province = {
			limit = { religion = ROOT }
			save_event_target_as = adopted_province
		}
	}

	option = {
		name = EVTOPTA_emf_heresy_2006
		piety = 20
		create_character = {
			random_traits = yes
			dynasty = ROOT
			religion = ROOT
			culture = event_target:adopted_province
			female = no
			age = 5
			health = 6.5
			trait = adopted
			attributes = {
				learning = 2
				diplomacy = 2
				martial = 2
				stewardship = 2
				intrigue = 2
			}
		}
		new_character = {
			if = {
				limit = { ROOT = { is_female = no } }
				set_father = ROOT
			}
			if = {
				limit = { ROOT = { is_female = yes } }
				set_mother = ROOT
			}
			random_list = {
				1 = { add_trait = genius }
				2 = { add_trait = quick }
				3 = { add_trait = strong }
				4 = { change_diplomacy = 2 }
				4 = { change_learning = 2 }
				4 = { change_martial = 2 }
				4 = { change_stewardship = 2 }
				4 = { change_intrigue = 2 }
				10 = { }
			}
			if = {
				limit = { has_dlc = "Zeus" }
				random_list = {
					3 = { add_trait = timid }
					1 = { add_trait = brooding }
					1 = { add_trait = curious }
				}
			}
			if = {
				limit = { NOT = { has_dlc = "Zeus" } }
				random_list = {
					3 = { add_trait = shy }
					1 = { add_trait = humble }
					1 = { add_trait = trusting }
				}
			}
		}
		recalc_succession = yes
	}
}

# Council of Saint-Félix
province_event = {
	id = emf_heresy.2010
	
	hide_window = yes
	
	trigger = {
		religion = catholic
		OR = {
			year = 1160
			AND = {
				year = 1100
				NOT = { religion_authority = 0.60 }
			}
		}
		OR = {
			culture = occitan
			AND = {
				year = 1175
				culture = frankish
			}
			AND = {
				year = 1175
				culture = arpitan
			}
			AND = {
				year = 1200
				region = world_europe_west_francia
			}
			year = 1225
		}
		any_province_holding = { holding_type = city }
		any_neighbor_province = { religion = catholic }
		NOR = {
			owner = { war = yes }
			religion_authority = 0.75
			any_independent_ruler = { religion = cathar }
			has_global_flag = cathar_activated
		}
	}
	
	mean_time_to_happen = {
		months = 120
		modifier = {
			factor = 0.75
			county = { title = c_carcassonne }
		}
		modifier = {
			factor = 1.5
			NOT = { culture = occitan }
		}
		modifier = {
			factor = 0.8
			NOT = { religion_authority = 0.70 }
		}
		modifier = {
			factor = 0.8
			NOT = { religion_authority = 0.65 }
		}
		modifier = {
			factor = 0.8
			NOT = { religion_authority = 0.60 }
		}
		modifier = {
			factor = 0.8
			NOT = { religion_authority = 0.55 }
		}
		modifier = {
			factor = 0.8
			NOT = { religion_authority = 0.50 }
		}
		modifier = {
			factor = 1.5
			NOT = { year = 1165 }
		}
		modifier = {
			factor = 0.5
			year = 1175
		}
		modifier = {
			factor = 0.25
			year = 1200
		}
		modifier = {
			factor = 0.1
			year = 1225
		}
	}
	
	immediate = {
		set_global_flag = cathar_activated
		any_neighbor_province = {
			count = 3
			limit = {
				religion = ROOT
				culture = ROOT
			}
			religion = cathar
			add_province_modifier = {
				name = heretic_stronghold
				duration = 3650
			}
		}
		religion = cathar
		add_province_modifier = {
			name = heretic_stronghold
			duration = 3650
		}
		random_province_holding = {
			limit = { holding_type = city }
			save_event_target_as = council_location
		}
		owner = {
			narrative_event = { id = emf_heresy.2011 }
		}
	}
}

narrative_event = {
	id = emf_heresy.2011
	title = EVTTITLE_emf_heresy_2011
	desc = EVTDESC_emf_heresy_2011
	picture = GFX_evt_heretic_pride
	border = GFX_event_narrative_frame_religion

	major = yes
	is_triggered_only = yes
	hide_from = yes
	
	major_trigger = {
		OR = {
			any_demesne_province = { religion = cathar }
			religion = cathar
			religion = bogomilist
			capital_scope = {
				NOT = {
					distance = {
						where = FROM
						value = 600	# Same part of the world
					}
				}
			}
		}
	}
	
	option = {
		name = EVTOPTA_emf_heresy_2011
		trigger = {
			religion = catholic
			any_demesne_province = { religion = cathar }
		}
		piety = -100
		hidden_tooltip = {
			create_character = {
				random_traits = yes
				dynasty = random
				religion = cathar
				culture = ROOT
				female = no
				age = 35
				trait = mastermind_theologian
				trait = perfecti
				trait = zealous
				trait = gregarious
				trait = scholar
				attributes = {
					learning = 5
					diplomacy = 5
				}
			}
			new_character = {
				set_character_flag = title_monk
				set_special_character_title = MONK_BROTHER
			}
		}
	}
	option = {
		name = EVTOPTB_emf_heresy_2011
		trigger = {
			religion = catholic
			NOT = { any_demesne_province = { religion = cathar } }
		}
	}
	option = {
		name = I_SEE
		trigger = {
			NOR = {
				religion = catholic
				religion = bogomilist
			}
		}
	}
	option = {
		name = EVTOPTC_emf_heresy_2011
		trigger = {
			religion = bogomilist
		}
	}
}

# Cathars are allowed to use holy wars/crusades once holy war is used against them
character_event = {
	id = emf_heresy.2012
	title = EVTTITLE_emf_heresy_2012
	desc = EVTDESC_emf_heresy_2012
	picture = GFX_evt_heresy_defeated
	border = GFX_event_normal_frame_war
	
	major = yes
	only_rulers = yes
	religion = cathar
	
	trigger = {
		is_heretic = yes
		war = yes
		any_war = {
			attacker = {
				is_parent_religion = ROOT
				any_demesne_title = { temporary = no }
			}
			defender = { character = ROOT }
			OR = {
				using_cb = crusade
				using_cb = religious
			}
		}
		NOT = { has_global_flag = cathar_holy_war_enabled }
	}
	
	major_trigger = {
		religion = cathar
	}
	
	mean_time_to_happen = {
		days = 10
    }

	immediate = {
		set_global_flag = cathar_holy_war_enabled
	}
	
	option = {
		name = EVTOPTA_emf_heresy_2012
	}
}

# A Cathar Patriarch is elected (fired from decision)
character_event = {
	id = emf_heresy.2013
	
	is_triggered_only = yes
	hide_window = yes

	immediate = {
		activate_title = { title = d_cathar status = yes }
		
		# First pick appropriate realm priest
		random_realm_lord = {
			limit = {
				religion = cathar
				is_theocracy = yes
				capital_holding = { is_holy_site = ROOT }
				prisoner = no
				trait = perfecti
				NOT = { trait = incapable }
			}
			d_cathar = { grant_title = PREV }
			set_defacto_liege = ROOT
			pf_liege_change_effect = yes
			save_event_target_as = new_cathar_pope
			ROOT = { narrative_event = { id = emf_heresy.2014 } }
			break = yes
		}
		
		# Failing that, create a new character
		create_random_priest = {
			random_traits = yes
			dynasty = random
			religion = cathar
			culture = ROOT
			age = 40
			health = 7
			trait = quick
			trait = zealous
			trait = perfecti
			trait = scholar
			trait = mastermind_theologian
			attributes = {
				learning = 5
				diplomacy = 5
				martial = 2
				stewardship = 5
				intrigue = 5
			}
		}
		new_character = {
			d_cathar = { grant_title = PREV }
			ROOT = {
				random_realm_title = {
					limit = { is_holy_site = ROOT }
					gain_title = PREVPREV
				}
			}
			set_defacto_liege = ROOT
			save_event_target_as = new_cathar_pope
		}
		narrative_event = { id = emf_heresy.2014 }
	}
}

# The rest of the world is told about the new Cathar Patriarch
narrative_event = {
	id = emf_heresy.2014
	title = EVTTITLE_emf_heresy_2014
	desc = EVTDESC_emf_heresy_2014
	picture = GFX_evt_pope
	border = GFX_event_narrative_frame_religion
	sound = church_bells

	major = yes

	is_triggered_only = yes

	option = {
		name = EVTOPTA_emf_heresy_2014
		trigger = {
			NOT = { religion = cathar }
			religion_group = christian
		}
	}
	option = {
		name = EVTOPTB_emf_heresy_2014
		trigger = { NOT = { religion_group = christian } }
	}
	option = {
		name = EVTOPTC_emf_heresy_2014
		trigger = { religion = cathar }
	}
}

### LOLLARD EVENTS

# John Wycliff appears in England
narrative_event = {
	id = emf_heresy.2015
	title = EVTNAME_emf_heresy_2015
	desc = EVTDESC_emf_heresy_2015
	picture = GFX_evt_lollard_heresy
	border = GFX_event_narrative_frame_religion

	major = yes
	only_rulers = yes
	religion = catholic
	
	trigger = {
		war = no
		year = 1300
		tier = KING
		any_realm_province = {
			region = custom_england
			religion = catholic
		}
		NOR = {
			religion_authority = 0.60
			any_realm_province = { religion = lollard }
			any_independent_ruler = { religion = lollard }
			has_global_flag = lollard_activated
		}
	}

	major_trigger = {
		OR = {
			character = ROOT
			religion = lollard
			capital_scope = {
				NOT = {
					distance = {
						where = event_target:new_lollard_stronghold
						value = 600	# Same part of the world
					}
				}
			}
		}
	}

	mean_time_to_happen = {
		months = 500
		modifier = {
			factor = 0.5
			year = 1325
		}
		modifier = {
			factor = 0.5
			year = 1350
		}
		modifier = {
			factor = 0.25
			year = 1375
		}
		modifier = {
			factor = 0.1
			year = 1400
		}
	}
	
	immediate = {
		set_global_flag = lollard_activated
		random_realm_province = {
			limit = {
				region = custom_england
				religion = catholic 
			}
			save_event_target_as = new_lollard_stronghold
			religion = lollard
			add_province_modifier = {
				name = heretic_stronghold
				duration = 3650
            }
			if = {
				limit = { culture = english }
				owner = {
					create_character = {
						name = "John"
						random_traits = yes
						dynasty = 1000124390 #Wycliff
						religion = lollard
						culture = english
						female = no
						age = 39
						trait = mastermind_theologian
						trait = humble
						trait = zealous
						trait = gregarious
						trait = scholar
						trait = monk
						attributes = {
							learning = 5
							diplomacy = 5
						}
					}
					new_character = {
						save_event_target_as = lollard_founder
						set_character_flag = title_monk
						set_special_character_title = MONK_BROTHER
					}
				}
			}
			if = {
				limit = { NOT = { culture = english } }
				owner = {
					create_character = {
						random_traits = yes
						dynasty = random
						religion = lollard
						culture = PREV
						female = no
						age = 39
						trait = mastermind_theologian
						trait = humble
						trait = zealous
						trait = gregarious
						trait = scholar
						trait = monk
						attributes = {
							learning = 5
							diplomacy = 5
						}
					}
					new_character = {
						save_event_target_as = lollard_founder
					}
				}
			}
		}
	}
	
	option = {
		name = EVTOPTA_emf_heresy_2015
		trigger = { character = ROOT }
		piety = -100
		tooltip = {
			event_target:new_lollard_stronghold = {
				religion = lollard
				add_province_modifier = {
					name = heretic_stronghold
					duration = 3650
				}
			}
		}
	}
	option = {
		name = EVTOPTB_emf_heresy_2015
		trigger = {
			NOT = { character = ROOT }
			religion = catholic
		}
	}
	option = {
		name = EVTOPTC_emf_heresy_2015
		trigger = {
			NOT = { character = ROOT }
			NOT = { religion = catholic }
			religion_group = christian
		}
	}
	option = {
		name = EVTOPTD_emf_heresy_2015
		trigger = {
			NOT = { religion_group = christian }
		}
	}
}

# Lollard/Paulician/Iconoclast wins siege over a Christian temple
character_event = { 
	id = emf_heresy.2016
	desc = EVTDESC_emf_heresy_2016
	picture = GFX_evt_siege
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	trigger = {
		OR = {
			religion = lollard
			religion = paulician
			religion = iconoclast
			religion = bogomilist
		}
		FROM = { 
			holding_type = temple
			owner = {
				wealth = 50
				religion_group = christian
				NOR = {
					religion = lollard
					religion = paulician
					religion = iconoclast
					religion = bogomilist
				}
			}
		}
	}
	
	option = {
		name = EVTOPTA_emf_heresy_2016
		ai_chance = {
			factor = 50
			modifier = {
				factor = 2
				religion = iconoclast
			}
			modifier = {
				factor = 5
				trait = zealous
			}
			modifier = {
				factor = 1.5
				trait = greedy
			}
			modifier = {
				factor = 1.5
				trait = wroth
			}
		}
		if = {
			limit = { NOT = { trait = iconoclast_trait } }
			add_trait = iconoclast_trait
		}
		wealth = 50
		piety = -25
		hidden_tooltip = {
			FROM = {
				owner = {
					wealth = -50
					opinion = { who = ROOT modifier = opinion_outraged years = 20 }
				}
			}
		}
	}
	option = {
		name = EVTOPTB_emf_heresy_2016
		ai_chance = {
			factor = 50
			modifier = {
				factor = 0
				trait = iconoclast_trait
			}
			modifier = {
				factor = 0
				NOT = { piety = 0 }
			}
			modifier = {
				factor = 2
				trait = cynical
			}
			modifier = {
				factor = 1.5
				trait = kind
			}
			modifier = {
				factor = 1.5
				trait = humble
			}
		}
		piety = 10
	}
}

# Bible translation is well-received
narrative_event = { 
	id = emf_heresy.2017
	title = EVTNAME_emf_heresy_2017
	desc = EVTDESC_emf_heresy_2017
	picture = GFX_evt_book_carolingian_script
	border = GFX_event_narrative_frame_religion
	
	is_triggered_only = yes
	major = yes
	
	trigger = {
		OR = {
			religion = lollard
			religion = waldensian
		}
		higher_tier_than = DUKE
		has_character_flag = bible_translation_begun
		NOT = { has_global_flag = bible_translation_finished }
	}
	
	major_trigger = {
		religion_group = christian
	}
	
	option = {
		name = EVTOPTA_emf_heresy_2017
		trigger = { character = ROOT }
		clr_character_flag = bible_translation_begun
		set_global_flag = bible_translation_finished
		piety = 500
		prestige = 500
		religion_authority = {
			modifier = bible_translated_lollard
			years = 25
		}
		k_papal_state = {
			holder_scope = {
				religion_authority = {
					modifier = bible_translated
					years = 25
				}
			}
		}
	}
	option = {
		name = EVTOPTA_emf_heresy_2017
		trigger = {
			NOT = { character = ROOT }
			religion = ROOT
		}
		tooltip = {
			religion_authority = {
				modifier = bible_translated_lollard
				years = 25
			}
			k_papal_state = {
				holder_scope = {
					religion_authority = {
						modifier = bible_translated
						years = 25
					}
				}
			}
		}
	}
	option = {
		name = EVTOPTB_emf_heresy_2017
		trigger = {
			NOT = { character = ROOT }
			NOT = { religion = ROOT }
		}
		tooltip = {
			ROOT = {
				religion_authority = {
					modifier = bible_translated_lollard
					years = 25
				}
			}
			k_papal_state = {
				holder_scope = {
					religion_authority = {
						modifier = bible_translated
						years = 25
					}
				}
			}
		}
	}
}

# Bible translation is poorly-received
narrative_event = { 
	id = emf_heresy.2018
	title = EVTNAME_emf_heresy_2017
	desc = EVTDESC_emf_heresy_2018
	picture = GFX_evt_book_carolingian_script
	border = GFX_event_narrative_frame_religion
	
	is_triggered_only = yes
	major = yes
	
	trigger = {
		OR = {
			religion = lollard
			religion = waldensian
		}
		higher_tier_than = DUKE
		has_character_flag = bible_translation_begun
		NOT = { has_global_flag = bible_translation_finished }
	}
	
	major_trigger = {
		religion_group = christian
	}
	
	option = {
		name = EVTOPTA_emf_heresy_2018
		clr_character_flag = bible_translation_begun
		set_global_flag = bible_translation_finished
		piety = 250
		prestige = -250
		religion_authority = {
			modifier = bible_translated_poor_lollard
			years = 25
		}
		k_papal_state = {
			holder_scope = {
				religion_authority = {
					modifier = bible_translated_poor
					years = 25
				}
			}
		}
	}
	option = {
		name = EVTOPTA_emf_heresy_2017
		trigger = {
			NOT = { character = ROOT }
			religion = ROOT
		}
		tooltip = {
			religion_authority = {
				modifier = bible_translated_poor_lollard
				years = 25
			}
			k_papal_state = {
				holder_scope = {
					religion_authority = {
						modifier = bible_translated_poor
						years = 25
					}
				}
			}
		}
	}
	option = {
		name = EVTOPTB_emf_heresy_2017
		trigger = {
			NOT = { character = ROOT }
			NOT = { religion = ROOT }
		}
		tooltip = {
			ROOT = {
				religion_authority = {
					modifier = bible_translated_poor_lollard
					years = 25
				}
			}
			k_papal_state = {
				holder_scope = {
					religion_authority = {
						modifier = bible_translated_poor
						years = 25
					}
				}
			}
		}
	}
}

# Ruler dies while Bible is being translated
character_event = {
	id = emf_heresy.2019
	
	hide_window = yes
	is_triggered_only = yes
	
	trigger = {
		has_character_flag = bible_translation_begun
		NOT = { has_global_flag = bible_translation_finished }
	}
	
	immediate = {
		current_heir = {
			character_event = { id = emf_heresy.2020 days = 3 }
		}
	}
}

# Ruler's heir decides whether to continue work on Bible translation
character_event = {
	id = emf_heresy.2020
	desc = EVTDESC_emf_heresy_2020
	picture = GFX_evt_book_carolingian_script
	border = GFX_event_normal_frame_religion	
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_emf_heresy_2020 # Continue his work
		trigger = {
			has_regent = no
			higher_tier_than = DUKE
			OR = {
				religion = lollard
				religion = waldensian
			}
			wealth = 0
		}
		set_character_flag = bible_translation_begun
		scaled_wealth = -0.5
		random_list = {
			50 = {
				modifier = {
					factor = 1.1
					learning = 12
				}
				modifier = {
					factor = 1.1
					learning = 14
				}
				modifier = {
					factor = 1.2
					learning = 16
				}
				modifier = {
					factor = 1.2
					learning = 18
				}
				modifier = {
					factor = 1.2
					learning = 20
				}
				narrative_event = { id = emf_heresy.2017 days = 150 random = 250 tooltip = BIBLE_TRANSLATION_GOOD }
			}
			50 = {
				modifier = {
					factor = 0.8
					NOT = { learning = 8 }
				}
				modifier = {
					factor = 0.8
					NOT = { learning = 6 }
				}
				modifier = {
					factor = 0.8
					NOT = { learning = 4 }
				}
				narrative_event = { id = emf_heresy.2018 days = 150 random = 250 tooltip = BIBLE_TRANSLATION_POOR }
			}
		}
	}
	option = {
		name = EVTOPTB_emf_heresy_2020 # His efforts die with him
		if = {
			limit = {
				OR = {
					religion = lollard
					religion = waldensian
				}
			}
			piety = -100
		}
	}
}

# Lollard ruler attempts to revoke/claim religious titles (fired from decision)
letter_event = {
	id = emf_heresy.2021
	border = GFX_event_letter_frame_religion
	
	desc = {
		text = EVTDESC_emf_heresy_2021_not_lollard
		trigger = {
			NOT = { religion = lollard }
		}
	}
	desc = {
		text = EVTDESC_emf_heresy_2021_wicked
		trigger = {
			religion = lollard
			trait = bad_priest_christian
		}
	}
	desc = {
		text = EVTDESC_emf_heresy_2021_high_tier
		trigger = {
			religion = lollard
			NOT = { trait = bad_priest_christian }
			higher_tier_than = COUNT
		}
	}
	
	is_triggered_only = yes
	
	trigger = {
		is_ruler = yes
		holy_order = no
		vassal_of = FROMFROM
		capital_holding = { holding_type = temple }
		NOR = {
			any_demesne_title = { temporary = yes }
			reverse_has_truce = FROMFROM
			has_non_aggression_pact_with = FROMFROM
		}
	}
	
	immediate = {
		clr_character_flag = lollard_revoking_titles
	}
	
	option = {
		name = EVTOPTA_emf_heresy_2021 # I have no choice
		prestige = -100
		if = {
			limit = {
				OR = {
					NOT = { religion = lollard }
					trait = bad_priest_christian
				}
			}
			any_demesne_title = {
				limit = {
					OR = {
						is_theocracy = yes
						higher_tier_than = BARON
					}
				}
				usurp_title_plus_barony_if_unlanded = FROMFROM
			}
			set_defacto_liege = FROMFROM
			pf_liege_change_effect = yes
			hidden_tooltip = {
				FROMFROM = { letter_event = { id = emf_heresy.2022 } }
			}
		}
		if = {
			limit = {
				religion = lollard
				NOT = { trait = bad_priest_christian }
			}
			any_demesne_title = {
				limit = { higher_tier_than = COUNT }
				tooltip = { add_claim = FROMFROM }
			}
			hidden_tooltip = {
				FROMFROM = { letter_event = { id = emf_heresy.2023 } }
			}
		}
	}
	option = {
		name = EVTOPTB_emf_heresy_2021 # How dare he!
		trigger = {
			higher_tier_than = BARON
			OR = {
				NOT = { religion = lollard }
				trait = bad_priest_christian
			}
		}
		FROMFROM = {
			opinion = { who = ROOT modifier = opinion_rebel_traitor years = 20 }
			hidden_tooltip = { letter_event = { id = emf_heresy.2024 } }
		}
		tooltip = {
			war = {
				target = FROMFROM
				casus_belli = overthrow_ruler
			}
		}
	}
}

# Priest accepts titles being revoked
letter_event = {
	id = emf_heresy.2022
	desc = EVTDESC_emf_heresy_2022
	border = GFX_event_letter_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EXCELLENT
		FROM = {
			any_demesne_title = {
				limit = {
					OR = {
						is_theocracy = yes
						higher_tier_than = BARON
					}
				}
				usurp_title_plus_barony_if_unlanded = ROOT
			}
			set_defacto_liege = FROM
			pf_liege_change_effect = yes
		}
	}
}

# Lollard ruler gains claims to titles
letter_event = {
	id = emf_heresy.2023
	desc = EVTDESC_emf_heresy_2023
	border = GFX_event_letter_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EXCELLENT
		FROM = {
			opinion = { who = ROOT modifier = opinion_outraged years = 10 }
			any_demesne_title = {
				limit = { higher_tier_than = COUNT }
				add_claim = ROOT
			}
		}
	}
}

# Priest refuses titles being revoked
letter_event = {
	id = emf_heresy.2024
	desc = EVTDESC_emf_heresy_2024
	border = GFX_event_letter_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_emf_heresy_2024
		FROM = { opinion = { who = ROOT modifier = opinion_outraged years = 20 } }
		reverse_war = {
			target = FROM
			casus_belli = overthrow_ruler
		}
	}
}

### FRATICELLI EVENTS

# Brother Angelo criticizes the Pope
narrative_event = {
	id = emf_heresy.2025
	title = EVTNAME_emf_heresy_2025
	desc = EVTDESC_emf_heresy_2025
	picture = GFX_evt_lollard_heresy
	border = GFX_event_narrative_frame_religion

	major = yes
	only_playable = yes
	religion = catholic
	
	trigger = {
		war = no
		year = 1200
		has_landed_title = k_papal_state
		OR = {
			trait = bad_priest_christian
			NOT = { religion_authority = 0.70 }
		}
		NOT = { has_global_flag = fraticelli_activated }
	}
	
	major_trigger = {
		religion_group = christian
	}
	
	immediate = {
		set_global_flag = fraticelli_activated
		create_character = {
			name = "Angelo"
			random_traits = yes
			dynasty = random
			religion = fraticelli
			culture = italian
			female = no
			age = 40
			trait = monk
			trait = mastermind_theologian
			trait = zealous
			trait = gregarious
			trait = scholar
			attributes = {
				learning = 5
				diplomacy = 5
			}
		}
		new_character = {
			set_character_flag = title_monk
			set_special_character_title = MONK_BROTHER
			character_event = { id = emf_heresy.2026 }
		}
	}
	
	mean_time_to_happen = {
		years = 25
		modifier = {
			factor = 0.5
			year = 1225
		}
		modifier = {
			factor = 0.5
			year = 1250
		}
		modifier = {
			factor = 0.25
			year = 1275
		}
		modifier = {
			factor = 0.1
			year = 1300
		}
	}
	option = {
		name = EVTDESC_emf_heresy_2025
		trigger = { has_landed_title = k_papal_state }
		piety = -200
		religion_authority = {
			modifier = fraticelli_reforms
			years = 25
		}
	}
	option = {
		name = EVTOPTB_emf_heresy_2025
		trigger = {
			NOT = { has_landed_title = k_papal_state }
			is_heretic = yes
		}
	}
	option = {
		name = EVTOPTC_emf_heresy_2025
		trigger = {
			NOT = { has_landed_title = k_papal_state }
			is_heretic = no
		}
	}
}

# Catholic bishops react to the words of Brother Angelo
character_event = { 
	id = emf_heresy.2026
	
	is_triggered_only = yes
	hide_window = yes
	
	immediate = {
		any_character = {
			limit = {
				ai = yes
				is_ruler = yes
				religion = catholic
				controls_religion = no
				is_theocracy = yes
				trait = mastermind_theologian
				is_within_diplo_range = ROOT
			}
			character_event = { id = emf_heresy.2027 days = 7 }
		}
	}
}

# The Catholic faithful consider the Fraticelli heresy
character_event = {
	id = emf_heresy.2027
	desc = EVTDESC_emf_heresy_2027
	picture = GFX_evt_bishop
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	trigger = {
		has_global_flag = fraticelli_activated
		ai = yes
		is_ruler = yes
		religion = catholic
		controls_religion = no
		is_theocracy = yes
		trait = mastermind_theologian
		OR = {
			trait = cynical
			trait = humble
			trait = temperate
			trait = charitable
		}
		NOR = {
			rightful_religious_head = ROOT
			has_claim = k_papal_state
			trait = zealous
			trait = greedy
			trait = gluttonous
			trait = proud
			trait = bad_priest_christian
			has_character_flag = considered_fraticelli
		}
	}
	
	immediate = {
		set_character_flag = considered_fraticelli
	}
	
	option = {
		name = EVTOPTA_emf_heresy_2027
		ai_chance = {
			factor = 20
			modifier = {
				factor = 3
				OR = {
					any_liege = { is_heretic = yes }
					father_even_if_dead = { is_heretic = yes }
					mother_even_if_dead = { is_heretic = yes }
					any_sibling = { is_heretic = yes }
					any_child = { is_heretic = yes }
				}
			}
			modifier = {
				factor = 0.5
				is_ruler = yes
			}
			modifier = {
				factor = 0.5
				is_councillor = yes
				NOT = { any_liege = { is_heretic = yes } }
			}
			modifier = {
				factor = 2
				trait = cynical
			}
			modifier = {
				factor = 1.5
				trait = just
			}
			modifier = {
				factor = 1.5
				trait = wroth
			}
			modifier = {
				factor = 0.75
				trait = arbitrary
			}
			modifier = {
				factor = 0.75
				trait = trusting
			}
			modifier = {
				factor = 0.75
				trait = patient
			}
			modifier = {
				factor = 0.5
				trait = content
			}
			modifier = {
				factor = 0.5
				trait = craven
			}
			modifier = {
				factor = 0.5
				trait = slothful
			}
		}
		if = {
			limit = { NOT = { trait = cynical } }
			random = {
				chance = 50
				add_trait = zealous
			}
		}
		if = {
			limit = { trait = cynical }
			remove_trait = cynical
		}
		if = {
			limit = { higher_tier_than = BARON }
			religion_authority = {
				modifier = ruler_converted_from
			}
		}
		religion = fraticelli
		if = {
			limit = { higher_tier_than = BARON }
			hidden_tooltip = {
				religion_authority = {
					modifier = ruler_converted_to
				}
			}
		}
		piety = 100
	}
	option = {
		name = EVTOPTB_emf_heresy_2027
		ai_chance = {
			factor = 80
		}
	}
}

### WALDENSIAN EVENTS

# The Poor of Lyons appear
narrative_event = {
	id = emf_heresy.2030
	title = EVTTITLE_emf_heresy_2030
	desc = EVTDESC_emf_heresy_2030
	picture = GFX_evt_heretic
	border = GFX_event_narrative_frame_religion

	major = yes
	
	religion = catholic
	only_playable = yes
	
	trigger = {
		war = no
		year = 1100
		tier = KING
		any_realm_province = {
			culture = arpitan
			religion = catholic
		}
		NOR = {
			religion_authority = 0.80
			has_global_flag = waldensian_activated
			any_independent_ruler = { religion = waldensian }
		}
	}
	
	major_trigger = {
		OR = {
			character = ROOT
			religion = waldensian
			capital_scope = {
				NOT = {
					distance = {
						where = event_target:poor_of_lyons
						value = 600	# Same part of the world
					}
				}
			}
		}
	}
	
	mean_time_to_happen = {
		years = 50
		modifier = {
			factor = 0.5
			year = 1150
		}
		modifier = {
			factor = 0.5
			year = 1175
		}
		modifier = {
			factor = 0.25
			year = 1200
		}
		modifier = {
			factor = 0.1
			year = 1225
		}
	}
	
	immediate = {
		set_global_flag = waldensian_activated
		create_character = {
			name = "Pierre"
			random_traits = yes
			dynasty = 1000124391 #Valdes
			religion = waldensian
			culture = arpitan
			female = no
			age = 40
			trait = grey_eminence
			trait = possessed
			trait = zealous
			trait = gregarious
			trait = charitable
			trait = humble
			trait = novellani
			attributes = {
				learning = 5
				diplomacy = 5
			}
		}
		new_character = {
			add_character_modifier = {
				name = voice_of_jesus
				duration = -1
			}
		}
		random_realm_province = {
			limit = {
				culture = arpitan
				religion = catholic
				county = { title = c_lyon }
			}
			save_event_target_as = poor_of_lyons
			break = yes
		}
		random_realm_province = {
			limit = {
				culture = arpitan
				religion = catholic
			}
			save_event_target_as = poor_of_lyons
		}
	}
	
	option = {
		name = EVTOPTA_emf_heresy_2030
		trigger = {
			character = ROOT
		}
		piety = -100
		event_target:poor_of_lyons = {
			religion = waldensian
			add_province_modifier = {
				name = heretic_stronghold
				duration = 3650
			}
		}
	}
	option = {
		name = EVTOPTB_emf_heresy_2030
		trigger = {
			NOT = { character = ROOT }
			religion = catholic
		}
	}
	option = {
		name = EVTOPTC_emf_heresy_2030
		trigger = {
			NOT = { religion = catholic }
		}
	}
}

# Waldensian chooses their path (fired from decision)
character_event = { 
	id = emf_heresy.2031
	desc = EVTDESC_emf_heresy_2031
	picture = GFX_evt_heretic_pride
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_emf_heresy_2031
		trigger = {
			OR = { 
				is_ruler = yes
				intrigue = 7
			}		
		}
		add_trait = sandaliati
	}
	option = {
		name = EVTOPTB_emf_heresy_2031
		trigger = {
			OR = { 
				is_priest = yes
				learning = 9
			}		
		}
		add_trait = doctores
	}
	option = {
		name = EVTOPTC_emf_heresy_2031
		trigger = {
			OR = {
				is_ruler = no
				tier = BARON
			}
		}
		add_trait = novellani
	}
}

# The first Waldensian king
character_event = { 
	id = emf_heresy.2032
	desc = EVTDESC_emf_heresy_2032
	picture = GFX_evt_heretic_pride
	border = GFX_event_normal_frame_religion
	
	only_independent = yes
	min_age = 16
	capable_only = yes
	prisoner = no
	religion = waldensian
	
	trigger = {
		higher_real_tier_than = DUKE
		piety = 200
		trait = charitable
		any_realm_province = { religion = waldensian }
		NOT = { has_global_flag = waldensian_king }
	}
	
	mean_time_to_happen = {
		years = 10
	}
	
	option = {
		name = EVTOPTA_emf_heresy_2032
		set_global_flag = waldensian_king
		religion_authority = {
			modifier = wald_king
			years = 10
		}
	}
}

# Hospital removed from province if non-Waldensian
province_event = {
	id = emf_heresy.2033
	
	hide_window = yes
	
	trigger = {
		has_province_modifier = wald_hospital
		owner = { NOT = { religion = waldensian } }
	}
	
	mean_time_to_happen = {
		months = 1
	}
	
	immediate = {
		remove_province_modifier = wald_hospital
	}
}

# Christian temple is sacked
character_event = { 
	id = emf_heresy.2034
	desc = EVTDESC_emf_heresy_2034
	picture = GFX_evt_siege
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	trigger = {
		religion = waldensian
		FROM = { 
			holding_type = temple
			NOR = {
				title = b_roma
				title = b_canterbury
				title = b_santiago
				title = b_koln
			}
			owner = {
				religion_group = christian
				NOT = { religion = waldensian }
			}
		}
	}
	
	option = {
		name = EVTOPTA_emf_heresy_2034
		ai_chance = {
			factor = 75
			modifier = {
				factor = 0
				trait = greedy
			}
			modifier = {
				factor = 0.5
				trait = envious
			}
			modifier = {
				factor = 0.5
				trait = gluttonous
			}
			modifier = {
				factor = 0.5
				trait = humble
			}
			modifier = {
				factor = 0.5
				trait = cynical
			}
		}
		piety = 50
		if = {
			limit = { NOT = { trait = charitable } }
			random = {
				chance = 50
				add_trait = charitable
			}
		}
		FROM = {
			owner = {
				religion_authority = {
					modifier = relics_destroyed
					years = 5
				}
				piety = -100
			}
		}
		if = {
			limit = { is_ruler = no }
			liege = {
				random_realm_province = {
					limit = {
						religion = waldensian
						NOT = { has_province_modifier = wald_charity }
					}
					add_province_modifier = {
						name = wald_charity
						duration = 1000
					}
				}
			}
		}
		if = {
			limit = { is_ruler = yes }
			random_realm_province = {
				limit = {
					religion = waldensian
					NOT = { has_province_modifier = wald_charity }
				}
				add_province_modifier = {
					name = wald_charity
					duration = 1000
				}
			}
		}
	}
	option = {
		name = EVTOPTB_emf_heresy_2034
		ai_chance = {
			factor = 25
			modifier = {
				factor = 0
				trait = charitable
			}
			modifier = {
				factor = 0.5
				trait = temperate
			}
			modifier = {
				factor = 0.5
				trait = proud
			}
			modifier = {
				factor = 0.5
				trait = zealous
			}
		}
		piety = -50
		wealth = 50
		if = {
			limit = { NOT = { trait = greedy } }
			random = {
				chance = 50
				add_trait = greedy
			}
		}
		FROM = {
			owner = {
				religion_authority = {
					modifier = relics_destroyed
					years = 5
				}
				piety = -100
			}
		}
	}
}

# Christian holy site is sacked
character_event = {
	id = emf_heresy.2035
	picture = GFX_evt_heresy_defeated
	border = GFX_event_normal_frame_war
	
	desc = {
		text = EVTDESC_emf_heresy_2035_rome
		trigger = {
			FROM = { title = b_roma }
		}
	}
	desc = {
		text = EVTDESC_emf_heresy_2035_canterbury
		trigger = {
			FROM = { title = b_canterbury }
		}
	}
	desc = {
		text = EVTDESC_emf_heresy_2035_santiago
		trigger = {
			FROM = { title = b_santiago }
		}
	}
	desc = {
		text = EVTDESC_emf_heresy_2035_koln
		trigger = {
			FROM = { title = b_koln }
		}
	}
	
	is_triggered_only = yes
	
	trigger = {
		religion = waldensian
		OR = {
			AND = {
				FROM = { title = b_roma }
				NOT = { has_global_flag = wald_roma }
			}
			AND = {
				FROM = { title = b_canterbury }
				NOT = { has_global_flag = wald_canterbury }
			}
			AND = {
				FROM = { title = b_santiago }
				NOT = { has_global_flag = wald_santiago }
			}
			AND = {
				FROM = { title = b_koln }
				NOT = { has_global_flag = wald_koln }
			}
		}
		FROM = {
			owner = {
				religion_group = christian
				NOT = { religion = waldensian }
			}
		}
	}
	
	option = {
		name = EVTOPTA_emf_heresy_2035
		if = {
			limit = { is_ruler = yes }
			piety = 200
		}
		if = {
			limit = { is_ruler = no }
			piety = 100
			liege = { piety = 100 }
		}
		if = {
			limit = { FROM = { title = b_roma } }
			set_global_flag = wald_roma
		}
		if = {
			limit = { FROM = { title = b_canterbury } }
			set_global_flag = wald_canterbury
		}
		if = {
			limit = { FROM = { title = b_santiago } }
			set_global_flag = wald_santiago
		}
		if = {
			limit = { FROM = { title = b_koln } }
			set_global_flag = wald_koln
		}
		FROM = {
			owner = {
				religion_authority = {
					modifier = wald_sack
					years = 10
				}
				piety = -300
				hidden_tooltip = { narrative_event = { id = emf_heresy.2036 days = 1 } }
			}
		}
		if = {
			limit = { is_ruler = no }
			liege = {
				random_realm_province = {
					limit = {
						religion = waldensian
						NOT = { has_province_modifier = wald_charity }
					}
					add_province_modifier = {
						name = wald_charity
						duration = 1000
					}
				}
			}
		}
		if = {
			limit = { is_ruler = yes }
			random_realm_province = {
				limit = {
					religion = waldensian
					NOT = { has_province_modifier = wald_charity }
				}
				add_province_modifier = {
					name = wald_charity
					duration = 1000
				}
			}
		}		
	}
}

# Christians informed that holy site was sacked
narrative_event = {
	id = emf_heresy.2036
	title = EVTNAME_emf_heresy_2036
	picture = GFX_evt_heresy_defeated
	border = GFX_event_narrative_frame_war
	
	desc = {
		text = EVTDESC_emf_heresy_2036_rome
		trigger = {
			FROMFROM = { title = b_roma }
		}
	}
	desc = {
		text = EVTDESC_emf_heresy_2036_canterbury
		trigger = {
			FROMFROM = { title = b_canterbury }
		}
	}
	desc = {
		text = EVTDESC_emf_heresy_2036_santiago
		trigger = {
			FROMFROM = { title = b_santiago }
		}
	}
	desc = {
		text = EVTDESC_emf_heresy_2036_koln
		trigger = {
			FROMFROM = { title = b_koln }
		}
	}
	
	major = yes
	is_triggered_only = yes
	
	major_trigger = {
		religion_group = christian
	}
	
	option = {
		name = EVTOPTA_emf_heresy_2036
		trigger = { NOT = { religion = waldensian } }
	}
	option = {
		name = EVTOPTB_emf_heresy_2036
		trigger = { religion = waldensian }
	}
}

# Refugees arrive at a Waldensian ruler's capital
character_event = { 
	id = emf_heresy.2037
	desc = EVTDESC_emf_heresy_2037
	picture = GFX_evt_pilgrims_epic_journey
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	religion = waldensian
	
	trigger = {
		war = yes
		is_ruler = yes
		demesne_size = 1
		OR = {
			NOT = { has_character_flag = wald_refugees }
			had_character_flag = { flag = wald_refugees days = 3650 }
		}
	}
	
	weight_multiplier = {
		days = 1
	}
	
	option = {
		name = EVTOPTA_emf_heresy_2037
		set_character_flag = wald_refugees
		piety = 50
		scaled_wealth = -0.4
		if = {
			limit = { trait = greedy }
			remove_trait = greedy
		}
		if = {
			limit = {
				NOT = { trait = charitable }
				NOT = { trait = greedy }
			}
			random = {
				chance = 75
				add_trait = charitable
			}
		}
	}
	option = {
		name = EVTOPTB_emf_heresy_2037
		set_character_flag = wald_refugees
		piety = -50
		if = {
			limit = { trait = charitable }
			remove_trait = charitable
		}
		if = {
			limit = {
				NOT = { trait = greedy }
				NOT = { trait = charitable }
			}
			random = {
				chance = 40
				add_trait = greedy
			}
		}
	}
}

# Waldensian ruler is greedy
character_event = { 
	id = emf_heresy.2038
	desc = EVTDESC_emf_heresy_2038
	picture = GFX_evt_bishop
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	religion = waldensian
	
	trigger = {
		is_ruler = yes
		trait = greedy
		NOT = { has_character_modifier = the_greedy }
	}
	
	weight_multiplier = {
		days = 1
	}
	
	option = {
		name = EVTOPTA_emf_heresy_2038
		piety = -50
		add_character_modifier = {
			name = the_greedy
			duration = 730
		}
	}
}

# Charitable Waldensian sees opportunity to help the poor
character_event = { 
	id = emf_heresy.2039
	desc = EVTDESC_emf_heresy_2039
	picture = GFX_evt_busy_trading_dock_republic
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	religion = waldensian
	
	trigger = {
		war = no
		is_ruler = yes
		trait = charitable
		scaled_wealth = 1.0
		wealth = 50
		OR = {
			trait = fortune_builder
			trait = thrifty_clerk
			trait = indulgent_wastrel
		}
		NOT = { has_character_flag = wald_steward }
	}
	
	weight_multiplier = {
		days = 1
	}
	
	option = {
		name = EVTOPTA_emf_heresy_2039
		set_character_flag = wald_steward
		scaled_wealth = { value = -0.5 min = -25 }
		if = {
			limit = { trait = fortune_builder }
			remove_trait = fortune_builder
			add_trait = midas_touched
		}
		if = {
			limit = { trait = thrifty_clerk }
			remove_trait = thrifty_clerk
			add_trait = fortune_builder
		}
		if = {
			limit = { trait = indulgent_wastrel }
			remove_trait = indulgent_wastrel
			add_trait = thrifty_clerk
		}
	}
	option = {
		name = EVTOPTB_emf_heresy_2039
		set_character_flag = wald_steward
		piety = -20
	}
}

# Waldensian child learns charity
character_event = {
	id = emf_heresy.2040
	desc = EVTDESC_emf_heresy_2040
	picture = GFX_evt_child_talking
	
	is_triggered_only = yes
	
	min_age = 6
	max_age = 16
	religion = waldensian

	trigger = {
		NOT = { personality_traits = 5 }
		NOT = { trait = charitable }
		NOT = { trait = greedy }
		educator = { religion = ROOT }
	}
	
	weight_multiplier = {
		days = 1
		modifier = {
			factor = 0.1
			educator = { trait = greedy }
		}
		modifier = {
			factor = 2.0
			educator = { trait = charitable }
		}
	}	
	
	option = {
		name = EVTOPTA_emf_heresy_2040
		add_trait = charitable
		hidden_tooltip = {
			educator = {
				character_event = {
					id = 2030
					days = 3
				}
			}
		}
	}
}

### MESSALIAN EVENTS

# Attempting to drive out the demons
character_event = {
	id = emf_heresy.2041
	desc = EVTDESC_emf_heresy_2041
	picture = GFX_evt_ritual_scroll
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_emf_heresy_2041
		set_character_flag = messalian_praying
		hidden_tooltip = {
			# Randomly pick which sin is addressed first, and whether there is a temptation event		
			random_list = {
				10 = {
					modifier = {
						factor = 0
						NOR = {
							trait = lustful
							trait = hedonist
						}
					}
					set_character_flag = driving_out_lust
					character_event = { id = emf_heresy.2045 days = 300 random = 200 } # check for success
					if = {
						limit = { NOT = { trait = homosexual } }
						random = {
							chance = 75
							character_event = { id = emf_heresy.2046 days = 150 random = 100 } # Lustful temptation
						}
					}
					if = {
						limit = { trait = homosexual }
						random = {
							chance = 75
							character_event = { id = emf_heresy.2047 days = 150 random = 100 } # Homosexual temptation
						}
					}
				}
				10 = {
					modifier = {
						factor = 0
						NOT = { trait = gluttonous }
					}
					set_character_flag = driving_out_gluttony
					character_event = { id = emf_heresy.2045 days = 300 random = 200 } # check for success
					random = {
						chance = 75
						character_event = { id = emf_heresy.2048 days = 150 random = 100 } # Gluttonous temptation
					}
				}
				10 = {
					modifier = {
						factor = 0
						NOT = { trait = greedy }
					}
					set_character_flag = driving_out_greed
					character_event = { id = emf_heresy.2045 days = 300 random = 200 } # check for success
					random = {
						chance = 75
						character_event = { id = emf_heresy.2049 days = 150 random = 100 } # Greed temptation
					}
				}
				10 = {
					modifier = {
						factor = 0
						NOT = { trait = slothful }
					}
					set_character_flag = driving_out_sloth
					character_event = { id = emf_heresy.2045 days = 300 random = 200 } # check for success
					random = {
						chance = 75
						character_event = { id = emf_heresy.2050 days = 150 random = 100 } # Slothful temptation
					}
				}
				10 = {
					modifier = {
						factor = 0
						NOT = { trait = wroth }
					}
					set_character_flag = driving_out_wrath
					character_event = { id = emf_heresy.2045 days = 300 random = 200 } # check for success
					random = {
						chance = 75
						character_event = { id = emf_heresy.2051 days = 150 random = 100 } # Wrathful temptation
					}
				}
				10 = {
					modifier = {
						factor = 0
						NOT = { trait = envious }
					}
					set_character_flag = driving_out_envy
					character_event = { id = emf_heresy.2045 days = 300 random = 200 } # check for success
					random = {
						chance = 75
						character_event = { id = emf_heresy.2052 days = 150 random = 100 } # Envious temptation
					}
				}
				10 = {
					modifier = {
						factor = 0
						NOT = { trait = proud }
					}
					set_character_flag = driving_out_pride
					character_event = { id = emf_heresy.2045 days = 300 random = 200 } # check for success
					random = {
						chance = 75
						character_event = { id = emf_heresy.2053 days = 150 random = 100 } # Pride temptation
					}
				}
				10 = {
					modifier = {
						factor = 0
						NOT = { trait = cruel }
					}
					set_character_flag = driving_out_cruelty
					character_event = { id = emf_heresy.2045 days = 300 random = 200 } # check for success
					random = {
						chance = 75
						character_event = { id = emf_heresy.2054 days = 150 random = 100 } # Cruelty temptation
					}
				}
				10 = {
					modifier = {
						factor = 0
						NOT = { trait = possessed }
					}
					set_character_flag = driving_out_possession
					character_event = { id = emf_heresy.2045 days = 300 random = 200 } # check for success
				}
				10 = {
					modifier = {
						factor = 0
						NOT = { trait = lunatic }
					}
					set_character_flag = driving_out_lunacy
					character_event = { id = emf_heresy.2045 days = 300 random = 200 } # check for success
				}
			}
		}
	}
}

# Failed to drive out the demons
character_event = {
	id = emf_heresy.2042
	desc = EVTDESC_emf_heresy_2042
	picture = GFX_evt_messalian_sin
	border = GFX_event_normal_frame_religion
	
	desc = {
		text = EVTDESC_emf_heresy_2042
		trigger = {
			NOR = {
				has_character_flag = driving_out_lunacy
				has_character_flag = driving_out_possession
			}
		}
	}
	desc = {
		text = EVTDESC_emf_heresy_2042_lunacy
		trigger = { has_character_flag = driving_out_lunacy }
	}
	desc = {
		text = EVTDESC_emf_heresy_2042_possession
		trigger = { has_character_flag = driving_out_possession }
	}

	is_triggered_only = yes
	
	trigger = { has_character_modifier = messalian_prayer }

	option = {
		name = EVTOPTA_emf_heresy_2042
		prestige = -50
		piety = -50
		clr_character_flag = messalian_praying
		remove_character_modifier = messalian_prayer
		if = {
			limit = { has_character_flag = driving_out_lust }
			add_trait = lustful
		}
		if = {
			limit = { has_character_flag = driving_out_gluttony }
			add_trait = gluttonous
		}
		if = {
			limit = { has_character_flag = driving_out_greed }
			add_trait = greedy
		}
		if = {
			limit = { has_character_flag = driving_out_sloth }
			add_trait = slothful
		}
		if = {
			limit = { has_character_flag = driving_out_wrath }
			add_trait = wroth
		}
		if = {
			limit = { has_character_flag = driving_out_envy }
			add_trait = envious
		}
		if = {
			limit = { has_character_flag = driving_out_pride }
			add_trait = proud
		}
		if = {
			limit = { has_character_flag = driving_out_cruelty }
			add_trait = cruel
		}
		if = {
			limit = { has_character_flag = driving_out_possession }
			add_trait = possessed
			add_character_modifier = {
				name = voice_of_satan
				duration = -1
			}
		}
		if = {
			limit = { has_character_flag = driving_out_lunacy }
			add_trait = lunatic
		}
		clr_character_flag = driving_out_lust
		clr_character_flag = driving_out_gluttony
		clr_character_flag = driving_out_greed
		clr_character_flag = driving_out_sloth
		clr_character_flag = driving_out_wrath
		clr_character_flag = driving_out_envy
		clr_character_flag = driving_out_pride
		clr_character_flag = driving_out_cruelty
		clr_character_flag = driving_out_possession
		clr_character_flag = driving_out_lunacy
		clr_character_flag = messalian_temptation
		random = {
			chance = 25
			add_trait = depressed
		}
		add_character_modifier = {
			name = messalian_prayer_timer
			duration = 1095
			hidden = yes
		}
	}
}

# Succeeded in driving out a demon
character_event = {
	id = emf_heresy.2043
	picture = GFX_evt_messalian_sin
	border = GFX_event_normal_frame_religion
	
	desc = {
		text = EVTDESC_emf_heresy_2043_lust
		trigger = { has_character_flag = driving_out_lust }
	}
	desc = {
		text = EVTDESC_emf_heresy_2043_gluttony
		trigger = { has_character_flag = driving_out_gluttony }
	}
	desc = {
		text = EVTDESC_emf_heresy_2043_greed
		trigger = { has_character_flag = driving_out_greed }
	}
	desc = {
		text = EVTDESC_emf_heresy_2043_sloth
		trigger = { has_character_flag = driving_out_sloth }
	}
	desc = {
		text = EVTDESC_emf_heresy_2043_wrath
		trigger = { has_character_flag = driving_out_wrath }
	}
	desc = {
		text = EVTDESC_emf_heresy_2043_envy
		trigger = { has_character_flag = driving_out_envy }
	}
	desc = {
		text = EVTDESC_emf_heresy_2043_pride
		trigger = { has_character_flag = driving_out_pride }
	}
	desc = {
		text = EVTDESC_emf_heresy_2043_cruelty
		trigger = { has_character_flag = driving_out_cruelty }
	}
	desc = {
		text = EVTDESC_emf_heresy_2043_possession
		trigger = { has_character_flag = driving_out_possession }
	}
	desc = {
		text = EVTDESC_emf_heresy_2043_lunacy
		trigger = { has_character_flag = driving_out_lunacy }
	}

	is_triggered_only = yes
	
	trigger = { has_character_modifier = messalian_prayer }

	option = {
		name = EVTOPTA_emf_heresy_2043
		prestige = 50
		piety = 50
		if = {
			limit = { has_character_flag = driving_out_lust }
			remove_trait = lustful
			remove_trait = hedonist
			random = {
				chance = 20
				add_trait = chaste
			}
		}
		if = {
			limit = { has_character_flag = driving_out_gluttony }
			remove_trait = gluttonous
			random = {
				chance = 20
				add_trait = temperate
			}
		}
		if = {
			limit = { has_character_flag = driving_out_greed }
			remove_trait = greedy
			random = {
				chance = 20
				add_trait = charitable
			}
		}
		if = {
			limit = { has_character_flag = driving_out_sloth }
			remove_trait = slothful
			random = {
				chance = 20
				add_trait = diligent
			}
		}
		if = {
			limit = { has_character_flag = driving_out_wrath }
			remove_trait = wroth
			random = {
				chance = 20
				add_trait = patient
			}
		}
		if = {
			limit = { has_character_flag = driving_out_envy }
			remove_trait = envious
			random = {
				chance = 20
				add_trait = kind
			}
		}
		if = {
			limit = { has_character_flag = driving_out_pride }
			remove_trait = proud
			random = {
				chance = 20
				add_trait = humble
			}
		}
		if = {
			limit = { has_character_flag = driving_out_cruelty }
			remove_trait = cruel
			random = {
				chance = 20
				add_trait = kind
			}
		}
		if = {
			limit = { has_character_flag = driving_out_possession }
			remove_trait = possessed
			hidden_tooltip = {
				remove_character_modifier = voice_of_satan
				remove_character_modifier = voice_of_jesus
				remove_character_modifier = speaking_in_tounges
				remove_character_modifier = holy_comet
				remove_character_modifier = lycanthropy
				clr_character_flag = demon_child
				clr_character_flag = demon_child_fake
				clr_character_flag = child_exorcism
			}
		}
		if = {
			limit = { has_character_flag = driving_out_lunacy }
			remove_trait = lunatic
		}
		clr_character_flag = driving_out_lust
		clr_character_flag = driving_out_gluttony
		clr_character_flag = driving_out_greed
		clr_character_flag = driving_out_sloth
		clr_character_flag = driving_out_wrath
		clr_character_flag = driving_out_envy
		clr_character_flag = driving_out_pride
		clr_character_flag = driving_out_cruelty
		clr_character_flag = driving_out_possession
		clr_character_flag = driving_out_lunacy
		clr_character_flag = messalian_temptation
		clr_character_flag = messalian_praying
		remove_character_modifier = messalian_prayer
	}
}

# Forced to abandon prayers
character_event = {
	id = emf_heresy.2044
	picture = GFX_evt_ritual_scroll
	border = GFX_event_normal_frame_religion

	desc = {
		text = EVTDESC_emf_heresy_2044_not_messalian
		trigger = { NOT = { religion = messalian } }
	}
	desc = {
		text = EVTDESC_emf_heresy_2044_prisoner
		trigger = { prisoner = yes }
	}
	desc = {
		text = EVTDESC_emf_heresy_2044_incapable
		trigger = { trait = incapable }
	}
	
	min_age = 16
	has_character_flag = messalian_praying
	
	trigger = {
		has_character_modifier = messalian_prayer
		OR = {
			NOT = { religion = messalian }
			prisoner = yes
			trait = incapable
		}
	}
	
	mean_time_to_happen = {
		days = 1
	}
	
	option = {
		name = OK
		remove_character_modifier = messalian_prayer
		clr_character_flag = driving_out_lust
		clr_character_flag = driving_out_gluttony
		clr_character_flag = driving_out_greed
		clr_character_flag = driving_out_sloth
		clr_character_flag = driving_out_wrath
		clr_character_flag = driving_out_envy
		clr_character_flag = driving_out_pride
		clr_character_flag = driving_out_cruelty
		clr_character_flag = driving_out_possession
		clr_character_flag = driving_out_lunacy
		clr_character_flag = messalian_temptation
		clr_character_flag = messalian_praying
		add_character_modifier = {
			name = messalian_prayer_timer
			duration = 1095
			hidden = yes
		}
	}
}

# Bounce event to determine success
character_event = {
	id = emf_heresy.2045
	
	hide_window = yes
	is_triggered_only = yes
	
	trigger = { has_character_modifier = messalian_prayer }
	
	immediate = {
		random_list = {
			60 = {
				modifier = {
					factor = 1.2
					trait = diligent
				}
				modifier = {
					factor = 1.2
					trait = patient
				}
				modifier = {
					factor = 1.2
					trait = ambitious
				}
				modifier = {
					factor = 0.25
					has_character_flag = messalian_temptation
				}
				modifier = {
					factor = 0.15
					OR = {
						has_character_flag = driving_out_possession
						has_character_flag = driving_out_lunacy
					}
				}
				character_event = { id = emf_heresy.2043 } #Success
			}
			40 = {
				modifier = {
					factor = 1.2
					trait = slothful
				}
				modifier = {
					factor = 1.2
					trait = content
				}
				modifier = {
					factor = 2.125
					has_character_flag = messalian_temptation
				}
				modifier = {
					factor = 2.25
					OR = {
						has_character_flag = driving_out_possession
						has_character_flag = driving_out_lunacy
					}
				}
				character_event = { id = emf_heresy.2042 } #Failure
			}
		}
	}
}

# Praying character receives lustful temptation
character_event = {
	id = emf_heresy.2046
	desc = EVTDESC_emf_heresy_2046
	picture = GFX_evt_lovers
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_emf_heresy_2046 #I will surround myself only with those of my gender!
		any_lover = {
			tooltip = { remove_lover = ROOT }
			hidden_tooltip = { character_event = { id = WoL.1103 } }
		}
		hidden_tooltip = {
			character_event = { id = emf_heresy.2047 days = 10 random = 20 }
		}
	}
	option = {
		name = EVTOPTB_emf_heresy_2046 #I cannot resist the temptation
		set_character_flag = messalian_temptation
		piety = -25
	}
}

# Praying character receives homosexual temptation
character_event = {
	id = emf_heresy.2047
	picture = GFX_evt_lovers
	border = GFX_event_normal_frame_religion
	
	desc = {
		text = EVTDESC_emf_heresy_2047_male
		trigger = { is_female = no }
	}
	desc = {
		text = EVTDESC_emf_heresy_2047_female
		trigger = { is_female = yes }
	}

	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_emf_heresy_2047 #I must resist!
		trigger = { piety = 50 }
		any_lover = {
			tooltip = { remove_lover = ROOT }
			hidden_tooltip = { character_event = { id = WoL.1103 } }
		}
		piety = -50
	}
	option = {
		name = EVTOPTB_emf_heresy_2047 #I have no choice but to give in
		set_character_flag = messalian_temptation
		if = {
			limit = { NOT = { trait = homosexual } }
			add_trait = homosexual
		}
	}
}

# Praying character receives gluttonous temptation
character_event = {
	id = emf_heresy.2048
	desc = EVTDESC_emf_heresy_2048
	picture = GFX_evt_knight_kneeling
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_emf_heresy_2048 #I cannot surrender to the sins of the flesh!
		trigger = {
			piety = 50
		}
		piety = -50
		health = -1
	}
	option = {
		name = EVTOPTB_emf_heresy_2047 #I have no choice but to give in
		set_character_flag = messalian_temptation
	}
}

# Praying character receives greed temptation
character_event = {
	id = emf_heresy.2049
	desc = EVTDESC_emf_heresy_2049
	picture = GFX_evt_knight_kneeling
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_emf_heresy_2049 #No, gambling is sinful and greedy
		trigger = {
			piety = 50
		}
		piety = -50
	}
	option = {
		name = EVTOPTB_emf_heresy_2049 #Perhaps just a few games won't hurt...
		set_character_flag = messalian_temptation
		scaled_wealth = 0.1
	}
}

# Praying character receives slothful temptation
character_event = {
	id = emf_heresy.2050
	desc = EVTDESC_emf_heresy_2050
	picture = GFX_evt_knight_kneeling
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_emf_heresy_2050 #I will make a determined effort
		trigger = {
			NOT = { trait = content }
			OR = {
				piety = 50
				NOT = { trait = stressed }
			}
		}
		if = {
			limit = { trait = stressed }
			piety = -50
		}
		if = {
			limit = { NOT = { trait = stressed } }
			add_trait = stressed
		}
	}
	option = {
		name = EVTOPTB_emf_heresy_2050 #Prayers can wait until tomorrow
		set_character_flag = messalian_temptation
		if = {
			limit = { NOT = { trait = content } }
			random = {
				chance = 30
				add_trait = content
			}
		}
	}
}

# Praying character receives wrathful temptation
character_event = {
	id = emf_heresy.2051
	desc = EVTDESC_emf_heresy_2051
	picture = GFX_evt_knight_kneeling
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_emf_heresy_2051 #Slowly count to ten...
		trigger = {
			piety = 50
		}
		piety = -50
		prestige = -50
	}
	option = {
		name = EVTOPTB_emf_heresy_2051 #Have that hat nailed to his head
		set_character_flag = messalian_temptation
		prestige = 50
	}
}

# Praying character receives envious temptation
character_event = {
	id = emf_heresy.2052
	desc = EVTDESC_emf_heresy_2052
	picture = GFX_evt_knight_kneeling
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_emf_heresy_2052 #I can do without it
		trigger = {
			piety = 50
		}
		piety = -50
		if = {
			limit = { trait = ambitious }
			random = {
				chance = 50
				remove_trait = ambitious
			}
		}
	}
	option = {
		name = EVTOPTB_emf_heresy_2052 #I will take it for myself
		set_character_flag = messalian_temptation
		prestige = 50
		if = {
			limit = { NOT = { trait = ambitious } }
			random = {
				chance = 50
				add_trait = ambitious
			}
		}
	}
}

# Praying character receives pride temptation
character_event = {
	id = emf_heresy.2053
	desc = EVTDESC_emf_heresy_2053
	picture = GFX_evt_knight_kneeling
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_emf_heresy_2053 #Humbly ask him for help
		trigger = {
			piety = 50
		}
		prestige = -50
		piety = -50
	}
	option = {
		name = EVTOPTB_emf_heresy_2053 #No, that's ridiculous! What could he do?
		set_character_flag = messalian_temptation
		prestige = 50
	}
}

# Praying character receives cruelty temptation
character_event = {
	id = emf_heresy.2054
	desc = EVTDESC_emf_heresy_2054
	picture = GFX_evt_knight_kneeling
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_emf_heresy_2054 #Let him go free
		trigger = {
			piety = 50
		}
		prestige = -50 
		piety = -50
		if = {
			limit = { NOT = { trait = arbitrary } }
			random = {
				chance = 30
				add_trait = arbitrary
			}
		}
	}
	option = {
		name = EVTOPTB_emf_heresy_2054 #Hang him as he deserves!
		set_character_flag = messalian_temptation
		prestige = 50
	}
}

# Messalian chooses a patron saint
character_event = {
	id = emf_heresy.2055
	desc = EVTDESC_emf_heresy_2055
	picture = GFX_evt_knight_kneeling
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_emf_heresy_2055
		add_character_modifier = {
			name = patron_nestor
			duration = -1
		}
	}
	option = {
		name = EVTOPTB_emf_heresy_2055
		add_character_modifier = {
			name = patron_addai
			duration = -1
		}
	}
	option = {
		name = EVTOPTC_emf_heresy_2055
		add_character_modifier = {
			name = patron_lucifer
			duration = -1
		}
	}
	option = {
		name = EVTOPTD_emf_heresy_2055
		add_character_modifier = {
			name = patron_adelphius 
			duration = -1
		}
	}
}

# Joining the Cult of Lucifer
character_event = { 
	id = emf_heresy.2056
	desc = EVTDESC_emf_heresy_2056
	picture = GFX_evt_cult_initiation
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_emf_heresy_2056
		add_trait = cult_of_lucifer
	}
}

# The Army of Lucifer founded
narrative_event = {
	id = emf_heresy.2057
	title = EVTNAME_emf_heresy_2057
	desc = EVTDESC_emf_heresy_2057
	picture = GFX_evt_crusaders
	border = GFX_event_narrative_frame_war
	
	is_triggered_only = yes
	major = yes
	hide_from = yes
	
	option = {
		name = EVTOPTA_emf_heresy_2057
		trigger = {
			religion = messalian
		}
	}
	option = {
		name = I_SEE
		trigger = {
			NOT = { religion = messalian }
		}
	}
}

# Ping event when donating money to the Army of Light
character_event = {
	id = emf_heresy.2058
	
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		wealth = 300
		FROM = {
			letter_event = {
				id = emf_heresy.2059
			}
		}
		opinion = {
			who = FROM
			modifier = opinion_generous_donation
		}
	}
}

# Notification event when donating money to the Army of Light
letter_event = {
	id = emf_heresy.2059
	desc = EVTDESC_emf_heresy_2059
	border = GFX_event_letter_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EXCELLENT
	}
}

# Ping event when expelling the Army of Light
character_event = {
	id = emf_heresy.2060
	
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		random_demesne_title = {
			limit = { holy_order = yes }
			save_event_target_as = holy_order_name
		}
		any_title_under = {
			limit = {
				tier = BARON
				location = {
					owner = {
						OR = {
							character = FROM
							is_liege_or_above = FROM
						}
					}
				}
			}
			usurp_title = FROM
		}
		if = {
			limit = { is_liege_or_above = FROM }
			set_defacto_liege = THIS
		}
		FROM = {
			letter_event = {
				id = emf_heresy.2061
			}
		}
		opinion = {
			who = FROM
			modifier = opinion_expelled_from_realm
		}
	}
}

# Notification event when expelling the Army of Light
letter_event = {
	id = emf_heresy.2061
	desc = EVTDESC_emf_heresy_2061
	border = GFX_event_letter_frame_religion
	
	is_triggered_only = yes
	
	immediate = {
		remove_character_modifier = donated_to_holy_order
	}
	
	option = {
		name = EVTOPTB_SOA_1061
	}
}

### MONK/NUN EVENTS

# Adult christian asks to become a monk/nun
letter_event = {
	id = emf_heresy.2062
	border = GFX_event_letter_frame_religion
	
	desc = {
		text = EVTDESC_emf_heresy_2062_male
		trigger = { FROM = { is_female = no } }
	}
	desc = {
		text = EVTDESC_emf_heresy_2062_female
		trigger = { FROM = { is_female = yes } }
	}
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_SoA_5218
		FROM = {
			any_spouse = { remove_spouse = PREV }
			if = {
				limit = { is_female = no }
				change_learning = 1
				add_trait = monk
				hidden_tooltip = {
					set_character_flag = title_monk
					set_special_character_title = MONK_BROTHER
				}
			}
			if = {
				limit = { is_female = yes }
				change_learning = 1
				add_trait = nun
				hidden_tooltip = {
					set_character_flag = title_nun
					set_special_character_title = NUN_SISTER
				}
			}
			opinion = {
				modifier = opinion_grateful
				who = ROOT
				years = 100
			}
		}
	}
	option = {
		name = EVTOPTB_SoA_5218
		FROM = {
			random_list = {
				50 = { add_trait = stressed }
				50 = { add_trait = depressed }
				20 = { add_trait = cynical }
			}
			set_character_flag = monk_refused
			opinion = {
				modifier = opinion_angry
				who = ROOT
				years = 10
			}
		}
	}
}

### MIAPHYSITE EVENTS

# Birth of the Order of Saint Blaise
narrative_event = {
	id = emf_heresy.2063
	title = EVTNAME_emf_heresy_2063
	desc = EVTDESC_emf_heresy_2063
	picture = GFX_evt_knight_kneeling
	
	major = yes
	only_playable = yes
	religion_group = christian
	hide_from = yes
	
	trigger = {
		OR = {
			religion = apostolic
			religion = paulician
			religion = tondrakian
		}
		is_heretic = no
		
		NOT = { is_title_active = d_saint_blaise }
		has_global_flag = christian_crusades_unlocked
		
		OR = {
			year = 1191	# Historical
			k_jerusalem = {
				holder_scope = { religion_group = christian }
			}
		}
	}
	
	mean_time_to_happen = {
		months = 36
		modifier = {
			factor = 10
			k_jerusalem = {
				holder_scope = { religion_group = christian }
			}
		}
	}
	
	immediate = {
		activate_title = { title = d_saint_blaise status = yes }
		create_character = {
			random_traits = no
			dynasty = random
			religion = ROOT
			culture = armenian
			female = no
			age = 35
		}
		new_character = {
			wealth = 500
			d_saint_blaise = {
				grant_title = PREV
			}
			create_random_soldier = {
				random_traits = yes
				dynasty = random
				religion = ROOT
				culture = armenian
				female = no
				age = 16
			}
			create_random_soldier = {
				random_traits = yes
				dynasty = random
				religion = ROOT
				culture = armenian
				female = no
				age = 18
			}
			create_random_soldier = {
				random_traits = yes
				dynasty = random
				religion = ROOT
				culture = armenian
				female = no
				age = 18
			}
			create_random_soldier = {
				random_traits = yes
				dynasty = random
				religion = ROOT
				culture = armenian
				female = no
				age = 20
			}
			create_random_priest = {
				random_traits = yes
				dynasty = random
				religion = ROOT
				culture = armenian
				female = no
				age = 25
			}
			create_random_priest = {
				random_traits = yes
				dynasty = random
				religion = ROOT
				culture = armenian
				female = no
				age = 26
			}
			create_character = {
				random_traits = yes
				dynasty = random
				religion = ROOT
				culture = coptic
				female = no
				age = 28
			}
			create_character = {
				random_traits = yes
				dynasty = random
				religion = ROOT
				culture = armenian
				female = yes
				age = 25
			}
		}
	}
	
	option = {
		name = EVTOPTA_emf_heresy_2063
		trigger = {
			religion_group = christian
		}
	}
	option = {
		name = EVTOPTB39100
		trigger = {
			NOT = { religion_group = christian }
		}
	}
}

# Birth of the Order of Saint Mark
narrative_event = {
	id = emf_heresy.2064
	title = EVTNAME_emf_heresy_2064
	desc = EVTDESC_emf_heresy_2064
	picture = GFX_evt_knight_kneeling
	
	major = yes
	hide_from = yes
	
	is_triggered_only = yes
	
	immediate = {
		create_random_soldier = {
			random_traits = yes
			dynasty = random
			religion = ROOT
			culture = ROOT
			female = no
			age = 35
		}
		new_character = {
			wealth = 500
			d_knights_saint_mark = {
				grant_title = PREV
			}
			create_random_soldier = {
				random_traits = yes
				dynasty = random
				religion = ROOT
				culture = ROOT
				female = no
				age = 16
			}
			create_random_soldier = {
				random_traits = yes
				dynasty = random
				religion = ROOT
				culture = ROOT
				female = no
				age = 18
			}
			create_random_soldier = {
				random_traits = yes
				dynasty = random
				religion = ROOT
				culture = ROOT
				female = no
				age = 18
			}
			create_random_soldier = {
				random_traits = yes
				dynasty = random
				religion = ROOT
				culture = ROOT
				female = no
				age = 20
			}
			create_random_priest = {
				random_traits = yes
				dynasty = random
				religion = ROOT
				culture = ROOT
				female = no
				age = 25
			}
			create_random_priest = {
				random_traits = yes
				dynasty = random
				religion = ROOT
				culture = ROOT
				female = no
				age = 26
			}
			create_character = {
				random_traits = yes
				dynasty = random
				religion = ROOT
				culture = ROOT
				female = no
				age = 28
			}
			create_character = {
				random_traits = yes
				dynasty = random
				religion = ROOT
				culture = ROOT
				female = yes
				age = 16
			}
		}
	}
	
	option = {
		name = EVTOPTA_emf_heresy_2063
		trigger = {
			religion_group = ROOT
		}
	}
	option = {
		name = EVTOPTB39100
		trigger = {
			NOT = { religion_group = ROOT }
		}
	}
}

# Desert Mother/Father moves on after staying a while
character_event = {
	id = emf_heresy.2065
	
	hide_window = yes
	ai = yes
	capable_only = yes
	prisoner = no
	religion_group = christian
	has_character_flag = is_desert_mother_father
	
	trigger = {
		OR = {
			trait = desert_mother
			trait = desert_father
		}
		war = no
		is_ill = no
		NOR = {
			any_liege = { war = yes }
			trait = wounded
			trait = maimed
			trait = infirm
		}
	}
	
	mean_time_to_happen = {
		months = 72
		modifier = {
			factor = 1.5
			OR = {
				is_councillor = yes
				is_voter = yes
			}
		}
		modifier = {
			factor = 2
			is_ruler = yes
		}
		modifier = {
			factor = 1.5
			liege = { reverse_opinion = { who = ROOT value = 25 } }
		}
		modifier = {
			factor = 0.5
			NOT = { liege = { reverse_opinion = { who = ROOT value = 0 } } }
		}
		modifier = {
			factor = 0.5
			NOT = { liege = { opinion = { who = ROOT value = 0 } } }
		}
	}
	
	immediate = {
		liege = { save_event_target_as = current_liege }
		location = { save_event_target_as = current_location }
		
		# Abdicate from title if one is held
		if = {
			limit = { is_ruler = yes }
			current_heir = {
				ROOT = { transfer_scaled_wealth = { to = PREV value = all } }
			}
			abdicate = yes
		}
		
		# Move to another court (other Miaphysites first)
		random_playable_ruler = {
			limit = {
				NOT = { character = event_target:current_liege }
				religion = ROOT
				capital_scope = {
					NOT = { distance = { where = event_target:current_location value = 200 } }
				}
			}
			ROOT = { move_character = PREV }
			break = yes
		}
		random_playable_ruler = {
			limit = {
				NOT = { character = event_target:current_liege }
				religion = ROOT
				capital_scope = {
					NOT = { distance = { where = event_target:current_location value = 400 } }
				}
			}
			ROOT = { move_character = PREV }
			break = yes
		}
		random_playable_ruler = {
			limit = {
				NOT = { character = event_target:current_liege }
				OR = {
					is_heresy_of = ROOT
					is_parent_religion = ROOT
				}
				capital_scope = {
					NOT = { distance = { where = event_target:current_location value = 400 } }
				}
			}
			ROOT = { move_character = PREV }
			break = yes
		}
		random_playable_ruler = {
			limit = {
				NOT = { character = event_target:current_liege }
				religion_group = ROOT
				capital_scope = {
					NOT = { distance = { where = event_target:current_location value = 200 } }
				}
			}
			ROOT = { move_character = PREV }
			break = yes
		}
		random_playable_ruler = {
			limit = {
				NOT = { character = event_target:current_liege }
				religion = ROOT
			}
			ROOT = { move_character = PREV }
			break = yes
		}
		random_playable_ruler = {
			limit = {
				NOT = { character = event_target:current_liege }
				OR = {
					is_heresy_of = ROOT
					is_parent_religion = ROOT
				}
			}
			ROOT = { move_character = PREV }
			break = yes
		}
		random_playable_ruler = {
			limit = {
				NOT = { character = event_target:current_liege }
				religion_group = ROOT
				capital_scope = {
					NOT = { distance = { where = event_target:current_location value = 400 } }
				}
			}
			ROOT = { move_character = PREV }
			break = yes
		}
	}
}

### ICONOCLAST EVENTS

# Iconoclast ruler has an Orthodox province with acheiropoieta
character_event = {
	id = emf_heresy.2100
	title = EVTNAME_emf_heresy_2100
	desc = EVTDESC_emf_heresy_2100
	picture = GFX_evt_icon
	
	only_playable = yes
	capable_only = yes
	prisoner = no
	min_age = 16
	religion = iconoclast
	
	trigger = {
		war = no
		controls_religion = no
		NOT = { rightful_religious_head = ROOT }
		d_iconoclast = { has_holder = yes }
		any_demesne_province = {
			religion = orthodox
			NOT = { has_province_flag = acheiropoieta_destroyed }
			NOT = { has_province_modifier = iconoclast_blowback }
		}
		OR = {
			NOT = { has_character_flag = acheiropoieta }
			had_character_flag = { flag = acheiropoieta days = 1825 }
		}
	}
	
	mean_time_to_happen = {
		years = 75
		modifier = {
			factor = 0.5
			trait = zealous
		}
		modifier = {
			factor = 2.0
			trait = cynical
		}
		modifier = {
			factor = 0.5
			trait = iconoclast_trait
		}
	}

	immediate = {
		set_character_flag = acheiropoieta
		random_demesne_province = {
			limit = {
				religion = orthodox
				NOT = { has_province_flag = acheiropoieta_destroyed }
				NOT = { has_province_modifier = iconoclast_blowback }
			}
			save_event_target_as = acheiropoieta_province
		}
		d_iconoclast = {
			holder_scope = {
				save_event_target_as = iconoclast_patriarch
			}
		}
	}
	
	option = {
		name = EVTOPTA_emf_heresy_2100 #Destroy it
		ai_chance = {
			factor = 75
			modifier = {
				factor = 2
				trait = zealous
			}
			modifier = {
				factor = 2
				trait = iconoclast_trait
			}
			modifier = {
				factor = 1.5
				trait = diligent
			}
			modifier = {
				factor = 1.5
				trait = wroth
			}
		}
		piety = 100
		if = {
			limit = { NOT = { trait = iconoclast_trait } }
			add_trait = iconoclast_trait
		}
		event_target:iconoclast_patriarch = {
			opinion = { who = ROOT modifier = opinion_pleased years = 5 }
		}
		event_target:acheiropoieta_province = {
			set_province_flag = acheiropoieta_destroyed
			add_province_modifier = {
				name = iconoclast_blowback
				duration = 3650
			}
			random_neighbor_province = {
				limit = {
					religion = orthodox
					NOT = { has_province_modifier = iconoclast_blowback }
				}
				add_province_modifier = {
					name = iconoclast_blowback
					duration = 1825
				}
			}
		}
	}
	option = {
		name = EVTOPTB_emf_heresy_2100 #Leave it be
		ai_chance = {
			factor = 25
			modifier = {
				factor = 0
				NOT = { piety = 0 }
				NOT = { trait = cynical }
			}
			modifier = {
				factor = 3
				trait = cynical
			}
			modifier = {
				factor = 2
				trait = charitable
			}
			modifier = {
				factor = 1.5
				trait = slothful
			}
			modifier = {
				factor = 1.5
				trait = patient
			}
		}
		piety = -50
		event_target:iconoclast_patriarch = {
			opinion = { who = ROOT modifier = opinion_disappointed multiplier = 2 years = 5 }
		}
		if = {
			limit = { trait = iconoclast_trait }
			remove_trait = iconoclast_trait
		}
	}
	option = {
		name = EVTOPTC_emf_heresy_2100 #Keep it for myself
		trigger = { trait = greedy }
		ai_chance = {
			factor = 50
			modifier = {
				factor = 1.5
				intrigue = 10
			}
			modifier = {
				factor = 1.5
				trait = proud
			}
			modifier = {
				factor = 1.5
				trait = ambitious
			}
			modifier = {
				factor = 0.5
				trait = temperate
			}
			modifier = {
				factor = 0.5
				trait = humble
			}
			modifier = {
				factor = 0.5
				trait = content
			}
		}
		tooltip_info = greedy
		prestige = 25
		piety = 25
		hidden_tooltip = {
			event_target:acheiropoieta_province = { set_province_flag = acheiropoieta_destroyed }
			character_event = { id = emf_heresy.2101 days = 1825 random = 3650 } #Chance of going crazy
		}
	}
}

# Iconoclast ruler who kept the acheiropoieta may go crazy
character_event = {
	id = emf_heresy.2101
	desc = EVTDESC_emf_heresy_2101
	picture = GFX_evt_icon

	is_triggered_only = yes
	
	trigger = {
		religion = iconoclast
		is_ruler = yes
		prisoner = no
		NOR = {
			trait = lunatic
			trait = possessed
			trait = incapable
		}
	}

	option = {
		name = EVTOPTA_emf_heresy_2101
		random = {
			chance = 50
			add_trait = possessed
		}
		piety = -100
		if = {
			limit = { higher_tier_than = BARON }
			religion_authority = {
				modifier = ruler_converted_from
			}
		}
		abandon_heresy = yes
		set_character_flag = converted_religion
		if = {
			limit = { higher_tier_than = BARON }
			hidden_tooltip = {
				religion_authority = {
					modifier = ruler_converted_to
				}
			}
		}
	}
	option = {
		name = EVTOPTB_emf_heresy_2101
		random_list = {
			50 = { add_trait = lunatic }
			25 = {
				modifier = {
					factor = 0
					trait = zealous
				}
				modifier = {
					factor = 2
					trait = cynical
				}
				add_trait = zealous
			}
			25 = {
				modifier = {
					factor = 0
					trait = paranoid
				}
				modifier = {
					factor = 2
					trait = trusting
				}
				add_trait = paranoid
			}
			50 = {}
		}
	}
}

# Constantine's Return
narrative_event = {
	id = emf_heresy.2102
	title = EVTNAME_emf_heresy_2102
	desc = EVTDESC_emf_heresy_2102
	picture = GFX_evt_icon
	border = GFX_event_narrative_frame_religion
	
	major = yes
	
	only_playable = yes
	min_age = 16
	capable_only = yes
	prisoner = no
	religion = orthodox

	trigger = {
		has_landed_title = e_byzantium
		any_war = {
			attacker = {
				any_demesne_title = { temporary = no }
			}
			OR = {
				using_cb = religious
				using_cb = crusade
				using_cb = invasion
				using_cb = tribal_invasion
				using_cb = manifest_destiny_invasion
			}
			OR = {
				attacker = {
					character = ROOT
					NOT = { war_score = -50 }
				}
				defender = {
					character = ROOT
					war_score = 50
				}
			}
		}
		NOR = {
			year = 1000
			has_global_flag = constantines_return
			has_character_flag = renounced_iconoclasm
			has_character_flag = converted_religion
		}
	}
	
	major_trigger = {
		OR = {
			has_landed_title = e_byzantium
			any_liege = { has_landed_title = e_byzantium }
		}
	}
	
	mean_time_to_happen = {
		days = 3
	}

	immediate = {
		set_global_flag = constantines_return
	}
	
	option = {
		name = EVTOPTA_emf_heresy_2102 #End the worship of icons
		trigger = { has_landed_title = e_byzantium }
		ai_chance = {
			factor = 30
			modifier = {
				factor = 0
				trait = zealous
			}
			modifier = {
				factor = 2
				trait = cynical
			}
			modifier = {
				factor = 0.75
				year = 950
			}
			modifier = {
				factor = 0.75
				year = 1000
			}
			modifier = {
				factor = 0.5
				year = 1100
			}
		}
		set_character_flag = renounced_iconoclasm
		set_character_flag = converted_religion
		if = {
			limit = { higher_tier_than = BARON }
			religion_authority = {
				modifier = ruler_converted_from
			}
		}
		religion = iconoclast
		if = {
			limit = { higher_tier_than = BARON }
			hidden_tooltip = {
				religion_authority = {
					modifier = ruler_converted_to
				}
			}
		}
		add_trait = zealous
		if = {
			limit = { NOT = { is_title_active = d_iconoclast } }
			activate_title = { title = d_iconoclast status = yes }
		}
		hidden_tooltip = {
			if = {
				limit = {
					any_vassal = { has_landed_title = k_orthodox }
				}
				k_orthodox = {
					holder_scope = {
						d_iconoclast = { grant_title = PREV }
						unsafe_destroy_landed_title = PREV
						unsafe_religion = iconoclast  # Use this effect with care
						set_defacto_liege = ROOT
						pf_liege_change_effect = yes
					}
				}
			}
			any_realm_province = {
				limit = { religion = iconoclast }
				add_province_modifier = {
					name = appeased_religious
					months = 60
				}
			}
			hidden_tooltip = {
				any_realm_character = {
					limit = {
						NOT = { character = ROOT }
						NOT = { has_landed_title = d_iconoclast }
					}
					character_event = { id = emf_heresy.2103 days = 1 }
				}
			}
		}
		capital_scope = {
			ROOT = {
				spawn_unit = {
					province = PREV
					home = PREV
					owner = THIS
					troops = {
						light_infantry = { 1426 1426 }
						heavy_infantry = { 275 275 }
						archers = { 425 425 }
					}
					attrition = 1.0
					maintenance_multiplier = 0
					cannot_inherit = yes
				}
			}
		}
	}
	option = {
		name = EVTOPTB_emf_heresy_2102 #That is not why we are losing
		trigger = { has_landed_title = e_byzantium }
		ai_chance = {
			factor = 70
		}
		piety = -100
		prestige = -250
	}
	option = {
		name = EVTOPTC_emf_heresy_2102 #That does not bode well...
		trigger = {
			NOT = { has_landed_title = e_byzantium }
		}
	}
}

# Byzantine subjects respond to the emperor's embracing of iconoclasm heresy
character_event = {
	id = emf_heresy.2103
	desc = EVTDESC_emf_heresy_2103
	picture = GFX_evt_icon
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	trigger = { prisoner = no }
	
	option = {
		name = EVTOPTA_emf_heresy_2103 #Agree
		trigger = {
			religion_group = christian
			NOT = { religion = iconoclast }
			can_change_religion = yes
		}
		ai_chance = {
			factor = 3
			modifier = {
				factor = 2
				trait = cynical
			}
			modifier = {
				factor = 0.1
				NOT = { religion = orthodox }
			}
		}
		if = {
			limit = { higher_tier_than = BARON }
			religion_authority = {
				modifier = ruler_converted_from
			}
		}
		religion = iconoclast
		set_character_flag = converted_religion	
		if = {
			limit = { higher_tier_than = BARON }
			hidden_tooltip = {
				religion_authority = {
					modifier = ruler_converted_to
				}
			}
		}
	}
	option = {
		name = EVTOPTB_emf_heresy_2103 #Refuse
		trigger = {
			religion_group = christian
			NOT = { religion = iconoclast }
			can_change_religion = yes
		}
		ai_chance = {
			factor = 1
			modifier = {
				factor = 10
				trait = zealous
			}
			modifier = {
				factor = 3
				OR = {
					is_priest = yes
					capital_holding = { holding_type = temple }
				}
			}
		}
	}
	option = {
		name = EVTOPTC_emf_heresy_2103
		trigger = { religion = iconoclast }
	}
	option = {
		name = EVTOPTB_emf_heresy_2103
		trigger = {
			religion_group = christian
			NOT = { religion = iconoclast }
			can_change_religion = no
		}
	}
	option = {
		name = EVTOPTD_emf_heresy_2103
		trigger = { NOT = { religion_group = christian } }
	}
}

### PAULICIAN EVENTS

# Paulicians spread in the Byzantine Empire due to effective patriarch
narrative_event = {
	id = emf_heresy.2105
	title = EVTNAME_emf_heresy_2105
	desc = EVTDESC_emf_heresy_2105
	picture = GFX_evt_heretic
	border = GFX_event_narrative_frame_religion

	major = yes
	
	only_playable = yes
	min_age = 16
	capable_only = yes
	prisoner = no
	religion = paulician
	
	trigger = {
		has_landed_title = d_paulician
		war = no
		year = 800
		NOT = { has_global_flag = sergius_tychus }
		calc_true_if = {
			amount = 2
			diplomacy = 10
			diplomacy = 15
			trait = zealous
		}
		e_byzantium = {
			holder_scope = {
				religion = orthodox
				war = no
				NOT = { religion_authority = 0.8 }
				any_realm_province = {
					OR = {
						province_id = 706
						AND = {
							culture = armenian
							OR = {
								religion = orthodox
								religion = iconoclast
							}
						}
					}
				}
			}
		}
	}
	
	major_trigger = {
		OR = {
			has_landed_title = e_byzantium
			has_landed_title = d_paulician
			any_liege = { has_landed_title = e_byzantium }
			any_liege = { has_landed_title = d_paulician }
			religion = orthodox
			religion = iconoclast
			religion = paulician
		}
	}
	
	mean_time_to_happen = {
		months = 1
		modifier = {
			factor = 0.1
			diplomacy = 15
		}
	}
	
	option = {
		name = EVTOPTA_emf_heresy_2105
		trigger = { has_landed_title = e_byzantium }
		set_global_flag = sergius_tychus
		piety = -100
		any_realm_province = {
			limit = {
				OR = {
					province_id = 706
					AND = {
						culture = armenian
						OR = {
							religion = orthodox
							religion = iconoclast
						}
					}
				}
			}
			religion = paulician
		}
		hidden_tooltip = {
			random_realm_province = {
				limit = {
					OR = {
						culture = armenian
						province_id = 706
					}
					religion = paulician
				}
				add_province_modifier = {
					name = heretic_stronghold
					duration = 3650
				}
			}
		}
	}
	option = {
		name = I_SEE
		trigger = {
			NOT = { has_landed_title = e_byzantium }
			NOT = { has_landed_title = d_paulician }
		}
	}
	option = {
		name = OK
		trigger = { has_landed_title = d_paulician }
		piety = 500
		add_trait = zealous
		add_trait = ambitious
		change_diplomacy = 5
		religion_authority = {
			modifier = sergius_tychus
			years = 30
		}
	}
}

# Byzantine Emperor persecutes the Paulicians
character_event = {
	id = emf_heresy.2106
	desc = EVTDESC_emf_heresy_2106
	picture = GFX_evt_burning_house
	
	is_triggered_only = yes
	major = yes
	
	major_trigger = {
		OR = {
			has_landed_title = e_byzantium
			has_landed_title = d_paulician
			any_liege = { has_landed_title = e_byzantium }
			religion = orthodox
			religion = paulician
		}
	}
	
	option = {
		name = EVTOPTA_emf_heresy_2106 #Hopefully that will take care of it
		trigger = { has_landed_title = e_byzantium }
	}
	option = {
		name = EVTOPTB_emf_heresy_2106 #A rather extreme measure...
		trigger = {
			any_liege = { has_landed_title = e_byzantium }
			NOT = { religion = paulician }
		}
		any_courtier = {
			limit = {
				is_ruler = no
				is_adult = yes
				prisoner = no
				religion = paulician
			}
			banish = yes
		}
	}
	option = {
		name = EVTOPTC_emf_heresy_2106 #This is an outrage!
		trigger = {
			any_liege = { has_landed_title = e_byzantium }
			religion = paulician
		}
		opinion = { who = ROOT modifier = opinion_outraged years = 20 }
		reverse_opinion = { who = ROOT modifier = mad_heretic years = 20 }
	}
	option = {
		name = EVTOPTC_emf_heresy_2106 #This is an outrage!
		trigger = { has_landed_title = d_paulician }
		opinion = { who = ROOT modifier = opinion_outraged years = 20 }
		reverse_opinion = { who = ROOT modifier = mad_heretic years = 20 }
		add_rival = ROOT
	}
	option = {
		name = I_SEE
		trigger = {
			NOR = {
				has_landed_title = e_byzantium
				has_landed_title = d_paulician
				any_liege = { has_landed_title = e_byzantium }
			}
		}
	}
}

# Paulician Patriarch appears
narrative_event = {
	id = emf_heresy.2107
	title = EVTNAME_emf_heresy_2107
	desc = EVTDESC_emf_heresy_2107
	picture = GFX_evt_heretic
	border = GFX_event_narrative_frame_religion

	major = yes
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_emf_heresy_2107
		trigger = { religion = paulician }
	}
	option = {
		name = EVTOPTB_emf_heresy_2107
		trigger = {
			religion_group = christian
			NOT = { religion = paulician }
		}
	}
	option = {
		name = EVTOPTC_emf_heresy_2107
		trigger = {
			NOT = { religion_group = christian }
		}
	}
}

### BOGOMILIST EVENTS

# Bogomil appears in Tyrnovo
narrative_event = {
	id = emf_heresy.2110
	title = EVTNAME_emf_heresy_2110
	desc = EVTDESC_emf_heresy_2110
	picture = GFX_evt_heretic
	border = GFX_event_narrative_frame_religion
	
	only_independent = yes
	religion_group = christian
	major = yes
	
	trigger = {
		year = 950
		higher_real_tier_than = DUKE
		any_realm_province = {
			OR = {
				AND = {
					emf_swmh_trigger = yes
					province_id = 493
				}
				AND = {
					emf_swmh_trigger = no
					province_id = 499
				}
			}
			OR = {
				religion = paulician
				religion = orthodox
				religion = iconoclast
				religion = monothelite
			}
			NOR = {
				culture = greek
				has_province_modifier = heretic_stronghold
			}
		}
		NOR = {
			religion = bogomilist
			has_global_flag = bogomilist_activated
		}
	}
	
	major_trigger = {
		OR = {
			same_realm = ROOT
			religion = bogomilist
			religion = orthodox
			religion = iconoclast
			religion = monothelite
			religion = paulician
			capital_scope = {
				NOT = {
					distance = {
						where = event_target:bogomil_origin
						value = 600	# Same part of the world
					}
				}
			}
		}
	}
	
	mean_time_to_happen = {
		years = 10
	}
	
	immediate = {
		set_global_flag = bogomilist_activated
		ROOT = {
			religion_authority = { modifier = bogomilism_spreading }
			random_realm_province = {
				limit = {
					OR = {
						AND = {
							emf_swmh_trigger = yes
							province_id = 493
						}
						AND = {
							emf_swmh_trigger = no
							province_id = 499
						}
					}
					OR = {
						religion = paulician
						religion = orthodox
						religion = iconoclast
						religion = monothelite
					}
					NOR = {
						culture = greek
						has_province_modifier = heretic_stronghold
					}
				}
				save_event_target_as = bogomil_origin
				religion = bogomilist
				add_province_modifier = {
					name = heretic_stronghold
					duration = 3650
				}
				owner = {
					create_character = {
						name = "Bogomil"
						random_traits = yes
						dynasty = none
						religion = bogomilist
						culture = PREV
						female = no
						age = 40
						trait = mastermind_theologian
						trait = possessed
						trait = zealous
						trait = gregarious
						trait = heresiarch
						trait = scholar
						trait = perfecti
						attributes = {
							learning = 12
							diplomacy = 10
						}
					}
					new_character = {
						religion_authority = { modifier = bogomil_appears }
					}
				}
			}
		}
	}
	
	option = {
		name = EVTOPTA_emf_heresy_2110 #Convert
		trigger = {
			character = ROOT
			controls_religion = no
			NOT = { rightful_religious_head = ROOT }
			mercenary = no
			holy_order = no
			prisoner = no
			is_adult = yes
			OR = {
				religion = orthodox
				religion = iconoclast
				religion = monothelite
			}
			NOR = {
				trait = zealous
				trait = incapable
				culture = greek
				has_character_flag = converted_religion
			}
		}
		capital_scope = {
			if = {
				limit = {
					NOT = { has_province_modifier = heretic_stronghold }
					any_neighbor_province = { religion = bogomilist }
					religion = ROOT
				}
			}
			religion = bogomilist
		}
		random_realm_province = {
			limit = {
				NOT = { has_province_modifier = heretic_stronghold }
				any_neighbor_province = { religion = bogomilist }
				religion = ROOT
			}
			religion = bogomilist
		}
		random_realm_province = {
			limit = {
				NOT = { has_province_modifier = heretic_stronghold }
				any_neighbor_province = { religion = bogomilist }
				religion = ROOT
			}
			religion = bogomilist
		}
		religion_authority = { modifier = ruler_converted_from }
		religion = bogomilist
		religion_authority = { modifier = ruler_converted_to }
		hidden_tooltip = {
			e_byzantium = {
				holder_scope = {
					if = {
						limit = {
							OR = {
								religion = orthodox
								religion = iconoclast
								religion = monothelite
							}
							NOR = {
								character = ROOT
								trait = cynical
								any_claim = {
									is_primary_holder_title = yes
									holder = ROOT
								}
							}
						}
						ROOT = {
							primary_title = {
								add_claim = PREVPREV
							}
						}
					}
				}
			}
			any_courtier = {
				limit = {
					is_adult = no
					is_ruler = no
					dynasty = ROOT
					NOT = { religion = bogomilist }
				}
				religion = ROOT
			}
			primary_title = { add_law = bogomilist_church_0 }
		}
	}
	option = {
		name = EVTOPTB_emf_heresy_2110 #Don't Convert
		trigger = {
			character = ROOT
		}
	}
	option = {
		name = EVTOPTC_emf_heresy_2110
		trigger = {
			NOT = { character = ROOT }
			religion = bogomilist
		}
	}
	option = {
		name = EVTOPTD_emf_heresy_2110
		trigger = {
			NOT = { character = ROOT }
			NOT = { religion = bogomilist }
			religion_group = christian
		}
	}
	option = {
		name = I_SEE
		trigger = {
			NOT = { character = ROOT }
			NOT = { religion_group = christian }
		}
	}
}

# Initialization event for Bogomilist laws
character_event = {
	id = emf_heresy.2111
	hide_window = yes
	
	religion = bogomilist
	only_playable = yes
	
	mean_time_to_happen = {
		days = 1
	}
	
	trigger = {
		higher_tier_than = BARON
		OR = {
			AND = {
				is_title_active = d_bogomilist
				primary_title = { NOT = { has_law = bogomilist_church_4 } }
			}
			AND = {
				d_bogomilist = { has_title_flag = bogomilist_formalized }
				primary_title = {
					NOR = { 
						has_law = bogomilist_church_3
						has_law = bogomilist_church_4
					}
				}
			}
			AND = {
				d_bogomilist = { has_title_flag = bogomilist_organized }
				primary_title = {
					NOR = {
						has_law = bogomilist_church_2
						has_law = bogomilist_church_3
						has_law = bogomilist_church_4
					}
				}
			}
			AND = {
				any_demesne_title = { has_law = bogomilist_church_1 }
				primary_title = { has_law = bogomilist_church_0 }
			}
			AND = {
				any_liege = { has_law = bogomilist_church_1 }
				primary_title = { has_law = bogomilist_church_0 }
			}
		}
	}
	
	immediate = {
		if = {
			limit = {
				is_title_active = d_bogomilist
				primary_title = { NOT = { has_law = bogomilist_church_4 } }
			}
			primary_title = { add_law = bogomilist_church_4 }
			break = yes
		}
		if = {
			limit = {
				d_bogomilist = { has_title_flag = bogomilist_formalized }
				primary_title = {
					NOR = { 
						has_law = bogomilist_church_3
						has_law = bogomilist_church_4
					}
				}
			}
			primary_title = { add_law = bogomilist_church_3 }
			break = yes
		}
		if = {
			limit = {
				d_bogomilist = { has_title_flag = bogomilist_organized }
				primary_title = {
					NOR = {
						has_law = bogomilist_church_2
						has_law = bogomilist_church_3
						has_law = bogomilist_church_4
					}
				}
			}
			primary_title = { add_law = bogomilist_church_2 }
			break = yes
		}
		if = {
			limit = {
				any_demesne_title = { has_law = bogomilist_church_1 }
				primary_title = { has_law = bogomilist_church_0 }
			}
			primary_title = { add_law = bogomilist_church_1 }
			break = yes
		}
		if = {
			limit = {
				any_liege = { has_law = bogomilist_church_1 }
				primary_title = { has_law = bogomilist_church_0 }
			}
			primary_title = { add_law = bogomilist_church_1 }
			break = yes
		}
	}
}

# Formalization of Bogomilism begins
character_event = {
	id = emf_heresy.2112
	desc = EVTDESC_emf_heresy_2112
	picture = GFX_evt_monastery_monks
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_emf_heresy_2112
		custom_tooltip = {
			text = BOGO_BEGIN_FORMALIZATION
			hidden_tooltip = {
				d_bogomilist = { change_variable = { which = "bogomil_formalization" value = 1 } }
			}
		}
	}
}

# Formalization of Bogomilism ends
character_event = {
	id = emf_heresy.2113
	picture = GFX_evt_monastery_monks
	border = GFX_event_normal_frame_religion
	
	desc = {
		text = EVTDESC_emf_heresy_2113_religion
		trigger = { NOT = { religion = bogomilist } }
	}
	desc = {
		text = EVTDESC_emf_heresy_2113_rule
		trigger = { religion = bogomilist }
	}
	
	trigger = {
		has_character_modifier = formalizing_bogomilist
		OR = {
			NOT = { religion = bogomilist }
			is_ruler = no
			lower_tier_than = KING
		}
	}
	
	mean_time_to_happen = {
		days = 1
	}
	
	option = {
		name = OK
		remove_character_modifier = formalizing_bogomilist
	}
}

# Formalization: Support Common Liturgy
character_event = {
	id = emf_heresy.2114
	desc = EVTDESC_emf_heresy_2114
	picture = GFX_evt_monastery_monks
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	religion = bogomilist
	major = yes
	
	trigger = {
		religion = bogomilist
		higher_tier_than = DUKE
		has_character_modifier = formalizing_bogomilist
		d_bogomilist = {
			NOT = { is_variable_equal = { which = "bogomil_formalization" value = 4 } }
			NOT = { has_title_flag = common_liturgy }
		}
	}
	
	major_trigger = {
		religion = bogomilist
	}
	
	option = {
		name = EXCELLENT
		trigger = { character = ROOT }
		if = {
			limit = { d_bogomilist = { is_variable_equal = { which = "bogomil_formalization" value = 3 } } }
			custom_tooltip = { text = BOGO_FORMALIZATION4 }
		}
		if = {
			limit = { d_bogomilist = { is_variable_equal = { which = "bogomil_formalization" value = 2 } } }
			custom_tooltip = { text = BOGO_FORMALIZATION3 }
		}
		if = {
			limit = { d_bogomilist = { is_variable_equal = { which = "bogomil_formalization" value = 1 } } }
			custom_tooltip = { text = BOGO_FORMALIZATION2 }
		}		
		if = {
			limit = { d_bogomilist = { is_variable_equal = { which = "bogomil_formalization" value = 0 } } }
			custom_tooltip = { text = BOGO_FORMALIZATION1 }
		}
		if = {
			limit = { d_bogomilist = { NOT = { check_variable = { which = "bogomil_formalization" value = -0.5 } } } }
			custom_tooltip = { text = BOGO_FORMALIZATION0 }
		}
		hidden_tooltip = {
			d_bogomilist = {
				change_variable = { which = "bogomil_formalization" value = 1 }
				set_title_flag = common_liturgy
			}
		}
		piety = 50
	}
	option = {
		name = I_SEE
		trigger = { NOT = { character = ROOT } }
	}
}

# Formalization: Canonicalize Bible
character_event = {
	id = emf_heresy.2115
	desc = EVTDESC_emf_heresy_2115
	picture = GFX_evt_book_carolingian_script
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	religion = bogomilist
	major = yes
	
	trigger = {
		religion = bogomilist
		higher_tier_than = DUKE
		has_character_modifier = formalizing_bogomilist
		d_bogomilist = {
			NOT = { is_variable_equal = { which = "bogomil_formalization" value = 4 } }
			NOT = { has_title_flag = bible_canon }
		}
	}
	
	major_trigger = {
		religion = bogomilist
	}
	
	option = {
		name = EXCELLENT
		trigger = { character = ROOT }
		if = {
			limit = { d_bogomilist = { is_variable_equal = { which = "bogomil_formalization" value = 3 } } }
			custom_tooltip = { text = BOGO_FORMALIZATION4 }
		}
		if = {
			limit = { d_bogomilist = { is_variable_equal = { which = "bogomil_formalization" value = 2 } } }
			custom_tooltip = { text = BOGO_FORMALIZATION3 }
		}
		if = {
			limit = { d_bogomilist = { is_variable_equal = { which = "bogomil_formalization" value = 1 } } }
			custom_tooltip = { text = BOGO_FORMALIZATION2 }
		}		
		if = {
			limit = { d_bogomilist = { is_variable_equal = { which = "bogomil_formalization" value = 0 } } }
			custom_tooltip = { text = BOGO_FORMALIZATION1 }
		}
		if = {
			limit = { d_bogomilist = { NOT = { check_variable = { which = "bogomil_formalization" value = -0.5 } } } }
			custom_tooltip = { text = BOGO_FORMALIZATION0 }
		}
		hidden_tooltip = {
			d_bogomilist = {
				change_variable = { which = "bogomil_formalization" value = 1 }
				set_title_flag = bible_canon
			}
		}
		piety = 100
		prestige = 100
		change_learning = 1
		set_dynasty_flag = bogomil_canon_bible
	}
	option = {
		name = I_SEE
		trigger = { NOT = { character = ROOT } }
	}
}

# Formalization: Church Councils
character_event = {
	id = emf_heresy.2116
	desc = EVTDESC_emf_heresy_2116
	picture = GFX_evt_monastery_monks
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	religion = bogomilist
	
	trigger = {
		religion = bogomilist
		higher_tier_than = DUKE
		has_character_modifier = formalizing_bogomilist
		scaled_wealth = 1.0
		d_bogomilist = {
			NOT = { is_variable_equal = { which = "bogomil_formalization" value = 4 } }
			NOT = { has_title_flag = church_councils }
		}
	}
	
	option = {
		name = EVTOPTA_emf_heresy_2116
		if = {
			limit = { d_bogomilist = { is_variable_equal = { which = "bogomil_formalization" value = 3 } } }
			custom_tooltip = { text = BOGO_FORMALIZATION4 }
		}
		if = {
			limit = { d_bogomilist = { is_variable_equal = { which = "bogomil_formalization" value = 2 } } }
			custom_tooltip = { text = BOGO_FORMALIZATION3 }
		}
		if = {
			limit = { d_bogomilist = { is_variable_equal = { which = "bogomil_formalization" value = 1 } } }
			custom_tooltip = { text = BOGO_FORMALIZATION2 }
		}		
		if = {
			limit = { d_bogomilist = { is_variable_equal = { which = "bogomil_formalization" value = 0 } } }
			custom_tooltip = { text = BOGO_FORMALIZATION1 }
		}
		if = {
			limit = { d_bogomilist = { NOT = { check_variable = { which = "bogomil_formalization" value = -0.5 } } } }
			custom_tooltip = { text = BOGO_FORMALIZATION0 }
		}
		hidden_tooltip = {
			d_bogomilist = {
				change_variable = { which = "bogomil_formalization" value = 1 }
				set_title_flag = church_councils
			}
		}
		scaled_wealth = -1.0
		piety = 100
		hidden_tooltip = {
			character_event = { id = emf_heresy.2117 }
		}
	}
	option = {
		name = EVTOPTB_emf_heresy_2116
		prestige = -50
	}
}

character_event = {
	id = emf_heresy.2117
	desc = EVTDESC_emf_heresy_2117
	picture = GFX_evt_monastery_monks
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	major = yes
	
	major_trigger = {
		religion = bogomilist
	}
	
	option = {
		name = EVTOPTA_emf_heresy_2117
	}
}

# Formalization: Seminary Schools
character_event = {
	id = emf_heresy.2118
	desc = EVTDESC_emf_heresy_2118
	picture = GFX_evt_monastery_monks
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	religion = bogomilist
	
	trigger = {
		religion = bogomilist
		higher_tier_than = DUKE
		has_character_modifier = formalizing_bogomilist
		scaled_wealth = 0.5
		d_bogomilist = {
			NOT = { is_variable_equal = { which = "bogomil_formalization" value = 4 } }
		}
	}
	
	option = {
		name = EVTOPTA_emf_heresy_2118
		if = {
			limit = { d_bogomilist = { is_variable_equal = { which = "bogomil_formalization" value = 3 } } }
			custom_tooltip = { text = BOGO_FORMALIZATION4 }
		}
		if = {
			limit = { d_bogomilist = { is_variable_equal = { which = "bogomil_formalization" value = 2 } } }
			custom_tooltip = { text = BOGO_FORMALIZATION3 }
		}
		if = {
			limit = { d_bogomilist = { is_variable_equal = { which = "bogomil_formalization" value = 1 } } }
			custom_tooltip = { text = BOGO_FORMALIZATION2 }
		}		
		if = {
			limit = { d_bogomilist = { is_variable_equal = { which = "bogomil_formalization" value = 0 } } }
			custom_tooltip = { text = BOGO_FORMALIZATION1 }
		}
		if = {
			limit = { d_bogomilist = { NOT = { check_variable = { which = "bogomil_formalization" value = -0.5 } } } }
			custom_tooltip = { text = BOGO_FORMALIZATION0 }
		}
		hidden_tooltip = {
			d_bogomilist = {
				change_variable = { which = "bogomil_formalization" value = 1 }
			}
		}
		scaled_wealth = -0.5
		piety = 50
		hidden_tooltip = {
			character_event = { id = emf_heresy.2119 }
		}
	}
	option = {
		name = EVTOPTB_emf_heresy_2118
		piety = -50
	}
}

character_event = {
	id = emf_heresy.2119
	desc = EVTDESC_emf_heresy_2119
	picture = GFX_evt_monastery_monks
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	major = yes
	
	major_trigger = {
		religion = bogomilist
	}
	
	option = {
		name = EVTOPTA_emf_heresy_2117
	}
}

# Formalization: Endorsed by Priest
character_event = {
	id = emf_heresy.2120
	desc = EVTDESC_emf_heresy_2120
	picture = GFX_evt_heretic
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	religion = bogomilist
	major = yes
	
	trigger = {
		religion = bogomilist
		higher_tier_than = DUKE
		has_character_modifier = formalizing_bogomilist
		piety = 100
		d_bogomilist = {
			NOT = { is_variable_equal = { which = "bogomil_formalization" value = 4 } }
		}
	}
	
	major_trigger = {
		religion = bogomilist
	}
	
	option = {
		name = EXCELLENT
		trigger = { character = ROOT }
		if = {
			limit = { d_bogomilist = { is_variable_equal = { which = "bogomil_formalization" value = 3 } } }
			custom_tooltip = { text = BOGO_FORMALIZATION4 }
		}
		if = {
			limit = { d_bogomilist = { is_variable_equal = { which = "bogomil_formalization" value = 2 } } }
			custom_tooltip = { text = BOGO_FORMALIZATION3 }
		}
		if = {
			limit = { d_bogomilist = { is_variable_equal = { which = "bogomil_formalization" value = 1 } } }
			custom_tooltip = { text = BOGO_FORMALIZATION2 }
		}		
		if = {
			limit = { d_bogomilist = { is_variable_equal = { which = "bogomil_formalization" value = 0 } } }
			custom_tooltip = { text = BOGO_FORMALIZATION1 }
		}
		if = {
			limit = { d_bogomilist = { NOT = { check_variable = { which = "bogomil_formalization" value = -0.5 } } } }
			custom_tooltip = { text = BOGO_FORMALIZATION0 }
		}
		hidden_tooltip = {
			d_bogomilist = {
				change_variable = { which = "bogomil_formalization" value = 1 }
			}
		}
		piety = 25
		prestige = 25
	}
	option = {
		name = I_SEE
		trigger = { NOT = { character = ROOT } }
	}
}

# Formalization: Public Speech
character_event = {
	id = emf_heresy.2121
	desc = EVTDESC_emf_heresy_2121
	picture = GFX_evt_bishop
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	religion = bogomilist
	major = yes
	
	trigger = {
		religion = bogomilist
		higher_tier_than = DUKE
		has_character_modifier = formalizing_bogomilist
		diplomacy = 12
		has_regent = no
		d_bogomilist = {
			NOT = { is_variable_equal = { which = "bogomil_formalization" value = 4 } }
		}
	}
	
	major_trigger = {
		religion = bogomilist
	}
	
	option = {
		name = EXCELLENT
		trigger = { character = ROOT }
		if = {
			limit = { d_bogomilist = { is_variable_equal = { which = "bogomil_formalization" value = 3 } } }
			custom_tooltip = { text = BOGO_FORMALIZATION4 }
		}
		if = {
			limit = { d_bogomilist = { is_variable_equal = { which = "bogomil_formalization" value = 2 } } }
			custom_tooltip = { text = BOGO_FORMALIZATION3 }
		}
		if = {
			limit = { d_bogomilist = { is_variable_equal = { which = "bogomil_formalization" value = 1 } } }
			custom_tooltip = { text = BOGO_FORMALIZATION2 }
		}		
		if = {
			limit = { d_bogomilist = { is_variable_equal = { which = "bogomil_formalization" value = 0 } } }
			custom_tooltip = { text = BOGO_FORMALIZATION1 }
		}
		if = {
			limit = { d_bogomilist = { NOT = { check_variable = { which = "bogomil_formalization" value = -0.5 } } } }
			custom_tooltip = { text = BOGO_FORMALIZATION0 }
		}
		hidden_tooltip = {
			d_bogomilist = {
				change_variable = { which = "bogomil_formalization" value = 1 }
			}
		}
		piety = 25
		prestige = 25
	}
	option = {
		name = I_SEE
		trigger = { NOT = { character = ROOT } }
	}
}

# Formalization: Ruler Writes Text
character_event = {
	id = emf_heresy.2122
	desc = EVTDESC_emf_heresy_2122
	picture = GFX_evt_book_carolingian_script
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	religion = bogomilist
	major = yes
	
	trigger = {
		religion = bogomilist
		higher_tier_than = DUKE
		has_character_modifier = formalizing_bogomilist
		learning = 12
		NOT = { trait = blinded }
		has_regent = no
		d_bogomilist = {
			NOT = { is_variable_equal = { which = "bogomil_formalization" value = 4 } }
		}
	}
	
	major_trigger = {
		religion = bogomilist
	}
	
	option = {
		name = EXCELLENT
		trigger = { character = ROOT }
		if = {
			limit = { d_bogomilist = { is_variable_equal = { which = "bogomil_formalization" value = 3 } } }
			custom_tooltip = { text = BOGO_FORMALIZATION4 }
		}
		if = {
			limit = { d_bogomilist = { is_variable_equal = { which = "bogomil_formalization" value = 2 } } }
			custom_tooltip = { text = BOGO_FORMALIZATION3 }
		}
		if = {
			limit = { d_bogomilist = { is_variable_equal = { which = "bogomil_formalization" value = 1 } } }
			custom_tooltip = { text = BOGO_FORMALIZATION2 }
		}		
		if = {
			limit = { d_bogomilist = { is_variable_equal = { which = "bogomil_formalization" value = 0 } } }
			custom_tooltip = { text = BOGO_FORMALIZATION1 }
		}
		if = {
			limit = { d_bogomilist = { NOT = { check_variable = { which = "bogomil_formalization" value = -0.5 } } } }
			custom_tooltip = { text = BOGO_FORMALIZATION0 }
		}
		hidden_tooltip = {
			d_bogomilist = {
				change_variable = { which = "bogomil_formalization" value = 1 }
			}
		}
		piety = 25
		prestige = 25
	}
	option = {
		name = I_SEE
		trigger = { NOT = { character = ROOT } }
	}
}

# Formalization: Troublemaker Sect
character_event = {
	id = emf_heresy.2123
	desc = EVTDESC_emf_heresy_2123
	picture = GFX_evt_monastery_monks
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	religion = bogomilist
	
	trigger = {
		religion = bogomilist
		higher_tier_than = DUKE
		has_character_modifier = formalizing_bogomilist
		d_bogomilist = {
			NOT = { is_variable_equal = { which = "bogomil_formalization" value = 4 } }
			check_variable = { which = "bogomil_formalization" value = 0.5 }
		}
	}
	
	option = {
		name = EVTOPTA_emf_heresy_2123
		if = {
			limit = { d_bogomilist = { is_variable_equal = { which = "bogomil_formalization" value = 3 } } }
			custom_tooltip = { text = BOGO_FORMALIZATION2 }
		}
		if = {
			limit = { d_bogomilist = { is_variable_equal = { which = "bogomil_formalization" value = 2 } } }
			custom_tooltip = { text = BOGO_FORMALIZATION1 }
		}
		if = {
			limit = { d_bogomilist = { NOT = { check_variable = { which = "bogomil_formalization" value = 1.5 } } } }
			custom_tooltip = { text = BOGO_FORMALIZATION0 }
		}
		hidden_tooltip = {
			d_bogomilist = {
				change_variable = { which = "bogomil_formalization" value = -1 }
			}
		}
		piety = 50
	}
	option = {
		name = EVTOPTB_emf_heresy_2123
		prestige = -100
		piety = -100
	}
}

# Formalization: Traditionalist Revival
character_event = {
	id = emf_heresy.2124
	desc = EVTDESC_emf_heresy_2124
	picture = GFX_evt_heretic
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	religion = bogomilist
	
	trigger = {
		religion = bogomilist
		higher_tier_than = DUKE
		has_character_modifier = formalizing_bogomilist
		d_bogomilist = {
			NOT = { is_variable_equal = { which = "bogomil_formalization" value = 4 } }
			check_variable = { which = "bogomil_formalization" value = 0.5 }
		}
	}
	
	option = {
		name = CURSES
		if = {
			limit = { d_bogomilist = { is_variable_equal = { which = "bogomil_formalization" value = 3 } } }
			custom_tooltip = { text = BOGO_FORMALIZATION2 }
		}
		if = {
			limit = { d_bogomilist = { is_variable_equal = { which = "bogomil_formalization" value = 2 } } }
			custom_tooltip = { text = BOGO_FORMALIZATION1 }
		}
		if = {
			limit = { d_bogomilist = { NOT = { check_variable = { which = "bogomil_formalization" value = 1.5 } } } }
			custom_tooltip = { text = BOGO_FORMALIZATION0 }
		}
		hidden_tooltip = {
			d_bogomilist = {
				change_variable = { which = "bogomil_formalization" value = -1 }
			}
		}
		prestige = -50
	}
}

# Formalization: Demand For Reversal
character_event = {
	id = emf_heresy.2125
	desc = EVTDESC_emf_heresy_2125
	picture = GFX_evt_heretic
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	religion = bogomilist
	
	trigger = {
		religion = bogomilist
		higher_tier_than = DUKE
		has_character_modifier = formalizing_bogomilist
		any_realm_province = {
			religion = bogomilist
			NOT = { has_province_modifier = religious_unrest }
		}
		d_bogomilist = {
			NOT = { is_variable_equal = { which = "bogomil_formalization" value = 4 } }
			check_variable = { which = "bogomil_formalization" value = 1.5 }
		}
	}
	
	immediate = {
		random_realm_province = {
			limit = {
				religion = bogomilist
				NOT = { has_province_modifier = religious_unrest }
			}
			save_event_target_as = demand_province
		}
	}
	
	option = {
		name = EVTOPTA_emf_heresy_2125
		if = {
			limit = { d_bogomilist = { is_variable_equal = { which = "bogomil_formalization" value = 3 } } }
			custom_tooltip = { text = BOGO_FORMALIZATION2 }
		}
		if = {
			limit = { d_bogomilist = { is_variable_equal = { which = "bogomil_formalization" value = 2 } } }
			custom_tooltip = { text = BOGO_FORMALIZATION1 }
		}
		if = {
			limit = { d_bogomilist = { NOT = { check_variable = { which = "bogomil_formalization" value = 1.5 } } } }
			custom_tooltip = { text = BOGO_FORMALIZATION0 }
		}
		hidden_tooltip = {
			d_bogomilist = {
				change_variable = { which = "bogomil_formalization" value = -1 }
			}
		}
		prestige = -100
	}
	option = {
		name = EVTOPTB_emf_heresy_2125
		event_target:demand_province = {
			add_province_modifier = {
				name = religious_unrest
				duration = 1095
			}
		}
	}
}

# Formalization: Blamed by Priest
character_event = {
	id = emf_heresy.2126
	desc = EVTDESC_emf_heresy_2126
	picture = GFX_evt_heretic
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	religion = bogomilist
	major = yes
	
	trigger = {
		religion = bogomilist
		higher_tier_than = DUKE
		has_character_modifier = formalizing_bogomilist
		NOT = { piety = 100 }
		d_bogomilist = {
			NOT = { is_variable_equal = { which = "bogomil_formalization" value = 4 } }
		}
	}
	
	major_trigger = {
		religion = bogomilist
	}
	
	option = {
		name = CURSES
		if = {
			limit = { d_bogomilist = { is_variable_equal = { which = "bogomil_formalization" value = 3 } } }
			custom_tooltip = { text = BOGO_FORMALIZATION2 }
		}
		if = {
			limit = { d_bogomilist = { is_variable_equal = { which = "bogomil_formalization" value = 2 } } }
			custom_tooltip = { text = BOGO_FORMALIZATION1 }
		}
		if = {
			limit = { d_bogomilist = { NOT = { check_variable = { which = "bogomil_formalization" value = 1.5 } } } }
			custom_tooltip = { text = BOGO_FORMALIZATION0 }
		}
		hidden_tooltip = {
			d_bogomilist = {
				change_variable = { which = "bogomil_formalization" value = -1 }
			}
		}
		prestige = -50
	}
}

# Formalization: Learned Priest Objects
character_event = {
	id = emf_heresy.2127
	desc = EVTDESC_emf_heresy_2127
	picture = GFX_evt_heretic
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	religion = bogomilist
	major = yes
	
	trigger = {
		religion = bogomilist
		higher_tier_than = DUKE
		has_character_modifier = formalizing_bogomilist
		NOT = { learning = 12 }
		d_bogomilist = {
			NOT = { is_variable_equal = { which = "bogomil_formalization" value = 4 } }
		}
	}
	
	major_trigger = {
		religion = bogomilist
	}
	
	option = {
		name = CURSES
		if = {
			limit = { d_bogomilist = { is_variable_equal = { which = "bogomil_formalization" value = 3 } } }
			custom_tooltip = { text = BOGO_FORMALIZATION2 }
		}
		if = {
			limit = { d_bogomilist = { is_variable_equal = { which = "bogomil_formalization" value = 2 } } }
			custom_tooltip = { text = BOGO_FORMALIZATION1 }
		}
		if = {
			limit = { d_bogomilist = { NOT = { check_variable = { which = "bogomil_formalization" value = 1.5 } } } }
			custom_tooltip = { text = BOGO_FORMALIZATION0 }
		}
		hidden_tooltip = {
			d_bogomilist = {
				change_variable = { which = "bogomil_formalization" value = -1 }
			}
		}
		prestige = -50
		piety = -25
	}
}

# Formalization: Major Battle Won
character_event = {
	id = emf_heresy.2128
	desc = EVTDESC_emf_heresy_2128
	picture = GFX_evt_battle
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	religion = bogomilist
	major = yes
	
	trigger = {
		OR = {
			AND = {
				religion = bogomilist
				higher_tier_than = DUKE
				has_character_modifier = formalizing_bogomilist
			}
			any_liege = {
				religion = bogomilist
				higher_tier_than = DUKE
				has_character_modifier = formalizing_bogomilist
			}
		}
		OR = {
			any_war = {
				OR = {
					using_cb = crusade
					using_cb = religious
					using_cb = religious_revolt
					using_cb = emf_religious_reconquest
				}
			}
			any_liege = {
				any_war = {
					OR = {
						using_cb = crusade
						using_cb = religious
						using_cb = religious_revolt
						using_cb = emf_religious_reconquest
					}
				}
			}
		}
		d_bogomilist = {
			NOT = { is_variable_equal = { which = "bogomil_formalization" value = 4 } }
		}
	}
	
	major_trigger = {
		religion = bogomilist
	}
	
	option = {
		name = EXCELLENT
		trigger = {
			OR = {
				character = ROOT
				same_realm = ROOT
			}
			has_character_modifier = formalizing_bogomilist
		}
		if = {
			limit = { d_bogomilist = { is_variable_equal = { which = "bogomil_formalization" value = 3 } } }
			custom_tooltip = { text = BOGO_FORMALIZATION4 }
		}
		if = {
			limit = { d_bogomilist = { is_variable_equal = { which = "bogomil_formalization" value = 2 } } }
			custom_tooltip = { text = BOGO_FORMALIZATION3 }
		}
		if = {
			limit = { d_bogomilist = { is_variable_equal = { which = "bogomil_formalization" value = 1 } } }
			custom_tooltip = { text = BOGO_FORMALIZATION2 }
		}		
		if = {
			limit = { d_bogomilist = { is_variable_equal = { which = "bogomil_formalization" value = 0 } } }
			custom_tooltip = { text = BOGO_FORMALIZATION1 }
		}
		if = {
			limit = { d_bogomilist = { NOT = { check_variable = { which = "bogomil_formalization" value = -0.5 } } } }
			custom_tooltip = { text = BOGO_FORMALIZATION0 }
		}
		hidden_tooltip = {
			d_bogomilist = {
				change_variable = { which = "bogomil_formalization" value = 1 }
			}
		}
		piety = 50
	}
	option = {
		name = I_SEE
		trigger = {
			OR = {
				NOT = { has_character_modifier = formalizing_bogomilist }
				NOR = {
					character = ROOT
					same_realm = ROOT
				}
			}
		}
	}
}

# Formalization: Major Battle Lost
character_event = {
	id = emf_heresy.2129
	desc = EVTDESC_emf_heresy_2129
	picture = GFX_evt_battle
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	religion = bogomilist
	major = yes
	
	trigger = {
		OR = {
			AND = {
				religion = bogomilist
				higher_tier_than = DUKE
				has_character_modifier = formalizing_bogomilist
			}
			any_liege = {
				religion = bogomilist
				higher_tier_than = DUKE
				has_character_modifier = formalizing_bogomilist
			}
		}
		OR = {
			any_war = {
				OR = {
					using_cb = crusade
					using_cb = holy_war
					using_cb = religious_revolt
					using_cb = emf_religious_reconquest
				}
			}
			any_liege = {
				any_war = {
					OR = {
						using_cb = crusade
						using_cb = holy_war
						using_cb = religious_revolt
						using_cb = emf_religious_reconquest
					}
				}
			}
		}
		d_bogomilist = {
			NOT = { is_variable_equal = { which = "bogomil_formalization" value = 4 } }
		}
	}
	
	major_trigger = {
		religion = bogomilist
	}
	
	option = {
		name = CURSES
		trigger = {
			OR = {
				character = ROOT
				same_realm = ROOT
			}
			has_character_modifier = formalizing_bogomilist
		}
		if = {
			limit = { d_bogomilist = { is_variable_equal = { which = "bogomil_formalization" value = 3 } } }
			custom_tooltip = { text = BOGO_FORMALIZATION2 }
		}
		if = {
			limit = { d_bogomilist = { is_variable_equal = { which = "bogomil_formalization" value = 2 } } }
			custom_tooltip = { text = BOGO_FORMALIZATION1 }
		}
		if = {
			limit = { d_bogomilist = { NOT = { check_variable = { which = "bogomil_formalization" value = 1.5 } } } }
			custom_tooltip = { text = BOGO_FORMALIZATION0 }
		}
		hidden_tooltip = {
			d_bogomilist = {
				change_variable = { which = "bogomil_formalization" value = -1 }
			}
		}
		piety = 50
	}
	option = {
		name = I_SEE
		trigger = {
			OR = {
				NOT = { has_character_modifier = formalizing_bogomilist }
				NOR = {
					character = ROOT
					same_realm = ROOT
				}
			}
		}
	}
}
		
# Bogomilist Faith Organized
narrative_event = {
	id = emf_heresy.2130
	title = EVTNAME_emf_heresy_2130
	desc = EVTDESC_emf_heresy_2130
	picture = GFX_evt_monastery_monks
	border = GFX_event_narrative_frame_religion
	
	is_triggered_only = yes
	major = yes
	
	major_trigger = {
		religion = bogomilist
	}
	
	option = {
		name = EVTOPTA_emf_heresy_2130
		trigger = { character = ROOT }
	}
	option = {
		name = I_SEE
		trigger = { NOT = { character = ROOT } }
		tooltip = { religion_authority = { modifier = bogomilism_organized } }
		if = {
			limit = {
				primary_title = { NOT = { has_law = bogomilist_church_2 } }
			}
			primary_title = { add_law = bogomilist_church_2 }
		}
		if = {
			limit = { ai = yes }
			random_list = {
				25 = {
					modifier = {
						factor = 0
						ROOT = { is_heretic = yes }
					}
					modifier = {
						factor = 0
						OR = {
							trait = zealous
							trait = perfecti
							trait = incapable
							is_adult = no
							prisoner = yes
							can_change_religion = no
						}
					}
					emf_character_become_heretic_effect = yes
				}
				25 = {
					modifier = {
						factor = 0
						ROOT = { is_heretic = no }
					}
					modifier = {
						factor = 0
						OR = {
							trait = zealous
							trait = perfecti
							trait = incapable
							is_adult = no
							prisoner = yes
							can_change_religion = no
						}
					}
					abandon_heresy = yes
				}
				50 = {
					modifier = {
						factor = 0.5
						trait = cynical
					}
					modifier = {
						factor = 0.5
						trait = wroth
					}
					modifier = {
						factor = 2
						trait = patient
					}
					modifier = {
						factor = 2
						is_priest = yes
					}
				}
			}	
		}
		random_demesne_province = {
			limit = {
				religion = bogomilist
				NOT = { has_province_modifier = religious_unrest }
			}
			random_list = {
				50 = {
					add_province_modifier = {
						name = religious_unrest
						duration = 730
					}
				}
				25 = {
					modifier = {
						factor = 0
						ROOT = { is_heretic = yes }
					}
					emf_province_become_heretic_effect = yes
					add_province_modifier = {
						name = religious_unrest
						duration = 730
					}
				}
				25 = {
					modifier = {
						factor = 0
						ROOT = { is_heretic = no }
					}
					abandon_heresy = yes
					add_province_modifier = {
						name = religious_unrest
						duration = 730
					}
				}
				75 = {}
			}
		}
	}
}

# Bogomilist Faith Formalized by force
narrative_event = {
	id = emf_heresy.2131
	title = EVTNAME_emf_heresy_2131
	desc = EVTDESC_emf_heresy_2131
	picture = GFX_evt_monastery_monks
	border = GFX_event_narrative_frame_religion
	
	is_triggered_only = yes
	major = yes
	
	major_trigger = {
		religion = bogomilist
	}
	
	option = {
		name = EVTOPTA_emf_heresy_2131
		trigger = { character = ROOT }
	}
	option = {
		name = EVTOPTB_emf_heresy_2131
		trigger = { NOT = { character = ROOT } }
		tooltip = { religion_authority = { modifier = bogomilism_formalized } }
		if = {
			limit = {
				primary_title = { NOT = { has_law = bogomilist_church_3 } }
			}
			primary_title = { add_law = bogomilist_church_3 }
		}
		if = {
			limit = { ai = yes }
			random_list = {
				50 = {
					modifier = {
						factor = 0
						ROOT = { is_heretic = yes }
					}
					modifier = {
						factor = 0
						OR = {
							trait = zealous
							trait = perfecti
							trait = incapable
							is_adult = no
							prisoner = yes
							can_change_religion = no
						}
					}
					emf_character_become_heretic_effect = yes
				}
				50 = {
					modifier = {
						factor = 0
						ROOT = { is_heretic = no }
					}
					modifier = {
						factor = 0
						OR = {
							trait = zealous
							trait = perfecti
							trait = incapable
							is_adult = no
							prisoner = yes
							can_change_religion = no
						}
					}
					abandon_heresy = yes
				}
				50 = {
					modifier = {
						factor = 0.5
						trait = cynical
					}
					modifier = {
						factor = 0.5
						trait = wroth
					}
					modifier = {
						factor = 2
						trait = patient
					}
					modifier = {
						factor = 2
						is_priest = yes
					}
					random = {
						chance = 20
						add_trait = cynical
					}
				}
			}	
		}
		random_demesne_province = {
			limit = {
				religion = bogomilist
				NOT = { has_province_modifier = religious_unrest }
			}
			random_list = {
				50 = {
					add_province_modifier = {
						name = religious_unrest
						duration = 730
					}
				}
				50 = {
					modifier = {
						factor = 0
						ROOT = { is_heretic = yes }
					}
					emf_province_become_heretic_effect = yes
					add_province_modifier = {
						name = religious_unrest
						duration = 730
					}
				}
				50 = {
					modifier = {
						factor = 0
						ROOT = { is_heretic = no }
					}
					abandon_heresy = yes
					add_province_modifier = {
						name = religious_unrest
						duration = 730
					}
				}
				50 = {}
			}
		}
	}
}

# Bogomilist Faith Formalized
narrative_event = {
	id = emf_heresy.2132
	title = EVTNAME_emf_heresy_2131
	desc = EVTDESC_emf_heresy_2132
	picture = GFX_evt_monastery_monks
	border = GFX_event_narrative_frame_religion
	
	is_triggered_only = yes
	major = yes
	
	major_trigger = {
		religion = bogomilist
	}
	
	option = {
		name = EVTOPTA_emf_heresy_2130
		trigger = { character = ROOT }
	}
	option = {
		name = EVTOPTA_emf_heresy_2130
		trigger = { NOT = { character = ROOT } }
		tooltip = { religion_authority = { modifier = bogomilism_formalized } }
		if = {
			limit = {
				primary_title = { NOT = { has_law = bogomilist_church_3 } }
			}
			primary_title = { add_law = bogomilist_church_3 }
		}
	}
}

# A Bogomilist Patriarch is elected (fired from decision)
character_event = {
	id = emf_heresy.2133
	
	is_triggered_only = yes
	hide_window = yes

	immediate = {
		random_realm_lord = {
			limit = {
				religion = bogomilist
				is_theocracy = yes
				prisoner = no
				trait = perfecti
				NOT = { trait = incapable }
			}
			d_bogomilist = { grant_title = PREV }
			ROOT = {
				random_realm_title = {
					limit = { is_holy_site = ROOT }
					gain_title = PREVPREV
				}
			}
			set_defacto_liege = ROOT
			pf_liege_change_effect = yes
			save_event_target_as = new_bogomilist_patriarch
			ROOT = { narrative_event = { id = emf_heresy.2134 } }
			break = yes
		}
		random_realm_character = {
			limit = {
				religion = bogomilist
				is_ruler = no
				prisoner = no
				trait = perfecti
				learning = 12
				NOT = { trait = incapable }
			}
			d_bogomilist = { grant_title = PREV }
			ROOT = {
				random_realm_title = {
					limit = { is_holy_site = ROOT }
					gain_title = PREVPREV
				}
			}
			set_defacto_liege = ROOT
			pf_liege_change_effect = yes
			save_event_target_as = new_bogomilist_patriarch
			ROOT = { narrative_event = { id = emf_heresy.2134 } }
			break = yes
		}
		create_random_priest = {
			random_traits = yes
			dynasty = random
			religion = bogomilist
			culture = ROOT
			age = 40
			health = 7
			trait = quick
			trait = zealous
			trait = perfecti
			trait = scholar
			trait = mastermind_theologian
			attributes = {
				learning = 5
				diplomacy = 5
				martial = 2
				stewardship = 5
				intrigue = 5
			}
		}
		new_character = {
			d_bogomilist = { grant_title = PREV }
			ROOT = {
				random_realm_title = {
					limit = { is_holy_site = ROOT }
					gain_title = PREVPREV
				}
			}
			set_defacto_liege = ROOT
			save_event_target_as = new_bogomilist_patriarch
		}
		narrative_event = { id = emf_heresy.2134 }
	}
}

# The rest of the world is told about the new Bogomilist Patriarch
narrative_event = {
	id = emf_heresy.2134
	title = EVTTITLE_emf_heresy_2134
	desc = EVTDESC_emf_heresy_2134
	picture = GFX_evt_icon
	border = GFX_event_narrative_frame_religion
	sound = church_bells

	major = yes

	is_triggered_only = yes

	option = {
		name = EVTOPTA_emf_heresy_2134
		trigger = {
			NOT = { religion = bogomilist }
			religion_group = christian
		}
	}
	option = {
		name = EVTOPTB_emf_heresy_2134
		trigger = { NOT = { religion_group = christian } }
	}
	option = {
		name = EVTOPTA_emf_heresy_2130
		trigger = { religion = bogomilist }
		if = {
			limit = {
				primary_title = { NOT = { has_law = bogomilist_church_4 } }
			}
			primary_title = { add_law = bogomilist_church_4 }
		}
	}
}

# Church of St. Bogomil Construction Begun
province_event = {
	id = emf_heresy.2135
	desc = EVTDESC_emf_heresy_2135
	picture = GFX_evt_castle_construction
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_emf_heresy_2135
	}
}

province_event = {
	id = emf_heresy.2136
	
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		if = {
			limit = {
				OR = {
					owner = { war = yes }
					county = { is_occupied = yes }
				}
			}
			repeat_event = { id = emf_heresy.2136 days = 60 random = 120 }
			break = yes
		}
		if = {
			limit = {
				OR = {
					owner = { NOT = { religion = bogomilist } }
					owner = { top_liege = { NOT = { religion = bogomilist } } }
					NOT = { num_of_empty_holdings = 1 }
				}
			}
			remove_province_modifier = building_st_bogomil
			break = yes
		}
		
		# Building is successful
		set_province_flag = church_of_st_bogomil_built
		remove_province_modifier = building_st_bogomil
		owner = {
			top_liege = {
				narrative_event = { id = emf_heresy.2137 }
			}
		}
	}
}

# Church of St. Bogomil Built
narrative_event = {
	id = emf_heresy.2137
	title = EVTNAME_emf_heresy_2137
	desc = EVTDESC_emf_heresy_2137
	picture = GFX_evt_cathedral
	border = GFX_event_narrative_frame_religion
	major = yes
	
	is_triggered_only = yes
	
	hide_from = yes
	
	immediate = {
		if = {
			limit = { emf_swmh_trigger = yes }
			493 = {
				build_holding = {
				   title = b_st_bogomil
				   type = temple
				   holder = ROOT
				}
			}
		}
		if = {
			limit = { emf_swmh_trigger = no }
			499 = {
				build_holding = {
				   title = b_st_bogomil
				   type = temple
				   holder = ROOT
				}
			}
		}
	}
	
	option = {
		name = EVTOPTA_emf_heresy_2137
		trigger = { religion = bogomilist }
		if = {
			limit = { character = ROOT }
			prestige = 500
			piety = 500
			religion_authority = { modifier = church_st_bogomil_built }
		}
		if = {
			limit = {
				higher_tier_than = DUKE
				has_character_modifier = formalizing_bogomilist
				d_bogomilist = { NOT = { is_variable_equal = { which = "bogomil_formalization" value = 4 } } }
			}
			if = {
				limit = { d_bogomilist = { is_variable_equal = { which = "bogomil_formalization" value = 3 } } }
				custom_tooltip = { text = BOGO_FORMALIZATION4 }
			}
			if = {
				limit = { d_bogomilist = { is_variable_equal = { which = "bogomil_formalization" value = 2 } } }
				custom_tooltip = { text = BOGO_FORMALIZATION3 }
			}
			if = {
				limit = { d_bogomilist = { is_variable_equal = { which = "bogomil_formalization" value = 1 } } }
				custom_tooltip = { text = BOGO_FORMALIZATION2 }
			}		
			if = {
				limit = { d_bogomilist = { is_variable_equal = { which = "bogomil_formalization" value = 0 } } }
				custom_tooltip = { text = BOGO_FORMALIZATION1 }
			}
			if = {
				limit = { d_bogomilist = { NOT = { check_variable = { which = "bogomil_formalization" value = -0.5 } } } }
				custom_tooltip = { text = BOGO_FORMALIZATION0 }
			}
			hidden_tooltip = {
				d_bogomilist = {
					change_variable = { which = "bogomil_formalization" value = 1 }
				}
			}
		}
		if = {
			limit = { NOT = { character = ROOT } }
			tooltip = { religion_authority = { modifier = church_st_bogomil_built } }
		}
	}
	option = {
		name = OK
		trigger = { NOT = { religion = bogomilist } }
	}
}

# Bogomilist missionaries move into a neighboring realm
character_event = {
	id = emf_heresy.2138
	
	hide_window = yes
	is_triggered_only = yes
	religion = bogomilist
	only_independent = yes
	
	trigger = {
		religion = bogomilist
		independent = yes
		any_realm_province = {
			county = { is_occupied = no }
			religion = bogomilist
			any_neighbor_province = {
				county = { is_occupied = no }
				NOT = { religion = bogomilist }
				owner = {
					NOT = { war_with = ROOT }
					NOT = { reverse_has_truce = ROOT }
					NOT = { has_non_aggression_pact_with = ROOT }
					NOT = { same_realm = ROOT }
					NOT = { any_courtier = { has_character_flag = bogomilist_missionary } }
				}
			}
		}
		OR = {
			NOT = { has_character_flag = sent_bogomilist_missionary }
			had_character_flag = { flag = sent_bogomilist_missionary days = 3650 }
		}
	}
	
	weight_multiplier = {
		days = 1
		modifier = {
			factor = 0.75
			war = yes
		}
		modifier = {
			factor = 0.5
			has_law = bogomilist_church_0
		}
		modifier = {
			factor = 1.5
			has_law = bogomilist_church_2
		}
		modifier = {
			factor = 1.5
			has_law = bogomilist_church_3
		}
		modifier = {
			factor = 1.5
			has_law = bogomilist_church_4
		}
		modifier = {
			factor = 0.5
			lower_tier_than = DUKE
		}
		modifier = {
			factor = 1.5
			tier = EMPEROR
		}
	}
	
	immediate = {
		set_character_flag = sent_bogomilist_missionary
		random_realm_province = {
			limit = {
				religion = bogomilist
				county = { is_occupied = no }
				any_neighbor_province = {
					county = { is_occupied = no }
					NOT = { religion = bogomilist }
					owner = {
						NOT = { war_with = ROOT }
						NOT = { reverse_has_truce = ROOT }
						NOT = { has_non_aggression_pact_with = ROOT }
						NOT = { same_realm = ROOT }
						NOT = { any_courtier = { has_character_flag = bogomilist_missionary } }
					}
				}
			}
			random_neighbor_province = {
				limit = {
					county = { is_occupied = no }
					NOT = { religion = bogomilist }
					owner = {
						NOT = { war_with = ROOT }
						NOT = { reverse_has_truce = ROOT }
						NOT = { has_non_aggression_pact_with = ROOT }
						NOT = { same_realm = ROOT }
						NOT = { any_courtier = { has_character_flag = bogomilist_missionary } }
					}
				}
				owner = {
					create_random_diplomat = {
						random_traits = yes
						dynasty = none
						religion = ROOT
						culture = PREVPREV
						female = no
						age = 40
						trait = zealous
						trait = gregarious
						trait = perfecti
						attributes = {
							learning = 5
							diplomacy = 5
						}
					}
					new_character = {
						set_character_flag = bogomilist_missionary
					}
				}	
			}
		}
	}
}

