# -*- ck2.decisions -*-

decisions = {
	emf_toggle_employment = {
		only_playable = yes
		potential = {
			ai = no
		}
		effect = {
			if = {
				limit = {
					NOT = { has_character_flag = emf_toggle_employment }
				}
				set_character_flag = emf_toggle_employment
				break = yes
			}
			clr_character_flag = emf_toggle_employment
		}
		ai_will_do = {
			factor = 0
		}
	}
	
	employ_priest = {
		only_playable = yes
		potential = {
			OR = {
				AND = {
					ai = no
					has_character_flag = emf_toggle_employment
				}
				has_autocephaly = yes
				is_theocracy = yes
				is_tribal = yes
			}
			OR = {
				ai = no
				NOT = { has_character_flag = ai_employment_delay }
				had_character_flag = { flag = ai_employment_delay days = 365 }
			}
		}
		allow = {
			piety = 5
			NOT = { has_character_modifier = in_seclusion }
		}
		effect = {
			if = {
				limit = { ai = yes }
				set_character_flag = ai_employment_delay
			}
			piety = -5
			if = {
				limit = { religion_allows_female_temple_holders = no }
				create_random_priest = {
					random_traits = yes
					dynasty = random
					female = no
				}
			}			
			if = {
				limit = { religion_allows_female_temple_holders = yes }
				random_list = {
					50 = {
						create_random_priest = {
							random_traits = yes
							dynasty = random
							female = no
						}
					}
					50 = {
						create_random_priest = {
							random_traits = yes
							dynasty = random
							female = yes
						}
					}
				}
			}
			new_character = {
				hidden_tooltip = {
					if = {
						limit = {
							religion_group = christian
							NOR = {
								religion = cathar
								religion = bogomilist
								religion = miaphysite
								religion = monophysite
							}
						}
						if = {
							limit = { is_female = no }
							add_trait = monk
							set_character_flag = title_monk
							set_special_character_title = MONK_BROTHER
						}
						if = {
							limit = { is_female = yes }
							add_trait = nun
							set_character_flag = title_nun
							set_special_character_title = NUN_SISTER
						}
					}
					if = {
						limit = {
							OR = {
								religion = miaphysite
								religion = monophysite
							}
						}
						if = {
							limit = { is_female = yes }
							add_trait = desert_mother
							set_character_flag = title_desert_mother
							set_special_character_title = DESERT_MOTHER_TITLE
						}
						if = {
							limit = { is_female = no }
							add_trait = desert_father
							set_character_flag = title_desert_father
							set_special_character_title = DESERT_FATHER_TITLE
						}
					}
					if = {
						limit = {
							OR = {
								religion = cathar
								religion = bogomilist
							}
						}
						remove_trait = incapable
						remove_trait = cynical
						remove_trait = lustful
						remove_trait = hedonist
						remove_trait = seducer
						remove_trait = seductress
						add_trait = zealous
						add_trait = perfecti
						set_character_flag = consolamentum_taken
						if = {
							limit = { is_female = no }
							set_character_flag = title_monk
							set_special_character_title = MONK_BROTHER
						}
						if = {
							limit = { is_female = yes }
							set_character_flag = title_nun
							set_special_character_title = NUN_SISTER
						}
					}
					if = {
						limit = { religion_group = indian_group }
						add_trait = brahmin
						character_event = { id = RoI.30121 }
					}
				}
			}
		}
		revoke_allowed = {
			always = no
		}
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0
				NOR = {
					AND = {
						has_autocephaly = yes
						NOT = { any_courtier = { has_job_title = job_spiritual } }
					}
					AND = {
						is_theocracy = yes
						NOT = {
							any_courtier = {
								religion = ROOT
								has_education_learning_trigger = yes
								count = 3
							}
						}
					}
					AND = {
						is_tribal = yes
						NOT = {
							any_courtier = {
								is_adult = yes
								health = 4
								religion = ROOT
								culture = ROOT
								is_ruler = no
								OR = {
									is_female = no
									religion_allows_female_temple_holders = yes
								}
								OR = {
									has_education_learning_trigger = yes
									learning = 8
								}
								NOR = {
									trait = incapable
									trait = cynical
									trait = content
									trait = stressed
									trait = depressed
									is_dumb_trigger = yes
									has_severe_disability_trigger = yes
									any_heir_title = { always = yes }
								}
							}
						}
					}
				}
			}
		}
	}
	
	employ_steward = {
		only_playable = yes
		potential = {
			ai = no
			has_character_flag = emf_toggle_employment
		}
		allow = {
			scaled_wealth = 0.2
			NOT = { has_character_modifier = in_seclusion }
		}
		effect = {
			scaled_wealth = -0.2
			create_random_steward = {
				random_traits = yes
				dynasty = random
				female = no
			}
			new_character = {
				hidden_tooltip = {
					if = {
						limit = {
							religion_group = indian_group
						}
						add_trait = kshatriya
						character_event = { id = RoI.30121 }
					}
				}
			}
		}
		revoke_allowed = {
			always = no
		}
		ai_will_do = {
			factor = 0
		}
	}
	
	emf_employ_soldier = {
		only_playable = yes
		potential = {
			ai = no
			has_character_flag = emf_toggle_employment
		}
		allow = {
			scaled_wealth = 0.2
			prestige = 10
			NOT = { has_character_modifier = in_seclusion }
		}
		effect = {
			scaled_wealth = -0.2
			prestige = -10
			create_random_soldier = {
				random_traits = yes
				dynasty = random
				female = no
			}
			new_character = {
				hidden_tooltip = {
					if = {
						limit = {
							religion_group = indian_group
						}
						add_trait = kshatriya
						character_event = { id = RoI.30121 }
					}
				}
			}
		}
		revoke_allowed = {
			always = no
		}
		ai_will_do = {
			factor = 0
		}
	}
	
	emf_employ_spy = {
		only_playable = yes
		potential = {
			ai = no
			has_character_flag = emf_toggle_employment
		}
		allow = {
			scaled_wealth = 0.2
			NOT = { has_character_modifier = in_seclusion }
		}
		effect = {
			scaled_wealth = -0.2
			create_random_intriguer = {
				random_traits = yes
				dynasty = random
				female = no
			}
			new_character = {
				hidden_tooltip = {
					if = {
						limit = {
							religion_group = indian_group
						}
						add_trait = kshatriya
						character_event = { id = RoI.30121 }
					}
				}
			}
		}
		revoke_allowed = {
			always = no
		}
		ai_will_do = {
			factor = 0
		}
	}
	
	emf_employ_diplomat = {
		only_playable = yes
		potential = {
			ai = no
			has_character_flag = emf_toggle_employment
		}
		allow = {
			scaled_wealth = 0.2
			NOT = { has_character_modifier = in_seclusion }
		}
		effect = {
			scaled_wealth = -0.2
			create_random_diplomat = {
				random_traits = yes
				dynasty = random
				female = no
			}
			new_character = {
				hidden_tooltip = {
					if = {
						limit = {
							religion_group = indian_group
						}
						add_trait = kshatriya
						character_event = { id = RoI.30121 }
					}
				}
			}
		}
		revoke_allowed = {
			always = no
		}
		ai_will_do = {
			factor = 0
		}
	}
	
	present_debutante = {
		only_playable = yes
		potential = {
			ai = no
			has_character_flag = emf_toggle_employment
		}
		allow = {
			scaled_wealth = 0.2
			NOT = { has_character_modifier = in_seclusion }
		}
		effect = {
			scaled_wealth = -0.2
			random_list = {
				10 = {
					create_character = {
						random_traits = yes
						dynasty = random
						female = yes
						age = 16
					}
				}
				10 = {
					create_character = {
						random_traits = yes
						dynasty = random
						female = yes
						age = 17
					}
				}
				10 = {
					create_character = {
						random_traits = yes
						dynasty = random
						female = yes
						age = 18
					}
				}
				10 = {
					create_character = {
						random_traits = yes
						dynasty = random
						female = yes
						age = 19
					}
				}
			}
			new_character = {
				hidden_tooltip = {
					if = {
						limit = {
							religion_group = indian_group
						}
						add_trait = kshatriya
						character_event = { id = RoI.30121 }
					}
				}
			}
		}
		revoke_allowed = {
			always = no
		}
		ai_will_do = {
			factor = 0
		}
	}
}
