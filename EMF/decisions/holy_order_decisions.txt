# -*- ck2.decisions -*-

###########################################
#
# Holy Order Decisions for Sons of Abraham
#
###########################################
# Written by Henrik Fåhraeus
###########################################

# Holy Order Decisions are listed for each existing holy order of the right religion

decisions = {

	borrow_money_knights_templar = {
		only_playable = yes
		potential = {
			is_playable = yes
			emf_holy_order_templar_religion = yes
			is_nomadic = no
			is_title_active = d_knights_templar
			NOT = { has_character_modifier = borrowed_from_knights_templar }
			NOT = { has_character_modifier = expelled_d_knights_templar }
			
			has_dlc = "Sons of Abraham"
			
			d_knights_templar = {
				owner_under_ROOT = no
			}
		}
		
		allow = {
			d_knights_templar = {
				holder_scope = {
					wealth = 300
					ROOT = {
						NOT = { excommunicated_for = PREV }
					}
				}
			}
		}
		
		effect = {
			add_character_modifier = {
				name = borrowed_from_knights_templar
				duration = -1
				inherit = yes
			}
			
			hidden_tooltip = {
				d_knights_templar = {
					holder_scope = {
						character_event = {
							id = SoA.1010
						}
					}
				}
			}
			
			wealth = 300
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0
				wealth = 0
			}
			modifier = {
				factor = 0.01 # Slow it down
			}
		}
	}
	
	expel_the_knights_templar = {
		only_independent = yes
		potential = {
			ai = no
			emf_holy_order_templar_religion = yes
			higher_tier_than = DUKE
			independent = yes
			is_title_active = d_knights_templar
			NOT = { has_character_modifier = expelled_d_knights_templar }
			
			any_realm_province = {
				any_province_lord = {
					d_knights_templar = {
						holder_scope = {
							OR = {
								character = PREVPREV
								is_vassal_or_below = PREVPREV
							}
						}
					}
				}
			}
			
			has_dlc = "Sons of Abraham"
		}
		
		allow = {
			piety = 1000
			custom_tooltip = {
				text = expelling_holy_order_decision_tooltip
				hidden_tooltip = {
					NOT = { has_character_flag = expel_the_knights_templar_check }
				}
			}
		}
		
		effect = {
			set_character_flag = expel_the_knights_templar_check
			custom_tooltip = {
				text = expelling_holy_order_decision_tooltip_b
				hidden_tooltip = {
					character_event = { id = SoA.2990 }
				}
			}
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 0
		}
	}
	
	expel_the_knights_hospitaler = {
		only_independent = yes
		potential = {
			ai = no
			emf_holy_order_hospitaler_religion = yes
			higher_tier_than = DUKE
			independent = yes
			is_title_active = d_knights_hospitaler
			NOT = { has_character_modifier = expelled_d_knights_hospitaler }
			
			any_realm_province = {
				any_province_lord = {
					d_knights_hospitaler = {
						holder_scope = {
							OR = {
								character = PREVPREV
								is_vassal_or_below = PREVPREV
							}
						}
					}
				}
			}
			
			has_dlc = "Sons of Abraham"
		}
		
		allow = {
			piety = 1000
			custom_tooltip = {
				text = expelling_holy_order_decision_tooltip
				hidden_tooltip = {
					NOT = { has_character_flag = expel_the_knights_hospitaler_check }
				}
			}
		}
		
		effect = {
			set_character_flag = expel_the_knights_hospitaler_check
			custom_tooltip = {
				text = expelling_holy_order_decision_tooltip_b
				hidden_tooltip = {
					character_event = { id = SoA.2990 }
				}
			}
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 0
		}
	}
	
	expel_the_teutonic_order = {
		only_independent = yes
		potential = {
			ai = no
			emf_holy_order_teutonic_religion = yes
			higher_tier_than = DUKE
			independent = yes
			is_title_active = d_teutonic_order
			NOT = { has_character_modifier = expelled_d_teutonic_order }
			
			any_realm_province = {
				any_province_lord = {
					d_teutonic_order = {
						holder_scope = {
							OR = {
								character = PREVPREV
								is_vassal_or_below = PREVPREV
							}
						}
					}
				}
			}
			
			has_dlc = "Sons of Abraham"
		}
		
		allow = {
			piety = 1000
			custom_tooltip = {
				text = expelling_holy_order_decision_tooltip
				hidden_tooltip = {
					NOT = { has_character_flag = expel_the_teutonic_order_check }
				}
			}
		}
		
		effect = {
			set_character_flag = expel_the_teutonic_order_check
			custom_tooltip = {
				text = expelling_holy_order_decision_tooltip_b
				hidden_tooltip = {
					character_event = { id = SoA.2990 }
				}
			}
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 0
		}
	}
	
	expel_the_jomsvikings = {
		only_independent = yes
		potential = {
			ai = no
			emf_holy_order_jomsvikings_religion = yes
			higher_tier_than = DUKE
			independent = yes
			is_title_active = d_jomsvikings
			NOT = { has_character_modifier = expelled_d_jomsvikings }
			
			any_realm_province = {
				any_province_lord = {
					d_jomsvikings = {
						holder_scope = {
							OR = {
								character = PREVPREV
								is_vassal_or_below = PREVPREV
							}
						}
					}
				}
			}
			
			has_dlc = "Sons of Abraham"
		}
		
		allow = {
			piety = 1000
			custom_tooltip = {
				text = expelling_holy_order_decision_tooltip
				hidden_tooltip = {
					NOT = { has_character_flag = expel_the_jomsvikings_check }
				}
			}
		}
		
		effect = {
			set_character_flag = expel_the_jomsvikings_check
			custom_tooltip = {
				text = expelling_holy_order_decision_tooltip_b
				hidden_tooltip = {
					character_event = { id = SoA.2990 }
				}
			}
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 0
		}
	}
	
	expel_the_assassins = {
		only_independent = yes
		potential = {
			ai = no
			emf_holy_order_hashshashin_religion = yes
			higher_tier_than = DUKE
			independent = yes
			is_title_active = d_hashshashin
			NOT = { has_character_modifier = expelled_d_hashshashin }
			
			any_realm_province = {
				any_province_lord = {
					d_hashshashin = {
						holder_scope = {
							OR = {
								character = PREVPREV
								is_vassal_or_below = PREVPREV
							}
						}
					}
				}
			}
			
			has_dlc = "Sons of Abraham"
			NOT = { society_member_of = the_assassins }
		}
		
		allow = {
			piety = 1000
			custom_tooltip = {
				text = expelling_holy_order_decision_tooltip
				hidden_tooltip = {
					NOT = { has_character_flag = expel_the_assassins_check }
				}
			}
		}
		
		effect = {
			set_character_flag = expel_the_assassins_check
			custom_tooltip = {
				text = expelling_holy_order_decision_tooltip_b
				hidden_tooltip = {
					character_event = { id = SoA.2990 }
				}
			}
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 0
		}
	}
	
	donate_money_to_knights_templar = {
		only_playable = yes
		potential = {
			is_playable = yes
			
			OR = {
				AND = {
					NOR = {
						trait = cynical
						piety = 50
					}
					wealth = 1000
				}
				ai = no
			}
			
			is_title_active = d_knights_templar
			
			d_knights_templar = {
				holder_scope = { 
					religion = ROOT
				}
			}
			
			NOT = { has_character_modifier = expelled_d_knights_templar }
			
			OR = {
				AND = {
					NOT = { is_title_active = d_teutonic_order }
					NOT = { is_title_active = d_knights_santiago }
					NOT = { is_title_active = d_knights_calatrava }
				}
				AND = {
					NOT = { is_title_active = d_teutonic_order }
					NOT = { culture_group = iberian }
					NOT = { culture_group = west_african }
					NOT = { culture = maghreb_arabic }
					NOT = { culture = occitan }
				}
				AND = {
					NOT = { is_title_active = d_knights_santiago }
					NOT = { is_title_active = d_knights_calatrava }
					NOT = { culture_group = north_germanic }
					NOT = { culture_group = central_germanic }
					NOT = { culture_group = magyar }
					NOT = { culture_group = south_slavic }
					NOT = { culture_group = west_slavic }
				}
				AND = {
					NOT = { culture_group = iberian }
					NOT = { culture_group = west_african }
					NOT = { culture = maghreb_arabic }
					NOT = { culture = occitan }
					NOT = { culture_group = north_germanic }
					NOT = { culture_group = central_germanic }
					NOT = { culture_group = magyar }
					NOT = { culture_group = south_slavic }
					NOT = { culture_group = west_slavic }
				}
			}
			
			has_dlc = "Sons of Abraham"
			
			d_knights_templar = {
				owner_under_ROOT = no
			}
		}
		
		allow = {
			wealth = 300
		}
		
		effect = {
			if = {
				limit = { 
					NOT = { has_character_modifier = donated_to_holy_order }
				}
				add_character_modifier = {
					name = donated_to_holy_order
					duration = -1
				}
			}
			
			hidden_tooltip = {
				d_knights_templar = {
					holder_scope = {
						character_event = {
							id = SoA.1140
						}
					}
				}
			}
			
			wealth = -300
			piety = 75 # EMF
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0.002 # Slow it down
			}
		}
	}
	
	donate_money_to_knights_hospitaler = {
		only_playable = yes
		potential = {
			is_playable = yes
			
			OR = {
				AND = {
					wealth = 1000
					NOR = {
						trait = cynical
						piety = 50
					}
				}
				ai = no
			}
			
			is_title_active = d_knights_hospitaler
			
			d_knights_hospitaler = {
				holder_scope = { 
					religion = ROOT
				}
			}
			
			NOT = { has_character_modifier = expelled_d_knights_hospitaler }
			
			OR = {
				AND = {
					NOT = { is_title_active = d_teutonic_order }
					NOT = { is_title_active = d_knights_santiago }
					NOT = { is_title_active = d_knights_calatrava }
				}
				AND = {
					NOT = { is_title_active = d_teutonic_order }
					NOT = { culture_group = iberian }
					NOT = { culture_group = west_african }
					NOT = { culture = maghreb_arabic }
					NOT = { culture = occitan }
				}
				AND = {
					NOT = { is_title_active = d_knights_santiago }
					NOT = { is_title_active = d_knights_calatrava }
					NOT = { culture_group = north_germanic }
					NOT = { culture_group = central_germanic }
					NOT = { culture_group = magyar }
					NOT = { culture_group = south_slavic }
					NOT = { culture_group = west_slavic }
				}
				AND = {
					NOT = { culture_group = iberian }
					NOT = { culture_group = west_african }
					NOT = { culture = maghreb_arabic }
					NOT = { culture = occitan }
					NOT = { culture_group = north_germanic }
					NOT = { culture_group = central_germanic }
					NOT = { culture_group = magyar }
					NOT = { culture_group = south_slavic }
					NOT = { culture_group = west_slavic }
				}
			}
			
			has_dlc = "Sons of Abraham"
			
			d_knights_hospitaler = {
				owner_under_ROOT = no
			}
		}
		
		allow = {
			wealth = 300
		}
		
		effect = {
			if = {
				limit = { 
					NOT = { has_character_modifier = donated_to_holy_order }
				}
				add_character_modifier = {
					name = donated_to_holy_order
					duration = -1
				}
			}
			
			hidden_tooltip = {
				d_knights_hospitaler = {
					holder_scope = {
						character_event = {
							id = SoA.1140
						}
					}
				}
			}
			
			wealth = -300
			piety = 75 # EMF
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0.002 # Slow it down
			}
		}
	}
	
	donate_money_to_teutonic_order = {
		only_playable = yes
		potential = {
			is_playable = yes
			
			OR = {
				AND = {
					wealth = 1000
					NOR = {
						trait = cynical
						piety = 50
					}
				}
				ai = no
			}
			
			is_title_active = d_teutonic_order
			
			d_teutonic_order = {
				holder_scope = { 
					religion = ROOT
				}
			}
			
			NOT = { has_character_modifier = expelled_d_teutonic_order }
			
			OR = {
				AND = {
					NOT = { is_title_active = d_knights_hospitaler }
					NOT = { is_title_active = d_knights_templar }
					NOT = { is_title_active = d_knights_santiago }
					NOT = { is_title_active = d_knights_calatrava }
				}
				AND = {
					NOT = { is_title_active = d_knights_hospitaler }
					NOT = { is_title_active = d_knights_templar }
					NOT = { culture_group = iberian }
					NOT = { culture_group = west_african }
					NOT = { culture = maghreb_arabic }
					NOT = { culture = occitan }
				}
				culture_group = north_germanic
				culture_group = central_germanic
				culture_group = magyar
				culture_group = south_slavic
				culture_group = west_slavic
			}
			
			has_dlc = "Sons of Abraham"
			
			d_teutonic_order = {
				owner_under_ROOT = no
			}
		}
		
		allow = {
			wealth = 300
		}
		
		effect = {
			if = {
				limit = { 
					NOT = { has_character_modifier = donated_to_holy_order }
				}
				add_character_modifier = {
					name = donated_to_holy_order
					duration = -1
				}
			}
			
			hidden_tooltip = {
				d_teutonic_order = {
					holder_scope = {
						character_event = {
							id = SoA.1340
						}
					}
				}
			}
			
			wealth = -300
			piety = 75 # EMF
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0.002 # Slow it down
			}
		}
	}
	
	donate_money_to_jomsvikings = {
		only_playable = yes
		potential = {
			is_playable = yes
			emf_holy_order_jomsvikings_religion = yes
			OR = {
				AND = {
					wealth = 1000
					NOR = {
						trait = cynical
						piety = 50
					}
				}
				ai = no
			}
			is_title_active = d_jomsvikings
			has_dlc = "Sons of Abraham"
			d_jomsvikings = {
				owner_under_ROOT = no
			}
			NOT = { has_character_modifier = expelled_d_jomsvikings }
		}
		
		allow = {
			wealth = 300
		}
		
		effect = {
			if = {
				limit = { 
					NOT = { has_character_modifier = donated_to_holy_order }
				}
				add_character_modifier = {
					name = donated_to_holy_order
					duration = -1
				}
			}
			
			hidden_tooltip = {
				d_jomsvikings = {
					holder_scope = {
						character_event = {
							id = SoA.1540
						}
					}
				}
			}
			
			wealth = -300
			piety = 75 # EMF
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0.002 # Slow it down
			}
		}
	}
	
	borrow_money_assassins = {
		only_playable = yes
		potential = {
			is_playable = yes
			emf_holy_order_hashshashin_religion = yes
			is_title_active = d_hashshashin
			NOT = { has_character_modifier = borrowed_from_assassins }
			NOT = { has_character_modifier = expelled_d_hashshashin }
			NOT = { is_nomadic = yes }
			
			has_dlc = "Sons of Abraham"
			NOT = { society_member_of = the_assassins }
			
			d_hashshashin = {
				owner_under_ROOT = no
			}

			NOT = { has_character_modifier = assassins_debt } #From MNM.6001
		}
		
		allow = {
			d_hashshashin = {
				holder_scope = {
					wealth = 300
				}
			}
		}
		
		effect = {
			add_character_modifier = {
				name = borrowed_from_assassins
				duration = -1
				inherit = yes
			}
			
			hidden_tooltip = {
				d_hashshashin = {
					holder_scope = {
						character_event = {
							id = SoA.1410
						}
					}
				}
			}
			
			wealth = 300

			hidden_effect = {
				if = {
					limit = { has_dlc = "Mystics" }
					set_variable = { which = assassins_debt value = 300 }
				}
			}
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0
				wealth = 0
			}
			modifier = {
				factor = 0.01 # Slow it down
			}
		}
	}
	
	donate_money_to_assassins = {
		only_playable = yes
		potential = {
			is_playable = yes
			
			OR = {
				AND = {
					wealth = 1000
					NOR = {
						trait = cynical
						piety = 50
					}
				}
				ai = no
			}
			
			is_title_active = d_hashshashin
			
			d_hashshashin = {
				holder_scope = { 
					religion = ROOT
				}
			}
			
			NOT = { has_character_modifier = expelled_d_hashshashin }
			
			has_dlc = "Sons of Abraham"

			NOT = { society_member_of = the_assassins }
			
			d_hashshashin = {
				owner_under_ROOT = no
			}
		}
		
		allow = {
			wealth = 300
		}
		
		effect = {
			
			hidden_tooltip = {
				d_hashshashin = {
					holder_scope = {
						character_event = {
							id = SoA.1140
						}
					}
				}
			}
			
			wealth = -300
			piety = 75 # EMF
		}

		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0.002 # Slow it down
			}
		}
	}
		
		
	borrow_money_bektashi = {
		only_playable = yes
		potential = {
			is_playable = yes
			emf_holy_order_bektashi_religion = yes
			is_title_active = d_bektashi
			NOT = { has_character_modifier = borrowed_from_bektashi }
			NOT = { has_character_modifier = expelled_d_bektashi }
			NOT = { is_nomadic = yes }
			
			has_dlc = "Sons of Abraham"
			
			d_bektashi = {
				owner_under_ROOT = no
			}
		}
		
		allow = {
			d_bektashi = {
				holder_scope = {
					wealth = 300
				}
			}
		}
		
		effect = {
			add_character_modifier = {
				name = borrowed_from_bektashi
				duration = -1
				inherit = yes
			}
			
			hidden_tooltip = {
				d_bektashi = {
					holder_scope = {
						character_event = {
							id = SoA.1210
						}
					}
				}
			}
			wealth = 300
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0
				wealth = 0
			}
			modifier = {
				factor = 0.01 # Slow it down
			}
		}
	}

	donate_money_to_bektashi = {
		only_playable = yes
		potential = {
			is_playable = yes
			
			OR = {
				AND = {
					wealth = 1000
					NOR = {
						trait = cynical
						piety = 50
					}
				}
				ai = no
			}
			
			is_title_active = d_bektashi
			
			d_bektashi = {
				holder_scope = { 
					religion = ROOT
				}
			}
			has_dlc = "Sons of Abraham"
			
			NOT = { has_character_modifier = expelled_d_bektashi }
			
			d_bektashi = {
				owner_under_ROOT = no
			}
		}
		
		allow = {
			wealth = 300
		}
		
		effect = {
			
			hidden_tooltip = {
				d_bektashi = {
					holder_scope = {
						character_event = {
							id = SoA.1140
						}
					}
				}
			}
			
			wealth = -300
			piety = 75 # EMF
		}

		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0.002 # Slow it down
			}
		}
	}
	
	expel_the_bektashi = {
		only_independent = yes
		potential = {
			ai = no
			emf_holy_order_bektashi_religion = yes
			higher_tier_than = DUKE
			independent = yes
			is_title_active = d_bektashi
			NOT = { has_character_modifier = expelled_d_bektashi }
			
			any_realm_province = {
				any_province_lord = {
					d_bektashi = {
						holder_scope = {
							OR = {
								character = PREVPREV
								is_vassal_or_below = PREVPREV
							}
						}
					}
				}
			}
			
			has_dlc = "Sons of Abraham"
		}
		
		allow = {
			piety = 1000
			custom_tooltip = {
				text = expelling_holy_order_decision_tooltip
				hidden_tooltip = {
					NOT = { has_character_flag = expel_the_bektashi_check }
				}
			}
		}
		
		effect = {
			set_character_flag = expel_the_bektashi_check
			custom_tooltip = {
				text = expelling_holy_order_decision_tooltip_b
				hidden_tooltip = {
					character_event = { id = SoA.2990 }
				}
			}
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 0
		}
	}
	
	borrow_money_haruriyyah = {
		only_playable = yes
		potential = {
			is_playable = yes
			emf_holy_order_haruriyyah_religion = yes
			is_title_active = d_haruriyyah
			NOT = { has_character_modifier = borrowed_from_haruriyyah }
			NOT = { has_character_modifier = expelled_d_haruriyyah }
			NOT = { is_nomadic = yes }
			
			has_dlc = "Charlemagne"
			
			d_haruriyyah = {
				holder_scope = {
					liege = {
						NOT = { character = ROOT }
					}
				}
			}
		}
		
		allow = {
			d_haruriyyah = {
				holder_scope = {
					wealth = 300
				}
			}
		}
		
		effect = {
			add_character_modifier = {
				name = borrowed_from_haruriyyah
				duration = -1
				inherit = yes
			}
			
			hidden_tooltip = {
				d_haruriyyah = {
					holder_scope = {
						character_event = {
							id = CM.4310
						}
					}
				}
			}
			wealth = 300
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0
				wealth = 0
			}
			modifier = {
				factor = 0.01 # Slow it down
			}
		}
	}

	donate_money_to_haruriyyah = {
		only_playable = yes
		potential = {
			is_playable = yes
			
			OR = {
				AND = {
					wealth = 1000
					NOR = {
						trait = cynical
						piety = 50
					}
				}
				ai = no
			}
			
			is_title_active = d_haruriyyah
			
			d_haruriyyah = {
				holder_scope = { 
					religion = ROOT
				}
			}
			has_dlc = "Charlemagne"
			
			NOT = { has_character_modifier = expelled_d_haruriyyah }
			
			d_haruriyyah = {
				owner_under_ROOT = no
			}
		}
		
		allow = {
			wealth = 300
		}
		
		effect = {
			
			hidden_tooltip = {
				d_haruriyyah = {
					holder_scope = {
						character_event = {
							id = SoA.1140
						}
					}
				}
			}
			
			wealth = -300
			piety = 75 # EMF
		}

		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0.002 # Slow it down
			}
		}
	}
	
	expel_the_haruriyyah = {
		only_independent = yes
		potential = {
			ai = no
			emf_holy_order_haruriyyah_religion = yes
			higher_tier_than = DUKE
			independent = yes
			is_title_active = d_haruriyyah
			NOT = { has_character_modifier = expelled_d_haruriyyah }
			
			any_realm_province = {
				any_province_lord = {
					d_haruriyyah = {
						holder_scope = {
							OR = {
								character = PREVPREV
								is_vassal_or_below = PREVPREV
							}
						}
					}
				}
			}
			
			has_dlc = "Charlemagne"
		}
		
		allow = {
			piety = 1000
			custom_tooltip = {
				text = expelling_holy_order_decision_tooltip
				hidden_tooltip = {
					NOT = { has_character_flag = expel_the_haruriyyah_check }
				}
			}
		}
		
		effect = {
			set_character_flag = expel_the_haruriyyah_check
			custom_tooltip = {
				text = expelling_holy_order_decision_tooltip_b
				hidden_tooltip = {
					character_event = { id = SoA.2990 }
				}
			}
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 0
		}
	}
	
	vassalize_knights_templar = { # EMF: Heavily modified from vanilla
		only_playable = yes
		is_high_prio = yes
		
		potential = {
			is_playable = yes
			has_dlc = "Sons of Abraham"
			has_landed_title = k_jerusalem
			is_title_active = d_knights_templar
			emf_holy_order_templar_religion = yes
			primary_title = { is_primary_type_title = no }
			d_knights_templar = {
				owner_under_ROOT = no
			}
		}
		
		allow = {
			has_landed_title = k_jerusalem
			
			wealth = 500
			
			is_heretic = no
			
			NOT = { has_character_modifier = expelled_d_knights_templar }
			
			d_knights_templar = {
				is_primary_holder_title = yes
				holder_scope = {
					NOT = { has_truce = ROOT }
					NOT = { reverse_has_truce = ROOT }
					NOT = { has_non_aggression_pact_with = ROOT }
					liege = {
						NOT = { character = ROOT }
					}
					NOT = { num_of_count_titles = 3 }
					independent = yes
				}
			}
		}
		
		effect = {
			wealth = -500
			
			hidden_tooltip = {
				d_knights_templar = {
					holder_scope = {
						wealth = 500
						character_event = {
							id = SoA.1015
						}
					}
				}
			}
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 1
		}
	}
	

	vassalize_knights_hospitaler = { # EMF: Heavily modified from vanilla
		only_playable = yes
		is_high_prio = yes
		
		potential = {
			is_playable = yes
			has_dlc = "Sons of Abraham"
			has_landed_title = k_jerusalem
			is_title_active = d_knights_hospitaler
			emf_holy_order_hospitaler_religion = yes
			primary_title = { is_primary_type_title = no }
			d_knights_hospitaler = {
				holder_scope = {
					NOT = { is_liege_or_above = ROOT }
				}
			}
		}
		
		allow = {
			has_landed_title = k_jerusalem
			
			wealth = 500
			
			is_heretic = no
			
			NOT = { has_character_modifier = expelled_d_knights_hospitaler }
			
			d_knights_hospitaler = {
				is_primary_holder_title = yes
				holder_scope = {
					NOT = { has_truce = ROOT }
					NOT = { reverse_has_truce = ROOT }
					NOT = { has_non_aggression_pact_with = ROOT }
					liege = {
						NOT = { character = ROOT }
					}
					NOT = { num_of_count_titles = 3 }
					independent = yes
				}
			}
		}
		
		effect = {
			wealth = -500
			
			hidden_tooltip = {
				d_knights_hospitaler = {
					holder_scope = {
						wealth = 500
						character_event = {
							id = SoA.1115
						}
					}
				}
			}
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 1
		}
	}
	
	expel_the_holy_sepulchre = {
		only_independent = yes
		potential = {
			ai = no
			emf_holy_order_sepulchre_religion = yes
			higher_tier_than = DUKE
			independent = yes
			is_title_active = d_holy_sepulchre
			NOT = { has_character_modifier = expelled_d_holy_sepulchre }
			
			any_realm_province = {
				any_province_lord = {
					d_holy_sepulchre = {
						holder_scope = {
							OR = {
								character = PREVPREV
								is_vassal_or_below = PREVPREV
							}
						}
					}
				}
			}
			
			has_dlc = "Sons of Abraham"
		}
		
		allow = {
			piety = 1000
			custom_tooltip = {
				text = expelling_holy_order_decision_tooltip
				hidden_tooltip = {
					NOT = { has_character_flag = expel_the_holy_sepulchre_check }
				}
			}
		}
		
		effect = {
			set_character_flag = expel_the_holy_sepulchre_check
			custom_tooltip = {
				text = expelling_holy_order_decision_tooltip_b
				hidden_tooltip = {
					character_event = { id = SoA.2990 }
				}
			}
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 0
		}
	}
	
	donate_money_to_holy_sepulchre = {
		only_playable = yes
		potential = {
			is_playable = yes
			
			OR = {
				AND = {
					wealth = 1000
					NOR = {
						trait = cynical
						piety = 50
					}
				}
				ai = no
			}
			
			is_title_active = d_holy_sepulchre
			
			d_holy_sepulchre = {
				holder_scope = { 
					religion = ROOT
				}
			}
			
			NOT = { has_character_modifier = expelled_d_holy_sepulchre }
			
			d_holy_sepulchre = {
				owner_under_ROOT = no
			}
			
			has_dlc = "Sons of Abraham"
		}
		
		allow = {
			wealth = 300
		}
		
		effect = {
			if = {
				limit = { 
					NOT = { has_character_modifier = donated_to_holy_order }
				}
				add_character_modifier = {
					name = donated_to_holy_order
					duration = -1
				}
			}
			
			hidden_tooltip = {
				d_holy_sepulchre = {
					holder_scope = {
						character_event = {
							id = SoA.1640
						}
					}
				}
			}
			
			wealth = -300
			piety = 75 # EMF
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0.002 # Slow it down
			}
		}
	}
	
	expel_saint_anthony = {
		only_independent = yes
		potential = {
			ai = no
			emf_holy_order_saint_anthony_religion = yes
			higher_tier_than = DUKE
			independent = yes
			is_title_active = d_saint_anthony
			NOT = { has_character_modifier = expelled_d_saint_anthony }
			
			any_realm_province = {
				any_province_lord = {
					d_saint_anthony = {
						holder_scope = {
							OR = {
								character = PREVPREV
								is_vassal_or_below = PREVPREV
							}
						}
					}
				}
			}
			
			has_dlc = "Sons of Abraham"
		}
		
		allow = {
			piety = 1000
			custom_tooltip = {
				text = expelling_holy_order_decision_tooltip
				hidden_tooltip = {
					NOT = { has_character_flag = expel_saint_anthony_check }
				}
			}
		}
		
		effect = {
			set_character_flag = expel_saint_anthony_check
			custom_tooltip = {
				text = expelling_holy_order_decision_tooltip_b
				hidden_tooltip = {
					character_event = { id = SoA.2990 }
				}
			}
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 0
		}
	}
	
	donate_money_to_saint_anthony = {
		only_playable = yes
		potential = {
			is_playable = yes
			
			OR = {
				AND = {
					wealth = 1000
					NOR = {
						trait = cynical
						piety = 50
					}
				}
				ai = no
			}
			
			is_title_active = d_saint_anthony
			
			d_saint_anthony = {
				holder_scope = { 
					religion = ROOT
				}
			}
			
			NOT = { has_character_modifier = expelled_d_saint_anthony }
			
			d_saint_anthony = {
				owner_under_ROOT = no
			}
			
			has_dlc = "Sons of Abraham"
		}
		
		allow = {
			wealth = 300
		}
		
		effect = {
			if = {
				limit = { 
					NOT = { has_character_modifier = donated_to_holy_order }
				}
				add_character_modifier = {
					name = donated_to_holy_order
					duration = -1
				}
			}
			
			hidden_tooltip = {
				d_saint_anthony = {
					holder_scope = {
						character_event = {
							id = SoA.1740
						}
					}
				}
			}
			
			wealth = -300
			piety = 75 # EMF
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0.002 # Slow it down
			}
		}
	}
	
	expel_immortals = {
		only_independent = yes
		potential = {
			ai = no
			OR = {
				religion = zoroastrian
				religion = mazdaki
				religion = zurvanist
			}
			is_heretic = no
			higher_tier_than = DUKE
			independent = yes
			is_title_active = d_immortals
			NOT = { has_character_modifier = expelled_d_immortals }
			
			any_realm_province = {
				any_province_lord = {
					d_immortals = {
						holder_scope = {
							OR = {
								character = PREVPREV
								is_vassal_or_below = PREVPREV
							}
						}
					}
				}
			}
			
			has_dlc = "Sons of Abraham"
		}
		
		allow = {
			piety = 1000
			custom_tooltip = {
				text = expelling_holy_order_decision_tooltip
				hidden_tooltip = {
					NOT = { has_character_flag = expel_immortals_check }
				}
			}
		}
		
		effect = {
			set_character_flag = expel_immortals_check
			custom_tooltip = {
				text = expelling_holy_order_decision_tooltip_b
				hidden_tooltip = {
					character_event = { id = SoA.2990 }
				}
			}
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 0
		}
	}
	
	donate_money_to_the_immortals = {
		only_playable = yes
		potential = {
			is_playable = yes
			
			OR = {
				AND = {
					wealth = 1000
					NOR = {
						trait = cynical
						piety = 50
					}
				}
				ai = no
			}
			
			is_title_active = d_immortals
			
			d_immortals = {
				holder_scope = { 
					religion = ROOT
				}
			}
			
			NOT = { has_character_modifier = expelled_d_immortals }
			
			has_dlc = "Sons of Abraham"
			
			d_immortals = {
				owner_under_ROOT = no
			}
		}
		
		allow = {
			wealth = 300
		}
		
		effect = {
			if = {
				limit = { 
					NOT = { has_character_modifier = donated_to_holy_order }
				}
				add_character_modifier = {
					name = donated_to_holy_order
					duration = -1
				}
			}
			
			hidden_tooltip = {
				d_immortals = {
					holder_scope = {
						character_event = {
							id = SoA.1840
						}
					}
				}
			}
			
			wealth = -300
			piety = 75 # EMF
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0.002 # Slow it down
			}
		}
	}
	
	expel_zealots = {
		only_independent = yes
		potential = {
			ai = no
			OR = {
				religion = jewish
				religion = samaritan
				religion = karaite
			}
			is_heretic = no
			higher_tier_than = DUKE
			independent = yes
			is_title_active = d_zealots
			NOT = { has_character_modifier = expelled_d_zealots }
			
			any_realm_province = {
				any_province_lord = {
					d_zealots = {
						holder_scope = {
							OR = {
								character = PREVPREV
								is_vassal_or_below = PREVPREV
							}
						}
					}
				}
			}
			
			has_dlc = "Sons of Abraham"
		}
		
		allow = {
			piety = 1000
			custom_tooltip = {
				text = expelling_holy_order_decision_tooltip
				hidden_tooltip = {
					NOT = { has_character_flag = expel_zealots_check }
				}
			}
		}
		
		effect = {
			set_character_flag = expel_zealots_check
			custom_tooltip = {
				text = expelling_holy_order_decision_tooltip_b
				hidden_tooltip = {
					character_event = { id = SoA.2990 }
				}
			}
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 0
		}
	}
	
	donate_money_to_the_zealots = {
		only_playable = yes
		potential = {
			is_playable = yes
			
			OR = {
				AND = {
					wealth = 1000
					NOR = {
						trait = cynical
						piety = 50
					}
				}
				ai = no
			}
			
			is_title_active = d_zealots
			
			d_zealots = {
				holder_scope = { 
					religion = ROOT
				}
			}
			
			has_dlc = "Sons of Abraham"
			
			NOT = { has_character_modifier = expelled_d_zealots }
			
			d_zealots = {
				holder_scope = {
					liege = {
						NOT = { character = ROOT }
					}
				}
			}
		}
		
		allow = {
			wealth = 300
		}
		
		effect = {
			if = {
				limit = { 
					NOT = { has_character_modifier = donated_to_holy_order }
				}
				add_character_modifier = {
					name = donated_to_holy_order
					duration = -1
				}
			}
			
			hidden_tooltip = {
				d_zealots = {
					holder_scope = {
						character_event = {
							id = SoA.1940
						}
					}
				}
			}
			
			wealth = -300
			piety = 75 # EMF
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0.002 # Slow it down
			}
		}
	}
	
	expel_sky_lords = {
		only_independent = yes
		potential = {
			ai = no
			religion = tengri_pagan_reformed
			higher_tier_than = DUKE
			independent = yes
			is_title_active = d_sky_lords
			NOT = { has_character_modifier = expelled_d_sky_lords }
			
			any_realm_province = {
				any_province_lord = {
					d_sky_lords = {
						holder_scope = {
							OR = {
								character = PREVPREV
								is_vassal_or_below = PREVPREV
							}
						}
					}
				}
			}
			
			has_dlc = "Sons of Abraham"
		}
		
		allow = {
			piety = 1000
			custom_tooltip = {
				text = expelling_holy_order_decision_tooltip
				hidden_tooltip = {
					NOT = { has_character_flag = expel_sky_lords_check }
				}
			}
		}
		
		effect = {
			set_character_flag = expel_sky_lords_check
			custom_tooltip = {
				text = expelling_holy_order_decision_tooltip_b
				hidden_tooltip = {
					character_event = { id = SoA.2990 }
				}
			}
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 0
		}
	}
	
	donate_money_to_sky_lords = {
		only_playable = yes
		potential = {
			is_playable = yes
			
			religion = tengri_pagan_reformed
		
			OR = {
				AND = {
					wealth = 1000
					NOR = {
						trait = cynical
						piety = 50
					}
				}
				ai = no
			}
			
			is_title_active = d_sky_lords
			
			has_dlc = "Sons of Abraham"
			
			NOT = { has_character_modifier = expelled_d_sky_lords }
			
			d_sky_lords = {
				owner_under_ROOT = no
			}
		}
		
		allow = {
			wealth = 300
		}
		
		effect = {
			if = {
				limit = { 
					NOT = { has_character_modifier = donated_to_holy_order }
				}
				add_character_modifier = {
					name = donated_to_holy_order
					duration = -1
				}
			}
			
			hidden_tooltip = {
				d_sky_lords = {
					holder_scope = {
						character_event = {
							id = SoA.2040
						}
					}
				}
			}
			
			wealth = -300
			piety = 75 # EMF
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0.002 # Slow it down
			}
		}
	}
	
	expel_spirit_guardians = {
		only_independent = yes
		potential = {
			ai = no
			religion = west_african_pagan_reformed
			higher_tier_than = DUKE
			independent = yes
			is_title_active = d_spirit_guardians
			NOT = { has_character_modifier = expelled_d_spirit_guardians }
			
			any_realm_province = {
				any_province_lord = {
					d_spirit_guardians = {
						holder_scope = {
							OR = {
								character = PREVPREV
								is_vassal_or_below = PREVPREV
							}
						}
					}
				}
			}
			
			has_dlc = "Sons of Abraham"
		}
		
		allow = {
			piety = 1000
			custom_tooltip = {
				text = expelling_holy_order_decision_tooltip
				hidden_tooltip = {
					NOT = { has_character_flag = expel_spirit_guardians_check }
				}
			}
		}
		
		effect = {
			set_character_flag = expel_spirit_guardians_check
			custom_tooltip = {
				text = expelling_holy_order_decision_tooltip_b
				hidden_tooltip = {
					character_event = { id = SoA.2990 }
				}
			}
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 0
		}
	}
	
	donate_money_to_spirit_guardians = {
		only_playable = yes
		potential = {
			is_playable = yes
			
			religion = west_african_pagan_reformed
		
			OR = {
				AND = {
					wealth = 1000
					NOR = {
						trait = cynical
						piety = 50
					}
				}
				ai = no
			}
			
			is_title_active = d_spirit_guardians
			
			has_dlc = "Sons of Abraham"
			
			NOT = { has_character_modifier = expelled_d_spirit_guardians }
			
			d_spirit_guardians = {
				owner_under_ROOT = no
			}
		}
		
		allow = {
			wealth = 300
		}
		
		effect = {
			if = {
				limit = { 
					NOT = { has_character_modifier = donated_to_holy_order }
				}
				add_character_modifier = {
					name = donated_to_holy_order
					duration = -1
				}
			}
			
			hidden_tooltip = {
				d_spirit_guardians = {
					holder_scope = {
						character_event = {
							id = SoA.2140
						}
					}
				}
			}
			
			wealth = -300
			piety = 75 # EMF
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0.002 # Slow it down
			}
		}
	}
	
	expel_warriors_perun = {
		only_independent = yes
		potential = {
			ai = no
			religion = slavic_pagan_reformed
			higher_tier_than = DUKE
			independent = yes
			is_title_active = d_warriors_perun
			NOT = { has_character_modifier = expelled_d_warriors_perun }
			
			any_realm_province = {
				any_province_lord = {
					d_warriors_perun = {
						holder_scope = {
							OR = {
								character = PREVPREV
								is_vassal_or_below = PREVPREV
							}
						}
					}
				}
			}
			
			has_dlc = "Sons of Abraham"
		}
		
		allow = {
			piety = 1000
			custom_tooltip = {
				text = expelling_holy_order_decision_tooltip
				hidden_tooltip = {
					NOT = { has_character_flag = expel_warriors_perun_check }
				}
			}
		}
		
		effect = {
			set_character_flag = expel_warriors_perun_check
			custom_tooltip = {
				text = expelling_holy_order_decision_tooltip_b
				hidden_tooltip = {
					character_event = { id = SoA.2990 }
				}
			}
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 0
		}
	}
	
	donate_money_to_warriors_perun = {
		only_playable = yes
		potential = {
			is_playable = yes
			
			religion = slavic_pagan_reformed
			
			OR = {
				AND = {
					wealth = 1000
					NOR = {
						trait = cynical
						piety = 50
					}
				}
				ai = no
			}
			
			is_title_active = d_warriors_perun
			
			NOT = { has_character_modifier = expelled_d_warriors_perun }
			
			has_dlc = "Sons of Abraham"
			
			d_warriors_perun = {
				owner_under_ROOT = no
			}
		}
		
		allow = {
			wealth = 300
		}
		
		effect = {
			if = {
				limit = { 
					NOT = { has_character_modifier = donated_to_holy_order }
				}
				add_character_modifier = {
					name = donated_to_holy_order
					duration = -1
				}
			}
			
			hidden_tooltip = {
				d_warriors_perun = {
					holder_scope = {
						character_event = {
							id = SoA.2240
						}
					}
				}
			}
			
			wealth = -300
			piety = 75 # EMF
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0.002 # Slow it down
			}
		}
	}
	
	expel_chosen_perkunas = {
		only_independent = yes
		potential = {
			ai = no
			religion = baltic_pagan_reformed
			higher_tier_than = DUKE
			independent = yes
			is_title_active = d_chosen_perkunas
			NOT = { has_character_modifier = expelled_d_chosen_perkunas }
			
			any_realm_province = {
				any_province_lord = {
					d_chosen_perkunas = {
						holder_scope = {
							OR = {
								character = PREVPREV
								is_vassal_or_below = PREVPREV
							}
						}
					}
				}
			}
			
			has_dlc = "Sons of Abraham"
		}
		
		allow = {
			piety = 1000
			custom_tooltip = {
				text = expelling_holy_order_decision_tooltip
				hidden_tooltip = {
					NOT = { has_character_flag = expel_chosen_perkunas_check }
				}
			}
		}
		
		effect = {
			set_character_flag = expel_chosen_perkunas_check
			custom_tooltip = {
				text = expelling_holy_order_decision_tooltip_b
				hidden_tooltip = {
					character_event = { id = SoA.2990 }
				}
			}
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 0
		}
	}
	
	donate_money_to_chosen_perkunas = {
		only_playable = yes
		potential = {
			is_playable = yes
			
			religion = baltic_pagan_reformed
			
			OR = {
				AND = {
					wealth = 1000
					NOR = {
						trait = cynical
						piety = 50
					}
				}
				ai = no
			}
			
			is_title_active = d_chosen_perkunas
			
			has_dlc = "Sons of Abraham"
			
			NOT = { has_character_modifier = expelled_d_chosen_perkunas }
			
			d_chosen_perkunas = {
				owner_under_ROOT = no
			}
		}
		
		allow = {
			wealth = 300
		}
		
		effect = {
			if = {
				limit = { 
					NOT = { has_character_modifier = donated_to_holy_order }
				}
				add_character_modifier = {
					name = donated_to_holy_order
					duration = -1
				}
			}
			
			hidden_tooltip = {
				d_chosen_perkunas = {
					holder_scope = {
						character_event = {
							id = SoA.2340
						}
					}
				}
			}
			
			wealth = -300
			piety = 75 # EMF
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0.002 # Slow it down
			}
		}
	}
	
	expel_sons_kaleva = {
		only_independent = yes
		potential = {
			ai = no
			religion = finnish_pagan_reformed
			higher_tier_than = DUKE
			independent = yes
			is_title_active = d_sons_kaleva
			NOT = { has_character_modifier = expelled_d_sons_kaleva }
			
			any_realm_province = {
				any_province_lord = {
					d_chosen_perkunas = {
						holder_scope = {
							OR = {
								character = PREVPREV
								is_vassal_or_below = PREVPREV
							}
						}
					}
				}
			}
			
			has_dlc = "Sons of Abraham"
		}
		
		allow = {
			piety = 1000
			custom_tooltip = {
				text = expelling_holy_order_decision_tooltip
				hidden_tooltip = {
					NOT = { has_character_flag = expel_sons_kaleva_check }
				}
			}
		}
		
		effect = {
			set_character_flag = expel_sons_kaleva_check
			custom_tooltip = {
				text = expelling_holy_order_decision_tooltip_b
				hidden_tooltip = {
					character_event = { id = SoA.2990 }
				}
			}
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 0
		}
	}
	
	donate_money_to_sons_kaleva = {
		only_playable = yes
		potential = {
			is_playable = yes
			
			religion = finnish_pagan_reformed
			
			OR = {
				AND = {
					wealth = 1000
					NOR = {
						trait = cynical
						piety = 50
					}
				}
				ai = no
			}
			
			is_title_active = d_sons_kaleva
			
			has_dlc = "Sons of Abraham"
			
			NOT = { has_character_modifier = expelled_d_sons_kaleva }
			
			d_sons_kaleva = {
				owner_under_ROOT = no
			}
		}
		
		allow = {
			wealth = 300
		}
		
		effect = {
			if = {
				limit = { 
					NOT = { has_character_modifier = donated_to_holy_order }
				}
				add_character_modifier = {
					name = donated_to_holy_order
					duration = -1
				}
			}
			
			hidden_tooltip = {
				d_sons_kaleva = {
					holder_scope = {
						character_event = {
							id = SoA.2440
						}
					}
				}
			}
			
			wealth = -300
			piety = 75 # EMF
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0.002 # Slow it down
			}
		}
	}
	
	expel_huitzilopochtli = {
		only_independent = yes
		potential = {
			ai = no
			religion = aztec_reformed
			higher_tier_than = DUKE
			independent = yes
			is_title_active = d_huitzilopochtli
			NOT = { has_character_modifier = expelled_d_huitzilopochtli }
			
			any_realm_province = {
				any_province_lord = {
					d_huitzilopochtli = {
						holder_scope = {
							OR = {
								character = PREVPREV
								is_vassal_or_below = PREVPREV
							}
						}
					}
				}
			}
			
			has_dlc = "Sons of Abraham"
		}
		
		allow = {
			piety = 1000
			custom_tooltip = {
				text = expelling_holy_order_decision_tooltip
				hidden_tooltip = {
					NOT = { has_character_flag = expel_huitzilopochtli_check }
				}
			}
		}
		
		effect = {
			set_character_flag = expel_huitzilopochtli_check
			custom_tooltip = {
				text = expelling_holy_order_decision_tooltip_b
				hidden_tooltip = {
					character_event = { id = SoA.2990 }
				}
			}
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 0
		}
	}
	
	donate_money_to_huitzilopochtli = {
		only_playable = yes
		potential = {
			is_playable = yes
			
			religion = aztec_reformed
			
			OR = {
				AND = {
					wealth = 1000
					NOR = {
						trait = cynical
						piety = 50
					}
				}
				ai = no
			}
			
			is_title_active = d_huitzilopochtli
			
			has_dlc = "Sons of Abraham"
			
			NOT = { has_character_modifier = expelled_d_huitzilopochtli }
			
			d_huitzilopochtli = {
				owner_under_ROOT = no
			}
		}
		
		allow = {
			wealth = 300
		}
		
		effect = {
			if = {
				limit = { 
					NOT = { has_character_modifier = donated_to_holy_order }
				}
				add_character_modifier = {
					name = donated_to_holy_order
					duration = -1
				}
			}
			
			hidden_tooltip = {
				d_huitzilopochtli = {
					holder_scope = {
						character_event = {
							id = SoA.2540
						}
					}
				}
			}
			
			wealth = -300
			piety = 75 # EMF
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0.002 # Slow it down
			}
		}
	}
	
	expel_knights_santiago = {
		only_independent = yes
		potential = {
			ai = no
			OR = {
				religion = catholic
				religion = cathar
				religion = fraticelli
				religion = waldensian
				religion = lollard
				religion = adoptionist
				religion = arian
			}
			is_heretic = no
			higher_tier_than = DUKE
			independent = yes
			is_title_active = d_knights_santiago
			NOT = { has_character_modifier = expelled_d_knights_santiago }
			
			any_realm_province = {
				any_province_lord = {
					d_knights_santiago = {
						holder_scope = {
							OR = {
								character = PREVPREV
								is_vassal_or_below = PREVPREV
							}
						}
					}
				}
			}
			
			has_dlc = "Sons of Abraham"
		}
		
		allow = {
			piety = 1000
			custom_tooltip = {
				text = expelling_holy_order_decision_tooltip
				hidden_tooltip = {
					NOT = { has_character_flag = expel_knights_santiago_check }
				}
			}
		}
		
		effect = {
			set_character_flag = expel_knights_santiago_check
			custom_tooltip = {
				text = expelling_holy_order_decision_tooltip_b
				hidden_tooltip = {
					character_event = { id = SoA.2990 }
				}
			}
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 0
		}
	}
	
	donate_money_to_knights_santiago = {
		only_playable = yes
		potential = {
			is_playable = yes
			
			OR = {
				AND = {
					wealth = 1000
					NOR = {
						trait = cynical
						piety = 50
					}
				}
				ai = no
			}
			
			is_title_active = d_knights_santiago
			
			d_knights_santiago = {
				holder_scope = { 
					religion = ROOT
				}
			}
			
			NOT = { has_character_modifier = expelled_d_knights_santiago }

			OR = {
				AND = {
					NOT = { is_title_active = d_knights_hospitaler }
					NOT = { is_title_active = d_knights_templar }
					NOT = { is_title_active = d_teutonic_order }
				}
				AND = {
					NOT = { is_title_active = d_knights_templar }
					NOT = { is_title_active = d_knights_hospitaler }
					NOT = { culture_group = north_germanic }
					NOT = { culture_group = central_germanic }
					NOT = { culture_group = magyar }
					NOT = { culture_group = south_slavic }
					NOT = { culture_group = west_slavic }
				}
				culture_group = iberian
				culture_group = west_african
				culture = maghreb_arabic
				culture = occitan
			}
			
			has_dlc = "Sons of Abraham"
			
			d_knights_santiago = {
				owner_under_ROOT = no
			}
		}
		
		allow = {
			wealth = 300
		}
		
		effect = {
			if = {
				limit = { 
					NOT = { has_character_modifier = donated_to_holy_order }
				}
				add_character_modifier = {
					name = donated_to_holy_order
					duration = -1
				}
			}
			
			hidden_tooltip = {
				d_knights_santiago = {
					holder_scope = {
						character_event = {
							id = SoA.2640
						}
					}
				}
			}
			
			wealth = -300
			piety = 75 # EMF
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0.002 # Slow it down
			}
		}
	}
	
	expel_knights_calatrava = {
		only_independent = yes
		potential = {
			ai = no
			OR = {
				religion = catholic
				religion = cathar
				religion = fraticelli
				religion = waldensian
				religion = lollard
				religion = adoptionist
				religion = arian
			}
			is_heretic = no
			higher_tier_than = DUKE
			independent = yes
			is_title_active = d_knights_calatrava
			NOT = { has_character_modifier = expelled_d_knights_calatrava }
			
			any_realm_province = {
				any_province_lord = {
					d_knights_calatrava = {
						holder_scope = {
							OR = {
								character = PREVPREV
								is_vassal_or_below = PREVPREV
							}
						}
					}
				}
			}
			
			has_dlc = "Sons of Abraham"
		}
		
		allow = {
			piety = 1000
			custom_tooltip = {
				text = expelling_holy_order_decision_tooltip
				hidden_tooltip = {
					NOT = { has_character_flag = expel_knights_calatrava_check }
				}
			}
		}
		
		effect = {
			set_character_flag = expel_knights_calatrava_check
			custom_tooltip = {
				text = expelling_holy_order_decision_tooltip_b
				hidden_tooltip = {
					character_event = { id = SoA.2990 }
				}
			}
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 0
		}
	}
	
	donate_money_to_knights_calatrava = {
		only_playable = yes
		potential = {
			is_playable = yes
			
			OR = {
				AND = {
					wealth = 1000
					NOR = {
						trait = cynical
						piety = 50
					}
				}
				ai = no
			}
			
			is_title_active = d_knights_calatrava
			
			d_knights_calatrava = {
				holder_scope = { 
					religion = ROOT
				}
			}
			
			NOT = { has_character_modifier = expelled_d_knights_calatrava }

			OR = {
				AND = {
					NOT = { is_title_active = d_knights_hospitaler }
					NOT = { is_title_active = d_knights_templar }
					NOT = { is_title_active = d_teutonic_order }
				}
				AND = {
					NOT = { is_title_active = d_knights_templar }
					NOT = { is_title_active = d_knights_hospitaler }
					NOT = { culture_group = north_germanic }
					NOT = { culture_group = central_germanic }
					NOT = { culture_group = magyar }
					NOT = { culture_group = south_slavic }
					NOT = { culture_group = west_slavic }
				}
				culture_group = iberian
				culture_group = west_african
				culture = maghreb_arabic
				culture = occitan
			}
			
			has_dlc = "Sons of Abraham"
			
			d_knights_calatrava = {
				owner_under_ROOT = no
			}
		}
		
		allow = {
			wealth = 300
		}
		
		effect = {
			if = {
				limit = { 
					NOT = { has_character_modifier = donated_to_holy_order }
				}
				add_character_modifier = {
					name = donated_to_holy_order
					duration = -1
				}
			}
			
			hidden_tooltip = {
				d_knights_calatrava = {
					holder_scope = {
						character_event = {
							id = SoA.2740
						}
					}
				}
			}
			
			wealth = -300
			piety = 75 # EMF
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0.002 # Slow it down
			}
		}
	}
	
	expel_order_of_addai = {
		only_independent = yes
		potential = {
			ai = no
			OR = {
				religion = nestorian
				religion = messalian
			}
			is_heretic = no
			higher_tier_than = DUKE
			independent = yes
			is_title_active = d_saint_addai
			NOT = { has_character_modifier = expelled_d_saint_addai }
			
			any_realm_province = {
				any_province_lord = {
					d_saint_addai = {
						holder_scope = {
							OR = {
								character = PREVPREV
								is_vassal_or_below = PREVPREV
							}
						}
					}
				}
			}
			
			has_dlc = "Sons of Abraham"
		}
		
		allow = {
			piety = 1000
			custom_tooltip = {
				text = expelling_holy_order_decision_tooltip
				hidden_tooltip = {
					NOT = { has_character_flag = expel_order_of_addai_check }
				}
			}
		}
		
		effect = {
			set_character_flag = expel_order_of_addai_check
			custom_tooltip = {
				text = expelling_holy_order_decision_tooltip_b
				hidden_tooltip = {
					character_event = { id = SoA.2990 }
				}
			}
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 0
		}
	}
	
	donate_money_to_order_of_addai = {
		only_playable = yes
		potential = {
			is_playable = yes
			
			OR = {
				AND = {
					wealth = 1000
					NOR = {
						trait = cynical
						piety = 50
					}
				}
				ai = no
			}
			
			is_title_active = d_saint_addai
			
			d_saint_addai = {
				holder_scope = { 
					religion = ROOT
				}
			}
			
			NOT = { has_character_modifier = expelled_d_saint_addai }
			
			d_saint_addai = {
				owner_under_ROOT = no
			}
			
			has_dlc = "Sons of Abraham"
		}
		
		allow = {
			wealth = 300
		}
		
		effect = {
			if = {
				limit = { 
					NOT = { has_character_modifier = donated_to_holy_order }
				}
				add_character_modifier = {
					name = donated_to_holy_order
					duration = -1
				}
			}
			
			hidden_tooltip = {
				d_saint_addai = {
					holder_scope = {
						character_event = {
							id = SoA.2840
						}
					}
				}
			}
			
			wealth = -300
			piety = 75 # EMF
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0.002 # Slow it down
			}
		}
	}

	expel_zun_warriors = {
		only_independent = yes
		potential = {
			ai = no
			religion = zun_pagan_reformed
			higher_tier_than = DUKE
			independent = yes
			is_title_active = d_zun_warriors
			NOT = { has_character_modifier = expelled_d_zun_warriors }
			
			any_realm_province = {
				any_province_lord = {
					d_zun_warriors = {
						holder_scope = {
							OR = {
								character = PREVPREV
								is_vassal_or_below = PREVPREV
							}
						}
					}
				}
			}
			has_dlc = "Charlemagne"
		}
		
		allow = {
			piety = 1000
			custom_tooltip = {
				text = expelling_holy_order_decision_tooltip
				hidden_tooltip = {
					NOT = { has_character_flag = expel_zun_warriors_check }
				}
			}
		}
		
		effect = {
			set_character_flag = expel_zun_warriors_check
			custom_tooltip = {
				text = expelling_holy_order_decision_tooltip_b
				hidden_tooltip = {
					character_event = { id = SoA.2990 }
				}
			}
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 0
		}
	}

	donate_money_to_zun_warriors = {
		only_playable = yes
		potential = {
			is_playable = yes
			
			religion = zun_pagan_reformed
			
			OR = {
				AND = {
					wealth = 1000
					NOR = {
						trait = cynical
						piety = 50
					}
				}
				ai = no
			}
			
			is_title_active = d_zun_warriors
			
			has_dlc = "Charlemagne"
			
			NOT = { has_character_modifier = expelled_d_zun_warriors }
			
			d_zun_warriors = {
				owner_under_ROOT = no
			}
		}
		
		allow = {
			wealth = 300
		}
		
		effect = {
			if = {
				limit = { 
					NOT = { has_character_modifier = donated_to_holy_order }
				}
				add_character_modifier = {
					name = donated_to_holy_order
					duration = -1
				}
			}
			
			hidden_tooltip = {
				d_zun_warriors = {
					holder_scope = {
						character_event = {
							id = CM.4005
						}
					}
				}
			}
			
			wealth = -300
			piety = 75 # EMF
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0.002 # Slow it down
			}
		}
	}	
}

