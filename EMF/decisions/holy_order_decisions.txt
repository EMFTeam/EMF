###########################################
#
# Holy Order Decisions for Sons of Abraham
#
###########################################
# Written by Henrik Fåhraeus
###########################################

# Holy Order Decisions are listed for each existing holy order of the right religion

decisions = {

	borrow_money_knights_templar = {
		potential = {
			OR = {
				religion = catholic
				religion = cathar
				religion = fraticelli
				religion = waldensian
				religion = lollard
			}
			is_heretic = no
			is_title_active = d_knights_templar
			NOT = { has_character_modifier = borrowed_from_knights_templar }
			NOT = { has_character_modifier = expelled_d_knights_templar }
			NOT = { is_nomadic = yes }
			
			has_dlc = "Sons of Abraham"
			
			d_knights_templar = {
				holder_scope = {
					liege = {
						NOT = { character = ROOT }
					}
				}
			}
		}
		
		allow = {
			d_knights_templar = {
				holder_scope = {
					wealth = 300
					ROOT = {
						NOT = { excommunicated_for = PREV }
					}
				}
			}
		}
		
		effect = {
			add_character_modifier = {
				name = borrowed_from_knights_templar
				duration = -1
				inherit = yes
			}
			
			hidden_tooltip = {
				d_knights_templar = {
					holder_scope = {
						character_event = {
							id = SoA.1010
						}
					}
				}
			}
			
			wealth = 300
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0
				wealth = 0
			}
			modifier = {
				factor = 0.01 # Slow it down
			}
		}
	}
	
	expel_the_knights_templar = {
		potential = {
			ai = no
			OR = {
				religion = catholic
				religion = cathar
				religion = fraticelli
				religion = waldensian
				religion = lollard
			}
			is_heretic = no
			higher_tier_than = DUKE
			independent = yes
			is_title_active = d_knights_templar
			NOT = { has_character_modifier = expelled_d_knights_templar }
			
			any_realm_province = {
				any_province_lord = {
					d_knights_templar = {
						holder_scope = {
							OR = {
								character = PREVPREV
								is_vassal_or_below = PREVPREV
							}
						}
					}
				}
			}
			
			has_dlc = "Sons of Abraham"
		}
		
		allow = {
			piety = 1000
		}
		
		effect = {
			piety = -1000
			
			religion_authority = {
				modifier = holy_order_expelled
				years = 20
			}
			
			hidden_tooltip = {
				d_knights_templar = {
					holder_scope = {
						character_event = {
							id = SoA.1060
						}
					}
				}
				add_character_modifier = {
					name = expelled_d_knights_templar
					duration = -1
					inherit = yes
				}
			}
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 0
		}
	}
	
	expel_the_knights_hospitaler = {
		potential = {
			ai = no
			OR = {
				religion = catholic
				religion = cathar
				religion = fraticelli
				religion = waldensian
				religion = lollard
			}
			is_heretic = no
			higher_tier_than = DUKE
			independent = yes
			is_title_active = d_knights_hospitaler
			NOT = { has_character_modifier = expelled_d_knights_hospitaler }
			
			any_realm_province = {
				any_province_lord = {
					d_knights_hospitaler = {
						holder_scope = {
							OR = {
								character = PREVPREV
								is_vassal_or_below = PREVPREV
							}
						}
					}
				}
			}
			
			has_dlc = "Sons of Abraham"
		}
		
		allow = {
			piety = 1000
		}
		
		effect = {
			piety = -1000
			
			religion_authority = {
				modifier = holy_order_expelled
				years = 20
			}
			
			hidden_tooltip = {
				d_knights_hospitaler = {
					holder_scope = {
						character_event = {
							id = SoA.1060
						}
					}
				}
				add_character_modifier = {
					name = expelled_d_knights_hospitaler
					duration = -1
					inherit = yes
				}
			}
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 0
		}
	}
	
	expel_the_teutonic_order = {
		potential = {
			ai = no
			OR = {
				religion = catholic
				religion = cathar
				religion = fraticelli
				religion = waldensian
				religion = lollard
			}
			is_heretic = no
			higher_tier_than = DUKE
			independent = yes
			is_title_active = d_teutonic_order
			NOT = { has_character_modifier = expelled_d_teutonic_order }
			
			any_realm_province = {
				any_province_lord = {
					d_teutonic_order = {
						holder_scope = {
							OR = {
								character = PREVPREV
								is_vassal_or_below = PREVPREV
							}
						}
					}
				}
			}
			
			has_dlc = "Sons of Abraham"
		}
		
		allow = {
			piety = 1000
		}
		
		effect = {
			piety = -1000
			
			religion_authority = {
				modifier = holy_order_expelled
				years = 20
			}
			
			hidden_tooltip = {
				add_character_modifier = {
					name = expelled_d_teutonic_order
					duration = -1
					inherit = yes
				}
				d_teutonic_order = {
					holder_scope = {
						character_event = {
							id = SoA.1060
						}
					}
				}
			}
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 0
		}
	}
	
	expel_the_jomsvikings = {
		potential = {
			ai = no
			OR = {
				religion = norse_pagan
				religion = norse_pagan_reformed
			}
			higher_tier_than = DUKE
			independent = yes
			is_title_active = d_jomsvikings
			NOT = { has_character_modifier = expelled_d_jomsvikings }
			
			any_realm_province = {
				any_province_lord = {
					d_jomsvikings = {
						holder_scope = {
							OR = {
								character = PREVPREV
								is_vassal_or_below = PREVPREV
							}
						}
					}
				}
			}
			
			has_dlc = "Sons of Abraham"
		}
		
		allow = {
			piety = 1000
		}
		
		effect = {
			piety = -1000
			
			religion_authority = {
				modifier = holy_order_expelled
				years = 20
			}
			
			hidden_tooltip = {
				d_jomsvikings = {
					holder_scope = {
						character_event = {
							id = SoA.1560
						}
					}
				}
				add_character_modifier = {
					name = expelled_d_jomsvikings
					duration = -1
					inherit = yes
				}
			}
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 0
		}
	}
	
	expel_the_assassins = {
		potential = {
			ai = no
			OR = {
				religion = shiite
				religion = druze
				religion = hurufi
			}
			is_heretic = no
			higher_tier_than = DUKE
			independent = yes
			is_title_active = d_hashshashin
			NOT = { has_character_modifier = expelled_d_hashshashin }
			
			any_realm_province = {
				any_province_lord = {
					d_hashshashin = {
						holder_scope = {
							OR = {
								character = PREVPREV
								is_vassal_or_below = PREVPREV
							}
						}
					}
				}
			}
			
			has_dlc = "Sons of Abraham"
		}
		
		allow = {
			piety = 1000
		}
		
		effect = {
			piety = -1000
			
			religion_authority = {
				modifier = holy_order_expelled
				years = 20
			}
			
			hidden_tooltip = {
				d_hashshashin = {
					holder_scope = {
						character_event = {
							id = SoA.1460
						}
					}
				}
				
				add_character_modifier = {
					name = expelled_d_hashshashin
					duration = -1
					inherit = yes
				}
			}
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 0
		}
	}
	
	donate_money_to_knights_templar = {
		potential = {
			OR = {
				religion = catholic
				religion = cathar
				religion = fraticelli
				religion = waldensian
				religion = lollard
			}
			is_heretic = no
			is_title_active = d_knights_templar
			
			NOT = { has_character_modifier = expelled_d_knights_templar }
			
			OR = {
				AND = {
					NOT = { is_title_active = d_teutonic_order }
					NOT = { is_title_active = d_knights_santiago }
					NOT = { is_title_active = d_knights_calatrava }
				}
				AND = {
					NOT = { is_title_active = d_teutonic_order }
					NOT = { culture_group = iberian }
					NOT = { culture_group = west_african }
					NOT = { culture = maghreb_arabic }
					NOT = { culture = occitan }
				}
				AND = {
					NOT = { is_title_active = d_knights_santiago }
					NOT = { is_title_active = d_knights_calatrava }
					NOT = { culture_group = north_germanic }
					NOT = { culture_group = central_germanic }
					NOT = { culture_group = magyar }
					NOT = { culture_group = south_slavic }
					NOT = { culture_group = west_slavic }
				}
			}
			
			has_dlc = "Sons of Abraham"
			
			d_knights_templar = {
				holder_scope = {
					liege = {
						NOT = { character = ROOT }
					}
				}
			}
		}
		
		allow = {
			wealth = 300
		}
		
		effect = {
			if = {
				limit = { 
					NOT = { has_character_modifier = donated_to_holy_order }
				}
				add_character_modifier = {
					name = donated_to_holy_order
					duration = -1
				}
			}
			
			hidden_tooltip = {
				d_knights_templar = {
					holder_scope = {
						character_event = {
							id = SoA.1140
						}
					}
				}
			}
			
			wealth = -300
			piety = 75 # EMF
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0
				OR = {
					piety = 1000
					NOT = { wealth = 1000 }
					AND = {
						NOT = { controls_religion = catholic }
						NOT = { controls_religion = fraticelli }
						NOT = { controls_religion = waldensian }
						NOT = { controls_religion = lollard }
					}
				}
			}
			modifier = {
				factor = 0.002 # Slow it down
			}
		}
	}
	
	donate_money_to_knights_hospitaler = {
		potential = {
			OR = {
				religion = catholic
				religion = cathar
				religion = fraticelli
				religion = waldensian
				religion = lollard
			}
			is_heretic = no
			is_title_active = d_knights_hospitaler
			
			NOT = { has_character_modifier = expelled_d_knights_hospitaler }
			
			OR = {
				AND = {
					NOT = { is_title_active = d_teutonic_order }
					NOT = { is_title_active = d_knights_santiago }
					NOT = { is_title_active = d_knights_calatrava }
				}
				AND = {
					NOT = { is_title_active = d_teutonic_order }
					NOT = { culture_group = iberian }
					NOT = { culture_group = west_african }
					NOT = { culture = maghreb_arabic }
					NOT = { culture = occitan }
				}
				AND = {
					NOT = { is_title_active = d_knights_santiago }
					NOT = { is_title_active = d_knights_calatrava }
					NOT = { culture_group = north_germanic }
					NOT = { culture_group = central_germanic }
					NOT = { culture_group = magyar }
					NOT = { culture_group = south_slavic }
					NOT = { culture_group = west_slavic }
				}
			}
			
			has_dlc = "Sons of Abraham"
			
			d_knights_hospitaler = {
				holder_scope = {
					liege = {
						NOT = { character = ROOT }
					}
				}
			}
		}
		
		allow = {
			wealth = 300
		}
		
		effect = {
			if = {
				limit = { 
					NOT = { has_character_modifier = donated_to_holy_order }
				}
				add_character_modifier = {
					name = donated_to_holy_order
					duration = -1
				}
			}
			
			hidden_tooltip = {
				d_knights_hospitaler = {
					holder_scope = {
						character_event = {
							id = SoA.1140
						}
					}
				}
			}
			
			wealth = -300
			piety = 75 # EMF
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0
				OR = {
					piety = 1000
					NOT = { wealth = 1000 }
					AND = {
						NOT = { controls_religion = catholic }
						NOT = { controls_religion = fraticelli }
						NOT = { controls_religion = waldensian }
						NOT = { controls_religion = lollard }
					}
				}
			}
			modifier = {
				factor = 0.002 # Slow it down
			}
		}
	}
	
	donate_money_to_teutonic_order = {
		potential = {
			OR = {
				religion = catholic
				religion = cathar
				religion = fraticelli
				religion = waldensian
				religion = lollard
			}
			is_heretic = no
			is_title_active = d_teutonic_order
			
			NOT = { has_character_modifier = expelled_d_teutonic_order }
			
			OR = {
				AND = {
					NOT = { is_title_active = d_knights_hospitaler }
					NOT = { is_title_active = d_knights_templar }
					NOT = { is_title_active = d_knights_santiago }
					NOT = { is_title_active = d_knights_calatrava }
				}
				AND = {
					NOT = { is_title_active = d_knights_hospitaler }
					NOT = { is_title_active = d_knights_templar }
					NOT = { culture_group = iberian }
					NOT = { culture_group = west_african }
					NOT = { culture = maghreb_arabic }
					NOT = { culture = occitan }
				}
				culture_group = north_germanic
				culture_group = central_germanic
				culture_group = magyar
				culture_group = south_slavic
				culture_group = west_slavic
			}
			
			has_dlc = "Sons of Abraham"
			
			d_teutonic_order = {
				holder_scope = {
					liege = {
						NOT = { character = ROOT }
					}
				}
			}
		}
		
		allow = {
			wealth = 75 # EMF
		}
		
		effect = {
			if = {
				limit = { 
					NOT = { has_character_modifier = donated_to_holy_order }
				}
				add_character_modifier = {
					name = donated_to_holy_order
					duration = -1
				}
			}
			
			hidden_tooltip = {
				d_teutonic_order = {
					holder_scope = {
						character_event = {
							id = SoA.1340
						}
					}
				}
			}
			
			wealth = -300
			piety = 300
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0
				OR = {
					piety = 1000
					NOT = { wealth = 1000 }
					AND = {
						NOT = { controls_religion = catholic }
						NOT = { controls_religion = fraticelli }
						NOT = { controls_religion = waldensian }
						NOT = { controls_religion = lollard }
					}
				}
			}
			modifier = {
				factor = 0.002 # Slow it down
			}
		}
	}
	
	donate_money_to_jomsvikings = {
		potential = {
			OR = {
				religion = norse_pagan
				religion = norse_pagan_reformed
			}
			
			is_title_active = d_jomsvikings
			
			has_dlc = "Sons of Abraham"
			
			d_jomsvikings = {
				holder_scope = {
					liege = {
						NOT = { character = ROOT }
					}
				}
			}
			
			NOT = { has_character_modifier = expelled_d_jomsvikings }
		}
		
		allow = {
			wealth = 300
		}
		
		effect = {
			if = {
				limit = { 
					NOT = { has_character_modifier = donated_to_holy_order }
				}
				add_character_modifier = {
					name = donated_to_holy_order
					duration = -1
				}
			}
			
			hidden_tooltip = {
				d_jomsvikings = {
					holder_scope = {
						character_event = {
							id = SoA.1540
						}
					}
				}
			}
			
			wealth = -300
			piety = 75 # EMF
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0
				OR = {
					piety = 1000
					NOT = { wealth = 1000 }
				}
			}
			modifier = {
				factor = 0.002 # Slow it down
			}
		}
	}
	
	borrow_money_assassins = {
		potential = {
			OR = {
				religion = shiite
				religion = druze
				religion = hurufi
			}
			is_heretic = no
			is_title_active = d_hashshashin
			NOT = { has_character_modifier = borrowed_from_assassins }
			NOT = { has_character_modifier = expelled_d_hashshashin }
			NOT = { is_nomadic = yes }
			
			has_dlc = "Sons of Abraham"
			
			d_hashshashin = {
				holder_scope = {
					liege = {
						NOT = { character = ROOT }
					}
				}
			}
		}
		
		allow = {
			d_hashshashin = {
				holder_scope = {
					wealth = 300
				}
			}
		}
		
		effect = {
			add_character_modifier = {
				name = borrowed_from_assassins
				duration = -1
				inherit = yes
			}
			
			hidden_tooltip = {
				d_hashshashin = {
					holder_scope = {
						character_event = {
							id = SoA.1410
						}
					}
				}
			}
			
			wealth = 300
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0
				wealth = 0
			}
			modifier = {
				factor = 0.01 # Slow it down
			}
		}
	}
	
	donate_money_to_assassins = {
		potential = {
			OR = {
				religion = shiite
				religion = druze
				religion = hurufi
			}
			is_heretic = no
			is_title_active = d_hashshashin
			
			NOT = { has_character_modifier = expelled_d_hashshashin }
			
			has_dlc = "Sons of Abraham"
			
			d_hashshashin = {
				holder_scope = {
					liege = {
						NOT = { character = ROOT }
					}
				}
			}
		}
		
		allow = {
			wealth = 300
		}
		
		effect = {
			
			hidden_tooltip = {
				d_hashshashin = {
					holder_scope = {
						character_event = {
							id = SoA.1140
						}
					}
				}
			}
			
			wealth = -300
			piety = 75 # EMF
		}

		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0
				OR = {
					piety = 1000
					NOT = { wealth = 1000 }
				}
			}
			modifier = {
				factor = 0.002 # Slow it down
			}
		}
	}
		
		
	borrow_money_bektashi = {
		potential = {
			OR = {
				religion = sunni
				religion = zikri
				religion = yazidi
			}
			is_heretic = no
			is_title_active = d_bektashi
			NOT = { has_character_modifier = borrowed_from_bektashi }
			NOT = { has_character_modifier = expelled_d_bektashi }
			NOT = { is_nomadic = yes }
			
			has_dlc = "Sons of Abraham"
			
			d_bektashi = {
				holder_scope = {
					liege = {
						NOT = { character = ROOT }
					}
				}
			}
		}
		
		allow = {
			d_bektashi = {
				holder_scope = {
					wealth = 300
				}
			}
		}
		
		effect = {
			add_character_modifier = {
				name = borrowed_from_bektashi
				duration = -1
				inherit = yes
			}
			
			hidden_tooltip = {
				d_bektashi = {
					holder_scope = {
						character_event = {
							id = SoA.1210
						}
					}
				}
			}
			wealth = 300
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0
				wealth = 0
			}
			modifier = {
				factor = 0.01 # Slow it down
			}
		}
	}

	donate_money_to_bektashi = {
		potential = {
			OR = {
				religion = sunni
				religion = zikri
				religion = yazidi
			}
			is_heretic = no
			is_title_active = d_bektashi
			has_dlc = "Sons of Abraham"
			
			NOT = { has_character_modifier = expelled_d_bektashi }
			
			d_bektashi = {
				holder_scope = {
					liege = {
						NOT = { character = ROOT }
					}
				}
			}
		}
		
		allow = {
			wealth = 300
		}
		
		effect = {
			
			hidden_tooltip = {
				d_bektashi = {
					holder_scope = {
						character_event = {
							id = SoA.1140
						}
					}
				}
			}
			
			wealth = -300
			piety = 75 # EMF
		}

		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0
				OR = {
					piety = 1000
					NOT = { wealth = 1000 }
				}
			}
			modifier = {
				factor = 0.002 # Slow it down
			}
		}
	}
	
	expel_the_bektashi = {
		potential = {
			ai = no
			OR = {
				religion = sunni
				religion = zikri
				religion = yazidi
			}
			is_heretic = no
			higher_tier_than = DUKE
			independent = yes
			is_title_active = d_bektashi
			NOT = { has_character_modifier = expelled_d_bektashi }
			
			any_realm_province = {
				any_province_lord = {
					d_bektashi = {
						holder_scope = {
							OR = {
								character = PREVPREV
								is_vassal_or_below = PREVPREV
							}
						}
					}
				}
			}
			
			has_dlc = "Sons of Abraham"
		}
		
		allow = {
			piety = 1000
		}
		
		effect = {
			piety = -1000
			
			religion_authority = {
				modifier = holy_order_expelled
				years = 20
			}
			
			hidden_tooltip = {
				d_bektashi = {
					holder_scope = {
						character_event = {
							id = SoA.1460
						}
					}
				}
				
				add_character_modifier = {
					name = expelled_d_bektashi
					duration = -1
					inherit = yes
				}
			}
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 0
		}
	}
	
	borrow_money_haruriyyah = {
		potential = {
			OR = {
				religion = ibadi
				religion = kharijite
			}
			is_heretic = no
			is_title_active = d_haruriyyah
			NOT = { has_character_modifier = borrowed_from_haruriyyah }
			NOT = { has_character_modifier = expelled_d_haruriyyah }
			NOT = { is_nomadic = yes }
			
			has_dlc = "Charlemagne"
			
			d_haruriyyah = {
				holder_scope = {
					liege = {
						NOT = { character = ROOT }
					}
				}
			}
		}
		
		allow = {
			d_haruriyyah = {
				holder_scope = {
					wealth = 300
				}
			}
		}
		
		effect = {
			add_character_modifier = {
				name = borrowed_from_haruriyyah
				duration = -1
				inherit = yes
			}
			
			hidden_tooltip = {
				d_haruriyyah = {
					holder_scope = {
						character_event = {
							id = CM.4310
						}
					}
				}
			}
			wealth = 300
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0
				wealth = 0
			}
			modifier = {
				factor = 0.01 # Slow it down
			}
		}
	}

	donate_money_to_haruriyyah = {
		potential = {
			OR = {
				religion = ibadi
				religion = kharijite
			}
			is_heretic = no
			is_title_active = d_haruriyyah
			has_dlc = "Charlemagne"
			
			NOT = { has_character_modifier = expelled_d_haruriyyah }
			
			d_haruriyyah = {
				holder_scope = {
					liege = {
						NOT = { character = ROOT }
					}
				}
			}
		}
		
		allow = {
			wealth = 300
		}
		
		effect = {
			
			hidden_tooltip = {
				d_haruriyyah = {
					holder_scope = {
						character_event = {
							id = SoA.1140
						}
					}
				}
			}
			
			wealth = -300
			piety = 75 # EMF
		}

		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0
				OR = {
					piety = 1000
					NOT = { wealth = 1000 }
				}
			}
			modifier = {
				factor = 0.002 # Slow it down
			}
		}
	}
	
	expel_the_haruriyyah = {
		potential = {
			ai = no
			OR = {
				religion = ibadi
				religion = kharijite
			}
			is_heretic = no
			higher_tier_than = DUKE
			independent = yes
			is_title_active = d_haruriyyah
			NOT = { has_character_modifier = expelled_d_haruriyyah }
			
			any_realm_province = {
				any_province_lord = {
					d_haruriyyah = {
						holder_scope = {
							OR = {
								character = PREVPREV
								is_vassal_or_below = PREVPREV
							}
						}
					}
				}
			}
			
			has_dlc = "Charlemagne"
		}
		
		allow = {
			piety = 1000
		}
		
		effect = {
			piety = -1000
			
			religion_authority = {
				modifier = holy_order_expelled
				years = 20
			}
			
			hidden_tooltip = {
				d_haruriyyah = {
					holder_scope = {
						character_event = {
							id = SoA.1460
						}
					}
				}
				
				add_character_modifier = {
					name = expelled_d_haruriyyah
					duration = -1
					inherit = yes
				}
			}
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 0
		}
	}
	
	vassalize_knights_templar = { # EMF: Heavily modified from vanilla
		is_high_prio = yes
		
		potential = {
			has_dlc = "Sons of Abraham"
			has_landed_title = k_jerusalem
			is_title_active = d_knights_templar
			OR = {
				religion = catholic
				religion = cathar
				religion = fraticelli
				religion = waldensian
				religion = lollard
			}
			primary_title = { is_primary_type_title = no }
			d_knights_templar = {
				holder_scope = {
					NOT = { is_liege_or_above = ROOT }
				}
			}
		}
		
		allow = {
			has_landed_title = k_jerusalem
			
			wealth = 500
			
			is_heretic = no
			
			NOT = { has_character_modifier = expelled_d_knights_templar }
			
			d_knights_templar = {
				holder_scope = {
					NOT = { has_truce = ROOT }
					ROOT = { NOT = { has_truce = PREV } }
					NOT = { has_non_aggression_pact_with = ROOT }
					liege = {
						NOT = { character = ROOT }
					}
					NOT = { num_of_count_titles = 3 }
					independent = yes
					primary_title = { title = d_knights_templar }
				}
			}
		}
		
		effect = {
			wealth = -500
			
			hidden_tooltip = {
				d_knights_templar = {
					holder_scope = {
						wealth = 500
						character_event = {
							id = SoA.1015
						}
					}
				}
			}
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 1
		}
	}
	

	vassalize_knights_hospitaler = { # EMF: Heavily modified from vanilla
		is_high_prio = yes
		
		potential = {
			has_dlc = "Sons of Abraham"
			has_landed_title = k_jerusalem
			is_title_active = d_knights_hospitaler
			OR = {
				religion = catholic
				religion = cathar
				religion = fraticelli
				religion = waldensian
				religion = lollard
			}
			primary_title = { is_primary_type_title = no }
			d_knights_hospitaler = {
				holder_scope = {
					NOT = { is_liege_or_above = ROOT }
				}
			}
		}
		
		allow = {
			has_landed_title = k_jerusalem
			
			wealth = 500
			
			is_heretic = no
			
			NOT = { has_character_modifier = expelled_d_knights_hospitaler }
			
			d_knights_hospitaler = {
				holder_scope = {
					NOT = { has_truce = ROOT }
					ROOT = { NOT = { has_truce = PREV } }
					NOT = { has_non_aggression_pact_with = ROOT }
					liege = {
						NOT = { character = ROOT }
					}
					NOT = { num_of_count_titles = 3 }
					independent = yes
					primary_title = { title = d_knights_hospitaler }
				}
			}
		}
		
		effect = {
			wealth = -500
			
			hidden_tooltip = {
				d_knights_hospitaler = {
					holder_scope = {
						wealth = 500
						character_event = {
							id = SoA.1115
						}
					}
				}
			}
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 1
		}
	}
	
	expel_the_holy_sepulchre = {
		potential = {
			ai = no
			OR = {
				religion = orthodox
				religion = bogomilist
				religion = monothelite
				religion = iconoclast
				religion = paulician
			}
			is_heretic = no
			higher_tier_than = DUKE
			independent = yes
			is_title_active = d_holy_sepulchre
			NOT = { has_character_modifier = expelled_d_holy_sepulchre }
			
			any_realm_province = {
				any_province_lord = {
					d_holy_sepulchre = {
						holder_scope = {
							OR = {
								character = PREVPREV
								is_vassal_or_below = PREVPREV
							}
						}
					}
				}
			}
			
			has_dlc = "Sons of Abraham"
		}
		
		allow = {
			piety = 1000
		}
		
		effect = {
			piety = -1000
			
			religion_authority = {
				modifier = holy_order_expelled
				years = 20
			}
			
			hidden_tooltip = {
				d_holy_sepulchre = {
					holder_scope = {
						character_event = {
							id = SoA.1660
						}
					}
				}
				add_character_modifier = {
					name = expelled_d_holy_sepulchre
					duration = -1
					inherit = yes
				}
			}
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 0
		}
	}
	
	donate_money_to_holy_sepulchre = {
		potential = {
			OR = {
				religion = orthodox
				religion = bogomilist
				religion = monothelite
				religion = iconoclast
				religion = paulician
			}
			is_heretic = no
			
			is_title_active = d_holy_sepulchre
			
			NOT = { has_character_modifier = expelled_d_holy_sepulchre }
			
			d_holy_sepulchre = {
				holder_scope = {
					liege = {
						NOT = { character = ROOT }
					}
				}
			}
			
			has_dlc = "Sons of Abraham"
		}
		
		allow = {
			wealth = 300
		}
		
		effect = {
			if = {
				limit = { 
					NOT = { has_character_modifier = donated_to_holy_order }
				}
				add_character_modifier = {
					name = donated_to_holy_order
					duration = -1
				}
			}
			
			hidden_tooltip = {
				d_holy_sepulchre = {
					holder_scope = {
						character_event = {
							id = SoA.1640
						}
					}
				}
			}
			
			wealth = -300
			piety = 75 # EMF
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0
				OR = {
					piety = 1000
					NOT = { wealth = 1000 }
					AND = {
						NOT = { controls_religion = orthodox }
						NOT = { controls_religion = bogomilist }
						NOT = { controls_religion = monothelite }
						NOT = { controls_religion = iconoclast }
						NOT = { controls_religion = paulician }
					}
				}
			}
			modifier = {
				factor = 0.002 # Slow it down
			}
		}
	}
	
	expel_saint_anthony = {
		potential = {
			ai = no
			OR = {
				religion = miaphysite
				religion = monophysite
			}
			is_heretic = no
			higher_tier_than = DUKE
			independent = yes
			is_title_active = d_saint_anthony
			NOT = { has_character_modifier = expelled_d_saint_anthony }
			
			any_realm_province = {
				any_province_lord = {
					d_saint_anthony = {
						holder_scope = {
							OR = {
								character = PREVPREV
								is_vassal_or_below = PREVPREV
							}
						}
					}
				}
			}
			
			has_dlc = "Sons of Abraham"
		}
		
		allow = {
			piety = 1000
		}
		
		effect = {
			piety = -1000
			
			religion_authority = {
				modifier = holy_order_expelled
				years = 20
			}
			
			hidden_tooltip = {
				d_saint_anthony = {
					holder_scope = {
						character_event = {
							id = SoA.1760
						}
					}
				}
				add_character_modifier = {
					name = expelled_d_saint_anthony
					duration = -1
					inherit = yes
				}
			}
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 0
		}
	}
	
	donate_money_to_saint_anthony = {
		potential = {
			OR = {
				religion = miaphysite
				religion = monophysite
			}
			is_heretic = no
			
			is_title_active = d_saint_anthony
			
			NOT = { has_character_modifier = expelled_d_saint_anthony }
			
			d_saint_anthony = {
				holder_scope = {
					liege = {
						NOT = { character = ROOT }
					}
				}
			}
			
			has_dlc = "Sons of Abraham"
		}
		
		allow = {
			wealth = 300
		}
		
		effect = {
			if = {
				limit = { 
					NOT = { has_character_modifier = donated_to_holy_order }
				}
				add_character_modifier = {
					name = donated_to_holy_order
					duration = -1
				}
			}
			
			hidden_tooltip = {
				d_saint_anthony = {
					holder_scope = {
						character_event = {
							id = SoA.1740
						}
					}
				}
			}
			
			wealth = -300
			piety = 75 # EMF
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0
				OR = {
					piety = 1000
					NOT = { wealth = 1000 }
					AND = {
						NOT = { controls_religion = miaphysite }
						NOT = { controls_religion = monophysite }
					}
				}
			}
			modifier = {
				factor = 0.002 # Slow it down
			}
		}
	}
	
	expel_immortals = {
		potential = {
			ai = no
			OR = {
				religion = zoroastrian
				religion = mazdaki
			}
			is_heretic = no
			higher_tier_than = DUKE
			independent = yes
			is_title_active = d_immortals
			NOT = { has_character_modifier = expelled_d_immortals }
			
			any_realm_province = {
				any_province_lord = {
					d_immortals = {
						holder_scope = {
							OR = {
								character = PREVPREV
								is_vassal_or_below = PREVPREV
							}
						}
					}
				}
			}
			
			has_dlc = "Sons of Abraham"
		}
		
		allow = {
			piety = 1000
		}
		
		effect = {
			piety = -1000
			
			religion_authority = {
				modifier = holy_order_expelled
				years = 20
			}
			
			hidden_tooltip = {
				d_immortals = {
					holder_scope = {
						character_event = {
							id = SoA.1860
						}
					}
				}
				add_character_modifier = {
					name = expelled_d_immortals
					duration = -1
					inherit = yes
				}
			}
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 0
		}
	}
	
	donate_money_to_the_immortals = {
		potential = {
			OR = {
				religion = zoroastrian
				religion = mazdaki
			}
			is_heretic = no
			
			is_title_active = d_immortals
			
			NOT = { has_character_modifier = expelled_d_immortals }
			
			has_dlc = "Sons of Abraham"
			
			d_immortals = {
				holder_scope = {
					liege = {
						NOT = { character = ROOT }
					}
				}
			}
		}
		
		allow = {
			wealth = 300
		}
		
		effect = {
			if = {
				limit = { 
					NOT = { has_character_modifier = donated_to_holy_order }
				}
				add_character_modifier = {
					name = donated_to_holy_order
					duration = -1
				}
			}
			
			hidden_tooltip = {
				d_immortals = {
					holder_scope = {
						character_event = {
							id = SoA.1840
						}
					}
				}
			}
			
			wealth = -300
			piety = 75 # EMF
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0
				OR = {
					piety = 1000
					NOT = { wealth = 1000 }
					AND = {
						NOT = { controls_religion = zoroastrian }
						NOT = { controls_religion = mazdaki }
					}
				}
			}
			modifier = {
				factor = 0.002 # Slow it down
			}
		}
	}
	
	expel_zealots = {
		potential = {
			ai = no
			OR = {
				religion = jewish
				religion = samaritan
				religion = karaite
			}
			is_heretic = no
			higher_tier_than = DUKE
			independent = yes
			is_title_active = d_zealots
			NOT = { has_character_modifier = expelled_d_zealots }
			
			any_realm_province = {
				any_province_lord = {
					d_zealots = {
						holder_scope = {
							OR = {
								character = PREVPREV
								is_vassal_or_below = PREVPREV
							}
						}
					}
				}
			}
			
			has_dlc = "Sons of Abraham"
		}
		
		allow = {
			piety = 1000
		}
		
		effect = {
			piety = -1000
			
			religion_authority = {
				modifier = holy_order_expelled
				years = 20
			}
			
			hidden_tooltip = {
				d_zealots = {
					holder_scope = {
						character_event = {
							id = SoA.1960
						}
					}
				}
				add_character_modifier = {
					name = expelled_d_zealots
					duration = -1
					inherit = yes
				}
			}
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 0
		}
	}
	
	donate_money_to_the_zealots = {
		potential = {
			OR = {
				religion = jewish
				religion = samaritan
				religion = karaite
			}
			is_heretic = no
			
			is_title_active = d_zealots
			
			has_dlc = "Sons of Abraham"
			
			NOT = { has_character_modifier = expelled_d_zealots }
			
			d_zealots = {
				holder_scope = {
					liege = {
						NOT = { character = ROOT }
					}
				}
			}
		}
		
		allow = {
			wealth = 300
		}
		
		effect = {
			if = {
				limit = { 
					NOT = { has_character_modifier = donated_to_holy_order }
				}
				add_character_modifier = {
					name = donated_to_holy_order
					duration = -1
				}
			}
			
			hidden_tooltip = {
				d_zealots = {
					holder_scope = {
						character_event = {
							id = SoA.1940
						}
					}
				}
			}
			
			wealth = -300
			piety = 75 # EMF
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0
				OR = {
					piety = 1000
					NOT = { wealth = 1000 }
					AND = {
						NOT = { controls_religion = jewish }
						NOT = { controls_religion = samaritan }
						NOT = { controls_religion = karaite }
					}
				}
			}
			modifier = {
				factor = 0.002 # Slow it down
			}
		}
	}
	
	expel_sky_lords = {
		potential = {
			ai = no
			religion = tengri_pagan_reformed
			higher_tier_than = DUKE
			independent = yes
			is_title_active = d_sky_lords
			NOT = { has_character_modifier = expelled_d_sky_lords }
			
			any_realm_province = {
				any_province_lord = {
					d_sky_lords = {
						holder_scope = {
							OR = {
								character = PREVPREV
								is_vassal_or_below = PREVPREV
							}
						}
					}
				}
			}
			
			has_dlc = "Sons of Abraham"
		}
		
		allow = {
			piety = 1000
		}
		
		effect = {
			piety = -1000
			
			religion_authority = {
				modifier = holy_order_expelled
				years = 20
			}
			
			hidden_tooltip = {
				d_sky_lords = {
					holder_scope = {
						character_event = {
							id = SoA.2060
						}
					}
				}
				add_character_modifier = {
					name = expelled_d_sky_lords
					duration = -1
					inherit = yes
				}
			}
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 0
		}
	}
	
	donate_money_to_sky_lords = {
		potential = {
			religion = tengri_pagan_reformed
			
			is_title_active = d_sky_lords
			
			has_dlc = "Sons of Abraham"
			
			NOT = { has_character_modifier = expelled_d_sky_lords }
			
			d_sky_lords = {
				holder_scope = {
					liege = {
						NOT = { character = ROOT }
					}
				}
			}
		}
		
		allow = {
			wealth = 300
		}
		
		effect = {
			if = {
				limit = { 
					NOT = { has_character_modifier = donated_to_holy_order }
				}
				add_character_modifier = {
					name = donated_to_holy_order
					duration = -1
				}
			}
			
			hidden_tooltip = {
				d_sky_lords = {
					holder_scope = {
						character_event = {
							id = SoA.2040
						}
					}
				}
			}
			
			wealth = -300
			piety = 75 # EMF
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0
				OR = {
					piety = 1000
					NOT = { wealth = 1000 }
					NOT = { controls_religion = tengri_pagan_reformed }
				}
			}
			modifier = {
				factor = 0.002 # Slow it down
			}
		}
	}
	
	expel_spirit_guardians = {
		potential = {
			ai = no
			religion = west_african_pagan_reformed
			higher_tier_than = DUKE
			independent = yes
			is_title_active = d_spirit_guardians
			NOT = { has_character_modifier = expelled_d_spirit_guardians }
			
			any_realm_province = {
				any_province_lord = {
					d_spirit_guardians = {
						holder_scope = {
							OR = {
								character = PREVPREV
								is_vassal_or_below = PREVPREV
							}
						}
					}
				}
			}
			
			has_dlc = "Sons of Abraham"
		}
		
		allow = {
			piety = 1000
		}
		
		effect = {
			piety = -1000
			
			religion_authority = {
				modifier = holy_order_expelled
				years = 20
			}
			
			hidden_tooltip = {
				d_spirit_guardians = {
					holder_scope = {
						character_event = {
							id = SoA.2160
						}
					}
				}
				add_character_modifier = {
					name = expelled_d_spirit_guardians
					duration = -1
					inherit = yes
				}
			}
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 0
		}
	}
	
	donate_money_to_spirit_guardians = {
		potential = {
			religion = west_african_pagan_reformed
			
			is_title_active = d_spirit_guardians
			
			has_dlc = "Sons of Abraham"
			
			NOT = { has_character_modifier = expelled_d_spirit_guardians }
			
			d_spirit_guardians = {
				holder_scope = {
					liege = {
						NOT = { character = ROOT }
					}
				}
			}
		}
		
		allow = {
			wealth = 300
		}
		
		effect = {
			if = {
				limit = { 
					NOT = { has_character_modifier = donated_to_holy_order }
				}
				add_character_modifier = {
					name = donated_to_holy_order
					duration = -1
				}
			}
			
			hidden_tooltip = {
				d_spirit_guardians = {
					holder_scope = {
						character_event = {
							id = SoA.2140
						}
					}
				}
			}
			
			wealth = -300
			piety = 75 # EMF
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0
				OR = {
					piety = 1000
					NOT = { wealth = 1000 }
					NOT = { controls_religion = west_african_pagan_reformed }
				}
			}
			modifier = {
				factor = 0.002 # Slow it down
			}
		}
	}
	
	expel_warriors_perun = {
		potential = {
			ai = no
			religion = slavic_pagan_reformed
			higher_tier_than = DUKE
			independent = yes
			is_title_active = d_warriors_perun
			NOT = { has_character_modifier = expelled_d_warriors_perun }
			
			any_realm_province = {
				any_province_lord = {
					d_warriors_perun = {
						holder_scope = {
							OR = {
								character = PREVPREV
								is_vassal_or_below = PREVPREV
							}
						}
					}
				}
			}
			
			has_dlc = "Sons of Abraham"
		}
		
		allow = {
			piety = 1000
		}
		
		effect = {
			piety = -1000
			
			religion_authority = {
				modifier = holy_order_expelled
				years = 20
			}
			
			hidden_tooltip = {
				d_warriors_perun = {
					holder_scope = {
						character_event = {
							id = SoA.2260
						}
					}
				}
				add_character_modifier = {
					name = expelled_d_warriors_perun
					duration = -1
					inherit = yes
				}
			}
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 0
		}
	}
	
	donate_money_to_warriors_perun = {
		potential = {
			religion = slavic_pagan_reformed
			
			is_title_active = d_warriors_perun
			
			NOT = { has_character_modifier = expelled_d_warriors_perun }
			
			has_dlc = "Sons of Abraham"
			
			d_warriors_perun = {
				holder_scope = {
					liege = {
						NOT = { character = ROOT }
					}
				}
			}
		}
		
		allow = {
			wealth = 300
		}
		
		effect = {
			if = {
				limit = { 
					NOT = { has_character_modifier = donated_to_holy_order }
				}
				add_character_modifier = {
					name = donated_to_holy_order
					duration = -1
				}
			}
			
			hidden_tooltip = {
				d_warriors_perun = {
					holder_scope = {
						character_event = {
							id = SoA.2240
						}
					}
				}
			}
			
			wealth = -300
			piety = 75 # EMF
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0
				OR = {
					piety = 1000
					NOT = { wealth = 1000 }
					NOT = { controls_religion = slavic_pagan_reformed }
				}
			}
			modifier = {
				factor = 0.002 # Slow it down
			}
		}
	}
	
	expel_chosen_perkunas = {
		potential = {
			ai = no
			religion = baltic_pagan_reformed
			higher_tier_than = DUKE
			independent = yes
			is_title_active = d_chosen_perkunas
			NOT = { has_character_modifier = expelled_d_chosen_perkunas }
			
			any_realm_province = {
				any_province_lord = {
					d_chosen_perkunas = {
						holder_scope = {
							OR = {
								character = PREVPREV
								is_vassal_or_below = PREVPREV
							}
						}
					}
				}
			}
			
			has_dlc = "Sons of Abraham"
		}
		
		allow = {
			piety = 1000
		}
		
		effect = {
			piety = -1000
			
			religion_authority = {
				modifier = holy_order_expelled
				years = 20
			}
			
			hidden_tooltip = {
				d_chosen_perkunas = {
					holder_scope = {
						character_event = {
							id = SoA.2360
						}
					}
				}
				add_character_modifier = {
					name = expelled_d_chosen_perkunas
					duration = -1
					inherit = yes
				}
			}
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 0
		}
	}
	
	donate_money_to_chosen_perkunas = {
		potential = {
			religion = baltic_pagan_reformed
			
			is_title_active = d_chosen_perkunas
			
			has_dlc = "Sons of Abraham"
			
			NOT = { has_character_modifier = expelled_d_chosen_perkunas }
			
			d_chosen_perkunas = {
				holder_scope = {
					liege = {
						NOT = { character = ROOT }
					}
				}
			}
		}
		
		allow = {
			wealth = 300
		}
		
		effect = {
			if = {
				limit = { 
					NOT = { has_character_modifier = donated_to_holy_order }
				}
				add_character_modifier = {
					name = donated_to_holy_order
					duration = -1
				}
			}
			
			hidden_tooltip = {
				d_chosen_perkunas = {
					holder_scope = {
						character_event = {
							id = SoA.2340
						}
					}
				}
			}
			
			wealth = -300
			piety = 75 # EMF
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0
				OR = {
					piety = 1000
					NOT = { wealth = 1000 }
					NOT = { controls_religion = baltic_pagan_reformed }
				}
			}
			modifier = {
				factor = 0.002 # Slow it down
			}
		}
	}
	
	expel_sons_kaleva = {
		potential = {
			ai = no
			religion = finnish_pagan_reformed
			higher_tier_than = DUKE
			independent = yes
			is_title_active = d_sons_kaleva
			NOT = { has_character_modifier = expelled_d_sons_kaleva }
			
			any_realm_province = {
				any_province_lord = {
					d_chosen_perkunas = {
						holder_scope = {
							OR = {
								character = PREVPREV
								is_vassal_or_below = PREVPREV
							}
						}
					}
				}
			}
			
			has_dlc = "Sons of Abraham"
		}
		
		allow = {
			piety = 1000
		}
		
		effect = {
			piety = -1000
			
			religion_authority = {
				modifier = holy_order_expelled
				years = 20
			}
			
			hidden_tooltip = {
				d_sons_kaleva = {
					holder_scope = {
						character_event = {
							id = SoA.2460
						}
					}
				}
				add_character_modifier = {
					name = expelled_d_sons_kaleva
					duration = -1
					inherit = yes
				}
			}
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 0
		}
	}
	
	donate_money_to_sons_kaleva = {
		potential = {
			religion = finnish_pagan_reformed
			
			is_title_active = d_sons_kaleva
			
			has_dlc = "Sons of Abraham"
			
			NOT = { has_character_modifier = expelled_d_sons_kaleva }
			
			d_sons_kaleva = {
				holder_scope = {
					liege = {
						NOT = { character = ROOT }
					}
				}
			}
		}
		
		allow = {
			wealth = 300
		}
		
		effect = {
			if = {
				limit = { 
					NOT = { has_character_modifier = donated_to_holy_order }
				}
				add_character_modifier = {
					name = donated_to_holy_order
					duration = -1
				}
			}
			
			hidden_tooltip = {
				d_sons_kaleva = {
					holder_scope = {
						character_event = {
							id = SoA.2440
						}
					}
				}
			}
			
			wealth = -300
			piety = 75 # EMF
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0
				OR = {
					piety = 1000
					NOT = { wealth = 1000 }
					NOT = { controls_religion = finnish_pagan_reformed }
				}
			}
			modifier = {
				factor = 0.002 # Slow it down
			}
		}
	}
	
	expel_huitzilopochtli = {
		potential = {
			ai = no
			religion = aztec_reformed
			higher_tier_than = DUKE
			independent = yes
			is_title_active = d_huitzilopochtli
			NOT = { has_character_modifier = expelled_d_huitzilopochtli }
			
			any_realm_province = {
				any_province_lord = {
					d_huitzilopochtli = {
						holder_scope = {
							OR = {
								character = PREVPREV
								is_vassal_or_below = PREVPREV
							}
						}
					}
				}
			}
			
			has_dlc = "Sons of Abraham"
		}
		
		allow = {
			piety = 1000
		}
		
		effect = {
			piety = -1000
			
			religion_authority = {
				modifier = holy_order_expelled
				years = 20
			}
			
			hidden_tooltip = {
				d_huitzilopochtli = {
					holder_scope = {
						character_event = {
							id = SoA.2560
						}
					}
				}
				add_character_modifier = {
					name = expelled_d_huitzilopochtli
					duration = -1
					inherit = yes
				}
			}
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 0
		}
	}
	
	donate_money_to_huitzilopochtli = {
		potential = {
			religion = aztec_reformed
			
			is_title_active = d_huitzilopochtli
			
			has_dlc = "Sons of Abraham"
			
			NOT = { has_character_modifier = expelled_d_huitzilopochtli }
			
			d_huitzilopochtli = {
				holder_scope = {
					liege = {
						NOT = { character = ROOT }
					}
				}
			}
		}
		
		allow = {
			wealth = 300
		}
		
		effect = {
			if = {
				limit = { 
					NOT = { has_character_modifier = donated_to_holy_order }
				}
				add_character_modifier = {
					name = donated_to_holy_order
					duration = -1
				}
			}
			
			hidden_tooltip = {
				d_huitzilopochtli = {
					holder_scope = {
						character_event = {
							id = SoA.2540
						}
					}
				}
			}
			
			wealth = -300
			piety = 75 # EMF
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0
				OR = {
					piety = 1000
					NOT = { wealth = 1000 }
					NOT = { controls_religion = aztec_reformed }
				}
			}
			modifier = {
				factor = 0.002 # Slow it down
			}
		}
	}
	
	expel_knights_santiago = {
		potential = {
			ai = no
			OR = {
				religion = catholic
				religion = cathar
				religion = fraticelli
				religion = waldensian
				religion = lollard
			}
			is_heretic = no
			higher_tier_than = DUKE
			independent = yes
			is_title_active = d_knights_santiago
			NOT = { has_character_modifier = expelled_d_knights_santiago }
			
			any_realm_province = {
				any_province_lord = {
					d_knights_santiago = {
						holder_scope = {
							OR = {
								character = PREVPREV
								is_vassal_or_below = PREVPREV
							}
						}
					}
				}
			}
			
			has_dlc = "Sons of Abraham"
		}
		
		allow = {
			piety = 1000
		}
		
		effect = {
			piety = -1000
			
			religion_authority = {
				modifier = holy_order_expelled
				years = 20
			}
			
			hidden_tooltip = {
				d_knights_santiago = {
					holder_scope = {
						character_event = {
							id = SoA.2660
						}
					}
				}
				add_character_modifier = {
					name = expelled_d_knights_santiago
					duration = -1
					inherit = yes
				}
			}
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 0
		}
	}
	
	donate_money_to_knights_santiago = {
		potential = {
			OR = {
				religion = catholic
				religion = cathar
				religion = fraticelli
				religion = waldensian
				religion = lollard
			}
			is_heretic = no
			
			is_title_active = d_knights_santiago
			
			NOT = { has_character_modifier = expelled_d_knights_santiago }

			OR = {
				AND = {
					NOT = { is_title_active = d_knights_hospitaler }
					NOT = { is_title_active = d_knights_templar }
					NOT = { is_title_active = d_teutonic_order }
				}
				AND = {
					NOT = { is_title_active = d_knights_templar }
					NOT = { is_title_active = d_knights_hospitaler }
					NOT = { culture_group = north_germanic }
					NOT = { culture_group = central_germanic }
					NOT = { culture_group = magyar }
					NOT = { culture_group = south_slavic }
					NOT = { culture_group = west_slavic }
				}
				culture_group = iberian
				culture_group = west_african
				culture = maghreb_arabic
				culture = occitan
			}
			
			has_dlc = "Sons of Abraham"
			
			d_knights_santiago = {
				holder_scope = {
					liege = {
						NOT = { character = ROOT }
					}
				}
			}
		}
		
		allow = {
			wealth = 300
		}
		
		effect = {
			if = {
				limit = { 
					NOT = { has_character_modifier = donated_to_holy_order }
				}
				add_character_modifier = {
					name = donated_to_holy_order
					duration = -1
				}
			}
			
			hidden_tooltip = {
				d_knights_santiago = {
					holder_scope = {
						character_event = {
							id = SoA.2640
						}
					}
				}
			}
			
			wealth = -300
			piety = 75 # EMF
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0
				OR = {
					piety = 1000
					NOT = { wealth = 1000 }
					AND = {
						NOT = { controls_religion = catholic }
						NOT = { controls_religion = fraticelli }
						NOT = { controls_religion = waldensian }
						NOT = { controls_religion = lollard }
					}
				}
			}
			modifier = {
				factor = 0.002 # Slow it down
			}
		}
	}
	
	expel_knights_calatrava = {
		potential = {
			ai = no
			OR = {
				religion = catholic
				religion = cathar
				religion = fraticelli
				religion = waldensian
				religion = lollard
			}
			is_heretic = no
			higher_tier_than = DUKE
			independent = yes
			is_title_active = d_knights_calatrava
			NOT = { has_character_modifier = expelled_d_knights_calatrava }
			
			any_realm_province = {
				any_province_lord = {
					d_knights_calatrava = {
						holder_scope = {
							OR = {
								character = PREVPREV
								is_vassal_or_below = PREVPREV
							}
						}
					}
				}
			}
			
			has_dlc = "Sons of Abraham"
		}
		
		allow = {
			piety = 1000
		}
		
		effect = {
			piety = -1000
			
			religion_authority = {
				modifier = holy_order_expelled
				years = 20
			}
			
			hidden_tooltip = {
				d_knights_calatrava = {
					holder_scope = {
						character_event = {
							id = SoA.2760
						}
					}
				}
				add_character_modifier = {
					name = expelled_d_knights_calatrava
					duration = -1
					inherit = yes
				}
			}
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 0
		}
	}
	
	donate_money_to_knights_calatrava = {
		potential = {
			OR = {
				religion = catholic
				religion = cathar
				religion = fraticelli
				religion = waldensian
				religion = lollard
			}
			is_heretic = no
			is_title_active = d_knights_calatrava
			
			NOT = { has_character_modifier = expelled_d_knights_calatrava }

			OR = {
				AND = {
					NOT = { is_title_active = d_knights_hospitaler }
					NOT = { is_title_active = d_knights_templar }
					NOT = { is_title_active = d_teutonic_order }
				}
				AND = {
					NOT = { is_title_active = d_knights_templar }
					NOT = { is_title_active = d_knights_hospitaler }
					NOT = { culture_group = north_germanic }
					NOT = { culture_group = central_germanic }
					NOT = { culture_group = magyar }
					NOT = { culture_group = south_slavic }
					NOT = { culture_group = west_slavic }
				}
				culture_group = iberian
				culture_group = west_african
				culture = maghreb_arabic
				culture = occitan
			}
			
			has_dlc = "Sons of Abraham"
			
			d_knights_calatrava = {
				holder_scope = {
					liege = {
						NOT = { character = ROOT }
					}
				}
			}
		}
		
		allow = {
			wealth = 300
		}
		
		effect = {
			if = {
				limit = { 
					NOT = { has_character_modifier = donated_to_holy_order }
				}
				add_character_modifier = {
					name = donated_to_holy_order
					duration = -1
				}
			}
			
			hidden_tooltip = {
				d_knights_calatrava = {
					holder_scope = {
						character_event = {
							id = SoA.2740
						}
					}
				}
			}
			
			wealth = -300
			piety = 75 # EMF
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0
				OR = {
					piety = 1000
					NOT = { wealth = 1000 }
					AND = {
						NOT = { controls_religion = catholic }
						NOT = { controls_religion = fraticelli }
						NOT = { controls_religion = waldensian }
						NOT = { controls_religion = lollard }
					}
				}
			}
			modifier = {
				factor = 0.002 # Slow it down
			}
		}
	}
	
	expel_order_of_addai = {
		potential = {
			ai = no
			OR = {
				religion = nestorian
				religion = messalian
			}
			is_heretic = no
			higher_tier_than = DUKE
			independent = yes
			is_title_active = d_saint_addai
			NOT = { has_character_modifier = expelled_d_saint_addai }
			
			any_realm_province = {
				any_province_lord = {
					d_saint_addai = {
						holder_scope = {
							OR = {
								character = PREVPREV
								is_vassal_or_below = PREVPREV
							}
						}
					}
				}
			}
			
			has_dlc = "Sons of Abraham"
		}
		
		allow = {
			piety = 1000
		}
		
		effect = {
			piety = -1000
			
			religion_authority = {
				modifier = holy_order_expelled
				years = 20
			}
			
			hidden_tooltip = {
				d_saint_addai = {
					holder_scope = {
						character_event = {
							id = SoA.2860
						}
					}
				}
				add_character_modifier = {
					name = expelled_d_saint_addai
					duration = -1
					inherit = yes
				}
			}
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 0
		}
	}
	
	donate_money_to_order_of_addai = {
		potential = {
			OR = {
				religion = nestorian
				religion = messalian
			}
			is_heretic = no
			
			is_title_active = d_saint_addai
			
			NOT = { has_character_modifier = expelled_d_saint_addai }
			
			d_saint_addai = {
				holder_scope = {
					liege = {
						NOT = { character = ROOT }
					}
				}
			}
			
			has_dlc = "Sons of Abraham"
		}
		
		allow = {
			wealth = 300
		}
		
		effect = {
			if = {
				limit = { 
					NOT = { has_character_modifier = donated_to_holy_order }
				}
				add_character_modifier = {
					name = donated_to_holy_order
					duration = -1
				}
			}
			
			hidden_tooltip = {
				d_saint_addai = {
					holder_scope = {
						character_event = {
							id = SoA.2840
						}
					}
				}
			}
			
			wealth = -300
			piety = 75 # EMF
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0
				OR = {
					piety = 1000
					NOT = { wealth = 1000 }
					AND = {
						NOT = { controls_religion = nestorian }
						NOT = { controls_religion = messalian }
					}
				}
			}
			modifier = {
				factor = 0.002 # Slow it down
			}
		}
	}
	expel_zun_warriors = {
		potential = {
			ai = no
			religion = zun_pagan_reformed
			higher_tier_than = DUKE
			independent = yes
			is_title_active = d_zun_warriors
			NOT = { has_character_modifier = expelled_d_zun_warriors }
			
			any_realm_province = {
				any_province_lord = {
					d_zun_warriors = {
						holder_scope = {
							OR = {
								character = PREVPREV
								is_vassal_or_below = PREVPREV
							}
						}
					}
				}
			}
			has_dlc = "Charlemagne"
		}
		
		allow = {
			piety = 1000
		}
		
		effect = {
			piety = -1000
			
			religion_authority = {
				modifier = holy_order_expelled
				years = 20
			}
			
			hidden_tooltip = {
				d_zun_warriors = {
					holder_scope = {
						character_event = {
							id = CM.4012
						}
					}
				}
				add_character_modifier = {
					name = expelled_d_zun_warriors
					duration = -1
					inherit = yes
				}
			}
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 0
		}
	}
	donate_money_to_zun_warriors = {
		potential = {
			religion = zun_pagan_reformed
			
			is_title_active = d_zun_warriors
			
			has_dlc = "Charlemagne"
			
			NOT = { has_character_modifier = expelled_d_zun_warriors }
			
			d_zun_warriors = {
				holder_scope = {
					liege = {
						NOT = { character = ROOT }
					}
				}
			}
		}
		
		allow = {
			wealth = 300
		}
		
		effect = {
			if = {
				limit = { 
					NOT = { has_character_modifier = donated_to_holy_order }
				}
				add_character_modifier = {
					name = donated_to_holy_order
					duration = -1
				}
			}
			
			hidden_tooltip = {
				d_zun_warriors = {
					holder_scope = {
						character_event = {
							id = CM.4005
						}
					}
				}
			}
			
			wealth = -300
			piety = 300
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0
				OR = {
					piety = 1000
					NOT = { wealth = 1000 }
					NOT = { controls_religion = zun_pagan_reformed }
				}
			}
			modifier = {
				factor = 0.002 # Slow it down
			}
		}
	}	
}

