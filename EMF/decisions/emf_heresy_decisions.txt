targetted_decisions = {
	lollard_revoke_temple = {
		is_high_prio = yes
		
		filter = sub_realm
		ai_target_filter = sub_realm
		
		from_potential = {
			is_ruler = yes
			religion = lollard
			NOT = { has_character_modifier = do_not_disturb }
		}
		potential = {
			is_ruler = yes
			holy_order = no
			vassal_of = FROM
			capital_holding = { holding_type = temple }
			OR = {
				NOT = { religion = lollard }
				trait = bad_priest_christian
				higher_tier_than = COUNT
			}
			NOR = {
				has_character_flag = lollard_revoking_titles
				any_demesne_title = { temporary = yes }
				reverse_has_truce = FROM
				has_non_aggression_pact_with = FROM
			}
		}
		allow = {
			ROOT = {
				war = no
			}
			FROM = {
				war = no
				has_regent = no
			}
		}
		effect = {
			hidden_tooltip = {
				FROM = { add_character_modifier = { name = do_not_disturb duration = 3 hidden = yes } }
				set_character_flag = lollard_revoking_titles
				letter_event = { id = emf_heresy.2021 days = 3 }
			}
		}
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0
				FROM = {
					trait = cynical
					NOT = {
						trait = ambitious
						trait = greedy
						trait = envious
					}
				}
			}
			modifier = {
				factor = 0
				reverse_opinion = { who = FROM value = 0 }
			}
		}
	}

}

decisions = {
	ai_monk_title_gain = {
		is_high_prio = yes
		potential = {
			ai = yes
			is_ruler = no
			religion_group = christian
			OR = {
				AND = {
					trait = monk
					NOT = { has_character_flag = title_monk }
				}
				AND = {
					trait = nun
					NOT = { has_character_flag = title_nun }
				}
				AND = {
					trait = perfecti
					is_female = no
					NOT = { has_character_flag = title_monk }
				}
				AND = {
					trait = perfecti
					is_female = yes
					NOT = { has_character_flag = title_nun }
				}
			}
		}
		allow = {
			always = yes
		}
		effect = {
			if = {
				limit = { trait = monk }
				set_character_flag = title_monk
				set_special_character_title = MONK_BROTHER
			}
			if = {
				limit = { trait = nun }
				set_character_flag = title_nun
				set_special_character_title = NUN_SISTER
			}
			if = {
				limit = {
					trait = perfecti
					is_female = no
				}
				set_character_flag = title_monk
				set_special_character_title = MONK_BROTHER
			}
			if = {
				limit = {
					trait = perfecti
					is_female = yes
				}
				set_character_flag = title_nun
				set_special_character_title = NUN_SISTER
			}
		}
	}
	
	ai_monk_title_lose = {
		is_high_prio = yes
		potential = {
			ai = yes
			religion_group = christian
			OR = {
				has_character_flag = title_monk
				has_character_flag = title_nun
			}
			OR = {
				AND = {
					has_character_flag = title_monk
					NOT = { trait = monk }
					NOT = { trait = perfecti }
				}
				AND = {
					has_character_flag = title_nun
					NOT = { trait = nun }
					NOT = { trait = perfecti }
				}
				is_ruler = yes
			}
		}
		allow = {
			always = yes
		}
		effect = {
			if = {
				limit = { is_female = no }
				clr_character_flag = title_monk
				remove_special_character_title = MONK_BROTHER
			}
			if = {
				limit = { is_female = yes }
				clr_character_flag = title_nun
				remove_special_character_title = NUN_SISTER
			}
		}
	}

	ai_desert_father_title_lose = {
		is_high_prio = yes
		potential = {
			ai = yes
			has_character_flag = is_desert_mother_father
			OR = {
				AND = {
					has_character_flag = title_desert_father
					NOT = { trait = desert_father }
				}
				AND = {
					has_character_flag = title_desert_mother
					NOT = { trait = desert_mother }
				}
				AND = {
					OR = {
						has_character_flag = title_desert_father
						has_character_flag = title_desert_mother
					}
					is_ruler = yes
				}
			}
		}
		allow = {
			always = yes
		}
		effect = {
			clr_character_flag = is_desert_mother_father
			if = {
				limit = { is_female = no }
				clr_character_flag = title_desert_father
				remove_special_character_title = DESERT_FATHER_TITLE
			}
			if = {
				limit = { is_female = yes }
				clr_character_flag = title_desert_mother
				remove_special_character_title = DESERT_MOTHER_TITLE
			}
		}
	}
	
	ai_become_monk = {
		potential = {
			ai = yes
			religion_group = christian
			is_adult = yes
			is_ruler = no
			prisoner = no
			OR = {
				trait = detached_priest
				trait = martial_cleric
				trait = scholarly_theologian
				trait = mastermind_theologian
				trait = zealous
				has_job_title = job_spiritual
			}
			NOR = {
				trait = cynical
				trait = ambitious
				trait = incapable
				trait = stressed
				trait = depressed
				trait = hedonist
				trait = monk
				trait = nun
				is_pregnant = yes
				trait = sympathy_islam
				trait = sympathy_pagans
				trait = sympathy_zoroastrianism
				trait = sympathy_judaism
				trait = sympathy_indian
				any_liege = { holy_order = yes }
				any_liege = { mercenary = yes }
				any_spouse = {
					trait = pregnant
					father_of_unborn = { character = ROOT }
				}
				any_heir_title = { always = yes }
				any_pretender_title = { always = yes }
				AND = {
					is_councillor = yes
					NOT = { has_job_title = job_spiritual }
				}
				has_minor_title = title_commander
				religion = cathar
				religion = bogomilist
				religion = miaphysite
				religion = monophysite
				has_character_modifier = voice_of_satan
				has_character_modifier = planning_claimant_adventure
				has_character_flag = claimant_adventurer
				has_character_flag = monk_refused
			}
		}
		allow = {
			is_ill = no
			calc_true_if = {
				amount = 2
				trait = zealous
				trait = humble
				trait = content
				trait = possessed
				trait = scholar
				trait = theologian
				trait = scholarly_theologian
				trait = mastermind_theologian
				has_character_modifier = voice_of_jesus
				has_job_title = job_spiritual
			}
			# Won't go if married unless zealous/lunatic/possessed or he hates his wife
			OR = {
				is_married = no
				trait = zealous
				trait = lunatic
				trait = possessed
				NOT = { 
					any_spouse = { reverse_opinion = { who = ROOT value = 0 } }
				}
			}
			# Won't go if he/she has a legit child unless lunatic/possessed
			OR = {
				NOT = {
					any_child = {
						is_alive = yes
						is_adult = no
						NOT = { trait = bastard }
					}
				}
				trait = lunatic
				trait = possessed
			}
			liege = {
				religion = ROOT
				war = no
			}
		}
		effect = {
			if = {
				limit = {
					liege = {
						OR = {
							ai = yes
							NOR = {
								dynasty = ROOT
								is_close_relative = ROOT
							}
						}
					}
				}
				any_spouse = { remove_spouse = ROOT }
				if = {
					limit = { is_female = no }
					change_learning = 1
					add_trait = monk
					set_character_flag = title_monk
					set_special_character_title = MONK_BROTHER
				}
				if = {
					limit = { is_female = yes }
					change_learning = 1
					add_trait = nun
					set_character_flag = title_nun
					set_special_character_title = NUN_SISTER
				}
			}
			if = {
				limit = {
					liege = {
						ai = no
						OR = {
							dynasty = ROOT
							is_close_relative = ROOT
						}
					}
				}
				liege = {
					letter_event = { id = emf_heresy.2062 }
				}
			}
		}
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0.01
				always = yes
			}
			modifier = {
				factor = 0.1
				NOT = { age = 20 }
			}
			modifier = {
				factor = 0.25
				NOT = { age = 25 }
			}
			modifier = {
				factor = 0.5
				NOT = { age = 30 }
			}
			modifier = {
				factor = 5
				OR = {
					liege = { is_theocracy = yes }
					has_job_title = job_spiritual
				}
			}
			modifier = {
				factor = 0.5
				NOR = {
					trait = detached_priest
					trait = martial_cleric
					trait = scholarly_theologian
					trait = mastermind_theologian
				}
			}
			modifier = {
				factor = 10
				has_character_modifier = voice_of_jesus
			}
			modifier = {
				factor = 2
				trait = zealous
			}
			modifier = {
				factor = 0.25
				trait = proud
			}
			modifier = {
				factor = 0.25
				trait = slothful
			}
			modifier = {
				factor = 0.25
				OR = {
					father_even_if_dead = { higher_tier_than = COUNT }
					mother_even_if_dead = { higher_tier_than = COUNT }
				}
			}
		}
	}	
	
	cathar_consolamentum = {
		potential = {
			OR = {
				religion = cathar
				religion = bogomilist
			}
			NOR = {
				trait = perfecti
				has_character_flag = consolamentum_taken
			}
		}
		allow = {
			is_adult = yes
			prisoner = no
			piety = 0
			NOR = {
				trait = incapable
				trait = cynical
				trait = lustful
				trait = hedonist
				trait = seducer
				trait = seductress
				has_character_modifier = voice_of_satan
			}
		}
		effect = {
			set_character_flag = consolamentum_taken
			add_trait = perfecti
			if = {
				limit = { NOT = { trait = celibate } }
				add_trait = celibate
			}
			if = {
				limit = { NOT = { trait = zealous } }
				add_trait = zealous
			}
		}
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0.1
				always = yes
			}
			modifier = {
				factor = 10
				is_theocracy = yes
			}
			modifier = {
				factor = 5
				trait = zealous
			}
			modifier = {
				factor = 5
				trait = celibate
			}
			modifier = {
				factor = 0.25
				trait = gluttonous
			}
			modifier = {
				factor = 0.25
				trait = envious
			}
			modifier = {
				factor = 0.25
				trait = greedy
			}
			modifier = {
				factor = 0
				religion = bogomilist
				has_job_title = job_spiritual
				NOT = { trait = zealous }
				liege = {
					NOR = {
						has_law = bogomilist_church_3
						has_law = bogomilist_church_4
					}
				}
			}
			modifier = {
				factor = 0
				NOT = { age = 25 }
			}
			modifier = {
				factor = 0
				NOR = {
					trait = zealous
					trait = possessed
					trait = lunatic
					trait = detached_priest
					trait = martial_cleric
					trait = scholarly_theologian
					trait = mastermind_theologian
					is_theocracy = yes
				}
			}
		}
	}
	
	cathar_adoption = {
        potential = {
			is_playable = yes
			OR = {
				religion = cathar
				religion = bogomilist
			}
			primary_title = {
				NOR = {
					has_law = succ_papal_succession
					has_law = succ_appointment
					has_law = succ_open_elective
					has_law = succ_catholic_bishopric
					has_law = succ_patrician_elective
				}
			}
			NOT = {
				any_child = {
					is_alive = yes
					NOT = { trait = bastard }
				}
			}
		}
		allow = {
			war = no
			has_regent = no
			any_realm_province = { religion = ROOT }
			OR = {
				age = 45
				trait = celibate
				NOT = { fertility = 0.05 }
			}
		}
		effect = {
			character_event = { id = emf_heresy.2006 tooltip = SEARCH_ADOPTED_CHILD }
		}
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0.1
				always = yes
			}
			modifier = {
				factor = 0
				current_heir = { dynasty = ROOT }
			}
		}
    }
	
	create_cathar_papacy = {
		is_high_prio = yes
		potential = {
			is_playable = yes
			religion = cathar
			NOR = {
				is_title_active = d_cathar
				any_demesne_title = { temporary = yes }
			}
		}
		allow = {
			war = no
			has_regent = no
			independent = yes
			trait = perfecti
			piety = 1000
			higher_tier_than = DUKE
			any_realm_title = { is_holy_site = ROOT }
		}
		effect = {
			character_event = { id = emf_heresy.2013 tooltip = CREATE_CATHAR_POPE }
		}
		ai_will_do = {
			factor = 1
		}
	}

	lollard_renounce_vows = {
		potential = {
			religion = lollard
			OR = {
				trait = monk
				trait = nun
				trait = celibate
			}
			is_adult = yes
			prisoner = no
			NOT = {
				trait = incapable
				has_character_modifier = lollard_former_monk
			}
		}
		allow = {
			piety = 50
		}
		effect = {
			piety = -50
			if = {
				limit = { trait = monk }
				remove_trait = monk
			}
			if = {
				limit = { trait = nun }
				remove_trait = nun
			}
			if = {
				limit = { trait = celibate }
				remove_trait = celibate
			}
			add_character_modifier = {
				name = lollard_former_monk
				duration = -1
			}
		}
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0.1
				always = yes
			}
			modifier = {
				factor = 0
				NOR = {
					trait = ambitious
					trait = cynical
					trait = slothful
				}
			}
			modifier = {
				factor = 0
				OR = {
					trait = zealous
					trait = content
					trait = humble
					trait = diligent
				}
			}
		}
	}

	lollard_translate_bible = {
		is_high_prio = yes
		potential = {
			has_dlc = "Way of Life"
			is_ruler = yes
			higher_tier_than = DUKE
			OR = {
				religion = lollard
				religion = waldensian
			}
			has_regent = no
			NOR = {
				has_character_flag = bible_translation_begun
				has_global_flag = bible_translation_finished
			}
		}
		allow = {
			war = no
			realm_size = 100
			realm_learning = 20
			scaled_wealth = 3.0
			OR = {
				has_focus = focus_theology
				has_focus = focus_scholarship
			}
		}
		effect = {
			set_character_flag = bible_translation_begun
			scaled_wealth = -3.0
			custom_tooltip = { text = BEGIN_TRANSLATING_BIBLE }
			random_list = {
				50 = {
					modifier = {
						factor = 1.1
						learning = 12
					}
					modifier = {
						factor = 1.1
						learning = 14
					}
					modifier = {
						factor = 1.2
						learning = 16
					}
					modifier = {
						factor = 1.2
						learning = 18
					}
					modifier = {
						factor = 1.2
						learning = 20
					}
					narrative_event = { id = emf_heresy.2017 days = 300 random = 500 tooltip = BIBLE_TRANSLATION_GOOD }
				}
				50 = {
					modifier = {
						factor = 0.8
						NOT = { learning = 8 }
					}
					modifier = {
						factor = 0.8
						NOT = { learning = 6 }
					}
					modifier = {
						factor = 0.8
						NOT = { learning = 4 }
					}
					narrative_event = { id = emf_heresy.2018 days = 300 random = 500 tooltip = BIBLE_TRANSLATION_POOR }
				}
			}
		}
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0
				trait = cynical
			}
			modifier = {
				factor = 0
				NOT = { scaled_wealth = 5.0 }
			}
		}
	}

	waldensian_choose_path = {
		is_high_prio = yes
		
		potential = {
			religion = waldensian
			NOR = {
				trait = sandaliati
				trait = novellani
				trait = doctores
				has_character_flag = wald_chose_path
			}
		}
		allow = {
			is_adult = yes
			prisoner = no
			NOT = { trait = incapable }
		}
		effect = {
			set_character_flag = wald_chose_path
			character_event = { id = emf_heresy.2031 }
		}
		ai_will_do = {
			factor = 1
		}
	}
	
	waldensian_charity = {
		potential = {
			religion = waldensian
			is_adult = yes
			is_playable = yes
			any_realm_province = { religion = waldensian }
			NOT = { has_character_flag = voluntary_charity }
		}
		allow = {
			scaled_wealth = 1.0
			NOT = { trait = greedy }
		}
		effect = {
			set_character_flag = voluntary_charity
			if = {
				limit = { NOT = { trait = charitable } }
				add_trait = charitable
			}
			scaled_wealth = -1.0
			piety = 100
			if = {
				limit = {
					NOT = {
						any_demesne_province = {
							religion = waldensian
							NOT = { has_province_modifier = wald_charity }
						}
					}
				}
				random_realm_province = {
					limit = {
						religion = waldensian
						NOT = { has_province_modifier = wald_charity }
					}
					add_province_modifier = {
						name = wald_charity
						duration = 1000
					}
				}
			}
			if = {
				limit = {
					NOT = {
						capital_scope = {
							religion = waldensian
							NOT = { has_province_modifier = wald_charity }
						}
					}
					any_demesne_province = {
						religion = waldensian
						NOT = { has_province_modifier = wald_charity }
					}
				}
				random_demesne_province = {
					limit = {
						religion = waldensian
						NOT = { has_province_modifier = wald_charity }
					}
					add_province_modifier = {
						name = wald_charity
						duration = 1000
					}
				}
			}
			if = {
				limit = {
					capital_scope = {
						religion = waldensian
						NOT = { has_province_modifier = wald_charity }
					}
				}
				capital_scope = {
					add_province_modifier = {
						name = wald_charity
						duration = 1000
					}
				}
			}
		}
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0
				OR = {
					NOT = { scaled_wealth = 3.0 }
					piety = 100
				}
			}
		}
	}

	waldensian_hospital = {
		potential = {
			has_dlc = "Way of Life"
			religion = waldensian
			higher_real_tier_than = DUKE
			capital_scope = {
				NOT = { has_province_modifier = wald_hospital }
			}
		}
		allow = {
			war = no
			has_regent = no
			has_focus = focus_rulership
			wealth = 500
		}
		effect = {
			wealth = -500
			piety = 100
			capital_scope = {
				if = {
					limit = { NOT = { religion = waldensian } }
					religion = waldensian
				}
				add_province_modifier = {
					name = wald_hospital
					duration = -1
				}
			}
		}
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0
				NOT = { wealth = 1000 }
			}
		}
	}

}

