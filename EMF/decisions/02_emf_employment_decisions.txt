# -*- ck2.decisions -*-

decisions = {
	emf_toggle_employment = {
		only_playable = yes
		potential = {
			ai = no
		}
		effect = {
			if = {
				limit = {
					NOT = { has_character_flag = emf_toggle_employment }
				}
				set_character_flag = emf_toggle_employment
				break = yes
			}
			clr_character_flag = emf_toggle_employment
		}
		ai_will_do = {
			factor = 0
		}
	}

	employ_priest = {
		only_playable = yes
		potential = {
			OR = {
				ai = yes
				has_character_flag = emf_toggle_employment
			}
			OR = {
				ai = no
				has_autocephaly = yes
				is_theocracy = yes
				is_tribal = yes
			}
		}
		allow = {
			custom_tooltip = { text = NEEDS_25_PIETY_COST hidden_tooltip = { piety = 25 } }
			in_seclusion = no
			custom_tooltip = {
				text = NOT_RECRUITED_COURTIER_ONE_MONTH
				hidden_tooltip = {
					NOT = { has_character_modifier = emf_employ_priest_timer }
				}
			}
		}
		effect = {
			add_character_modifier = { name = emf_employ_priest_timer duration = 30 hidden = yes }
			piety = -25
			random_list = {
				50 = {
					modifier = {
						factor = 0
						religion_allows_female_temple_holders = no
					}
					create_random_priest = {
						random_traits = yes
						dynasty = random
						female = yes
						attributes = {
							diplomacy = 2
							martial = 2
							stewardship = 2
							intrigue = 2
							learning = 5
						}
					}
				}
				50 = {
					modifier = {
						factor = 0
						religion_allows_male_temple_holders = no
					}
					create_random_priest = {
						random_traits = yes
						dynasty = random
						female = no
						attributes = {
							diplomacy = 2
							martial = 2
							stewardship = 2
							intrigue = 2
							learning = 5
						}
					}
				}
			}
			new_character = {
				remove_trait = dull

				emf_remove_lifestyle_traits = yes

				random_list = {
					20 = { }
					15 = { change_learning = 1 }
					10 = { change_learning = 2 }
					5  = { change_learning = 3 }
					3  = { change_learning = 4 }
					2  = { change_learning = 5 }
				}

				random_list = {
					60 = { }
					25 = { add_trait = theologian }
					15 = {
						if = {
							limit = { religion_group = muslim }
							add_trait = faqih
						}
						else = {
							add_trait = scholar
						}
					}
					15 = { add_trait = erudite }
					5  = { add_trait = shrewd }
				}
				
				#If we have a wonder upgrade with "inpires_learning" flag, the priest will be better
				if = {
					limit = { ROOT = { realm_wonder_or_upgrade_has_flag_inspires_learning_trigger = yes } }
					random_list = { 
						15 = {
							if = {
								limit = { religion_group = muslim }
								add_trait = faqih
							}
							else = {
								add_trait = scholar
							}
							change_learning = 1
						}
						10 = {
							if = {
								limit = { religion_group = muslim }
								add_trait = faqih
							}
							else = {
								add_trait = scholar
							}
							change_learning = 2
						}
						 5 = {
							if = {
								limit = { religion_group = muslim }
								add_trait = faqih
							}
							else = {
								add_trait = scholar
							}
							change_learning = 3
						}
						10 = { add_trait = erudite }
						10 = { add_trait = physician }
						10 = { add_trait = scholarly_theologian }
						10 = { add_trait = mastermind_theologian }
					}
					random_list = {
						50 = {  } # Nothing
						10 = { add_trait = genius }
						10 = { add_trait = chaste }
						10 = { add_trait = poet }
						10 = { add_trait = proud }
						10 = { add_trait = humble }
					}
				}

				hidden_tooltip = {
					if = {
						limit = {
							religion_group = christian
							NOR = {
								religion = cathar
								religion = bogomilist
								religion = miaphysite
								religion = monophysite
							}
						}
						if = {
							limit = { is_female = no }
							add_trait = monk
							set_character_flag = title_monk
							set_special_character_title = MONK_BROTHER
						}
						if = {
							limit = { is_female = yes }
							add_trait = nun
							set_character_flag = title_nun
							set_special_character_title = NUN_SISTER
						}
					}
					if = {
						limit = {
							OR = {
								religion = miaphysite
								religion = monophysite
							}
						}
						if = {
							limit = { is_female = yes }
							add_trait = desert_mother
							set_character_flag = title_desert_mother
							set_special_character_title = DESERT_MOTHER_TITLE
						}
						if = {
							limit = { is_female = no }
							add_trait = desert_father
							set_character_flag = title_desert_father
							set_special_character_title = DESERT_FATHER_TITLE
						}
					}
					if = {
						limit = {
							OR = {
								religion = cathar
								religion = bogomilist
							}
						}
						remove_trait = incapable
						remove_trait = cynical
						remove_trait = lustful
						add_trait = zealous
						add_trait = perfecti
						set_character_flag = consolamentum_taken
						if = {
							limit = { is_female = no }
							set_character_flag = title_monk
							set_special_character_title = MONK_BROTHER
						}
						if = {
							limit = { is_female = yes }
							set_character_flag = title_nun
							set_special_character_title = NUN_SISTER
						}
					}
					emf_new_character_priest = yes
					emf_dna_improve_homozygous_recessive_for_intelligence = yes
					remove_trait = dim
					remove_trait = slow
					remove_trait = imbecile
					save_event_target_as = invited_character
				}
			}
			if = {
				limit = { ai = yes }
				change_variable = { which = "global_n_ai_employed_priests" value = 1 }
			}
			hidden_tooltip = { character_event = { id = NE.1 } }
		}
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0
				NOR = {
					AND = {
						has_autocephaly = yes
						NOT = { any_courtier = { has_job_title = job_spiritual } }
					}
					AND = {
						is_theocracy = yes
						NOT = {
							any_courtier = {
								religion = ROOT
								has_education_learning_trigger = yes
								count = 3
							}
						}
					}
					AND = {
						is_tribal = yes
						NOT = {
							any_courtier = {
								is_adult = yes
								health = 4
								religion = ROOT
								culture = ROOT
								is_ruler = no
								OR = {
									is_female = no
									religion_allows_female_temple_holders = yes
								}
								OR = {
									has_education_learning_trigger = yes
									learning = 8
								}
								NOR = {
									is_incapable = yes
									trait = cynical
									NOT = { ai_ambition = -39 }
									trait = stressed
									trait = depressed
									is_dumb_trigger = yes
									has_severe_disability_trigger = yes
									any_heir_title = { always = yes }
								}
							}
						}
					}
				}
			}
		}
	}

	employ_steward = {
		only_playable = yes
		potential = {
			ai = no
			has_character_flag = emf_toggle_employment
		}
		allow = {
			custom_tooltip = {
				text = HAVE_SUFFICIENT_WEALTH
				hidden_tooltip = {
					wealth = 25
					scaled_wealth = 0.25
				}
			}
			custom_tooltip = { text = NEEDS_25_PRESTIGE_COST hidden_tooltip = { prestige = 25 } }
			in_seclusion = no
			custom_tooltip = {
				text = NOT_RECRUITED_COURTIER_ONE_MONTH
				hidden_tooltip = {
					NOT = { has_character_modifier = emf_employ_steward_timer }
				}
			}
		}
		effect = {
			add_character_modifier = { name = emf_employ_steward_timer duration = 30 hidden = yes }
			scaled_wealth = { value = -0.25 min = -25 }
			prestige = -25
			random_list = {
				50 = {
					modifier = {
						factor = 0
						NOT = { has_religion_feature = religion_matriarchal }
						gender_equality_trigger = no
					}
					create_random_steward = {
						random_traits = yes
						dynasty = random
						female = yes
						attributes = {
							diplomacy = 2
							martial = 2
							stewardship = 5
							intrigue = 2
							learning = 2
						}
					}
				}
				50 = {
					modifier = {
						factor = 0
						has_religion_feature = religion_matriarchal
					}
					create_random_steward = {
						random_traits = yes
						dynasty = random
						female = no
						attributes = {
							diplomacy = 2
							martial = 2
							stewardship = 5
							intrigue = 2
							learning = 2
						}
					}
				}
			}
			new_character = {
				remove_trait = dull

				emf_remove_lifestyle_traits = yes

				random_list = {
					20 = { }
					15 = { change_stewardship = 1 }
					10 = { change_stewardship = 2 }
					5  = { change_stewardship = 3 }
					3  = { change_stewardship = 4 }
					2  = { change_stewardship = 5 }
				}
				random_list = {
					50 = { }
					15 = { add_trait = gardener }
					15 = { add_trait = architect }
					15 = { add_trait = administrator }
					5  = { add_trait = shrewd }
				}
				emf_new_character_steward = yes
				emf_dna_improve_homozygous_recessive_for_intelligence = yes
				remove_trait = dim
				remove_trait = slow
				remove_trait = imbecile
				save_event_target_as = invited_character
			}
			hidden_tooltip = {
				character_event = { id = NE.1 }
			}
		}
		ai_will_do = {
			factor = 0
		}
	}

	emf_employ_soldier = {
		only_playable = yes
		potential = {
			ai = no
			has_character_flag = emf_toggle_employment
		}
		allow = {
			custom_tooltip = {
				text = HAVE_SUFFICIENT_WEALTH
				hidden_tooltip = {
					wealth = 25
					scaled_wealth = 0.25
				}
			}
			custom_tooltip = { text = NEEDS_25_PRESTIGE_COST hidden_tooltip = { prestige = 25 } }
			in_seclusion = no
			custom_tooltip = {
				text = NOT_RECRUITED_COURTIER_ONE_MONTH
				hidden_tooltip = {
					NOT = { has_character_modifier = emf_employ_soldier_timer }
				}
			}
		}
		effect = {
			add_character_modifier = { name = emf_employ_soldier_timer duration = 30 hidden = yes }
			scaled_wealth = { value = -0.25 min = -25 }
			prestige = -25
			random_list = {
				50 = {
					modifier = {
						factor = 0
						NOT = { has_religion_feature = religion_matriarchal }
						gender_equality_trigger = no
					}
					create_random_soldier = {
						random_traits = yes
						dynasty = random
						female = yes
						attributes = {
							diplomacy = 2
							martial = 5
							stewardship = 2
							intrigue = 2
							learning = 2
						}
					}
				}
				50 = {
					modifier = {
						factor = 0
						has_religion_feature = religion_matriarchal
					}
					create_random_soldier = {
						random_traits = yes
						dynasty = random
						female = no
						attributes = {
							diplomacy = 2
							martial = 5
							stewardship = 2
							intrigue = 2
							learning = 2
						}
					}
				}
			}
			new_character = {
				remove_trait = dull

				emf_remove_lifestyle_traits = yes

				random_list = {
					60 = { }
					40 = { change_martial = 1 }
					20 = { change_martial = 2 }
					10 = { change_martial = 3 }
					5  = { change_martial = 4 }
					2  = { change_martial = 5 }
				}
				random_list = {
					50 = { }
					12 = { add_trait = duelist }
					12 = { add_trait = hunter }
					12 = { add_trait = strategist }
					8  = { add_trait = robust }
					3  = { add_trait = tall }
					3  = { add_trait = imposing }
					2  = {
						add_trait = tall
						add_trait = imposing
					}
				}
				if = {
					limit = {
						any_owned_bloodline = {
							has_bloodline_flag = bloodline_inspire_commanders
							bloodline_is_active_for = PREV
						}
					}
					remove_trait = craven
					change_diplomacy = 1
					change_learning = 1
					change_stewardship = 1
					change_intrigue = 1
					change_martial = 1
					if = {
						limit = { trait = misguided_warrior }
						remove_trait = misguided_warrior
						add_trait = tough_soldier
					}
					if = {
						limit = { trait = tough_soldier }
						remove_trait = tough_soldier
						add_trait = skilled_tactician
					}
					if = {
						limit = { trait = skilled_tactician }
						remove_trait = skilled_tactician
						add_trait = brilliant_strategist
					}
					random_list = {
						60 = { }
						40 = { change_martial = 1 }
						20 = { change_martial = 2 }
						10 = { change_martial = 3 }
						5  = { change_martial = 4 }
						2  = { change_martial = 5 }
					}
					random_list = {
						50 = { }
						12 = { add_trait = duelist }
						12 = { add_trait = hunter }
						12 = { add_trait = strategist }
						8  = { add_trait = robust }
						3  = { add_trait = tall }
						3  = { add_trait = imposing }
						2  = {
							add_trait = tall
							add_trait = imposing
						}
					}
				}
				random = {
					chance = 3
					modifier = {
						factor = 0
						NOT = { has_dlc = "Reapers" }
					}
					add_trait = one_eyed
				}
				emf_new_character_noble = yes
				emf_dna_improve_homozygous_recessive_for_intelligence = yes
				remove_trait = dim
				remove_trait = slow
				remove_trait = imbecile
				emf_dna_improve_homozygous_recessive_for_strength = yes
				remove_trait = delicate
				remove_trait = weak
				set_character_flag = invited_soldier
				save_event_target_as = invited_character
			}
			hidden_tooltip = {
				character_event = { id = NE.1 }
			}
		}
		ai_will_do = {
			factor = 0
		}
	}

	emf_employ_spy = {
		only_playable = yes
		potential = {
			ai = no
			has_character_flag = emf_toggle_employment
		}
		allow = {
			custom_tooltip = {
				text = HAVE_SUFFICIENT_WEALTH
				hidden_tooltip = {
					wealth = 25
					scaled_wealth = 0.25
				}
			}
			custom_tooltip = { text = NEEDS_25_PRESTIGE_COST hidden_tooltip = { prestige = 25 } }
			in_seclusion = no
			custom_tooltip = {
				text = NOT_RECRUITED_COURTIER_ONE_MONTH
				hidden_tooltip = {
					NOT = { has_character_modifier = emf_employ_spy_timer }
				}
			}
		}
		effect = {
			add_character_modifier = { name = emf_employ_spy_timer duration = 30 hidden = yes }
			scaled_wealth = { value = -0.25 min = -25 }
			prestige = -25
			random_list = {
				50 = {
					modifier = {
						factor = 0
						NOT = { has_religion_feature = religion_matriarchal }
						gender_equality_trigger = no
					}
					create_random_intriguer = {
						random_traits = yes
						dynasty = random
						female = yes
						attributes = {
							diplomacy = 2
							martial = 2
							stewardship = 2
							intrigue = 5
							learning = 2
						}
					}
				}
				50 = {
					modifier = {
						factor = 0
						has_religion_feature = religion_matriarchal
					}
					create_random_intriguer = {
						random_traits = yes
						dynasty = random
						female = no
						attributes = {
							diplomacy = 2
							martial = 2
							stewardship = 2
							intrigue = 5
							learning = 2
						}
					}
				}
			}
			new_character = {
				remove_trait = dull

				emf_remove_lifestyle_traits = yes

				random_list = {
					20 = { }
					15 = { change_intrigue = 1 }
					10 = { change_intrigue = 2 }
					5  = { change_intrigue = 3 }
					3  = { change_intrigue = 4 }
					2  = { change_intrigue = 5 }
				}
				random_list = {
					50 = { }
					15 = { add_trait = schemer }
					15 = { add_trait = impaler }
					15 = { add_trait = seducer }
					5  = { add_trait = shrewd }
				}
				if = {
					limit = { emf_religion_has_castes = yes }
					emf_copy_caste_from_ROOT = yes
				}
				emf_new_character = yes
				emf_dna_improve_homozygous_recessive_for_intelligence = yes
				remove_trait = dim
				remove_trait = slow
				remove_trait = imbecile
				save_event_target_as = invited_character
			}
			hidden_tooltip = {
				character_event = { id = NE.1 }
			}
		}
		ai_will_do = {
			factor = 0
		}
	}

	emf_employ_diplomat = {
		only_playable = yes
		potential = {
			ai = no
			has_character_flag = emf_toggle_employment
		}
		allow = {
			custom_tooltip = {
				text = HAVE_SUFFICIENT_WEALTH
				hidden_tooltip = {
					wealth = 25
					scaled_wealth = 0.25
				}
			}
			custom_tooltip = { text = NEEDS_25_PRESTIGE_COST hidden_tooltip = { prestige = 25 } }
			in_seclusion = no
			custom_tooltip = {
				text = NOT_RECRUITED_COURTIER_ONE_MONTH
				hidden_tooltip = {
					NOT = { has_character_modifier = emf_employ_diplomat_timer }
				}
			}
		}
		effect = {
			add_character_modifier = { name = emf_employ_diplomat_timer duration = 30 hidden = yes }
			scaled_wealth = { value = -0.25 min = -25 }
			prestige = -25
			random_list = {
				50 = {
					modifier = {
						factor = 0
						NOT = { has_religion_feature = religion_matriarchal }
						gender_equality_trigger = no
					}
					create_random_diplomat = {
						random_traits = yes
						dynasty = random
						female = yes
						attributes = {
							diplomacy = 5
							martial = 2
							stewardship = 2
							intrigue = 2
							learning = 2
						}
					}
				}
				50 = {
					modifier = {
						factor = 0
						has_religion_feature = religion_matriarchal
					}
					create_random_diplomat = {
						random_traits = yes
						dynasty = random
						female = no
						attributes = {
							diplomacy = 5
							martial = 2
							stewardship = 2
							intrigue = 2
							learning = 2
						}
					}
				}
			}
			new_character = {
				remove_trait = dull

				emf_remove_lifestyle_traits = yes

				random_list = {
					60 = { }
					40 = { change_diplomacy = 1 }
					20 = { change_diplomacy = 2 }
					10 = { change_diplomacy = 3 }
					5  = { change_diplomacy = 4 }
					2  = { change_diplomacy = 5 }
				}
				random_list = {
					50 = { }
					15 = { add_trait = socializer }
					15 = { add_trait = gamer }
					15 = {
						add_trait = gregarious
						add_trait = fair
					}
					5  = { add_trait = shrewd }
				}
				if = {
					limit = { emf_religion_has_castes = yes }
					emf_copy_caste_from_ROOT = yes
				}
				emf_new_character = yes
				emf_dna_improve_homozygous_recessive_for_intelligence = yes
				remove_trait = dim
				remove_trait = slow
				remove_trait = imbecile
				save_event_target_as = invited_character
			}
			hidden_tooltip = {
				character_event = { id = NE.1 }
			}
		}
		ai_will_do = {
			factor = 0
		}
	}

	present_debutante = {
		ai = no
		only_playable = yes
		
		potential = {
			has_character_flag = emf_toggle_employment
			NOT = {
				has_religion_feature = religion_matriarchal
			}
		}
		allow = {
			custom_tooltip = {
				text = HAVE_SUFFICIENT_WEALTH
				hidden_tooltip = {
					wealth = 20
					scaled_wealth = 0.2
				}
			}
			custom_tooltip = { text = NEEDS_10_PRESTIGE_COST hidden_tooltip = { prestige = 10 } }
			in_seclusion = no
			custom_tooltip = {
				text = NOT_RECRUITED_COURTIER_ONE_MONTH
				hidden_tooltip = {
					NOT = { has_character_modifier = emf_present_debutante_timer }
				}
			}
		}
		effect = {
			scaled_wealth = { value = -0.2 min = -20 }
			prestige = -10
			add_character_modifier = { name = emf_present_debutante_timer duration = 30 hidden = yes }
			create_character = {
				random_traits = yes
				dynasty = actually_culture
				female = yes
				age = 16
			}
			new_character = {
				remove_trait = dull
				remove_trait = inbred
				random_list = {
					10 = {}
					10 = { add_age = 1 }
					10 = { add_age = 2 }
					10 = { add_age = 3 }
				}
				random_list = {
					50 = { }
					5 = {
						add_trait = shy
						add_trait = humble
						change_diplomacy = 3
					}
					5 =  { add_trait = tall }
					5 =  { add_trait = calm_voice }
					10 = { add_trait = melodious_voice }
					10 = { add_trait = fertile }
					20 = { add_trait = fair }
					3 = {
						add_trait = fertile
						add_trait = fair
					}
				}
				if = {
					limit = { emf_religion_has_castes = yes }
					emf_copy_caste_from_ROOT = yes
				}
				emf_new_character = yes
				emf_dna_remove_negative_mendelian_traits_with_genetics = yes
				emf_dna_improve_homozygous_recessive_for_intelligence = yes
				remove_trait = dim
				remove_trait = slow
				remove_trait = imbecile
				emf_dna_improve_homozygous_recessive_for_attractiveness = yes
				remove_trait = homely
				remove_trait = ugly
				set_character_flag = debutante
				save_event_target_as = invited_character
			}
			hidden_tooltip = {
				character_event = { id = NE.1 }
			}
		}
		ai_will_do = {
			factor = 0
		}
	}
	
	present_bachelor = {
		ai = no
		only_playable = yes
		
		potential = {
			has_character_flag = emf_toggle_employment
			OR = {
				has_religion_feature = religion_matriarchal
				gender_equality_trigger = yes
			}
		}
		allow = {
			custom_tooltip = {
				text = HAVE_SUFFICIENT_WEALTH
				hidden_tooltip = {
					wealth = 20
					scaled_wealth = 0.2
				}
			}
			custom_tooltip = { text = NEEDS_10_PRESTIGE_COST hidden_tooltip = { prestige = 10 } }
			in_seclusion = no
			custom_tooltip = {
				text = NOT_RECRUITED_COURTIER_ONE_MONTH
				hidden_tooltip = {
					NOT = { has_character_modifier = emf_present_debutante_timer }
				}
			}
		}
		effect = {
			scaled_wealth = { value = -0.2 min = -20 }
			prestige = -10
			add_character_modifier = { name = emf_present_debutante_timer duration = 30 hidden = yes }
			create_character = {
				random_traits = yes
				dynasty = actually_culture
				female = no
				age = 16
			}
			new_character = {
				remove_trait = dull
				remove_trait = inbred
				random_list = {
					10 = {}
					10 = { add_age = 1 }
					10 = { add_age = 2 }
					10 = { add_age = 3 }
				}
				random_list = {
					50 = { }
					5 = {
						add_trait = shy
						add_trait = humble
						change_diplomacy = 3
					}
					5 =  { add_trait = tall }
					5 =  { add_trait = calm_voice }
					10 = { add_trait = melodious_voice }
					10 = { add_trait = fertile }
					20 = { add_trait = fair }
					3 = {
						add_trait = fertile
						add_trait = fair
					}
				}
				if = {
					limit = { emf_religion_has_castes = yes }
					emf_copy_caste_from_ROOT = yes
				}
				emf_new_character = yes
				emf_dna_remove_negative_mendelian_traits_with_genetics = yes
				emf_dna_improve_homozygous_recessive_for_intelligence = yes
				remove_trait = dim
				remove_trait = slow
				remove_trait = imbecile
				emf_dna_improve_homozygous_recessive_for_attractiveness = yes
				remove_trait = homely
				remove_trait = ugly
				set_character_flag = debutante
				save_event_target_as = invited_character
			}
			hidden_tooltip = {
				character_event = { id = NE.1 }
			}
		}
		ai_will_do = {
			factor = 0
		}
	}
}

